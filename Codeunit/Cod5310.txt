OBJECT Codeunit 5310 Outlook Synch. Resolve Confl.
{
  OBJECT-PROPERTIES
  {
    Date=05/11/08;
    Time=12:00:00;
    Version List=NAVW16.00;
  }
  PROPERTIES
  {
    TableNo=472;
    OnRun=VAR
            XMLTextReader@1001 : Automation "{CAF2CEDD-2636-48EC-AE94-3A2E78BDCAA4} 1.0:{8FC8A753-24F6-495F-98BB-E975695CA4C9}:'Microsoft Dynamics NAV Outlook Synchronization Common Library'.XmlTextReader";
          BEGIN
            JQEntry := Rec;
            CLEAR(XMLTextReader);
            CREATE(XMLTextReader);

            IF NOT OSynchNAVMgt.GetXMLFromJQEntry(XMLTextReader,JQEntry) THEN
              ERROR(Text001);

            CREATE(ErrorLogXMLWriter);
            ErrorLogXMLWriter.WriteStartDocument;
            ErrorLogXMLWriter.WriteStartElement('SynchronizationMessage');
            OSynchOutlookMgt.ProcessOutlookChanges("User ID",XMLTextReader,ErrorLogXMLWriter,TRUE);

            IF NOT ISCLEAR(ErrorLogXMLWriter) THEN BEGIN
              ErrorLogXMLWriter.WriteEndElement;
              ErrorLogXMLWriter.WriteEndDocument;

              IF NOT OSynchNAVMgt.PutXMLToJQResponse(JQEntry,ErrorLogXMLWriter) THEN BEGIN
                CLEAR(ErrorLogXMLWriter);
                ERROR(Text002);
              END;
              CLEAR(ErrorLogXMLWriter);
            END;
            Rec := JQEntry;
          END;

  }
  CODE
  {
    VAR
      Text001@1000 : TextConst 'ENU=The synchronization failed because the synchronization data from Microsoft Outlook cannot be processed. Try again later and if the problem persists contact your system administrator.;FRA=La synchronisation a ‚chou‚ car les donn‚es de synchronisation de Microsoft Outlook ne peuvent pas ˆtre trait‚es. R‚essayez plus tard et, si le problŠme persiste, contactez votre administrateur systŠme.';
      Text002@1001 : TextConst 'ENU=The synchronization failed because the synchronization data from Microsoft Dynamics NAV could not be sent. Try again later and if the problem persists contact your system administrator.;FRA=La synchronisation a ‚chou‚ car les donn‚es de synchronisation de Microsoft Dynamics NAV n''ont pas pu ˆtre envoy‚es. R‚essayez plus tard et, si le problŠme persiste, contactez votre administrateur systŠme.';
      JQEntry@1005 : Record 472;
      OSynchOutlookMgt@1004 : Codeunit 5304;
      OSynchNAVMgt@1003 : Codeunit 5301;
      ErrorLogXMLWriter@1002 : Automation "{CAF2CEDD-2636-48EC-AE94-3A2E78BDCAA4} 1.0:{25FBE079-487E-44F2-8352-23B354C2AD0E}:'Microsoft Dynamics NAV Outlook Synchronization Common Library'.XmlTextWriter";

    BEGIN
    END.
  }
}