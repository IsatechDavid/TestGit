OBJECT Form 5050 Contact Card
{
  OBJECT-PROPERTIES
  {
    Date=28/02/14;
    Time=11:42:41;
    Modified=Yes;
    Version List=NAVW16.00.10,NAVFR5.00,IMH6.01;
  }
  PROPERTIES
  {
    Width=20790;
    Height=13090;
    CaptionML=[ENU=Contact Card;
               FRA=Fiche contact];
    SourceTable=Table5050;
    UpdateOnActivate=Yes;
    OnOpenForm=VAR
                 MapMgt@1000 : Codeunit 802;
               BEGIN
                 //IF NOT MapMgt.TestSetup THEN
                 //  CurrForm.MapPoint.VISIBLE(FALSE);

                 // <<IMH06.ISAT.MA
                 IF "Service Contact" = "Service Contact"::Provider THEN BEGIN
                   CurrForm.EDITABLE(ProviderMgt.IsEditable("No."))
                 END ELSE
                   CurrForm.EDITABLE(TRUE);
                 // >>IMH06.ISAT.MA
               END;

    OnFindRecord=VAR
                   RecordFound@1000 : Boolean;
                 BEGIN
                   RecordFound := FIND(Which);
                   CurrForm.EDITABLE := RecordFound OR (GETFILTER("No.") = '');
                   CurrForm.ContractContact.VISIBLE :=  ("Service Contact" = "Service Contact"::Beneficiary);

                   EXIT(RecordFound);
                 END;

    OnAfterGetRecord=BEGIN
                       SETRANGE("No.");
                       KeyBoardAddress :='';
                       //<<IMH07
                       CurrForm.PActivity.VISIBLE := ("Service Contact" = "Service Contact"::Beneficiary);
                       CurrForm.Todos.VISIBLE := ("Service Contact" = "Service Contact"::Beneficiary);
                       CurrForm.PService.VISIBLE := ("Service Contact" = "Service Contact"::Beneficiary);
                       CurrForm.CalcService.VISIBLE := ("Service Contact" = "Service Contact"::Beneficiary);
                       CurrForm.PServiceHeader.VISIBLE := ("Service Contact" = "Service Contact"::Beneficiary);
                       CurrForm.CalcServiceHeader.VISIBLE := ("Service Contact" = "Service Contact"::Beneficiary);
                       CurrForm.PIntervention.VISIBLE := ("Service Contact" = "Service Contact"::Beneficiary);
                       CurrForm.CalcInterv.VISIBLE := ("Service Contact" = "Service Contact"::Beneficiary);
                       //>>MH07
                       CurrForm.Birthdate.VISIBLE(NOT ("Service Contact" = "Service Contact"::Provider));  //IMH08

                       //<<IMH
                       //CheckContract;
                       //>>IMH
                     END;

    OnAfterGetCurrRecord=BEGIN
                           EnableFields;

                           IF Type = Type::Person THEN
                             IntegrationFindCustomerNo;
                           // <<IMH06.ISAT.MA
                           IF "Service Contact" = "Service Contact"::Provider THEN
                             CurrForm.EDITABLE(ProviderMgt.IsEditable("No."))
                           ELSE
                             CurrForm.EDITABLE(TRUE);
                           // >>IMH06.ISAT.MA
                         END;

  }
  CONTROLS
  {
    { 1   ;TabControl   ;220  ;220  ;16280;8360 ;HorzGlue=Both;
                                                 VertGlue=Top;
                                                 PageNamesML=[ENU=General,Communication,Segmentation,Foreign Trade;
                                                              FRA=G‚n‚ral,Communication,Segmentation,International] }
    { 2   ;TextBox      ;3850 ;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="No.";
                                                 OnAssistEdit=BEGIN
                                                                IF AssistEdit(xRec) THEN
                                                                  CurrForm.UPDATE;
                                                              END;
                                                               }
    { 3   ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=2 }
    { 4   ;TextBox      ;3850 ;1540 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr=Type;
                                                 OnAfterValidate=BEGIN
                                                                   EnableFields;
                                                                 END;
                                                                  }
    { 5   ;Label        ;440  ;1540 ;3300 ;440  ;ParentControl=4 }
    { 6   ;TextBox      ;3850 ;2200 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 NextControl=10;
                                                 SourceExpr="Company No." }
    { 7   ;Label        ;440  ;2200 ;3300 ;440  ;ParentControl=6 }
    { 8   ;TextBox      ;3850 ;2750 ;5500 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 AssistEdit=Yes;
                                                 PermanentAssist=Yes;
                                                 SourceExpr="Company Name";
                                                 OnAssistEdit=BEGIN
                                                                Cont.SETRANGE("No.","Company No.");
                                                                CLEAR(CompanyDetails);
                                                                CompanyDetails.SETTABLEVIEW(Cont);
                                                                CompanyDetails.SETRECORD(Cont);
                                                                IF Type = Type::Person THEN
                                                                  CompanyDetails.EDITABLE := FALSE;
                                                                CompanyDetails.RUNMODAL;
                                                              END;
                                                               }
    { 9   ;Label        ;440  ;2750 ;3300 ;440  ;ParentControl=8 }
    { 10  ;TextBox      ;3850 ;4070 ;5500 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 AssistEdit=Yes;
                                                 PermanentAssist=Yes;
                                                 SourceExpr=Name;
                                                 OnAssistEdit=BEGIN
                                                                MODIFY;
                                                                COMMIT;
                                                                Cont.SETRANGE("No.","No.");
                                                                IF Type = Type::Person THEN BEGIN
                                                                  CLEAR(NameDetails);
                                                                  NameDetails.SETTABLEVIEW(Cont);
                                                                  NameDetails.SETRECORD(Cont);
                                                                  NameDetails.RUNMODAL;
                                                                END ELSE BEGIN
                                                                  CLEAR(CompanyDetails);
                                                                  CompanyDetails.SETTABLEVIEW(Cont);
                                                                  CompanyDetails.SETRECORD(Cont);
                                                                  CompanyDetails.RUNMODAL;
                                                                END;
                                                                GET("No.");
                                                                CurrForm.UPDATE;
                                                              END;

                                                 OnAfterValidate=BEGIN
                                                                   //**eb
                                                                   IF xRec.Name = '' THEN BEGIN
                                                                     Name := UPPERCASE(Name);
                                                                     CurrForm.UPDATE;
                                                                   END;
                                                                   //**
                                                                 END;
                                                                  }
    { 11  ;Label        ;440  ;4070 ;3300 ;440  ;ParentControl=10 }
    { 12  ;TextBox      ;3850 ;5720 ;5500 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 AssistEdit=No;
                                                 SourceExpr=Address;
                                                 OnAssistEdit=BEGIN
                                                                AddressStandardization.AssistContactAddr(Rec);      //IMH05 isat.zw
                                                              END;
                                                               }
    { 13  ;Label        ;440  ;5720 ;3300 ;440  ;ParentControl=12 }
    { 14  ;TextBox      ;3850 ;6270 ;5500 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Address 2" }
    { 15  ;Label        ;440  ;6270 ;3300 ;440  ;ParentControl=14 }
    { 16  ;TextBox      ;3850 ;8030 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 NextControl=34;
                                                 SourceExpr="Post Code" }
    { 17  ;Label        ;440  ;8030 ;3300 ;440  ;ParentControl=16;
                                                 CaptionML=[ENU=Post Code/City;
                                                            FRA=CP/Ville] }
    { 20  ;TextBox      ;12980;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Search Name" }
    { 21  ;Label        ;9570 ;990  ;3300 ;440  ;ParentControl=20 }
    { 24  ;TextBox      ;12980;2640 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Salesperson Code" }
    { 25  ;Label        ;9570 ;2640 ;3300 ;440  ;ParentControl=24 }
    { 26  ;TextBox      ;12980;3410 ;1650 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Last Date Modified" }
    { 27  ;Label        ;9570 ;3410 ;3300 ;440  ;ParentControl=26 }
    { 28  ;TextBox      ;12980;3960 ;1650 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Date of Last Interaction";
                                                 OnDrillDown=VAR
                                                               InteractionLogEntry@1000 : Record 5065;
                                                             BEGIN
                                                               InteractionLogEntry.SETCURRENTKEY("Contact Company No.",Date,"Contact No.",Canceled,"Initiated By","Attempt Failed");
                                                               InteractionLogEntry.SETRANGE("Contact Company No.","Company No.");
                                                               InteractionLogEntry.SETFILTER("Contact No.","Lookup Contact No.");
                                                               InteractionLogEntry.SETRANGE("Attempt Failed",FALSE);
                                                               IF InteractionLogEntry.FIND('+') THEN
                                                                 FORM.RUN(0,InteractionLogEntry);
                                                             END;
                                                              }
    { 29  ;Label        ;9570 ;3960 ;3300 ;440  ;ParentControl=28 }
    { 30  ;TextBox      ;12980;4510 ;1650 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Last Date Attempted";
                                                 OnDrillDown=VAR
                                                               InteractionLogEntry@1000 : Record 5065;
                                                             BEGIN
                                                               InteractionLogEntry.SETCURRENTKEY("Contact Company No.",Date,"Contact No.",Canceled,"Initiated By","Attempt Failed");
                                                               InteractionLogEntry.SETRANGE("Contact Company No.","Company No.");
                                                               InteractionLogEntry.SETFILTER("Contact No.","Lookup Contact No.");
                                                               InteractionLogEntry.SETRANGE("Initiated By",InteractionLogEntry."Initiated By"::Us);
                                                               IF InteractionLogEntry.FIND('+') THEN
                                                                 FORM.RUN(0,InteractionLogEntry);
                                                             END;
                                                              }
    { 31  ;Label        ;9570 ;4510 ;3300 ;440  ;ParentControl=30 }
    { 32  ;TextBox      ;12980;5060 ;1650 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Next To-do Date" }
    { 33  ;Label        ;9570 ;5060 ;3300 ;440  ;ParentControl=32 }
    { 34  ;TextBox      ;6710 ;8030 ;2640 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 NextControl=18;
                                                 SourceExpr=City }
    { 22  ;TextBox      ;12980;2090 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Phone No." }
    { 23  ;Label        ;9570 ;2090 ;3300 ;440  ;ParentControl=22 }
    { 73  ;PictureBox   ;6710 ;990  ;440  ;440  ;Focusable=No;
                                                 ParentControl=1;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 Border=No;
                                                 BitmapPos=Center;
                                                 BitmapList=7,6;
                                                 SourceExpr=Comment }
    { 74  ;CommandButton;6710 ;990  ;440  ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 BackTransparent=Yes;
                                                 PushAction=RunObject;
                                                 ToolTipML=[ENU=Comment;
                                                            FRA=Commentaires];
                                                 RunObject=Form 5072;
                                                 RunFormLinkType=OnUpdate;
                                                 RunFormLink=Table Name=CONST(Contact),
                                                             No.=FIELD(No.),
                                                             Sub No.=CONST(0) }
    { 148 ;CommandButton;15840;2090 ;440  ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 Bitmap=34;
                                                 ToolTipML=[ENU=Make Phone Call;
                                                            FRA=T‚l‚phoner];
                                                 OnPush=VAR
                                                          TAPIManagement@1001 : Codeunit 5053;
                                                        BEGIN
                                                          TAPIManagement.DialContCustVendBank(DATABASE::Contact,"No.","Phone No.",'');
                                                        END;
                                                         }
    { 1120008;TextBox   ;3850 ;7480 ;5500 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr=County }
    { 1120009;Label     ;440  ;7480 ;3300 ;440  ;ParentControl=1120008 }
    { 1100281007;TextBox;3850 ;3410 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Service Contact" }
    { 1100281008;Label  ;440  ;3410 ;3300 ;440  ;ParentControl=1100281007 }
    { 1100281009;TextBox;12980;5720 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Corporate No." }
    { 1100281010;Label  ;9570 ;5720 ;3300 ;440  ;ParentControl=1100281009 }
    { 1100281013;TextBox;12980;7370 ;1700 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr=Birthdate }
    { 1100281014;Label  ;9570 ;7370 ;3300 ;440  ;ParentControl=1100281013 }
    { 1100281015;TextBox;12980;6820 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Member No." }
    { 1100281016;Label  ;9570 ;6820 ;3300 ;440  ;ParentControl=1100281015 }
    { 1100281028;TextBox;3850 ;5170 ;5500 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 CaptionML=[ENU=Keyboarding Address;
                                                            FRA=Adresse saisie rapide];
                                                 SourceExpr=KeyBoardAddress;
                                                 OnValidate=BEGIN
                                                              IF AddressStandardization.AssistContactQuickAddress(Rec,KeyBoardAddress) THEN
                                                                KeyBoardAddress :='';
                                                            END;
                                                             }
    { 1100281029;Label  ;440  ;5170 ;3300 ;440  ;ParentControl=1100281028 }
    { 128 ;TextBox      ;3850 ;4620 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Salutation Code" }
    { 129 ;Label        ;440  ;4620 ;3300 ;440  ;ParentControl=128 }
    { 1100281005;TextBox;12980;1540 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Notify Customer" }
    { 1100281006;Label  ;9570 ;1540 ;3300 ;440  ;ParentControl=1100281005 }
    { 1100281011;TextBox;12980;6270 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Corporate Region Code" }
    { 1100281012;Label  ;9570 ;6270 ;3300 ;440  ;ParentControl=1100281011 }
    { 1100281043;TextBox;3850 ;6820 ;5500 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Address 3" }
    { 1100281044;Label  ;440  ;6820 ;3300 ;440  ;ParentControl=1100281043 }
    { 36  ;TextBox      ;3850 ;1540 ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Mobile Phone No." }
    { 37  ;Label        ;440  ;1540 ;3300 ;440  ;ParentControl=36 }
    { 38  ;TextBox      ;3850 ;2640 ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Fax No." }
    { 39  ;Label        ;440  ;2640 ;3300 ;440  ;ParentControl=38 }
    { 40  ;TextBox      ;3850 ;2090 ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Mobile Phone No. 2" }
    { 41  ;Label        ;440  ;2090 ;3300 ;440  ;ParentControl=40 }
    { 44  ;TextBox      ;3850 ;3190 ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Business Phone No." }
    { 45  ;Label        ;440  ;3190 ;3300 ;440  ;ParentControl=44 }
    { 46  ;TextBox      ;3850 ;3740 ;4950 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="E-Mail" }
    { 47  ;Label        ;440  ;3740 ;3300 ;440  ;ParentControl=46 }
    { 48  ;TextBox      ;3850 ;4290 ;4950 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Home Page" }
    { 49  ;Label        ;440  ;4290 ;3300 ;440  ;ParentControl=48 }
    { 35  ;TextBox      ;3850 ;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Phone No." }
    { 71  ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=35 }
    { 113 ;CommandButton;8910 ;4290 ;440  ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 ShowCaption=No;
                                                 Bitmap=20;
                                                 ToolTipML=[ENU=Hyperlink;
                                                            FRA=Hyperlien];
                                                 OnPush=BEGIN
                                                          TESTFIELD("Home Page");
                                                          HYPERLINK("Home Page");
                                                        END;
                                                         }
    { 114 ;CommandButton;8910 ;3740 ;440  ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 ShowCaption=No;
                                                 Bitmap=21;
                                                 ToolTipML=[ENU=New Mail Message;
                                                            FRA=Nouveau message];
                                                 OnPush=VAR
                                                          Mail@1001 : Codeunit 397;
                                                          lNAVSendMail@1100281001 : Codeunit 50128;
                                                        BEGIN
                                                          //<<IMH14.ST
                                                          lNAVSendMail.SendMailFromContNo("No.", "E-Mail");
                                                          //Mail.MailContCustVendBank(DATABASE::Contact,"No.","E-Mail");
                                                          //>>IMH14.ST
                                                        END;
                                                         }
    { 115 ;CommandButton;6710 ;990  ;440  ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 ShowCaption=No;
                                                 Bitmap=34;
                                                 ToolTipML=[ENU=Make Phone Call;
                                                            FRA=T‚l‚phoner];
                                                 OnPush=VAR
                                                          TAPIManagement@1001 : Codeunit 5053;
                                                        BEGIN
                                                          TAPIManagement.DialContCustVendBank(DATABASE::Contact,"No.","Phone No.",'');
                                                        END;
                                                         }
    { 104 ;CommandButton;6710 ;1540 ;440  ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 ShowCaption=No;
                                                 Bitmap=34;
                                                 ToolTipML=[ENU=Make Phone Call;
                                                            FRA=T‚l‚phoner];
                                                 OnPush=VAR
                                                          TAPIManagement@1001 : Codeunit 5053;
                                                        BEGIN
                                                          TAPIManagement.DialContCustVendBank(DATABASE::Contact,"No.","Mobile Phone No.",'');
                                                        END;
                                                         }
    { 1100281003;TextBox;3850 ;4840 ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="VIP Code" }
    { 1100281004;Label  ;440  ;4840 ;3300 ;440  ;ParentControl=1100281003 }
    { 1100281020;CommandButton;6710;2090;440;440;ParentControl=1;
                                                 InPage=1;
                                                 ShowCaption=No;
                                                 Bitmap=34;
                                                 ToolTipML=[ENU=Make Phone Call;
                                                            FRA=T‚l‚phoner];
                                                 OnPush=VAR
                                                          TAPIManagement@1001 : Codeunit 5053;
                                                        BEGIN
                                                          TAPIManagement.DialContCustVendBank(DATABASE::Contact,"No.","Mobile Phone No. 2",'');
                                                        END;
                                                         }
    { 1100281035;TextBox;3850 ;5390 ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Correspondence Type" }
    { 1100281036;Label  ;440  ;5390 ;3300 ;440  ;ParentControl=1100281035 }
    { 1100281039;CheckBox;3850;5940 ;440  ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 ShowCaption=No;
                                                 SourceExpr="Declaration Contact" }
    { 1100281040;Label  ;440  ;5940 ;3300 ;440  ;ParentControl=1100281039 }
    { 1100281041;TextBox;3850 ;6490 ;5500 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Declaration E-Mail" }
    { 1100281042;Label  ;440  ;6490 ;3300 ;440  ;ParentControl=1100281041 }
    { 1100281045;TextBox;3850 ;7150 ;5500 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="First Name" }
    { 1100281046;Label  ;440  ;7150 ;3300 ;440  ;ParentControl=1100281045 }
    { 1100281047;TextBox;3850 ;7700 ;5500 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr=Surname }
    { 1100281048;Label  ;440  ;7700 ;3300 ;440  ;ParentControl=1100281047 }
    { 1000000000;CheckBox;13420;1100;440  ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 ShowCaption=No;
                                                 SourceExpr="Preferred Contact DPR" }
    { 1000000001;Label  ;10010;1100 ;3300 ;440  ;ParentControl=1000000000 }
    { 1000000002;CheckBox;13420;1650;440  ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 ShowCaption=No;
                                                 SourceExpr="Preferred Contact DGS" }
    { 1000000003;Label  ;10010;1650 ;3300 ;440  ;ParentControl=1000000002 }
    { 1000000004;CheckBox;13420;2200;440  ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 ShowCaption=No;
                                                 SourceExpr="Preferred Contact DFC" }
    { 1000000005;Label  ;10010;2200 ;3300 ;440  ;ParentControl=1000000004 }
    { 1000000006;CheckBox;13420;2750;440  ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 ShowCaption=No;
                                                 SourceExpr="Preferred Contact DTC" }
    { 1000000007;Label  ;10010;2750 ;3300 ;440  ;ParentControl=1000000006 }
    { 50  ;TextBox      ;3850 ;990  ;1650 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="No. of Mailing Groups";
                                                 OnDrillDown=VAR
                                                               ContMailingGrp@1001 : Record 5056;
                                                             BEGIN
                                                               CurrForm.SAVERECORD;
                                                               COMMIT;
                                                               ContMailingGrp.SETRANGE("Contact No.","No.");
                                                               FORM.RUNMODAL(FORM::"Contact Mailing Groups",ContMailingGrp);
                                                               CurrForm.UPDATE(FALSE);
                                                             END;
                                                              }
    { 51  ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=50 }
    { 52  ;TextBox      ;3850 ;1650 ;1650 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="No. of Business Relations";
                                                 OnDrillDown=VAR
                                                               ContBusRel@1001 : Record 5054;
                                                             BEGIN
                                                               CurrForm.SAVERECORD;
                                                               COMMIT;
                                                               ContBusRel.SETRANGE("Contact No.","Company No.");
                                                               FORM.RUNMODAL(FORM::"Contact Business Relations",ContBusRel);
                                                               CurrForm.UPDATE(FALSE);
                                                             END;
                                                              }
    { 53  ;Label        ;440  ;1650 ;3300 ;440  ;ParentControl=52 }
    { 54  ;TextBox      ;3850 ;2200 ;1650 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="No. of Industry Groups";
                                                 OnDrillDown=VAR
                                                               ContIndustGrp@1001 : Record 5058;
                                                             BEGIN
                                                               CurrForm.SAVERECORD;
                                                               COMMIT;
                                                               ContIndustGrp.SETRANGE("Contact No.","Company No.");
                                                               FORM.RUNMODAL(FORM::"Contact Industry Groups",ContIndustGrp);
                                                               CurrForm.UPDATE(FALSE);
                                                             END;
                                                              }
    { 55  ;Label        ;440  ;2200 ;3300 ;440  ;ParentControl=54 }
    { 56  ;TextBox      ;3850 ;2860 ;1650 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="No. of Job Responsibilities";
                                                 OnDrillDown=VAR
                                                               ContJobResp@1001 : Record 5067;
                                                             BEGIN
                                                               CurrForm.SAVERECORD;
                                                               COMMIT;
                                                               ContJobResp.SETRANGE("Contact No.","No.");
                                                               FORM.RUNMODAL(FORM::"Contact Job Responsibilities",ContJobResp);
                                                               CurrForm.UPDATE(FALSE);
                                                             END;
                                                              }
    { 57  ;Label        ;440  ;2860 ;3300 ;440  ;ParentControl=56 }
    { 58  ;TextBox      ;3850 ;3410 ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Organizational Level Code" }
    { 59  ;Label        ;440  ;3410 ;3300 ;440  ;ParentControl=58 }
    { 60  ;CheckBox     ;3850 ;4070 ;440  ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 ShowCaption=No;
                                                 SourceExpr="Exclude from Segment" }
    { 61  ;Label        ;440  ;4070 ;3300 ;440  ;ParentControl=60 }
    { 1120000;TextBox   ;10560;990  ;5500 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Trade Register" }
    { 1120001;Label     ;7150 ;990  ;3300 ;440  ;ParentControl=1120000 }
    { 1120002;TextBox   ;10560;1540 ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="APE Code" }
    { 1120003;Label     ;7150 ;1540 ;3300 ;440  ;ParentControl=1120002 }
    { 1120004;TextBox   ;10560;2090 ;5500 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Legal Form" }
    { 1120005;Label     ;7150 ;2090 ;3300 ;440  ;ParentControl=1120004 }
    { 1120006;TextBox   ;10560;2640 ;5500 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Stock Capital" }
    { 1120007;Label     ;7150 ;2640 ;3300 ;440  ;ParentControl=1120006 }
    { 64  ;TextBox      ;3850 ;990  ;1650 ;440  ;ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr="Currency Code" }
    { 65  ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=64 }
    { 66  ;TextBox      ;12980;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr="VAT Registration No." }
    { 67  ;Label        ;9570 ;990  ;3300 ;440  ;ParentControl=66 }
    { 68  ;TextBox      ;3850 ;1540 ;2750 ;440  ;ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr="Territory Code" }
    { 69  ;Label        ;440  ;1540 ;3300 ;440  ;ParentControl=68 }
    { 1100281037;TextBox;3850 ;2200 ;2750 ;440  ;ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr="Country/Region Code";
                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATE(TRUE);
                                                                 END;
                                                                  }
    { 1100281038;Label  ;440  ;2200 ;3300 ;440  ;ParentControl=1100281037 }
    { 70  ;CommandButton;14300;12320;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 PushAction=FormHelp }
    { 72  ;SubForm      ;220  ;8800 ;16280;3300 ;Name=ContractSubForm;
                                                 HorzGlue=Both;
                                                 VertGlue=Both;
                                                 Border=No;
                                                 SubFormID=Form50048;
                                                 SubFormView=SORTING(Contact No.,Corporate No.,Contract Form Code,Occurence No.);
                                                 SubFormLink=Contact No.=FIELD(No.),
                                                             Corporate No.=FIELD(Corporate No.) }
    { 75  ;MenuButton   ;9460 ;12320;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[ENU=F&unctions;
                                                            FRA=Fonction&s];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=1000000008;
                                                     CaptionML=FRA=Actualiser contact;
                                                     OnPush=BEGIN
                                                              RefreshContact(Rec);
                                                            END;
                                                             }
                                                   { ID=1000000009;
                                                     MenuItemType=Separator }
                                                   { ID=1100281030;
                                                     CaptionML=[ENU=Create Service;
                                                                FRA=Cr‚er service];
                                                     OnPush=VAR
                                                              lService@1100281001 : Record 50066;
                                                            BEGIN
                                                              CreateService(lService, TRUE);  //IMH11
                                                            END;
                                                             }
                                                   { ID=102;
                                                     CaptionML=[ENU=Launch &Web Source;
                                                                FRA=Lancer &recherche Web];
                                                     OnPush=VAR
                                                              ContactWebSource@1001 : Record 5060;
                                                            BEGIN
                                                              ContactWebSource.SETRANGE("Contact No.","Company No.");
                                                              IF FORM.RUNMODAL(FORM::"Web Source Launch",ContactWebSource) = ACTION::LookupOK THEN
                                                                ContactWebSource.Launch;
                                                            END;
                                                             }
                                                   { ID=103;
                                                     CaptionML=[ENU=Print Cover &Sheet;
                                                                FRA=&Imprimer bordereau d'envoi];
                                                     OnPush=VAR
                                                              Cont@1001 : Record 5050;
                                                            BEGIN
                                                              Cont := Rec;
                                                              Cont.SETRECFILTER;
                                                              REPORT.RUN(REPORT::"Contact - Cover Sheet",TRUE,FALSE,Cont);
                                                            END;
                                                             }
                                                   { ID=105;
                                                     CaptionML=[ENU=Create as;
                                                                FRA=Cr‚er comme] }
                                                   { ID=106;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=Customer;
                                                                FRA=Client];
                                                     OnPush=BEGIN
                                                              CreateCustomer(ChooseCustomerTemplate);
                                                            END;
                                                             }
                                                   { ID=107;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=Vendor;
                                                                FRA=Fournisseur];
                                                     OnPush=BEGIN
                                                              CreateVendor;
                                                            END;
                                                             }
                                                   { ID=108;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=Bank;
                                                                FRA=Banque];
                                                     OnPush=BEGIN
                                                              CreateBankAccount;
                                                            END;
                                                             }
                                                   { ID=109;
                                                     CaptionML=[ENU=Link with existing;
                                                                FRA=Lier avec existant] }
                                                   { ID=110;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=Customer;
                                                                FRA=Client];
                                                     OnPush=BEGIN
                                                              CreateCustomerLink;
                                                            END;
                                                             }
                                                   { ID=111;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=Vendor;
                                                                FRA=Fournisseur];
                                                     OnPush=BEGIN
                                                              CreateVendorLink;
                                                            END;
                                                             }
                                                   { ID=112;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=Bank;
                                                                FRA=Banque];
                                                     OnPush=BEGIN
                                                              CreateBankAccountLink;
                                                            END;
                                                             }
                                                   { ID=146;
                                                     Visible=No;
                                                     CaptionML=[ENU=Co&ntact Search;
                                                                FRA=Recherche co&ntact];
                                                     OnPush=VAR
                                                              SearchResult@1001 : Record 5113;
                                                              ContactSearchForm@1000 : Form 5177;
                                                            BEGIN
                                                              ContactSearchForm.LOOKUPMODE(TRUE);
                                                              IF ContactSearchForm.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                                                ContactSearchForm.GETRECORD(SearchResult);
                                                                IF GET(SearchResult."Contact No.") THEN;
                                                              END;
                                                            END;
                                                             }
                                                   { ID=1100281019;
                                                     ShortCutKey=Ctrl+F;
                                                     CaptionML=FRA=Rechercher contact;
                                                     OnPush=BEGIN
                                                              //<<IMH01
                                                              SearchContact;
                                                              //>>IMH01
                                                            END;
                                                             }
                                                   { ID=1100281027;
                                                     MenuItemType=Separator }
                                                   { ID=153;
                                                     Ellipsis=Yes;
                                                     CaptionML=[ENU=Apply Template;
                                                                FRA=Appliquer modŠle];
                                                     OnPush=VAR
                                                              TemplateMgt@1000 : Codeunit 8612;
                                                              RecRef@1001 : RecordRef;
                                                            BEGIN
                                                              RecRef.GETTABLE(Rec);
                                                              TemplateMgt.UpdateFromTemplateSelection(RecRef);
                                                            END;
                                                             }
                                                 }
                                                  }
    { 76  ;MenuButton   ;7040 ;12320;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[ENU=C&ontact;
                                                            FRA=Con&tact];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=78;
                                                     PushAction=LookupTable;
                                                     ShortCutKey=F5;
                                                     CaptionML=[ENU=List;
                                                                FRA=Lister] }
                                                   { ID=79;
                                                     PushAction=RunObject;
                                                     CaptionML=[ENU=Relate&d Contacts;
                                                                FRA=Con&tacts li‚s];
                                                     RunObject=Form 5052;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Company No.=FIELD(Company No.) }
                                                   { ID=82;
                                                     CaptionML=[ENU=Comp&any;
                                                                FRA=So&ci‚t‚] }
                                                   { ID=85;
                                                     PushAction=RunObject;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=Business Relations;
                                                                FRA=R&elations d'affaires];
                                                     RunObject=Form 5061;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Contact No.=FIELD(Company No.) }
                                                   { ID=83;
                                                     PushAction=RunObject;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=Industry Groups;
                                                                FRA=Secteurs d'activit‚];
                                                     RunObject=Form 5067;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Contact No.=FIELD(Company No.) }
                                                   { ID=84;
                                                     PushAction=RunObject;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=Web Sources;
                                                                FRA=Recherche &Web];
                                                     RunObject=Form 5070;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Contact No.=FIELD(Company No.) }
                                                   { ID=80;
                                                     CaptionML=[ENU=P&erson;
                                                                FRA=&Personne] }
                                                   { ID=81;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=Job Responsibilities;
                                                                FRA=Responsabilit‚s];
                                                     OnPush=VAR
                                                              ContJobResp@1001 : Record 5067;
                                                            BEGIN
                                                              TESTFIELD(Type,Type::Person);
                                                              ContJobResp.SETRANGE("Contact No.","No.");
                                                              FORM.RUNMODAL(FORM::"Contact Job Responsibilities",ContJobResp);
                                                            END;
                                                             }
                                                   { ID=86;
                                                     PushAction=RunObject;
                                                     CaptionML=[ENU=Mailing &Groups;
                                                                FRA=&Groupes de distribution];
                                                     RunObject=Form 5064;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Contact No.=FIELD(No.) }
                                                   { ID=87;
                                                     CaptionML=[ENU=Pro&files;
                                                                FRA=Pro&fil];
                                                     OnPush=VAR
                                                              ProfileManagement@1001 : Codeunit 5059;
                                                            BEGIN
                                                              ProfileManagement.ShowContactQuestionnaireCard(Rec,'',0);
                                                            END;
                                                             }
                                                   { ID=88;
                                                     PushAction=RunObject;
                                                     ShortCutKey=F9;
                                                     CaptionML=[ENU=Statistics;
                                                                FRA=Statistiques];
                                                     RunObject=Form 5053;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=No.=FIELD(No.) }
                                                   { ID=89;
                                                     PushAction=RunObject;
                                                     CaptionML=[ENU=&Picture;
                                                                FRA=Imag&e];
                                                     RunObject=Form 5104;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=No.=FIELD(No.) }
                                                   { ID=90;
                                                     PushAction=RunObject;
                                                     CaptionML=[ENU=Co&mments;
                                                                FRA=Co&mmentaires];
                                                     RunObject=Form 5072;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Table Name=CONST(Contact),
                                                                 No.=FIELD(No.),
                                                                 Sub No.=CONST(0) }
                                                   { ID=91;
                                                     CaptionML=[ENU=Alternati&ve Address;
                                                                FRA=&Adresse secondaire] }
                                                   { ID=92;
                                                     PushAction=RunObject;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=Card;
                                                                FRA=Fiche];
                                                     RunObject=Form 5056;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Contact No.=FIELD(No.) }
                                                   { ID=93;
                                                     PushAction=RunObject;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=Date Ranges;
                                                                FRA=Plage de dates];
                                                     RunObject=Form 5059;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Contact No.=FIELD(No.) }
                                                   { ID=94;
                                                     MenuItemType=Separator;
                                                     CaptionML=[ENU="";
                                                                FRA=""] }
                                                   { ID=95;
                                                     PushAction=RunObject;
                                                     ShortCutKey=Ctrl+F5;
                                                     CaptionML=[ENU=Interaction Log E&ntries;
                                                                FRA=Ecritures &journal interaction];
                                                     RunObject=Form 5076;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Contact Company No.,Date,Contact No.,Canceled,Initiated By,Attempt Failed);
                                                     RunFormLink=Contact Company No.=FIELD(Company No.),
                                                                 Contact No.=FILTER(<>''),
                                                                 Contact No.=FIELD(FILTER(Lookup Contact No.)) }
                                                   { ID=149;
                                                     PushAction=RunObject;
                                                     CaptionML=[ENU=Postponed &Interactions;
                                                                FRA=Brouillons];
                                                     RunObject=Form 5082;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Contact Company No.,Date,Contact No.,Canceled,Initiated By,Attempt Failed);
                                                     RunFormLink=Contact Company No.=FIELD(Company No.),
                                                                 Contact No.=FILTER(<>''),
                                                                 Contact No.=FIELD(FILTER(Lookup Contact No.)) }
                                                   { ID=96;
                                                     PushAction=RunObject;
                                                     CaptionML=[ENU=T&o-dos;
                                                                FRA=Act&ions];
                                                     RunObject=Form 5096;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Contact Company No.,Date,Contact No.,Closed);
                                                     RunFormLink=Contact Company No.=FIELD(Company No.),
                                                                 Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                                                 System To-do Type=FILTER(Contact Attendee) }
                                                   { ID=151;
                                                     CaptionML=[ENU=Oppo&rtunities;
                                                                FRA=Oppo&rtunit‚s] }
                                                   { ID=97;
                                                     PushAction=RunObject;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=List;
                                                                FRA=Liste];
                                                     RunObject=Form 5123;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Contact Company No.,Contact No.);
                                                     RunFormLink=Contact Company No.=FIELD(Company No.),
                                                                 Contact No.=FILTER(<>''),
                                                                 Contact No.=FIELD(FILTER(Lookup Contact No.)) }
                                                   { ID=150;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=Bar Chart;
                                                                FRA=Graphique … barres];
                                                     OnPush=VAR
                                                              OpportunityBarChart@1000 : Form 5084;
                                                            BEGIN
                                                              OpportunityBarChart.SetContactFilter("No.","Company No.");
                                                              OpportunityBarChart.RUN;
                                                            END;
                                                             }
                                                   { ID=100;
                                                     PushAction=RunObject;
                                                     CaptionML=[ENU=Segmen&ts;
                                                                FRA=Segme&nts];
                                                     RunObject=Form 5150;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Contact No.,Segment No.);
                                                     RunFormLink=Contact Company No.=FIELD(Company No.),
                                                                 Contact No.=FILTER(<>''),
                                                                 Contact No.=FIELD(FILTER(Lookup Contact No.)) }
                                                   { ID=98;
                                                     MenuItemType=Separator;
                                                     CaptionML=[ENU="";
                                                                FRA=""] }
                                                   { ID=116;
                                                     PushAction=RunObject;
                                                     CaptionML=[ENU=Sales &Quotes;
                                                                FRA=&Devis];
                                                     RunObject=Form 41;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Document Type,Sell-to Contact No.);
                                                     RunFormLink=Sell-to Contact No.=FIELD(No.) }
                                                   { ID=119;
                                                     MenuItemType=Separator }
                                                   { ID=1100281000;
                                                     PushAction=RunObject;
                                                     CaptionML=[ENU=Contracts;
                                                                FRA=&Formules];
                                                     RunObject=Form 50059;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Contact No.,Corporate No.,Contract Form Code,Occurence No.);
                                                     RunFormLink=Contact No.=FIELD(No.);
                                                     OnPush=VAR
                                                              lContContract@1100281001 : Record 50059;
                                                            BEGIN
                                                              IF "Service Contact" <> "Service Contact"::Beneficiary THEN
                                                                EXIT;
                                                              lContContract.SETRANGE("Contact No.", "No.");
                                                              FORM.RUNMODAL(0,lContContract);
                                                            END;
                                                             }
                                                   { ID=1100281001;
                                                     MenuItemType=Separator }
                                                   { ID=99;
                                                     CaptionML=[ENU=C&ustomer/Vendor/Bank Acc.;
                                                                FRA=Client/Fournisseur/&Banque];
                                                     OnPush=BEGIN
                                                              ShowCustVendBank;
                                                            END;
                                                             }
                                                   { ID=62;
                                                     MenuItemType=Separator }
                                                   { ID=63;
                                                     CaptionML=[ENU=Online Map;
                                                                FRA=Online Map];
                                                     OnPush=BEGIN
                                                              DisplayMap;
                                                            END;
                                                             }
                                                   { ID=1100281002;
                                                     Visible=No }
                                                 }
                                                  }
    { 77  ;CommandButton;11880;12320;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[ENU=Create &Interact;
                                                            FRA=Cr‚er &interact.];
                                                 OnPush=BEGIN
                                                          CreateInteraction;
                                                        END;
                                                         }
    { 1100281017;Frame  ;16720;220  ;3840 ;11990;Name=ContactInfoPanel;
                                                 HorzGlue=Right;
                                                 VertGlue=Top;
                                                 CaptionML=[ENU=Contact Information;
                                                            FRA=Informations contact] }
    { 1100281021;CommandButton;16940;880;2640;550;
                                                 FocusOnClick=Yes;
                                                 ParentControl=1100281017;
                                                 InFrame=Yes;
                                                 HorzAlign=Left;
                                                 ForeColor=0;
                                                 BackColor=16777215;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 Bitmap=36;
                                                 CaptionML=[ENU=&Contracts;
                                                            FRA=&Formules];
                                                 OnPush=BEGIN
                                                          ContactInfoPane.LookupContracts(Rec); //IMH04.ST
                                                        END;
                                                         }
    { 1100281022;TextBox;19580;880  ;770  ;550  ;Name=ContractContact;
                                                 Editable=No;
                                                 Focusable=No;
                                                 ParentControl=1100281017;
                                                 InFrame=Yes;
                                                 HorzAlign=Right;
                                                 Border=No;
                                                 SourceExpr=STRSUBSTNO('(%1)',ContactInfoPane.CalcNoOfContracts(Rec)) }
    { 1100281023;TextBox;19580;3850 ;770  ;550  ;Name=Todos;
                                                 Editable=No;
                                                 Focusable=No;
                                                 ParentControl=1100281017;
                                                 InFrame=Yes;
                                                 HorzAlign=Right;
                                                 Border=No;
                                                 SourceExpr=STRSUBSTNO('(%1)',ContactInfoPane.CalcNoOfTrayLines(Rec,TRUE)) }
    { 1100281024;CommandButton;16940;3850;2640;550;
                                                 Name=PActivity;
                                                 FocusOnClick=Yes;
                                                 ParentControl=1100281017;
                                                 InFrame=Yes;
                                                 HorzAlign=Left;
                                                 ForeColor=0;
                                                 BackColor=16777215;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 Bitmap=36;
                                                 CaptionML=[ENU=Current &Tray Lines;
                                                            FRA=&Activit‚s en cours];
                                                 OnPush=BEGIN
                                                          ContactInfoPane.LookupTrayLines(Rec,TRUE);
                                                        END;
                                                         }
    { 1100281025;CommandButton;16940;1650;2640;550;
                                                 Name=PService;
                                                 FocusOnClick=Yes;
                                                 ParentControl=1100281017;
                                                 InFrame=Yes;
                                                 HorzAlign=Left;
                                                 ForeColor=0;
                                                 BackColor=16777215;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 Bitmap=36;
                                                 CaptionML=[ENU=Current &Services;
                                                            FRA=&Services en cours];
                                                 OnPush=BEGIN
                                                          ContactInfoPane.LookupService(Rec,TRUE); //IMH04.ST
                                                        END;
                                                         }
    { 1100281026;TextBox;19580;1650 ;770  ;550  ;Name=CalcService;
                                                 Editable=No;
                                                 Focusable=No;
                                                 ParentControl=1100281017;
                                                 InFrame=Yes;
                                                 HorzAlign=Right;
                                                 Border=No;
                                                 SourceExpr=STRSUBSTNO('(%1)',ContactInfoPane.CalcNoOfService(Rec,TRUE)) }
    { 1100281031;TextBox;19580;2420 ;770  ;550  ;Name=CalcServiceHeader;
                                                 Editable=No;
                                                 Focusable=No;
                                                 ParentControl=1100281017;
                                                 InFrame=Yes;
                                                 HorzAlign=Right;
                                                 Border=No;
                                                 SourceExpr=STRSUBSTNO('(%1)',ContactInfoPane.CalcNoOfServiceHeader(Rec,TRUE)) }
    { 1100281032;CommandButton;16940;2420;2640;550;
                                                 Name=PServiceHeader;
                                                 FocusOnClick=Yes;
                                                 ParentControl=1100281017;
                                                 InFrame=Yes;
                                                 HorzAlign=Left;
                                                 ForeColor=0;
                                                 BackColor=16777215;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 Bitmap=36;
                                                 CaptionML=[ENU=Current &Services Headers;
                                                            FRA=&Lignes produit en cours];
                                                 OnPush=BEGIN
                                                          ContactInfoPane.LookupServiceHeader(Rec,TRUE); //IMH07
                                                        END;
                                                         }
    { 1100281033;TextBox;19580;3080 ;770  ;550  ;Name=CalcInterv;
                                                 Editable=No;
                                                 Focusable=No;
                                                 ParentControl=1100281017;
                                                 InFrame=Yes;
                                                 HorzAlign=Right;
                                                 Border=No;
                                                 SourceExpr=STRSUBSTNO('(%1)',ContactInfoPane.CalcNoOfServiceIntervention(Rec,TRUE)) }
    { 1100281034;CommandButton;16940;3080;2640;550;
                                                 Name=PIntervention;
                                                 FocusOnClick=Yes;
                                                 ParentControl=1100281017;
                                                 InFrame=Yes;
                                                 HorzAlign=Left;
                                                 ForeColor=0;
                                                 BackColor=16777215;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 Bitmap=36;
                                                 CaptionML=[ENU=Current &Interventions;
                                                            FRA=&Interventions en cours];
                                                 OnPush=BEGIN
                                                          ContactInfoPane.LookupServiceIntervention(Rec,TRUE); //IMH07
                                                        END;
                                                         }
    { 1100281018;CommandButton;4620;12320;2200;550;
                                                 Name=SearchButton;
                                                 HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[ENU=Search;
                                                            FRA=Rechercher];
                                                 OnPush=VAR
                                                          lContactSearchManagement@1100281000 : Codeunit 50097;
                                                        BEGIN
                                                          //<<IMH01
                                                          SearchContact;
                                                          //>>IMH01
                                                        END;
                                                         }
  }
  CODE
  {
    VAR
      Cont@1000 : Record 5050;
      ServiceFormMgt@1100281004 : Codeunit 50086;
      CompanyDetails@1001 : Form 5054;
      NameDetails@1002 : Form 5055;
      IntegrationCustomerNo@1003 : Code[20];
      ContactInfoPane@1100281000 : Codeunit 50059;
      AddressStandardization@1100281001 : Codeunit 50098;
      ProviderMgt@1100281002 : Codeunit 50018;
      KeyBoardAddress@1100281003 : Text[1024];
      CorporateRegionDesc@1100281006 : Text[100];
      SalutationCodeDesc@1100281005 : Text[100];
      Text001@1100281008 : TextConst 'ENU=Do you want to refresh contact from beneficiary file lines :;FRA=Souhaitez-vous actualiser le contact … partir des lignes du fichier soci‚taire :';
      Text002@1100281007 : TextConst 'ENU=Not treat,Treated;FRA=Non trait‚es,Trait‚es';

    PROCEDURE EnableFields@1();
    BEGIN
      CurrForm."Currency Code".ENABLED(Type = Type::Company);
      CurrForm."VAT Registration No.".ENABLED(Type = Type::Company);
      CurrForm."Company No.".ENABLED(Type = Type::Person);
      CurrForm."Company Name".ENABLED(Type = Type::Person);
      CurrForm."Organizational Level Code".ENABLED(Type = Type::Person);
      CurrForm."No. of Job Responsibilities".ENABLED(Type = Type::Person);
      CurrForm."Trade Register".ENABLED(Type=Type::Company);
      CurrForm."APE Code".ENABLED(Type=Type::Company);
      CurrForm."Legal Form".ENABLED(Type=Type::Company);
      CurrForm."Stock Capital".ENABLED(Type=Type::Company);
      CurrForm.ContractSubForm.EDITABLE("Service Contact" = "Service Contact"::Beneficiary); //IMH02.ST
      //<<IMH12.ISAT.EBA
      //CurrForm.Address.EDITABLE(NOT AddressStandardization.CountryToAssist(DATABASE::Contact, "Country/Region Code")); //IMH05 isat.ZW
      CurrForm."Notify Customer".VISIBLE("Service Contact" <> "Service Contact"::Beneficiary);
      CurrForm."Declaration Contact".VISIBLE("Service Contact" <> "Service Contact"::Beneficiary);
      //>>IMH12.ISAT.EBA
    END;

    PROCEDURE IntegrationFindCustomerNo@2();
    VAR
      ContactBusinessRelation@1000 : Record 5054;
    BEGIN
      ContactBusinessRelation.SETCURRENTKEY("Link to Table","Contact No.");
      ContactBusinessRelation.SETRANGE("Link to Table",ContactBusinessRelation."Link to Table"::Customer);
      ContactBusinessRelation.SETRANGE("Contact No.","Company No.");
      IF ContactBusinessRelation.FINDFIRST THEN BEGIN
        IntegrationCustomerNo := ContactBusinessRelation."No.";
      END ELSE BEGIN
        IntegrationCustomerNo := '';
      END;
    END;

    PROCEDURE GetServFieldDescription@1100281010();
    BEGIN
      //IMH09
      CorporateRegionDesc := ServiceFormMgt.CorporateRegion_Desc("Corporate No.","Corporate Region Code");
      SalutationCodeDesc := ServiceFormMgt.Salutation_Desc("Salutation Code");
    END;

    PROCEDURE RefreshContact@1100281003(pContact@1100281002 : Record 5050);
    VAR
      lANSAAPMgt@1100281000 : Codeunit 50170;
      lSelection@1100281001 : Integer;
    BEGIN
      // IMH54.PC
      lSelection := 2;//STRMENU(Text002,1,Text001);    // IMH55.WGA
      CASE lSelection OF
        0 : EXIT;
        1 : lANSAAPMgt.ActualizeContact(pContact,FALSE);
        2 : lANSAAPMgt.ActualizeContact(pContact,TRUE);
      END;
    END;

    BEGIN
    {
      /** @r IMH14 @d 13/04/12 @a ISAT.ST @v IMH6.01.108 @d Interactions @h 3317 @c Envoi de mail  */
      /** @r IMH13 @d 20/07/11 @a ISAT.PC @v IMH6.01.002 @s Gestion des contacts
          @c ajout fonction CheckContract */
      /** @r IMH12 @d 18/04/11 @a ISAT.EBA @v IMH6.01.200 @s DPS Lot 3
          @c Repasser en saisie manuelle d adresse sur la fiche b‚n‚ficiaire */
      /** @r IHM11 @d 01/04/10 @a ISAT.ZW @v IMH6.01.136 @s interface fusion @c Ajout parametre creation service */
      /** @r IHM10 @d 24/03/10 @a ISAT.ZW @v IMH6.01.004 @s GED @c Ajout declaration contact */
      /** @r IHM09 @d 04/03/10 @a ISAT.ZW @v IMH6.01.004 @s GED @c renomer interaction report‚ en Brouillons */
      /** @r IMH08 @d 22/02/11 @a ISAT.ZW @v IMH6.01.020 @s Gestion prestataire
          @c ne plus faire apparaitre "date de naissance" sur les fiches contacts de type prestataire */
      /** @r IMH07 @d 10/11/10 @a ISAT.LLT @v IMH6.01.002 @s Gestion des contacts
          @c Ajout saisie rapide d'adresse
          @ Gestion affichage infopane */
      /** @r IMH06 @d 28/10/10 @a ISAT.MA @v IMH6.01.020 @s Gestion prestataire
          @c Fiche non ‚ditable si utilisateur n'est pas affect‚ au prestataire */
      /** @r IMH05 @d 21/10/10 @a ISAT.ZW @v IMH6.01.001 @s Normalisation des donn‚es
          @c Adresse non editable si Normalisation adresse pays + assistEdit adresse */
      /** @r IMH04 @d 14/10/10 @a ISAT.ST @v IMH6.01.011 @s Gestion des services
          @c Gestion de l'info pane, modif des version IMH01 & IMH03 */
      /** @r IMH03 @d 07/10/10 @a ISAT.ZW @v IMH6.01.013 @s Gestion des corbeilles @c Ajout info Action */
      /** @r IMH02 @d 28/09/10 @a ISAT.ST @v IMH6.01.002 @s Gestion des contact
          @c Changement du sous-formulaire pour lier sur les contrats */
      /** @r IMH01 @d 24/09/10 @a ISAT.LLT @v IMH6.01.002 @s Gestion des contacts
          @c Ajout lien vers liste des contrats sur Bouton Contact et sur Info Panel
          @c Ajout des champs Service Contact,Corporate No.,Corporate Region Code, VIP Code,Birthdate, Notify Customer, Member No.
          @c Suppression des champs Pager, Type correspondance */
    }
    END.
  }
}