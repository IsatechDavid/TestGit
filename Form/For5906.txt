OBJECT Form 5906 Service Item Worksheet
{
  OBJECT-PROPERTIES
  {
    Date=10/02/11;
    Time=15:33:48;
    Modified=Yes;
    Version List=NAVW16.00;
  }
  PROPERTIES
  {
    Width=20790;
    Height=10560;
    CaptionML=[ENU=Service Item Worksheet;
               FRA=Feuille activit‚ article serv.];
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table5901;
    DataCaptionExpr=Caption;
    OnOpenForm=BEGIN
                 CurrForm."Repair Status Code".ACTIVATE;
               END;

    OnAfterGetRecord=BEGIN
                       ServHeader.GET("Document Type","Document No.");
                       UpdateShiptoCode;
                       SETRANGE("Line No.");
                       IF NOT ServItem.GET("Service Item No.") THEN
                         CLEAR(ServItem);

                       IF "Serial No." = '' THEN
                         "No. of Previous Services" := 0;

                       CurrForm.ServInvLines.FORM.SetValues("Line No.");
                     END;

    OnAfterGetCurrRecord=BEGIN
                           InfopaneEnable("Service Item No." <> '');
                           ServHeader.GET("Document Type","Document No.");
                           UpdateShiptoCode;
                           IF "Serial No." = '' THEN
                             "No. of Previous Services" := 0;
                         END;

  }
  CONTROLS
  {
    { 1   ;TabControl   ;220  ;220  ;16280;5830 ;HorzGlue=Both;
                                                 PageNamesML=[ENU=General,Customer,Shipping,Details;
                                                              FRA=G‚n‚ral,Client,Livraison,Divers] }
    { 2   ;TextBox      ;3850 ;990  ;2750 ;440  ;Editable=No;
                                                 ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Document No." }
    { 3   ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=2 }
    { 6   ;TextBox      ;3850 ;3410 ;2750 ;440  ;Editable=No;
                                                 ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Serial No." }
    { 7   ;Label        ;440  ;3410 ;3300 ;440  ;ParentControl=6 }
    { 8   ;TextBox      ;3850 ;1650 ;2750 ;440  ;Editable=No;
                                                 ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Service Item No." }
    { 9   ;Label        ;440  ;1650 ;3300 ;440  ;ParentControl=8 }
    { 10  ;TextBox      ;3850 ;2200 ;2750 ;440  ;Editable=No;
                                                 ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Item No." }
    { 11  ;Label        ;440  ;2200 ;3300 ;440  ;ParentControl=10 }
    { 18  ;TextBox      ;12980;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Service Shelf No." }
    { 19  ;Label        ;9570 ;990  ;3300 ;440  ;ParentControl=18 }
    { 30  ;TextBox      ;12980;4620 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 NextControl=26;
                                                 SourceExpr="Repair Status Code" }
    { 31  ;Label        ;9570 ;4620 ;3300 ;440  ;ParentControl=30 }
    { 20  ;TextBox      ;12980;1650 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Service Price Group Code" }
    { 21  ;Label        ;9570 ;1650 ;3300 ;440  ;ParentControl=20 }
    { 69  ;TextBox      ;12980;2310 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Fault Area Code" }
    { 70  ;Label        ;9570 ;2310 ;3300 ;440  ;ParentControl=69 }
    { 71  ;TextBox      ;12980;2860 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Symptom Code" }
    { 72  ;Label        ;9570 ;2860 ;3300 ;440  ;ParentControl=71 }
    { 75  ;TextBox      ;3850 ;2750 ;2750 ;440  ;Editable=No;
                                                 ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Service Item Group Code" }
    { 76  ;Label        ;440  ;2750 ;3300 ;440  ;ParentControl=75 }
    { 77  ;TextBox      ;12980;3410 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Fault Code" }
    { 78  ;Label        ;9570 ;3410 ;3300 ;440  ;ParentControl=77 }
    { 93  ;TextBox      ;3850 ;3960 ;2750 ;440  ;Editable=No;
                                                 ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Fault Reason Code" }
    { 94  ;Label        ;440  ;3960 ;3300 ;440  ;ParentControl=93 }
    { 104 ;TextBox      ;3850 ;5280 ;2750 ;440  ;Editable=No;
                                                 ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Loaner No." }
    { 105 ;Label        ;440  ;5280 ;3300 ;440  ;ParentControl=104 }
    { 108 ;TextBox      ;12980;4070 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Resolution Code" }
    { 109 ;Label        ;9570 ;4070 ;3300 ;440  ;ParentControl=108 }
    { 110 ;PictureBox   ;15840;4070 ;440  ;440  ;Focusable=No;
                                                 ParentControl=1;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 Border=No;
                                                 BitmapPos=Center;
                                                 BitmapList=7,6;
                                                 SourceExpr="Resolution Comment" }
    { 111 ;CommandButton;15840;4070 ;440  ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 BackTransparent=Yes;
                                                 PushAction=RunObject;
                                                 ToolTipML=[ENU=Resolution Comments;
                                                            FRA=Commentaires solution];
                                                 RunObject=Form 5911;
                                                 RunFormLinkType=OnUpdate;
                                                 RunFormLink=Table Name=CONST(Service Header),
                                                             Table Subtype=FIELD(Document Type),
                                                             No.=FIELD(Document No.),
                                                             Table Line No.=FIELD(Line No.),
                                                             Type=CONST(Resolution) }
    { 113 ;PictureBox   ;6710 ;5280 ;440  ;440  ;Focusable=No;
                                                 ParentControl=1;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 Border=No;
                                                 BitmapPos=Center;
                                                 BitmapList=7,6;
                                                 SourceExpr="Service Item Loaner Comment" }
    { 115 ;CommandButton;6710 ;5280 ;440  ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 BackTransparent=Yes;
                                                 PushAction=RunObject;
                                                 ToolTipML=[ENU=Lent Loaner Comments;
                                                            FRA=Commentaires article de prˆt];
                                                 RunObject=Form 5911;
                                                 RunFormLinkType=OnUpdate;
                                                 RunFormLink=Table Name=CONST(Service Header),
                                                             Table Subtype=FIELD(Document Type),
                                                             No.=FIELD(Document No.),
                                                             Table Line No.=FIELD(Line No.),
                                                             Type=CONST(Service Item Loaner) }
    { 67  ;TextBox      ;3850 ;4620 ;2750 ;440  ;Name=Document Type;
                                                 Editable=No;
                                                 ParentControl=1;
                                                 InPage=0;
                                                 CaptionML=[ENU=Document Type;
                                                            FRA=Type document];
                                                 OptionCaptionML=[ENU=Quote,Order;
                                                                  FRA=Devis,Commande];
                                                 OptionString=Quote,Order;
                                                 SourceExpr="Document Type" }
    { 99  ;Label        ;440  ;4620 ;3300 ;440  ;ParentControl=67 }
    { 36  ;PictureBox   ;15840;3410 ;440  ;440  ;Focusable=No;
                                                 ParentControl=1;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 Border=No;
                                                 BitmapPos=Center;
                                                 BitmapList=7,6;
                                                 SourceExpr="Fault Comment" }
    { 37  ;CommandButton;15840;3410 ;440  ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 BackTransparent=Yes;
                                                 PushAction=RunObject;
                                                 ToolTipML=[ENU=Fault Comments;
                                                            FRA=Commentaires panne];
                                                 RunObject=Form 5911;
                                                 RunFormLinkType=OnUpdate;
                                                 RunFormLink=Table Name=CONST(Service Header),
                                                             Table Subtype=FIELD(Document Type),
                                                             No.=FIELD(Document No.),
                                                             Type=CONST(Fault),
                                                             Table Line No.=FIELD(Line No.) }
    { 50  ;TextBox      ;3850 ;990  ;2750 ;440  ;Editable=No;
                                                 ParentControl=1;
                                                 InPage=1;
                                                 CaptionML=[ENU=Customer No.;
                                                            FRA=Nø client];
                                                 NextControl=113;
                                                 SourceExpr="Customer No." }
    { 51  ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=50 }
    { 52  ;TextBox      ;3850 ;1540 ;5500 ;440  ;Editable=No;
                                                 ParentControl=1;
                                                 InPage=1;
                                                 CaptionML=[ENU=Name;
                                                            FRA=Nom];
                                                 SourceExpr=ServHeader.Name }
    { 53  ;Label        ;440  ;1540 ;3300 ;440  ;ParentControl=52 }
    { 54  ;TextBox      ;3850 ;2090 ;5500 ;440  ;Editable=No;
                                                 ParentControl=1;
                                                 InPage=1;
                                                 CaptionML=[ENU=Address;
                                                            FRA=Adresse];
                                                 SourceExpr=ServHeader.Address }
    { 55  ;Label        ;440  ;2090 ;3300 ;440  ;ParentControl=54 }
    { 56  ;TextBox      ;3850 ;2640 ;5500 ;440  ;Editable=No;
                                                 ParentControl=1;
                                                 InPage=1;
                                                 CaptionML=[ENU=Address 2;
                                                            FRA=Adresse (2Šme ligne)];
                                                 SourceExpr=ServHeader."Address 2" }
    { 57  ;Label        ;440  ;2640 ;3300 ;440  ;ParentControl=56 }
    { 58  ;TextBox      ;3850 ;3190 ;2750 ;440  ;Editable=No;
                                                 ParentControl=1;
                                                 InPage=1;
                                                 CaptionML=[ENU=Post Code;
                                                            FRA=Code postal];
                                                 NextControl=156;
                                                 SourceExpr=ServHeader."Post Code";
                                                 OnLookup=BEGIN
                                                            //IMH01 Ajout Code pays
                                                            PostCodeRec.LookUpPostCode(ServHeader.City,ServHeader."Post Code",ServHeader."Country/Region Code",FALSE);
                                                          END;
                                                           }
    { 59  ;Label        ;440  ;3190 ;3300 ;440  ;ParentControl=58;
                                                 CaptionML=[ENU=Post Code/City;
                                                            FRA=CP/Ville] }
    { 60  ;TextBox      ;6710 ;3190 ;2640 ;440  ;Editable=No;
                                                 ParentControl=1;
                                                 InPage=1;
                                                 CaptionML=[ENU=City;
                                                            FRA=Ville];
                                                 NextControl=126;
                                                 SourceExpr=ServHeader.City;
                                                 OnLookup=BEGIN
                                                            //IMH01 Ajout Code pays
                                                            PostCodeRec.LookUpCity(ServHeader.City,ServHeader."Post Code",ServHeader."Country/Region Code",FALSE);
                                                          END;
                                                           }
    { 61  ;TextBox      ;3850 ;3740 ;5500 ;440  ;Editable=No;
                                                 ParentControl=1;
                                                 InPage=1;
                                                 CaptionML=[ENU=Contact Name;
                                                            FRA=Nom contact];
                                                 SourceExpr=ServHeader."Contact Name" }
    { 62  ;Label        ;440  ;3740 ;3300 ;440  ;ParentControl=61 }
    { 63  ;TextBox      ;3850 ;4290 ;5500 ;440  ;Editable=No;
                                                 ParentControl=1;
                                                 InPage=1;
                                                 CaptionML=[ENU=Phone No.;
                                                            FRA=Nø t‚l‚phone];
                                                 SourceExpr=ServHeader."Phone No." }
    { 64  ;Label        ;440  ;4290 ;3300 ;440  ;ParentControl=63 }
    { 16  ;TextBox      ;3850 ;4950 ;5500 ;440  ;Editable=No;
                                                 ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Location of Service Item" }
    { 17  ;Label        ;440  ;4950 ;3300 ;440  ;ParentControl=16 }
    { 41  ;CommandButton;9460 ;4290 ;440  ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 ShowCaption=No;
                                                 Bitmap=34;
                                                 ToolTipML=[ENU=Make Phone Call;
                                                            FRA=T‚l‚phoner];
                                                 OnPush=VAR
                                                          TAPIManagement@1001 : Codeunit 5053;
                                                        BEGIN
                                                          TAPIManagement.DialContCustVendBank(DATABASE::Customer,ServHeader."Customer No.",ServHeader."Phone No.",'');
                                                        END;
                                                         }
    { 84  ;TextBox      ;3850 ;2090 ;5500 ;440  ;Editable=No;
                                                 ParentControl=1;
                                                 InPage=2;
                                                 CaptionML=[ENU=Ship-to Address;
                                                            FRA=Adresse destinataire];
                                                 SourceExpr=ShiptoAddress }
    { 83  ;Label        ;440  ;2090 ;3300 ;440  ;ParentControl=84 }
    { 85  ;TextBox      ;3850 ;2640 ;5500 ;440  ;Editable=No;
                                                 ParentControl=1;
                                                 InPage=2;
                                                 CaptionML=[ENU=Ship-to Address 2;
                                                            FRA=Adresse destinataire 2];
                                                 SourceExpr=ShiptoAddress2 }
    { 82  ;Label        ;440  ;2640 ;3300 ;440  ;ParentControl=85 }
    { 86  ;TextBox      ;3850 ;3190 ;2750 ;440  ;Editable=No;
                                                 ParentControl=1;
                                                 InPage=2;
                                                 CaptionML=[ENU=Post Code;
                                                            FRA=Code postal];
                                                 NextControl=149;
                                                 SourceExpr=ShiptoPostCode;
                                                 OnLookup=BEGIN
                                                            PostCodeRec.LookUpPostCode(ServHeader.City,ServHeader."Post Code",ServHeader."Country/Region Code",FALSE);
                                                          END;
                                                           }
    { 81  ;Label        ;440  ;3190 ;3300 ;440  ;ParentControl=86;
                                                 CaptionML=[ENU=Ship-to Post Code/City;
                                                            FRA=CP/Ville destinataire] }
    { 87  ;TextBox      ;3850 ;3740 ;5500 ;440  ;Editable=No;
                                                 ParentControl=1;
                                                 InPage=2;
                                                 CaptionML=[ENU=Ship-to Contact;
                                                            FRA=Contact destinataire];
                                                 SourceExpr=ServHeader."Ship-to Contact" }
    { 80  ;Label        ;440  ;3740 ;3300 ;440  ;ParentControl=87 }
    { 88  ;TextBox      ;3850 ;4290 ;5500 ;440  ;Editable=No;
                                                 ParentControl=1;
                                                 InPage=2;
                                                 CaptionML=[ENU=Ship-to Phone No.;
                                                            FRA=Nø t‚l. destinataire];
                                                 SourceExpr=ServHeader."Ship-to Phone" }
    { 79  ;Label        ;440  ;4290 ;3300 ;440  ;ParentControl=88 }
    { 89  ;TextBox      ;3850 ;1540 ;5500 ;440  ;Editable=No;
                                                 ParentControl=1;
                                                 InPage=2;
                                                 CaptionML=[ENU=Ship-to Name;
                                                            FRA=Nom du destinataire];
                                                 SourceExpr=ShiptoName }
    { 90  ;Label        ;440  ;1540 ;3300 ;440  ;ParentControl=89 }
    { 91  ;TextBox      ;3850 ;990  ;2750 ;440  ;Editable=No;
                                                 ParentControl=1;
                                                 InPage=2;
                                                 CaptionML=[ENU=Ship-to Code;
                                                            FRA=Code destinataire];
                                                 SourceExpr="Ship-to Code" }
    { 92  ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=91 }
    { 97  ;TextBox      ;6710 ;3190 ;2640 ;440  ;Editable=No;
                                                 ParentControl=1;
                                                 InPage=2;
                                                 CaptionML=[ENU=City;
                                                            FRA=Ville];
                                                 NextControl=149;
                                                 SourceExpr=ShiptoCity;
                                                 OnLookup=BEGIN
                                                            PostCodeRec.LookUpCity(ServHeader.City,ServHeader."Post Code",ServHeader."Country/Region Code",FALSE);
                                                          END;
                                                           }
    { 102 ;CommandButton;9460 ;4290 ;440  ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 ShowCaption=No;
                                                 Bitmap=34;
                                                 ToolTipML=[ENU=Make Phone Call;
                                                            FRA=T‚l‚phoner];
                                                 OnPush=VAR
                                                          TAPIManagement@1001 : Codeunit 5053;
                                                        BEGIN
                                                          TAPIManagement.DialContCustVendBank(DATABASE::Customer,ServHeader."Customer No.",ServHeader."Ship-to Phone",'');
                                                        END;
                                                         }
    { 25  ;TextBox      ;3850 ;990  ;2750 ;440  ;Editable=No;
                                                 ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr="Contract No." }
    { 27  ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=25 }
    { 14  ;CheckBox     ;3850 ;1540 ;440  ;440  ;Editable=No;
                                                 ParentControl=1;
                                                 InPage=3;
                                                 ShowCaption=No;
                                                 SourceExpr=Warranty }
    { 15  ;Label        ;440  ;1540 ;3300 ;440  ;ParentControl=14 }
    { 12  ;TextBox      ;3850 ;2090 ;1650 ;440  ;Editable=No;
                                                 ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr="Response Date" }
    { 13  ;Label        ;440  ;2090 ;3300 ;440  ;ParentControl=12 }
    { 33  ;TextBox      ;3850 ;2640 ;1650 ;440  ;Editable=No;
                                                 ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr="Response Time" }
    { 49  ;Label        ;440  ;2640 ;3300 ;440  ;ParentControl=33 }
    { 22  ;TextBox      ;3850 ;3190 ;2750 ;440  ;Editable=No;
                                                 ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr=Priority }
    { 23  ;Label        ;440  ;3190 ;3300 ;440  ;ParentControl=22 }
    { 114 ;TextBox      ;3850 ;3740 ;1650 ;440  ;Editable=No;
                                                 ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr="Starting Date" }
    { 116 ;Label        ;440  ;3740 ;3300 ;440  ;ParentControl=114 }
    { 117 ;TextBox      ;3850 ;4290 ;1650 ;440  ;Editable=No;
                                                 ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr="Starting Time" }
    { 118 ;Label        ;440  ;4290 ;3300 ;440  ;ParentControl=117 }
    { 119 ;TextBox      ;3850 ;4840 ;1650 ;440  ;Editable=No;
                                                 ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr="Finishing Date" }
    { 120 ;Label        ;440  ;4840 ;3300 ;440  ;ParentControl=119 }
    { 121 ;TextBox      ;3850 ;5390 ;1650 ;440  ;Editable=No;
                                                 ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr="Finishing Time" }
    { 122 ;Label        ;440  ;5390 ;3300 ;440  ;ParentControl=121 }
    { 5   ;TextBox      ;12980;990  ;1650 ;440  ;ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr="No. of Previous Services" }
    { 127 ;Label        ;9570 ;990  ;3300 ;440  ;ParentControl=5 }
    { 24  ;CommandButton;14300;9790 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 PushAction=FormHelp }
    { 26  ;SubForm      ;220  ;6270 ;20350;3300 ;Name=ServInvLines;
                                                 HorzGlue=Both;
                                                 VertGlue=Both;
                                                 Border=No;
                                                 SubFormID=Form5907;
                                                 SubFormLink=Document Type=FIELD(Document Type),
                                                             Document No.=FIELD(Document No.),
                                                             Service Item No.=FIELD(Service Item No.),
                                                             Service Item Line No.=FIELD(Line No.) }
    { 34  ;MenuButton   ;4620 ;9790 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[ENU=&Worksheet;
                                                            FRA=Feuille &activit‚];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=32;
                                                     PushAction=LookupTable;
                                                     ShortCutKey=F5;
                                                     CaptionML=[ENU=List;
                                                                FRA=Lister] }
                                                   { ID=40;
                                                     CaptionML=[ENU=Com&ments;
                                                                FRA=Co&mmentaires] }
                                                   { ID=38;
                                                     PushAction=RunObject;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=Faults;
                                                                FRA=Pannes];
                                                     RunObject=Form 5911;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Table Name=CONST(Service Header),
                                                                 Table Subtype=FIELD(Document Type),
                                                                 No.=FIELD(Document No.),
                                                                 Table Line No.=FIELD(Line No.),
                                                                 Type=CONST(Fault) }
                                                   { ID=39;
                                                     PushAction=RunObject;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=Resolutions;
                                                                FRA=Solutions];
                                                     RunObject=Form 5911;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Table Name=CONST(Service Header),
                                                                 Table Subtype=FIELD(Document Type),
                                                                 No.=FIELD(Document No.),
                                                                 Table Line No.=FIELD(Line No.),
                                                                 Type=CONST(Resolution) }
                                                   { ID=112;
                                                     PushAction=RunObject;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=Internal;
                                                                FRA=Interne];
                                                     RunObject=Form 5911;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Table Name=CONST(Service Header),
                                                                 Table Subtype=FIELD(Document Type),
                                                                 No.=FIELD(Document No.),
                                                                 Table Line No.=FIELD(Line No.),
                                                                 Type=CONST(Internal) }
                                                   { ID=68;
                                                     PushAction=RunObject;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=Accessories;
                                                                FRA=Accessoires];
                                                     RunObject=Form 5911;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Table Name=CONST(Service Header),
                                                                 Table Subtype=FIELD(Document Type),
                                                                 No.=FIELD(Document No.),
                                                                 Table Line No.=FIELD(Line No.),
                                                                 Type=CONST(Accessory) }
                                                   { ID=44;
                                                     PushAction=RunObject;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=Loaners;
                                                                FRA=A&rticles de prˆt];
                                                     RunObject=Form 5911;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Table Name=CONST(Service Header),
                                                                 Table Subtype=FIELD(Document Type),
                                                                 No.=FIELD(Document No.),
                                                                 Table Line No.=FIELD(Line No.),
                                                                 Type=CONST(Service Item Loaner) }
                                                   { ID=48;
                                                     CaptionML=[ENU=Service &Item;
                                                                FRA=&Article de service] }
                                                   { ID=35;
                                                     PushAction=RunObject;
                                                     ShortCutKey=Maj+F5;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=Card;
                                                                FRA=Fiche];
                                                     RunObject=Form 5980;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=No.=FIELD(Service Item No.) }
                                                   { ID=28;
                                                     PushAction=RunObject;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=&Log;
                                                                FRA=&Journal];
                                                     RunObject=Form 5989;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Service Item No.=FIELD(Service Item No.) }
                                                   { ID=124;
                                                     CaptionML=[ENU=&Fault/Resol. Codes Relationships;
                                                                FRA=&Relations codes panne/solution];
                                                     OnPush=BEGIN
                                                              SelectFaultResolutionCode;
                                                            END;
                                                             }
                                                   { ID=47;
                                                     CaptionML=[ENU=&Troubleshooting;
                                                                FRA=&Incident];
                                                     OnPush=BEGIN
                                                              TblshtgHeader.ShowForServItemLine(Rec);
                                                            END;
                                                             }
                                                 }
                                                  }
    { 42  ;MenuButton   ;9460 ;9790 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 HorzAlign=Center;
                                                 VertAlign=Center;
                                                 CaptionML=[ENU=F&unctions;
                                                            FRA=Fonction&s];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=43;
                                                     CaptionML=[ENU=Adjust Service Price;
                                                                FRA=Ajuster prix service];
                                                     OnPush=VAR
                                                              ServPriceMgmt@1001 : Codeunit 6080;
                                                            BEGIN
                                                              ServPriceMgmt.ShowPriceAdjustment(Rec);
                                                            END;
                                                             }
                                                   { ID=45;
                                                     CaptionML=[ENU=Insert &Ext. Texts;
                                                                FRA=Ins‚rer te&xtes ‚tendus];
                                                     OnPush=BEGIN
                                                              CurrForm.ServInvLines.FORM.InsertExtendedText(TRUE);
                                                            END;
                                                             }
                                                   { ID=46;
                                                     CaptionML=[ENU=Insert &Starting Fee;
                                                                FRA=Ins‚rer &frais forfaitaires];
                                                     OnPush=BEGIN
                                                              CurrForm.ServInvLines.FORM.InsertStartFee;
                                                            END;
                                                             }
                                                   { ID=123;
                                                     CaptionML=[ENU=Insert &Travel Fee;
                                                                FRA=&Ins‚rer frais de d‚placement];
                                                     OnPush=BEGIN
                                                              CurrForm.ServInvLines.FORM.InsertTravelFee;
                                                            END;
                                                             }
                                                   { ID=29;
                                                     CaptionML=[ENU=&Nonstock Items;
                                                                FRA=Articles non stoc&k‚s];
                                                     OnPush=BEGIN
                                                              CurrForm.ServInvLines.FORM.ShowNonstocksItems;
                                                            END;
                                                             }
                                                 }
                                                  }
    { 73  ;MenuButton   ;7040 ;9790 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[ENU=&Line;
                                                            FRA=&Ligne];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=74;
                                                     CaptionML=[ENU=Item Availability by;
                                                                FRA=Disponibilit‚ article par] }
                                                   { ID=95;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=Period;
                                                                FRA=P‚riode];
                                                     OnPush=BEGIN
                                                              CurrForm.ServInvLines.FORM.ItemAvailability(0);
                                                            END;
                                                             }
                                                   { ID=96;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=Variant;
                                                                FRA=Variante];
                                                     OnPush=BEGIN
                                                              CurrForm.ServInvLines.FORM.ItemAvailability(1);
                                                            END;
                                                             }
                                                   { ID=98;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=Location;
                                                                FRA=Magasin];
                                                     OnPush=BEGIN
                                                              CurrForm.ServInvLines.FORM.ItemAvailability(2);
                                                            END;
                                                             }
                                                   { ID=106;
                                                     MenuItemType=Separator;
                                                     CaptionML=[ENU="";
                                                                FRA=""] }
                                                   { ID=101;
                                                     ShortCutKey=Maj+Ctrl+D;
                                                     CaptionML=[ENU=Dimensions;
                                                                FRA=A&xes analytiques];
                                                     OnPush=BEGIN
                                                              CurrForm.ServInvLines.FORM.ShowDimensions;
                                                            END;
                                                             }
                                                   { ID=107;
                                                     MenuItemType=Separator;
                                                     CaptionML=[ENU="";
                                                                FRA=""] }
                                                   { ID=66;
                                                     CaptionML=[ENU=Select Item Substitution;
                                                                FRA=S‚lectionner article de substitution];
                                                     OnPush=BEGIN
                                                              CurrForm.ServInvLines.FORM.SelectItemSubstitution;
                                                            END;
                                                             }
                                                   { ID=100;
                                                     MenuItemType=Separator;
                                                     CaptionML=[ENU="";
                                                                FRA=""] }
                                                   { ID=65;
                                                     CaptionML=[ENU=&Fault/Resol. Codes Relationships;
                                                                FRA=&Relations codes panne/solution];
                                                     OnPush=BEGIN
                                                              CurrForm.ServInvLines.FORM.SelectFaultResolutionCode;
                                                            END;
                                                             }
                                                   { ID=129;
                                                     ShortCutKey=Maj+Ctrl+I;
                                                     CaptionML=[ENU=Item &Tracking Lines;
                                                                FRA=&Lignes tra‡abilit‚];
                                                     OnPush=BEGIN
                                                              CurrForm.ServInvLines.FORM.OpenItemTrackingLines;
                                                            END;
                                                             }
                                                 }
                                                  }
    { 4   ;CommandButton;11880;9790 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 Ellipsis=Yes;
                                                 CaptionML=[ENU=&Print;
                                                            FRA=&Imprimer];
                                                 OnPush=BEGIN
                                                          CLEAR(ServItemLine);
                                                          ServItemLine.SETRANGE("Document Type","Document Type");
                                                          ServItemLine.SETRANGE("Document No.","Document No.");
                                                          ServItemLine.SETRANGE("Line No.","Line No.");
                                                          REPORT.RUN(REPORT::"Service Item Worksheet",TRUE,FALSE,ServItemLine);
                                                        END;
                                                         }
    { 103 ;Frame        ;16720;220  ;3850 ;5830 ;Name=ServItemPanel;
                                                 HorzGlue=Right;
                                                 VertGlue=Both;
                                                 CaptionML=[ENU=Service Item Information;
                                                            FRA=Informations article de service] }
    { 137 ;CommandButton;16940;2970 ;2200 ;550  ;Name=IPBarchart;
                                                 FocusOnClick=Yes;
                                                 ParentControl=103;
                                                 InFrame=Yes;
                                                 HorzAlign=Left;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 Bitmap=36;
                                                 CaptionML=[ENU=Bar Chart;
                                                            FRA=Graphique … barres];
                                                 OnPush=VAR
                                                          ServLedgEntriesBarChart@1000 : Form 6085;
                                                        BEGIN
                                                          ServLedgEntriesBarChart.SetServItemFilter("Service Item No.");
                                                          ServLedgEntriesBarChart.RUNMODAL;
                                                        END;
                                                         }
    { 138 ;CommandButton;16940;2420 ;2200 ;550  ;Name=IPSkilledRes;
                                                 FocusOnClick=Yes;
                                                 ParentControl=103;
                                                 InFrame=Yes;
                                                 HorzAlign=Left;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 Bitmap=36;
                                                 CaptionML=[ENU=Skilled Resources;
                                                            FRA=Ressources comp‚tentes];
                                                 OnPush=BEGIN
                                                          ServInfoPaneMgt.ShowSkilledResources(Rec);
                                                        END;
                                                         }
    { 139 ;TextBox      ;19140;2420 ;1210 ;550  ;Name=IPSkilledResTextbox;
                                                 Editable=No;
                                                 Focusable=No;
                                                 ParentControl=103;
                                                 InFrame=Yes;
                                                 HorzAlign=Right;
                                                 Border=No;
                                                 SourceExpr=STRSUBSTNO('(%1)',ServInfoPaneMgt.CalcNoOfSkilledResources(Rec)) }
    { 140 ;CommandButton;16940;1870 ;2200 ;550  ;Name=IPTroubleshooting;
                                                 FocusOnClick=Yes;
                                                 ParentControl=103;
                                                 InFrame=Yes;
                                                 HorzAlign=Left;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 Bitmap=36;
                                                 CaptionML=[ENU=Troubleshooting;
                                                            FRA=Incident];
                                                 OnPush=BEGIN
                                                          ServInfoPaneMgt.ShowTroubleshootings(Rec);
                                                        END;
                                                         }
    { 141 ;TextBox      ;19140;1870 ;1210 ;550  ;Name=IPTroubleshootingTextbox;
                                                 Editable=No;
                                                 Focusable=No;
                                                 ParentControl=103;
                                                 InFrame=Yes;
                                                 HorzAlign=Right;
                                                 Border=No;
                                                 SourceExpr=STRSUBSTNO('(%1)',ServInfoPaneMgt.CalcNoOfTroubleshootings(Rec)) }
    { 142 ;CommandButton;16940;1320 ;2200 ;550  ;Name=IPCompList;
                                                 FocusOnClick=Yes;
                                                 ParentControl=103;
                                                 InFrame=Yes;
                                                 HorzAlign=Left;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 Bitmap=36;
                                                 CaptionML=[ENU=Components;
                                                            FRA=Composants];
                                                 OnPush=BEGIN
                                                          ServInfoPaneMgt.ShowServItemComponents(Rec);
                                                        END;
                                                         }
    { 143 ;TextBox      ;19140;1320 ;1210 ;550  ;Name=IPCompListTextbox;
                                                 Editable=No;
                                                 Focusable=No;
                                                 ParentControl=103;
                                                 InFrame=Yes;
                                                 HorzAlign=Right;
                                                 Border=No;
                                                 SourceExpr=STRSUBSTNO('(%1)',ServInfoPaneMgt.CalcNoOfServItemComponents(Rec)) }
    { 144 ;CommandButton;16940;770  ;2200 ;550  ;Name=IPServItem;
                                                 FocusOnClick=Yes;
                                                 ParentControl=103;
                                                 InFrame=Yes;
                                                 HorzAlign=Left;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 Bitmap=36;
                                                 CaptionML=[ENU=Service Ite&m Card;
                                                            FRA=Fiche ar&ticle service];
                                                 OnPush=BEGIN
                                                          ServInfoPaneMgt.LookupServItem(Rec);
                                                        END;
                                                         }
    { 145 ;PictureBox   ;19910;770  ;440  ;440  ;Name=IPServItemCommentPB;
                                                 Focusable=No;
                                                 ParentControl=103;
                                                 InFrame=Yes;
                                                 ShowCaption=No;
                                                 Border=No;
                                                 BitmapPos=Center;
                                                 BitmapList=7,6;
                                                 SourceExpr=ServInfoPaneMgt.ServItemCommentExists(Rec) }
    { 146 ;CommandButton;19910;770  ;440  ;440  ;Name=IPServItemButton;
                                                 ParentControl=103;
                                                 InFrame=Yes;
                                                 ShowCaption=No;
                                                 BackTransparent=Yes;
                                                 OnPush=BEGIN
                                                          ServInfoPaneMgt.LookupServItemComment(Rec);
                                                        END;
                                                         }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=You cannot open the form because %1 is %2 in the %3 table.;FRA=Vous ne pouvez pas ouvrir ce formulaire, car %1 est %2 dans la table %3.';
      ServHeader@1001 : Record 5900;
      ShiptoAddr@1005 : Record 222;
      ServItemLine@1002 : Record 5901;
      ServItem@1003 : Record 5940;
      ServInvLine@1004 : Record 5902;
      PostCodeRec@1017 : Record 225;
      TblshtgHeader@1006 : Record 5943;
      ServInfoPaneMgt@1018 : Codeunit 5972;
      ShiptoName@1007 : Text[50];
      ShiptoName2@1008 : Text[50];
      ShiptoAddress@1009 : Text[50];
      ShiptoAddress2@1010 : Text[50];
      ShiptoPostCode@1011 : Code[20];
      ShiptoCity@1012 : Text[30];
      ShiptoCounty@1013 : Text[30];
      ShiptoCountryCode@1014 : Code[10];
      ShiptoContact@1015 : Text[50];
      ShiptoPhoneNo@1016 : Text[30];

    PROCEDURE Caption@1() : Text[80];
    BEGIN
      IF "Service Item No." <> '' THEN
        EXIT(STRSUBSTNO('%1 %2',"Service Item No.",Description));
      IF "Item No." <> '' THEN
        EXIT(STRSUBSTNO('%1 %2',"Item No.",Description));
      EXIT(STRSUBSTNO('%1 %2',"Serial No.",Description));
    END;

    PROCEDURE SelectFaultResolutionCode@15();
    VAR
      ServSetup@1000 : Record 5911;
      FaultResolutionRelation@1001 : Form 5930;
    BEGIN
      ServSetup.GET;
      CASE ServSetup."Fault Reporting Level" OF
        ServSetup."Fault Reporting Level"::None:
          BEGIN
            ERROR(
              Text000,
              ServSetup.FIELDCAPTION("Fault Reporting Level"),ServSetup."Fault Reporting Level",ServSetup.TABLECAPTION);
          END;
      END;
      CLEAR(FaultResolutionRelation);
      FaultResolutionRelation.SetDocument(DATABASE::"Service Item Line","Document Type","Document No.","Line No.");
      FaultResolutionRelation.SetFilters("Symptom Code","Fault Code","Fault Area Code","Service Item Group Code");
      FaultResolutionRelation.RUNMODAL;
      CurrForm.UPDATE(FALSE);
    END;

    PROCEDURE UpdateShiptoCode@6();
    BEGIN
      ServHeader.GET("Document Type","Document No.");
      IF "Ship-to Code" = '' THEN BEGIN
        ShiptoName := ServHeader.Name;
        ShiptoName2 := ServHeader."Name 2";
        ShiptoAddress := ServHeader.Address;
        ShiptoAddress2 := ServHeader."Address 2";
        ShiptoPostCode := ServHeader."Post Code";
        ShiptoCity := ServHeader.City;
        ShiptoCounty := ServHeader.County;
        ShiptoCountryCode := ServHeader."Country/Region Code";
        ShiptoContact := ServHeader."Contact Name";
        ShiptoPhoneNo := ServHeader."Phone No.";
      END ELSE BEGIN
        ShiptoAddr.GET("Customer No.","Ship-to Code");
        ShiptoName := ShiptoAddr.Name;
        ShiptoName2 := ShiptoAddr."Name 2";
        ShiptoAddress := ShiptoAddr.Address;
        ShiptoAddress2 := ShiptoAddr."Address 2";
        ShiptoPostCode := ShiptoAddr."Post Code";
        ShiptoCity := ShiptoAddr.City;
        ShiptoCounty := ShiptoAddr.County;
        ShiptoCountryCode := ShiptoAddr."Country/Region Code";
        ShiptoContact := ShiptoAddr.Contact;
        ShiptoPhoneNo := ShiptoAddr."Phone No.";
      END;
    END;

    PROCEDURE InfopaneEnable@2(Value@1000 : Boolean);
    BEGIN
      CurrForm.IPServItem.ENABLED := Value;
      CurrForm.IPServItemButton.ENABLED := Value;
      CurrForm.IPServItemCommentPB.ENABLED := Value;
      CurrForm.IPCompList.ENABLED := Value;
      CurrForm.IPCompListTextbox.ENABLED := Value;
      CurrForm.IPTroubleshooting.ENABLED := Value;
      CurrForm.IPTroubleshootingTextbox.ENABLED := Value;
      CurrForm.IPSkilledRes.ENABLED := Value;
      CurrForm.IPSkilledResTextbox.ENABLED := Value;
      CurrForm.IPBarchart.ENABLED := Value;
    END;

    BEGIN
    {
      /** @r IHM01 @d 10/02/11 @a ISAT.ZW @v IMH6.01.001 @s Normalisation des donn‚es
          @c Associer les Pays au code postaux - descendre le code pays automatiquement*/
    }
    END.
  }
}