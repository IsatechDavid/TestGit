OBJECT Page 50000 Provider Card
{
  OBJECT-PROPERTIES
  {
    Date=07/05/14;
    Time=11:51:44;
    Modified=Yes;
    Version List=IMH6.01.08,JUILLET,SUPPORT,IMH6.01.P011;
  }
  PROPERTIES
  {
    Permissions=TableData 25=r,
                TableData 288=r,
                TableData 380=r;
    CaptionML=[ENU=Provider Card;
               FRA=Fiche prestataire];
    SourceTable=Table50000;
    DataCaptionExpr=GetCaption;
    PageType=Card;
    RefreshOnActivate=Yes;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Additional,Historic;
                                FRA=" ,  ,   ,    ,     "];
    OnInit=BEGIN
             IsEditable := TRUE; // IMH04.ISAT.MA
             ProviderSetup.GET;//IMH09
           END;

    OnOpenPage=BEGIN
                 TestCaption := 'toto';
               END;

    OnFindRecord=VAR
                   lFound@1100281000 : Boolean;
                 BEGIN
                   lFound := FIND(Which);
                   IF NOT lFound AND (GETFILTER("No.") <> '') THEN BEGIN
                     MESSAGE(Text001,GETFILTER("No."));
                     SETRANGE("No.");
                     lFound := FIND(Which);
                   END;
                   EXIT(lFound);
                 END;

    OnAfterGetRecord=BEGIN
                       CheckSalesperson; //IMH45.ST
                       SetImportantValue;
                       SetFormEditable();
                       SetPriorityDateEditable();
                       SetTurnOverDateEditable();
                       SetManpowerCheckDateEditable();
                       KeyBoardAddress := '';
                       UpdateSocieteComURL;
                       SetExclusionField;
                       IF ProviderSetup."Quality Control Specialization" <> '' THEN
                         QualityControllerVisible := ProvSpec.GET("No.",ProviderSetup."Quality Control Specialization");
                       CalcCalendarFields;  //IMH26

                       //<<IMH13.ST
                       CALCFIELDS("User Next Step Available");
                       UserNextStepAvailable := "User Next Step Available";
                       //>>IMH13.ST

                       //<<IMH35.zw
                       CALCFIELDS("Current Service Interv. Nb");
                       IF "Current Interv. Limit Max." <> 0 THEN
                         OccupationRate := ("Current Service Interv. Nb" / "Current Interv. Limit Max.") * 100
                       ELSE
                         OccupationRate := 0;
                       //>>IMH35.zw
                     END;

    OnInsertRecord=BEGIN
                     IsOnInsert := TRUE;
                   END;

    OnQueryClosePage=BEGIN
                       IF NOT Enable THEN
                         MESSAGE(Text015);
                     END;

    ActionList=ACTIONS
    {
      { 1100281098;  ;ActionContainer;
                      Name=RelatedInformation;
                      ActionContainerType=RelatedInformation }
      { 1100281096;1 ;Action    ;
                      Name=Contact;
                      ShortCutKey=Ctrl+Q;
                      CaptionML=[ENU=C&ontact;
                                 FRA=&Contacts];
                      Promoted=Yes;
                      Image=ExportSalesPerson;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 ShowContact;
                               END;
                                }
      { 1100281094;1 ;Action    ;
                      Name=RelatedContacts;
                      CaptionML=[ENU=Relate&d Contacts;
                                 FRA=Contacts &li‚s];
                      RunObject=Page 5052;
                      RunFormView=WHERE(Type=CONST(Person),
                                        Service Contact=CONST(Provider));
                      RunFormLink=Company No.=FIELD(No.);
                      Promoted=Yes;
                      Image=TeamSales;
                      PromotedCategory=Category4 }
      { 1100281091;1 ;Action    ;
                      Name=OperationelAddress;
                      CaptionML=[ENU=Ope&rationel Add.;
                                 FRA=Adr. &op‚rationnelle];
                      RunObject=Page 50125;
                      RunFormView=WHERE(Geo. Reference Address=CONST(Yes));
                      RunFormLink=Contact No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Note;
                      PromotedCategory=Category4 }
      { 1100281077;1 ;Action    ;
                      Name=OperationelAddressHistoric;
                      CaptionML=[ENU=Op. Add. His&toric;
                                 FRA=His&torique adr. op.];
                      RunObject=Page 50033;
                      RunFormLink=Contact No.=FIELD(No.);
                      RunFormMode=View }
      { 1100281090;1 ;Separator  }
      { 1100281087;1 ;Action    ;
                      Name=Specialization;
                      CaptionML=[ENU=Speciali&zation;
                                 FRA=&Sp‚cialit‚s];
                      Promoted=Yes;
                      Image=MaintenanceRegistrations;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 lProviderSpecialization@1100281001 : Record 50006;
                                 lProviderSpecializationsList@1100281002 : Page 50003;
                               BEGIN
                                 // <<IMH40.ISAT.MA
                                 IF "Main Specialization Code" = '' THEN
                                   IF NOT CONFIRM(Text010) THEN
                                     EXIT;
                                 lProviderSpecialization.SETRANGE("Provider No.","No.");
                                 lProviderSpecializationsList.SETTABLEVIEW(lProviderSpecialization);
                                 lProviderSpecializationsList.RUNMODAL;
                                 // >>IMH40.ISAT.MA
                               END;
                                }
      { 1100281089;1 ;Action    ;
                      Name=Agreement;
                      CaptionML=[ENU=Agreme&nt;
                                 FRA=&Agr‚ments];
                      RunObject=Page 50131;
                      RunFormLink=Provider No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Agreement;
                      PromotedCategory=Category4 }
      { 1100281008;1 ;Action    ;
                      Name=Agreement Document;
                      CaptionML=FRA=Doc. agr‚ment;
                      RunObject=Page 50270;
                      RunFormLink=Provider No.=FIELD(No.) }
      { 1100281088;1 ;Action    ;
                      Name=Qualification;
                      CaptionML=[ENU=&Qualification;
                                 FRA=&Qualifications];
                      RunObject=Page 50032;
                      RunFormLink=Provider No.=FIELD(No.);
                      Promoted=Yes;
                      Image=TaskList;
                      PromotedCategory=Category4 }
      { 1100281167;1 ;Action    ;
                      Name=QualificationHistoric;
                      CaptionML=[ENU=Qualification Historic;
                                 FRA=Historique qualification];
                      RunObject=Page 50249;
                      RunFormLink=Provider No.=FIELD(No.) }
      { 1100281201;1 ;Action    ;
                      Name=ProvServOrderTypeLimit;
                      CaptionML=[ENU=Prov. Serv. Order Type Limit;
                                 FRA=Limite interv. prestataire par type produit];
                      RunObject=Page 50340;
                      RunFormLink=Provider No.=FIELD(No.) }
      { 1100281150;1 ;Separator  }
      { 1100281088;1 ;Action    ;
                      Name=AbilityGeographical;
                      CaptionML=[ENU=Ability &Geographical;
                                 FRA=Comp‚tence &g‚o.];
                      RunObject=Page 50126;
                      RunFormLink=Provider No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Segment;
                      PromotedCategory=Category4 }
      { 1100281089;1 ;Action    ;
                      Name=StandardMap;
                      CaptionML=[ENU=Standard Map;
                                 FRA=Carte standard];
                      Promoted=Yes;
                      Image=Segment;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 lHtmlPage@1100281000 : Page 50174;
                               BEGIN
                                 lHtmlPage.LoadProviderMap("No.",'',FALSE,'',FALSE);
                                 lHtmlPage.RUNMODAL();
                               END;
                                }
      { 1100281090;1 ;Action    ;
                      Name=EmergencyMap;
                      CaptionML=[ENU=Emergency Map;
                                 FRA=Carte urgence];
                      Promoted=Yes;
                      Image=Segment;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 lGeoConceptMap@1100281000 : Page 50174;
                               BEGIN
                                 lGeoConceptMap.LoadProviderMap("No.",'',FALSE,'',TRUE);
                                 lGeoConceptMap.RUNMODAL();
                               END;
                                }
      { 1100281080;1 ;Separator  }
      { 1100281079;1 ;Action    ;
                      Name=Attachment;
                      CaptionML=[ENU=Attachment;
                                 FRA=Documents &joints];
                      RunObject=Page 50015;
                      RunFormView=SORTING(Provider No.)
                                  WHERE(Service No.=CONST(''),
                                        Service Document No.=CONST(''));
                      RunFormLink=Provider No.=FIELD(No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Links;
                      PromotedCategory=Process }
      { 1100281068;1 ;Action    ;
                      Name=LinkProvider;
                      CaptionML=[ENU=Link Provider;
                                 FRA=&Prestataire associ‚];
                      RunObject=Page 50129;
                      RunFormLink=Provider No.=FIELD(No.) }
      { 1100281078;1 ;Separator  }
      { 1100281153;1 ;Action    ;
                      Name=StandardCalendar;
                      CaptionML=[ENU=Std C&alendar;
                                 FRA=Calendrier &std.];
                      Image=CalendarChanged;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 ProviderCalendarMgt.GetStandardCalendar("No.");
                               END;
                                }
      { 1100281070;1 ;Action    ;
                      Name=StandardBusinessHours;
                      CaptionML=[ENU=Standard &Business Hours;
                                 FRA=Heures d'ou&verture standard];
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 ProviderCalendarMgt.GetBusinessHours("No.",FALSE);
                               END;
                                }
      { 1100281045;1 ;Action    ;
                      Name=EmergencyCalendar;
                      CaptionML=[ENU=Emer&g. Calendar;
                                 FRA=Calendrier &urg.];
                      Image=CalendarChanged;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 ProviderCalendarMgt.GetEmergencyCalendar("No.");
                               END;
                                }
      { 1100281043;1 ;Action    ;
                      Name=EmergencyBusinessHours;
                      CaptionML=[ENU=Emer&gency Business Hours;
                                 FRA=Heures d'ouverture ur&gence];
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 ProviderCalendarMgt.GetBusinessHours("No.",TRUE);
                               END;
                                }
      { 1100281042;1 ;Separator  }
      { 1100281133;1 ;Action    ;
                      Name=PostponedInteractions;
                      CaptionML=[ENU=Postponed &Interactions;
                                 FRA=Brouillons];
                      RunObject=Page 5082;
                      RunFormView=SORTING(Contact Company No.,Contact No.,Date,Postponed);
                      RunFormLink=Contact No.=FIELD(No.) }
      { 1100281137;1 ;Separator  }
      { 1100281151;1 ;Action    ;
                      Name=Provider Scoring Ledger Entry;
                      CaptionML=[ENU=Provider Scoring Ledger Entry;
                                 FRA=Ecritures Scoring prestataire];
                      RunObject=Page 50175;
                      RunFormLink=Provider No.=FIELD(No.) }
      { 1100281170;1 ;Action    ;
                      Name=History;
                      CaptionML=[ENU=History;
                                 FRA=Historiques];
                      RunObject=Page 595;
                      RunFormView=SORTING(Table No.,Primary Key Field 1 Value);
                      RunFormLink=Primary Key Field 1 Value=FIELD(No.),
                                  Table No.=FILTER(50000|50006);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=History;
                      PromotedCategory=Category5 }
      { 1100281181;1 ;Action    ;
                      Name=Priority History;
                      CaptionML=[ENU=Priority History;
                                 FRA=Historique des priorit‚s];
                      RunObject=Page 50267;
                      RunFormLink=Provider No.=FIELD(No.) }
      { 1100281029;1 ;ActionGroup;
                      Name=ActionGroupVisit;
                      CaptionML=[ENU=Visit;
                                 FRA=Visite] }
      { 1100281069;2 ;Action    ;
                      Name=CreateNewVisit;
                      CaptionML=[ENU=Create Visit;
                                 FRA=Cr‚er visite];
                      Image=NewDocument;
                      OnAction=VAR
                                 lNetworkVisit@1100281000 : Record 50105;
                               BEGIN
                                 lNetworkVisit.CreateNewVisit(TRUE,"No.");
                               END;
                                }
      { 1000000014;2 ;Action    ;
                      Name=VisitHistoric;
                      CaptionML=[ENU=Visit Historic;
                                 FRA=Historiques des visites];
                      RunObject=Page 50322;
                      RunFormView=SORTING(Provider No.);
                      RunFormLink=Provider No.=FIELD(No.) }
      { 1100281038;1 ;Separator  }
      { 1100281177;1 ;Action    ;
                      Name=CreateVendor;
                      CaptionML=[ENU=Create Vendor;
                                 FRA=Cr‚er fournisseur];
                      PromotedCategory=New;
                      OnAction=BEGIN
                                 CreateVendor;
                               END;
                                }
      { 1100281166;1 ;Action    ;
                      Name=ShowVendor;
                      CaptionML=[ENU=Vendor Card;
                                 FRA=Fiche fournisseur];
                      OnAction=BEGIN
                                 ShowVendorCard("No.");
                               END;
                                }
      { 1100281172;1 ;Action    ;
                      Name=ShowVendorBankAccount;
                      CaptionML=[ENU=Vendor Bank Account;
                                 FRA=Compte bancaire fournisseur];
                      OnAction=BEGIN
                                 ShowDefaultVendorBankAccount("No.");
                               END;
                                }
      { 1100281016;1 ;Separator  }
      { 1100281178;1 ;Action    ;
                      Name=Activit‚s en-cours;
                      OnAction=VAR
                                 lTrayLine@1100281001 : Record 50048;
                                 lProviderSetup@1000000002 : Record 50011;
                                 lTrayLinesList@1000000001 : Page 50123;
                               BEGIN
                                 //<<IMH47
                                 lTrayLine.SETCURRENTKEY("Contact No.",Closed);
                                 lTrayLine.SETRANGE(Closed, FALSE);
                                 lTrayLine.SETRANGE("Contact No.", "No.");
                                 //<<IMH50.PC
                                 lProviderSetup.GET;
                                 IF lProviderSetup."Team Code Default Filter" <> '' THEN BEGIN
                                   lTrayLine.SETFILTER("Team Code",lProviderSetup."Team Code Default Filter");
                                 END;
                                 //>>IMH50.PC
                                 lTrayLinesList.SETTABLEVIEW(lTrayLine);
                                 lTrayLinesList.RUNMODAL;
                                 //>>IMH47
                               END;
                                }
      { 1100281076;  ;ActionContainer;
                      Name=Actionitems;
                      ActionContainerType=ActionItems }
      { 1100281075;1 ;Action    ;
                      Name=AddPersonContact;
                      CaptionML=[ENU=Add P&erson Contact;
                                 FRA=Ajouter cont. pers.];
                      PromotedCategory=New;
                      OnAction=BEGIN
                                 IF IsEditable THEN  // IMH04.ISAT.MA
                                   ProviderContactUpdate.InsertNewContactPerson(Rec,FALSE,TRUE);
                               END;
                                }
      { 1100281175;1 ;Separator  }
      { 1100281073;1 ;Action    ;
                      Name=CopyProvider;
                      CaptionML=[ENU=Copy Provi&der;
                                 FRA=Copier &presta.];
                      Promoted=Yes;
                      PromotedCategory=New;
                      OnAction=BEGIN
                                 CopyProvider.SetProvider("No.");
                                 CopyProvider.RUNMODAL;
                               END;
                                }
      { 1100281044;1 ;Action    ;
                      Name=AddAttachment;
                      CaptionML=[ENU=Ad&d Attachment;
                                 FRA=Ajouter &doc. joint];
                      Image=Links;
                      OnAction=VAR
                                 lDocumentAttachment@1100281001 : Record 50021;
                                 lSourceAttachMgt@1100281000 : Codeunit 50003;
                               BEGIN
                                 IF IsEditable THEN  // IMH04.ISAT.MA
                                 BEGIN
                                   lDocumentAttachment.SETRANGE("Provider No.","No.");
                                   lSourceAttachMgt.CreateAttachmentFromForm(lDocumentAttachment);
                                 END;
                               END;
                                }
      { 1100281136;1 ;Action    ;
                      Name=NextStep;
                      CaptionML=[ENU=Next Step;
                                 FRA=Etape suivante];
                      Promoted=Yes;
                      Visible=UserNextStepAvailable;
                      Enabled=IsEditable;
                      PromotedIsBig=Yes;
                      Image=SelectItemSubstitution;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 lProcessProviderMgt@1100281000 : Codeunit 50044;
                               BEGIN
                                 //IMH11 isat.zw
                                 lProcessProviderMgt.SelectNextStep(Rec);
                               END;
                                }
      { 1100281041;1 ;Separator  }
      { 1100281081;1 ;Action    ;
                      Name=Completeness;
                      CaptionML=[ENU=Completeness;
                                 FRA=Compl‚tu&de];
                      RunObject=Page 50028;
                      RunFormLink=Provider No.=FIELD(No.);
                      Promoted=Yes;
                      Image=MachineCenterLoad;
                      PromotedCategory=Process }
      { 1100281082;1 ;Separator  }
      { 1100281039;1 ;Action    ;
                      Name=ProviderResearch;
                      ShortCutKey=Ctrl+F;
                      CaptionML=[ENU=Check Provider Exists;
                                 FRA=Exis&tence presta.];
                      RunObject=Codeunit 50000;
                      Image=Find;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ProviderMgt.ProviderDuplicate(Rec,FALSE);
                               END;
                                }
      { 1100281014;1 ;Separator  }
      { 1100281009;1 ;Action    ;
                      Name=CreateTrayLine;
                      CaptionML=[ENU=Create Tray Line;
                                 FRA=Activit‚s corbeille];
                      Promoted=Yes;
                      Image=BinContent;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 lContact@1100281001 : Record 5050;
                                 lTrayLineMgt@1100281000 : Codeunit 50050;
                               BEGIN
                                 lContact.GET("No.");
                                 lTrayLineMgt.CreateTLFromContact(lContact, '', '', TRUE);
                               END;
                                }
      { 1100281018;1 ;Separator  }
      { 1100281015;1 ;Action    ;
                      Name=Comments;
                      CaptionML=[ENU=Comment;
                                 FRA=Commentaires];
                      RunObject=Page 50070;
                      RunFormView=SORTING(Source No.,Creation Date)
                                  ORDER(Descending)
                                  WHERE(Source Table ID=CONST(50000));
                      RunFormLink=Source No.=FIELD(No.);
                      Promoted=Yes;
                      Image=ViewComments;
                      PromotedCategory=Process }
      { 1100281110;1 ;Separator  }
      { 1100281104;1 ;Action    ;
                      Name=CreateInteraction;
                      CaptionML=[ENU=Create &Interact;
                                 FRA=Cr‚er &interact.];
                      Promoted=Yes;
                      Image=CreateInteraction;
                      OnAction=BEGIN
                                 //IHM10 isat.zw
                                 CreateInteraction;
                               END;
                                }
      { 1100281134;1 ;Action    ;
                      Name=InteractionLogEntries;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Interaction Log E&ntries;
                                 FRA=Ecritures &journal interaction];
                      RunObject=Page 5076;
                      RunFormView=SORTING(Provider No.);
                      RunFormLink=Provider No.=FIELD(No.),
                                  Service No.=CONST(''),
                                  Service Header No.=CONST(''),
                                  Attachment Deleted=CONST(No);
                      Promoted=Yes;
                      Image=Track }
      { 1100281102;1 ;Separator  }
      { 1100281195;1 ;Action    ;
                      Name=ProviderinformationCard;
                      CaptionML=[ENU=Provider information Card;
                                 FRA=Fiche renseignement];
                      OnAction=VAR
                                 lProvider@1000000002 : Record 50000;
                                 lProviderInformation@1000000001 : Report 50035;
                               BEGIN
                                 //PDFManagement.PrintProvderReport(Rec, REPORT::"Provider Information");

                                 lProvider := Rec;
                                 lProvider.SETRECFILTER;
                                 //lProvider.SETRANGE("No.", "No.");
                                 REPORT.RUNMODAL(REPORT::"Provider Information",TRUE,TRUE,lProvider);
                               END;
                                }
      { 1100281198;1 ;Action    ;
                      Name=Provider summary information;
                      CaptionML=[ENU=Provider summary information;
                                 FRA=Fiche de synthŠse prestataire];
                      OnAction=VAR
                                 lProvider@1000000001 : Record 50000;
                               BEGIN
                                 //PDFManagement.PrintProvderReport(Rec, REPORT::"Provider Summary Information");
                                 lProvider := Rec;
                                 lProvider.SETRECFILTER;
                                 //lProvider.SETRANGE("No.", "No.");
                                 REPORT.RUNMODAL(REPORT::"Provider Summary Information",TRUE,TRUE,lProvider);
                               END;
                                }
      { 1100281103;1 ;Action    ;
                      Name=ProviderScoringPrint;
                      CaptionML=[ENU=Provider Scoring Print;
                                 FRA=Scoring prestataire];
                      OnAction=VAR
                                 lScoringExportMgt@1100281000 : Codeunit 50067;
                               BEGIN
                                 //IMH10 isat.zw
                                 lScoringExportMgt.LaunchExport("No.", FALSE);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1100281169;1;Group  ;
                Name=FollowUpGrp;
                CaptionML=[ENU=Follow Up;
                           FRA=Suivi];
                GroupType=Group }

    { 1100281202;2;Field  ;
                SourceExpr="Follow Up";
                MultiLine=Yes }

    { 1100281203;2;Field  ;
                SourceExpr="Follow Up Start Date" }

    { 1100281204;2;Field  ;
                SourceExpr="Follow Up End Date" }

    { 1100281205;2;Field  ;
                SourceExpr="Follow Up Date Creation" }

    { 1100281206;2;Field  ;
                SourceExpr="Follow Up User Creation" }

    { 1100281208;2;Field  ;
                SourceExpr="Follow Up Origin" }

    { 1100281196;1;Group  ;
                Name=Contr“le des prestataires;
                GroupType=Group }

    { 1100281193;2;Field  ;
                SourceExpr="AR Check" }

    { 1100281192;2;Field  ;
                SourceExpr="AR Check Userid" }

    { 1100281191;2;Field  ;
                SourceExpr="AR Check Date" }

    { 1100281190;2;Field  ;
                SourceExpr="Geo Setup Type";
                Importance=Promoted;
                Editable=FALSE }

    { 1100281183;2;Field  ;
                SourceExpr="CR Check" }

    { 1100281157;2;Field  ;
                SourceExpr="CR Check Userid" }

    { 1100281154;2;Field  ;
                SourceExpr="CR Check Date";
                Editable=FALSE }

    { 1100281000;1;Group  ;
                Name=General;
                CaptionML=[ENU=General;
                           FRA=G‚n‚ral];
                Editable=IsEditable }

    { 1100281013;2;Field  ;
                SourceExpr=Enable;
                Importance=Additional;
                Style=Attention;
                StyleExpr=TRUE }

    { 1100281001;2;Field  ;
                CaptionML=ENU=No.;
                SourceExpr="No." }

    { 1100281132;2;Field  ;
                SourceExpr=Status;
                Editable=false }

    { 1100281145;2;Field  ;
                SourceExpr="Process Status Description";
                Importance=Additional }

    { 1100281022;2;Field  ;
                SourceExpr="Establishment Type";
                Importance=Additional }

    { 1100281063;2;Field  ;
                SourceExpr="Salutation Code";
                Importance=Additional;
                Visible=FALSE }

    { 1100281121;2;Field  ;
                SourceExpr=Name;
                Editable=IsEditable }

    { 1100281061;2;Field  ;
                SourceExpr="Name 2" }

    { 1100281006;2;Field  ;
                SourceExpr="Search Name";
                Importance=Additional;
                Visible=false }

    { 1100281122;2;Field  ;
                SourceExpr=Address;
                Editable=AddressEditable }

    { 1100281123;2;Field  ;
                SourceExpr="Address 2";
                Importance=Additional }

    { 1100281066;2;Field  ;
                SourceExpr="Post Code" }

    { 1100281128;2;Field  ;
                SourceExpr=City }

    { 1100281163;2;Field  ;
                Name=IMHTerritoryDescription;
                CaptionML=[ENU=IMH Territory Description;
                           FRA=Zone IMH];
                SourceExpr=GetDescription(FIELDNO("IMH Territory Code"),"IMH Territory Code");
                TableRelation=Territory.Name;
                Visible=FALSE }

    { 1100281083;2;Field  ;
                Name=AdminTerritoryDescription;
                CaptionML=[ENU=Admin. Territory Description;
                           FRA=R‚gion administrative];
                SourceExpr=GetDescription(FIELDNO("Admin. Territory Code"),"Admin. Territory Code");
                Importance=Additional }

    { 1100281129;2;Field  ;
                CaptionML=[ENU=Country/Region Code;
                           FRA=Pays];
                SourceExpr="Country/Region Code";
                Importance=Additional }

    { 1100281021;2;Field  ;
                SourceExpr="Regional Coordinator";
                Importance=Additional }

    { 1100281112;2;Field  ;
                Name=Area Responsible Name;
                DrillDown=No;
                CaptionML=[ENU=Area Responsible Name;
                           FRA=Nom responsable de zone];
                SourceExpr=GetDescription(FIELDNO("Regional Coordinator"),"Salesp. Reg. Coordinator Code");
                TableRelation=Salesperson/Purchaser.Name;
                Editable=FALSE }

    { 1100281147;2;Field  ;
                SourceExpr="Network Facilitator";
                Importance=Additional }

    { 1100281148;2;Field  ;
                Name=Network Facilitator Name;
                CaptionML=[ENU=Network Facilitator Name;
                           FRA=Nom charg‚ de pilotage r‚seau];
                SourceExpr=GetDescription(FIELDNO("Network Facilitator"),"Salesp. Net. Facilitator Code");
                TableRelation=Salesperson/Purchaser.Name;
                Editable=FALSE }

    { 1100281020;2;Field  ;
                SourceExpr="Network Assistant";
                Importance=Additional }

    { 1100281113;2;Field  ;
                Name=Network Assistant Name;
                CaptionML=[ENU=Network Assistant Name;
                           FRA=Nom assistante r‚seau];
                SourceExpr=GetDescription(FIELDNO("Network Assistant"),"Salesp. Network Assistant Code");
                TableRelation=Salesperson/Purchaser.Name;
                Editable=FALSE }

    { 1100281155;2;Field  ;
                SourceExpr=Priority;
                Importance=Additional;
                OnValidate=BEGIN
                             SetPriorityDateEditable();
                           END;
                            }

    { 1100281004;2;Field  ;
                SourceExpr="Priority Start Date";
                Importance=Additional;
                Editable=IsPriorityDateEditable }

    { 1100281005;2;Field  ;
                SourceExpr="Priority End Date";
                Importance=Additional;
                Editable=IsPriorityDateEditable }

    { 1100281025;2;Field  ;
                SourceExpr="General Company" }

    { 1100281024;2;Field  ;
                SourceExpr="Renovation Company" }

    { 1100281064;2;Field  ;
                SourceExpr="Main Building Trade No.";
                Importance=Additional;
                OnValidate=BEGIN
                             CurrPage.UPDATE;
                           END;
                            }

    { 1100281119;2;Field  ;
                SourceExpr="Main Building Trade Desc.";
                Importance=Promoted;
                Editable=FALSE }

    { 1100281050;2;Field  ;
                SourceExpr="Main Specialization Code";
                Importance=Additional;
                OnValidate=BEGIN
                             IF "Main Specialization Code" = '' THEN
                               IF NOT CONFIRM(Text013) THEN
                                 ERROR('');
                             CurrPage.UPDATE;
                           END;
                            }

    { 1100281065;2;Field  ;
                SourceExpr="Main Spec. Description";
                Importance=Promoted;
                Editable=FALSE }

    { 1100281036;2;Field  ;
                SourceExpr="Main Specialization Check";
                Importance=Additional }

    { 1100281109;2;Field  ;
                SourceExpr="NAF Code";
                Importance=Additional }

    { 1100281028;2;Field  ;
                Name=NAF Activity;
                DrillDown=No;
                CaptionML=[ENU=NAF Activity;
                           FRA=Activit‚ NAF];
                SourceExpr=GetDescription(FIELDNO("NAF Code"),"NAF Code");
                TableRelation=Code.Description WHERE (Table ID=CONST(50000),
                                                      Field ID=CONST(54130));
                Importance=Additional;
                Editable=FALSE }

    { 1100281002;2;Field  ;
                SourceExpr=Category }

    { 1100281012;2;Field  ;
                SourceExpr="Provider Scoring";
                Editable=true }

    { 1100281100;2;Field  ;
                SourceExpr="Statistics Group No.";
                Importance=Additional;
                OnValidate=BEGIN
                             CALCFIELDS("Statistics Group");
                           END;
                            }

    { 1100281149;2;Field  ;
                Name=Statistical Group;
                DrillDown=No;
                CaptionML=[ENU=Statistical Group;
                           FRA=Groupe statistique];
                SourceExpr="Statistics Group";
                TableRelation="Statistics Group";
                Editable=FALSE }

    { 1100281019;2;Group  ;
                Name=Intervention;
                CaptionML=[ENU=Intervention;
                           FRA=Intervention];
                GroupType=Group }

    { 1100281067;3;Field  ;
                Name=LastIntervNb;
                CaptionML=[ENU=Last 12 months interv. Nb;
                           FRA=Nb. interv. depuis les 12 derniers mois];
                SourceExpr=GetLastIntervNb;
                OnLookup=BEGIN
                           LookupLastIntervNb;
                         END;
                          }

    { 1100281184;3;Field  ;
                SourceExpr="Current Interv. Limit Max." }

    { 1100281197;3;Field  ;
                SourceExpr="Theorical Interv. Limit Max." }

    { 1100281186;3;Field  ;
                SourceExpr="Current Service Interv. Nb" }

    { 1100281171;3;Field  ;
                Name=Occupation Rate;
                CaptionML=[ENU=Occupation Rate;
                           FRA=Taux d'occupation];
                SourceExpr=OccupationRate;
                Editable=false }

    { 1100281037;2;Field  ;
                SourceExpr="Creation Date";
                Importance=Additional }

    { 1100281035;2;Field  ;
                SourceExpr="Creation User ID";
                Importance=Additional }

    { 1100281033;2;Field  ;
                SourceExpr="Last Modification Date";
                Importance=Additional }

    { 1100281031;2;Field  ;
                SourceExpr="Last Modification User ID";
                Importance=Additional }

    { 1000000013;1;Group  ;
                Name=NetworkVisit;
                CaptionML=[ENU=Network Visit;
                           FRA=Informations visites];
                GroupType=Group }

    { 1000000012;2;Field  ;
                SourceExpr="Recruitment Date" }

    { 1000000011;2;Field  ;
                SourceExpr="Recruitment Origin" }

    { 1100281085;2;Field  ;
                SourceExpr="Planified Visit Date";
                Editable=false }

    { 1100281086;2;Field  ;
                SourceExpr="Next Visit interlocutor" }

    { 1100281115;2;Field  ;
                SourceExpr="Visit Last Date" }

    { 1000000009;2;Field  ;
                SourceExpr="Last Visit Reason Code" }

    { 1100281131;2;Field  ;
                SourceExpr="Last Visit interlocutor" }

    { 1000000010;2;Field  ;
                SourceExpr="Facilitator Visit Last Date" }

    { 1000000008;2;Field  ;
                SourceExpr="Planified Facilit. Visit Date" }

    { 1000000007;2;Field  ;
                SourceExpr="Visit Category Code" }

    { 1000000006;2;Field  ;
                SourceExpr="Period Between Two Visits";
                Visible=FALSE;
                Editable=FALSE }

    { 1000000005;2;Field  ;
                Name=TheoricalVisitNb;
                CaptionML=[ENU=Theorical Visit par Year;
                           FRA=Nb visite th‚orique par an];
                SourceExpr=GetTheoricalVisitNb_;
                Importance=Additional;
                Visible=FALSE }

    { 1000000004;2;Field  ;
                SourceExpr="Manual Visit Nb per Year";
                Importance=Additional;
                Visible=FALSE }

    { 1100281017;1;Part   ;
                Name=VisitsList;
                CaptionML=[ENU=Pending Visit;
                           FRA=Visites r‚seau];
                SubFormView=SORTING(Provider No.)
                            WHERE(Closed=CONST(No));
                SubFormLink=Provider No.=FIELD(No.);
                PagePartID=Page50328;
                Editable=FALSE;
                PartType=Page }

    { 1902768601;1;Group  ;
                Name=Communication;
                CaptionML=[ENU=Communication;
                           FRA=Communication];
                Editable=IsEditable }

    { 1100281162;2;Field  ;
                SourceExpr="Occupancy Building";
                Editable=FALSE }

    { 1100281114;2;Field  ;
                SourceExpr="Phone No.";
                OnAssistEdit=BEGIN
                               //**eb
                               PhoneNoAssistEdit("Phone No.");
                               //**
                             END;
                              }

    { 1100281084;2;Field  ;
                SourceExpr="Business Phone No.";
                Visible=false;
                OnAssistEdit=BEGIN
                               //**eb
                               PhoneNoAssistEdit("Business Phone No.");
                               //**
                             END;
                              }

    { 1100281138;2;Field  ;
                SourceExpr="Constraint Phone No.";
                OnAssistEdit=BEGIN
                               //**eb
                               PhoneNoAssistEdit("Constraint Phone No.");
                               //**
                             END;
                              }

    { 1100281120;2;Field  ;
                SourceExpr="Send to Mission Without Call";
                Visible=false }

    { 1100281107;2;Field  ;
                SourceExpr="Fax No.";
                OnAssistEdit=VAR
                               lSendMail@1100281000 : Codeunit 50128;
                             BEGIN
                               lSendMail.SendFaxFromContNo("No.", "Fax No.");
                             END;
                              }

    { 1100281095;2;Field  ;
                ExtendedDatatype=None;
                SourceExpr="E-Mail";
                OnAssistEdit=VAR
                               lSendMail@1100281000 : Codeunit 50128;
                             BEGIN
                               lSendMail.SendMailFromContNo("No.", "E-Mail");
                             END;
                              }

    { 1100281194;2;Field  ;
                SourceExpr="Correspondence Type" }

    { 1100281093;2;Field  ;
                SourceExpr="Home Page" }

    { 1100281105;2;Group  ;
                Name=AdminContact;
                CaptionML=[ENU=Admin. Contact;
                           FRA=Contact administratif];
                GroupType=Group }

    { 1100281207;3;Field  ;
                CaptionML=[ENU=No.;
                           FRA=Nø];
                SourceExpr="Admin. Contact No.";
                Importance=Additional;
                OnValidate=BEGIN
                             CALCFIELDS("Admin. Contact Name","Admin. Contact Phone No.","Admin. Contact Mb. Phone No.","Admin. Contact Mb. Phone No. 2",
                                        "Admin. Contact Fax No.","Admin. Contact E-mail","Admin. Contact Corr. Type","Admin. Contact Notify Customer");
                           END;
                            }

    { 1100281097;3;Field  ;
                CaptionML=[ENU=Name;
                           FRA=Nom];
                SourceExpr="Admin. Contact Name";
                Importance=Promoted }

    { 1100281118;3;Field  ;
                CaptionML=[ENU=Phone No.;
                           FRA=Nø t‚l‚phone];
                SourceExpr="Admin. Contact Phone No.";
                Importance=Promoted;
                OnAssistEdit=BEGIN
                               //**eb
                               PhoneNoAssistEdit("Admin. Contact Phone No.");
                               //**
                             END;
                              }

    { 1100281124;3;Field  ;
                CaptionML=[ENU=Mobile Phone No.;
                           FRA=Nø t‚l‚phone mobile];
                SourceExpr="Admin. Contact Mb. Phone No.";
                OnAssistEdit=BEGIN
                               //**eb
                               PhoneNoAssistEdit("Admin. Contact Mb. Phone No.");
                               //**
                             END;
                              }

    { 1100281125;3;Field  ;
                CaptionML=[ENU=Mobile Phone No. 2;
                           FRA=Nø t‚l‚phone mobile 2];
                SourceExpr="Admin. Contact Mb. Phone No. 2";
                OnAssistEdit=BEGIN
                               //**eb
                               PhoneNoAssistEdit("Admin. Contact Mb. Phone No. 2");
                               //**
                             END;
                              }

    { 1100281126;3;Field  ;
                CaptionML=[ENU=Fax No.;
                           FRA=Nø fax];
                SourceExpr="Admin. Contact Fax No.";
                OnAssistEdit=VAR
                               lSendMail@1100281000 : Codeunit 50128;
                             BEGIN
                               lSendMail.SendMailFromContNo("Admin. Contact No.", "Admin. Contact Fax No.");
                             END;
                              }

    { 1100281127;3;Field  ;
                ExtendedDatatype=None;
                CaptionML=[ENU=E-mail;
                           FRA=E-mail];
                SourceExpr="Admin. Contact E-mail";
                OnAssistEdit=VAR
                               lSendMail@1100281000 : Codeunit 50128;
                             BEGIN
                               lSendMail.SendMailFromContNo("Admin. Contact No.", "Admin. Contact E-mail");
                             END;
                              }

    { 1100281144;3;Field  ;
                CaptionML=[ENU=Corresp. Type;
                           FRA=Moyen communication privil‚gi‚];
                SourceExpr="Admin. Contact Corresp. Type" }

    { 1100281130;3;Field  ;
                CaptionML=[ENU=Ideal Channel;
                           FRA=Canal privil‚gi‚];
                SourceExpr="Admin. Contact Notify Customer" }

    { 1100281174;1;Group  ;
                Name=Extranet;
                GroupType=Group }

    { 1100281176;2;Field  ;
                SourceExpr=Extranet;
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;
                            }

    { 1100281180;2;Field  ;
                SourceExpr="Extranet Create Date" }

    { 1100281173;2;Field  ;
                SourceExpr="Extranet Link";
                Visible=FALSE;
                OnValidate=BEGIN
                             CALCFIELDS("Extranet Link Name");
                           END;
                            }

    { 1100281185;2;Field  ;
                SourceExpr="Extranet Link Name";
                Visible=FALSE;
                Enabled=FALSE;
                Editable=FALSE }

    { 1100281117;2;Field  ;
                SourceExpr="Extranet Login";
                Visible=FALSE;
                Enabled=FALSE;
                Editable=FALSE }

    { 1100281116;2;Field  ;
                SourceExpr="Extranet Password";
                Visible=FALSE;
                Enabled=FALSE;
                Editable=FALSE }

    { 1000000001;2;Field  ;
                DrillDown=Yes;
                CaptionML=[ENU="";
                           FRA=""];
                SourceExpr=Text017;
                Editable=FALSE;
                OnDrillDown=VAR
                              lLink@1000000000 : Text[1024];
                            BEGIN
                              //IMH46.ST
                              TESTFIELD(Extranet, TRUE);
                              ProviderSetup.GET;
                              ProviderSetup.TESTFIELD("Extranet Provider Open URL");
                              IF STRPOS(ProviderSetup."Extranet Provider Open URL", '%1') <> 0 THEN
                                lLink := STRSUBSTNO(ProviderSetup."Extranet Provider Open URL", "No.")
                              ELSE
                                lLink := ProviderSetup."Extranet Provider Open URL";
                              HYPERLINK(lLink);
                              //>>IMH46.ST
                            END;
                             }

    { 1000000000;2;Field  ;
                DrillDown=Yes;
                CaptionML=[ENU="";
                           FRA=""];
                SourceExpr=Text016;
                Editable=FALSE;
                OnDrillDown=VAR
                              lLink@1000000000 : Text[1024];
                            BEGIN
                              //IMH46.ST
                              TESTFIELD(Extranet, TRUE);
                              ProviderSetup.GET;
                              ProviderSetup.TESTFIELD("Extranet Provider Setup URL");
                              IF STRPOS(ProviderSetup."Extranet Provider Setup URL", '%1') <> 0 THEN
                                lLink := STRSUBSTNO(ProviderSetup."Extranet Provider Setup URL", "No.")
                              ELSE
                                lLink := ProviderSetup."Extranet Provider Setup URL";
                              HYPERLINK(lLink);
                              //>>IMH46.ST
                            END;
                             }

    { 1902955201;1;Group  ;
                Name=LegalsInfo;
                CaptionML=[ENU=Legals Informations;
                           FRA=Informations l‚gales];
                Editable=IsEditable }

    { 1100281026;2;Field  ;
                SourceExpr="Company Creation Date" }

    { 1100281032;2;Field  ;
                SourceExpr="Registration No.";
                Importance=Promoted }

    { 1100281108;2;Field  ;
                SourceExpr="SIREN No.";
                OnValidate=BEGIN
                             UpdateSocieteComURL();
                           END;
                            }

    { 1100281034;2;Field  ;
                SourceExpr="VAT Registration No.";
                Importance=Promoted }

    { 1100281111;2;Field  ;
                Name=LinkTowww.societe.com;
                ExtendedDatatype=URL;
                CaptionML=[ENU=Link to www.societe.com;
                           FRA=Lien vers www.societe.com];
                SourceExpr=SocieteComURL;
                Editable=FALSE }

    { 1100281040;2;Field  ;
                SourceExpr=Turnover }

    { 1100281046;2;Field  ;
                SourceExpr="Turnover Year" }

    { 1100281048;2;Field  ;
                SourceExpr="Turnover Check";
                OnValidate=BEGIN
                             SetTurnOverDateEditable();
                           END;
                            }

    { 1100281139;2;Field  ;
                SourceExpr="Turnover Check Date";
                Editable=IsTurnOverCheckDateEditable }

    { 1100281062;2;Field  ;
                SourceExpr="Turnover Amount Max." }

    { 1100281058;2;Field  ;
                SourceExpr=Income }

    { 1100281060;2;Field  ;
                SourceExpr="Income Date" }

    { 1100281179;2;Field  ;
                SourceExpr="Percentage Commission" }

    { 1100281092;2;Group  ;
                Name=Manpower;
                CaptionML=[ENU=Manpower;
                           FRA=Effectif];
                GroupType=Group }

    { 1100281101;3;Field  ;
                CaptionML=FRA=Effectif global;
                SourceExpr=Manpower;
                OnValidate=BEGIN
                             SetManpowerCheckDateEditable(); // IMH34.ISAT.MA
                           END;
                            }

    { 1100281168;3;Field  ;
                CaptionML=[ENU=Check;
                           FRA=Valid‚];
                SourceExpr="Manpower Check";
                OnValidate=BEGIN
                             SetManpowerCheckDateEditable();
                           END;
                            }

    { 1100281054;3;Field  ;
                CaptionML=[ENU=Check Date;
                           FRA=Date validation];
                SourceExpr="Manpower Check Date";
                Editable=IsManpowerCheckDateEditable }

    { 1100281056;3;Field  ;
                CaptionML=[ENU=Administrative Number;
                           FRA=Effectif admin.];
                SourceExpr="Manpower Admin." }

    { 1100281143;1;Group  ;
                Name=Calendar;
                CaptionML=[ENU=Calendar;
                           FRA=Calendrier];
                GroupType=Group }

    { 1100281141;2;Field  ;
                SourceExpr="Standard Calendar";
                Visible=FALSE;
                OnLookup=BEGIN
                           ProviderCalendarMgt.GetStandardCalendar("No.");
                         END;
                          }

    { 1100281152;2;Field  ;
                Name=StandardCalendar;
                CaptionML=[ENU=Standard Calendar;
                           FRA=Calendrier standard];
                OptionCaptionML=[ENU=Standard,Specific;
                                 FRA=Standard,Sp‚cifique];
                SourceExpr=StandardCalendarOption;
                Editable=FALSE;
                OnLookup=BEGIN
                           //<<IMH17.isat.PC
                           ProviderCalendarMgt.GetStandardCalendar("No.");
                           CalcCalendarFields;  //IMH26
                           //>>IMH17.isat.PC
                         END;
                          }

    { 1100281140;2;Field  ;
                SourceExpr="Standard Business Hours";
                Visible=FALSE }

    { 1100281135;2;Field  ;
                Name=StandardBusinessHours;
                CaptionML=[ENU=Standard Business Hours;
                           FRA=Heures d'ouverture standard];
                OptionCaptionML=[ENU=Default,Specific;
                                 FRA=D‚faut,Sp‚cifique];
                SourceExpr=StandardBusinesOption;
                Editable=FALSE;
                OnLookup=BEGIN
                           ProviderCalendarMgt.GetBusinessHours("No.",FALSE);
                           CalcCalendarFields;  //IMH26
                         END;
                          }

    { 1100281052;2;Field  ;
                SourceExpr="Standard Specializations" }

    { 1100281182;2;Field  ;
                SourceExpr="Copy Calendar";
                OnValidate=BEGIN
                             CurrPage.UPDATE;
                           END;
                            }

    { 1100281106;2;Field  ;
                SourceExpr="Emergency Calendar";
                Visible=FALSE;
                LookupFormID=Provider Calendar Card;
                OnLookup=BEGIN
                           ProviderCalendarMgt.GetEmergencyCalendar("No.");
                           CalcCalendarFields;  //IMH26
                         END;
                          }

    { 1100281158;2;Field  ;
                Name=EmergencyCalendar;
                CaptionML=[ENU=Emergency Calendar;
                           FRA=Calendrier d'urgence];
                OptionCaptionML=[ENU=Standard,Specific;
                                 FRA=Standard,Sp‚cifique];
                SourceExpr=EmergencyCalendarOption;
                Editable=FALSE;
                OnLookup=BEGIN
                           //<<IMH31.ISAT.MA
                           ProviderCalendarMgt.GetEmergencyCalendar("No.");
                           CalcCalendarFields;
                           //>>IMH31.ISAT.MA
                         END;
                          }

    { 1100281010;2;Field  ;
                SourceExpr="Emergency Business Hours";
                Visible=FALSE }

    { 1100281146;2;Field  ;
                Name=EmergencyBusinessHours;
                CaptionML=[ENU=Emergency Business Hours;
                           FRA=Heures d'ouverture urgence];
                OptionCaptionML=[ENU=Default,Specific;
                                 FRA=D‚faut,Sp‚cifique];
                SourceExpr=EmergencyBusinesOption;
                Editable=FALSE;
                OnLookup=BEGIN
                           ProviderCalendarMgt.GetBusinessHours("No.",TRUE);
                           CalcCalendarFields;  //IMH26
                         END;
                          }

    { 1100281011;2;Field  ;
                Name=EmergencySpecilizations;
                CaptionML=[ENU=Emergency Specilizations;
                           FRA=Sp‚cialit‚s urgentes];
                SourceExpr="Emergency Specialization" }

    { 1100281059;1;Group  ;
                Name=Corporate Exclusion;
                CaptionML=[ENU=Exclusion;
                           FRA=Exclusion];
                Editable=IsEditable;
                GroupType=Group }

    { 1100281187;2;Group  ;
                Editable=IsExcludeField;
                GroupType=Group }

    { 1100281057;3;Field  ;
                SourceExpr=Exclusion;
                Importance=Standard;
                Style=None;
                StyleExpr=TRUE;
                OnValidate=BEGIN
                             SetExclusionField;
                           END;
                            }

    { 1100281055;3;Field  ;
                CaptionML=[ENU=Perm. Reason Code Exclusion;
                           FRA=Code Motif exclusion d‚finitive];
                SourceExpr="Exclusion Reason Code";
                Importance=Additional;
                Editable=FALSE }

    { 1100281159;3;Field  ;
                CaptionML=[ENU=Perm. Exclusion Reason Description;
                           FRA=Motif exclusion d‚finitive];
                SourceExpr="Exclusion Reason Description" }

    { 1100281053;3;Field  ;
                SourceExpr="Exclusion Date" }

    { 1100281188;2;Group  ;
                Editable=IsExcludetempField;
                GroupType=Group }

    { 1100281051;3;Field  ;
                SourceExpr="Temp. Exclusion" }

    { 1100281049;3;Field  ;
                CaptionML=[ENU=Temp. Exclusion Reason Code;
                           FRA=Code Motif exclusion temporaire];
                SourceExpr="Temp. Exclusion Reason Code";
                Importance=Additional }

    { 1100281160;3;Field  ;
                CaptionML=[ENU=Temp. Exclusion Reason Desc.;
                           FRA=Motif exclusion temporaire];
                SourceExpr="Temp. Exclusion Reason Desc." }

    { 1100281047;3;Field  ;
                SourceExpr="Temp. Exclusion Start Date" }

    { 1100281030;3;Field  ;
                SourceExpr="Temp. Exclusion End Date" }

    { 1100281189;2;Group  ;
                Editable=IsBlackListField;
                GroupType=Group }

    { 1100281023;3;Field  ;
                SourceExpr="Black List";
                OnValidate=BEGIN
                             SetExclusionField;
                           END;
                            }

    { 1100281007;3;Field  ;
                CaptionML=[ENU=Black List Reason Code;
                           FRA=Code Motif Black List];
                SourceExpr="Black List Reason Code";
                Importance=Additional;
                Editable=FALSE }

    { 1100281161;3;Field  ;
                CaptionML=[ENU=Black List Reason Desc.;
                           FRA=Motif Black List];
                SourceExpr="Black List Reason Desc." }

    { 1100281003;3;Field  ;
                SourceExpr="Black List Date";
                Editable=FALSE }

    { 1100281200;1;Group  ;
                Name=Quality;
                CaptionML=[ENU=Quality control;
                           FRA=Contr“le qualit‚];
                GroupType=Group }

    { 1100281199;2;Group  ;
                Visible=QualityControllerVisible;
                GroupType=Group }

    { 1100281165;3;Field  ;
                SourceExpr="Max Number of Controls" }

    { 1100281164;3;Field  ;
                SourceExpr="Create Controls Manually" }

    { 1100281142;2;Field  ;
                SourceExpr="Targeted Control" }

    { 1100281156;2;Field  ;
                SourceExpr="Targeted Control Start Date" }

    { 1100281027;2;Field  ;
                SourceExpr="Targeted Controls Min." }

    { 1100281074;;Container;
                Name=FactBoxArea;
                ContainerType=FactBoxArea }

    { 1100281072;1;Part   ;
                Name=RecordLinks;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1100281071;1;Part   ;
                Name=Notes;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

    { 1100281099;1;Part   ;
                Name=ProviderInfoPaneFactBox;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page50020 }

  }
  CODE
  {
    VAR
      ProviderSetup@1100281021 : Record 50011;
      CopyProvider@1100281004 : Report 50006;
      ProvSpec@1000000001 : Record 50006;
      TAPIManagement@1100281000 : Codeunit 5053;
      ProviderCalendarMgt@1100281001 : Codeunit 50007;
      Text001@1100281002 : TextConst 'ENU=The provider %1 does not exist.;FRA=Le prestataire client %1 n''existe pas.';
      ProviderContactUpdate@1100281003 : Codeunit 50010;
      AddressStandardization@1100281005 : Codeunit 50098;
      ProviderMgt@1100281006 : Codeunit 50018;
      ExclusionStatus@1100281008 : Text[30] INDATASET;
      Text002@1100281010 : TextConst 'ENU=Black List;FRA=Black List';
      Text003@1100281009 : TextConst 'ENU=Exclusion;FRA=Exclusion';
      Text004@1100281011 : TextConst 'ENU=Temp. Exclusion;FRA=Exclusion temp.';
      Text005@1100281014 : TextConst 'ENU=Disable;FRA=Inactif';
      IsCardEditableText@1100281013 : Text[30];
      Text006@1100281015 : TextConst 'ENU=Not Editable;FRA=Non ‚ditable';
      KeyBoardAddress@1100281019 : Text[1024];
      SocieteComURL@1100281018 : Text[250];
      StandardBusinesOption@1100281022 : 'Default,Specific';
      EmergencyBusinesOption@1100281023 : 'Default,Specific';
      StandardCalendarOption@1100281025 : 'Standard,Specific';
      EmergencyCalendarOption@1100281029 : 'Standard,Specific';
      UserNextStepAvailable@1100281024 : Boolean INDATASET;
      IsPriorityDateEditable@1100281020 : Boolean INDATASET;
      IsEditable@1100281016 : Boolean INDATASET;
      AddressEditable@1100281017 : Boolean INDATASET;
      ExclusionStatusVisible@1100281012 : Boolean INDATASET;
      EditableInfoVisible@1100281007 : Boolean INDATASET;
      IsTOverCheckDateEditable@1100281027 : Boolean;
      IsTurnOverCheckDateEditable@1100281026 : Boolean INDATASET;
      IsManpowerCheckDateEditable@1100281028 : Boolean INDATASET;
      Text010@1100281030 : TextConst 'ENU=Main Specialization is empty. Do you want to continue ?;FRA=La sp‚cialit‚ principale n''est pas renseign‚. Souhaitez-vous continuer ?';
      IsOnInsert@1100281031 : Boolean;
      Text011@1100281032 : TextConst 'ENU=%1 is empty. Do you want to continue ?;FRA=%1 n''est pas renseign‚. Souhaitez-vous continuer ?';
      OccupationRate@1100281033 : Decimal;
      Text012@1100281034 : TextConst 'ENU=Do you want to exclude the provider?;FRA=Voulez-vous exclure d‚finitivement le prestataire?';
      Text013@1100281035 : TextConst 'ENU=Do you want to delete main speciality provider?;FRA=Souhaitez-vous supprimer la sp‚cialit‚ principale du prestataire?';
      Text014@1100281036 : TextConst 'ENU=You can''t delete main speciality provider.;FRA=Vous ne pouvez pas supprimer la sp‚cialit‚ principale du prestataire.';
      IsBlackListField@1100281037 : Boolean INDATASET;
      IsExcludeField@1100281038 : Boolean INDATASET;
      IsExcludetempField@1100281039 : Boolean INDATASET;
      TestCaption@1100281040 : Text[30] INDATASET;
      Text015@1100281041 : TextConst 'FRA=Attention la fiche prestataire n''est pas active.';
      PDFManagement@1100281042 : Codeunit 50127;
      Text016@1000000000 : TextConst 'ENU=Configure extranet access;FRA=Modifier l''accŠs extranet';
      Text017@1100281043 : TextConst 'ENU=Open extranet access;FRA=Ouvrir l''accŠs extranet';
      QualityControllerVisible@1000000002 : Boolean INDATASET;

    PROCEDURE SetImportantValue@1100281002();
    BEGIN
      IF "Black List" THEN BEGIN
        ExclusionStatus := Text002;
      END;
      IF Exclusion THEN BEGIN
        ExclusionStatus :=Text003;
      END;
      IF "Temp. Exclusion" THEN BEGIN
        ExclusionStatus :=Text004;
      END;

      ExclusionStatusVisible := "Temp. Exclusion" OR Exclusion OR "Black List";

      IF EditableInfoVisible THEN BEGIN
        IsCardEditableText := Text006
      END ELSE BEGIN
        IsCardEditableText := '';
      END;
    END;

    PROCEDURE SetFormEditable@1100281000();
    VAR
      lProviderMgt@1100281001 : Codeunit 50018;
      lIsEditable@1100281000 : Boolean;
    BEGIN
      //IMH03 isat.zw
      AddressEditable := TRUE;
      //  NOT AddressStandardization.CountryToAssist(DATABASE::"Contact Alt. Address", "Country/Region Code"); //IMH02 isat.ZW
      // IMH04.ISAT.MA
      IsEditable := ProviderMgt.IsEditable("No.");
    END;

    LOCAL PROCEDURE CategoryOnAfterValidate@19053914();
    BEGIN
      CurrPage.UPDATE;  // IMH02
    END;

    PROCEDURE GetCaption@1100281001() : Text[70];
    BEGIN
      EXIT("No." + ' ' + Name);
    END;

    PROCEDURE SetPriorityDateEditable@1100281003();
    BEGIN
      IsPriorityDateEditable := (Priority <> Priority::"(1) Normal");
    END;

    PROCEDURE UpdateSocieteComURL@1100281004();
    BEGIN
      //http://www.societe.com/cgi-bin/mainsrch?champ=
      SocieteComURL := ProviderSetup."Company URL"+ "SIREN No.";
    END;

    PROCEDURE SetTurnOverDateEditable@1100281005();
    BEGIN
      IsTurnOverCheckDateEditable := NOT "Turnover Check";
    END;

    PROCEDURE SetManpowerCheckDateEditable@1100281006();
    BEGIN
      IsManpowerCheckDateEditable := NOT "Manpower Check";
    END;

    PROCEDURE CalcCalendarFields@1100281007();
    BEGIN
      CALCFIELDS("Standard Business Hours","Emergency Business Hours", "Emergency Calendar");

      IF "Standard Business Hours" THEN BEGIN
        StandardBusinesOption := StandardBusinesOption::Specific;
      END ELSE BEGIN
        StandardBusinesOption := StandardBusinesOption::Default;
      END;

      IF "Emergency Business Hours" THEN BEGIN
        EmergencyBusinesOption := EmergencyBusinesOption::Specific;
      END ELSE BEGIN
        EmergencyBusinesOption := EmergencyBusinesOption::Default;
      END;

      CALCFIELDS("Standard Calendar");
      //<<IMH17.isat.PC
      IF "Standard Calendar" THEN BEGIN
        StandardCalendarOption := StandardCalendarOption::Specific;
      END ELSE BEGIN
        StandardCalendarOption := StandardCalendarOption::Standard;
      END;
      //>>IMH17.isat.PC

      // <<IMH31.ISAT.MA
      IF "Emergency Calendar" THEN BEGIN
        EmergencyCalendarOption := EmergencyCalendarOption::Specific;
      END ELSE BEGIN
        EmergencyCalendarOption := EmergencyCalendarOption::Standard;
      END;

      // >>IMH31.ISAT.MA
    END;

    PROCEDURE SetExclusionField@1100281008();
    BEGIN
      IsBlackListField := TRUE;
      IsExcludeField := TRUE;
      IsExcludetempField := TRUE;

      IF "Black List" THEN
      BEGIN
        IsExcludeField := FALSE;
        IsExcludetempField := FALSE;
      END;

      IF Exclusion THEN
      BEGIN
        IsBlackListField := FALSE;
        IsExcludetempField := FALSE;
      END;
    END;

    PROCEDURE CheckSalesperson@1000000000();
    BEGIN
      //IMH45.ST
      IF "Salesp. Net. Facilitator Code" = '' THEN
        VALIDATE("Network Facilitator");
      IF "Salesp. Reg. Coordinator Code" = '' THEN
        VALIDATE("Regional Coordinator");
      IF "Salesp. Network Assistant Code" = '' THEN
        VALIDATE("Network Assistant");
    END;

    BEGIN
    {
      /** @r IMH109 @d 10/04/14 @a ISAT.PC @v IMH6.01.P011 @s New Provider Search
          @c Add new field 55000, Follow Up
          @c Add new field 55001, Follow Up Start Date
          @c Add new field 55002, Follow Up End Date
          @c Add new field 55010, Follow Up Date Creation
          @c Add new field 55011, Follow Up User Creation
          @c Add new field 55015, Follow Up Origin */
      /** @r IMH58 @d 19/12/13 @a ISAT.ZW @v IMH6.01.4107 @s Gestion suppression PJ @h 4107
          @c Affichier uniquement les interaction DJ non supprim‚ */
      /** @r IHM57 @d 25/11/13 @a ISAT.ZW @v IMH6.01.4867 @s Support @h 4867 @c remet le filtre sur la liste des visites Closed = No */
      /** @r IMH56 @d 14/10/13 @a ISAT.ST @v IMH6.01.4760 @s Reorganisation region IMH @h 4760 @c Renommage CR / AR / R‚gion */
      /** @r IMH55 @d 17/07/13 @a ISAT.ACO @v IMH6.01.3670 @s JUILLET @h 3670 @c Modifier le filtre des visites r‚seaux */
      /** @r IHM54 @d 27/08/12 @a ISAT.ZW @v IMH6.01.3677 @s JUILLET @h 3677 @c Afficher le bontou Doc Joint sur le bandeau prestataire */
      /** @r IHM53 @d 27/08/12 @a ISAT.ZW @v IMH6.01.226 @s version 1.4 @h 2968 @c Ajout ParamŠtres Limite Interv type produit */
      /** @r IHM52 @d 06/06/12 @a ISAT.PC @v IMH6.01.3568 @h 3568 @s D‚placement de l'onglet Contr“le qualit‚ */
      /** @r IHM51 @d 02/04/12 @a ISAT.PC @v IMH6.01.2872 @h 2872 @s Filtre activit‚ @h 3328
          @c Suppression champ en double */
      /** @r IHM50 @d 02/04/12 @a ISAT.PC @v IMH6.01.020 @h 2872 @s Filtre activit‚
          @c Ajout gestion du filtre par d‚faut des corbeilles DPR */
      /** @r IMH49 @d 22/03/12 @a ISAT.ZW @v IMH6.01.110 @s Gestion des visites @c Gestion des onglets visite */
      /** @r IMH48 @d 17/02/12 @a ISAT.ST @v IMH6.01.108 @s Interactions @c Envoi mail / fax */
      /** @r IMH47 @d 31/01/12 @a ISAT.ZW @v IMH6.01.110 @s Extranet prestataire @c FOnction Activit‚ en cours */
      /** @r IMH46 @d 17/12/11 @a ISAT.ST @v IMH6.01.110 @s Extranet prestataire @c Ajout des accŠs URL */
      /** @r IMH45 @d 12/12/11 @a ISAT.ST @v IMH6.01.020 @s Gestion prestataire
          @c Ajout CheckSalesperson */
      /** @r IMH44 @d 09/11/11 @a ISAT.EBA @v IMH6.01.020 @s Gestion prestataire
          @c Modification filtre action "Ecritures journal interaction" */
      /** @r IMH43 @d 28/09/11 @a ISAT.PC @v IMH6.01.002 @s Gestion des contacts @h 635
          @c champ Occupancy Building mis … non editable */
      /** @r IMH42 @d 13/07/11 @a ISAT.ZW @v IMH6.01.002 @s Gestion des contacts
          @c Masquer le champ 54040 Send to Mission Without Call de la fiche prestataire */
      /** @r IHM41 @d 07/07/11 @a ISAT.MA @v IMH6.01.110 @s Finalisation prestataire
          @h 479 @c test sur code motif exclusion */
      /** @r IHM40 @d 30/06/11 @a ISAT.ZW @v IMH6.01.177 @s test specialit‚ principale en fermeture */
      /** @r IMH39 @d 22/06/11 @a ISAT.PC @v IMH6.01.020 @s Gestion prestataire
          @c suppression des libelle de la propriete PromotedActionCategoriesML */
      /** @r IHM38 @d 10/06/11 @a ISAT.ZW @v IMH6.01.177 @s Ajouter Historiques des priorit‚s */
      /** @r IHM37 @d 10/06/11 @a ISAT.ZW @v IMH6.01.177 @s Ajouter champ ® date cr‚ation compte extranet ¯ */
      /** @r IHM36 @d 12/05/10 @a ISAT.ZW @v IMH6.01.004 @s GED @c nom recherche non visible */
      /** @r IHM35 @d 09/05/10 @a ISAT.ZW @v IMH6.01.004 @s GED @c Ajout taux d'occupation */
      /** @r IMH34 @d 09/05/11 @a ISAT.MA @v IMH6.01.110 @s  Finalisation Prestataire
          @c Utilisation de la fonction SetManpowerCheckDateEditable() … la validation du
          @c champ effectif global */
      /** @r IMH33 @d 06/05/11 @a ISAT.MA @v IMH6.01.110 @s  Finalisation Prestataire
          @c Utilisation de la fonction GetDescription() */
      /** @r IMH32 @d 07/04/11 @a ISAT.EBA @v IMH6.01.110 @s  Finalisation Prestataire
          @c Champ "Immeuble habitation" non editable */
      /** @r IMH31 @d 24/03/11 @a ISAT.PC @v IMH6.01.020 @s Gestion prestataire
          @c ajout champ 54204, Temp. Exclusion Reason Desc.
          @c ajout champ 54213, Exclusion Reason Description
          @c ajout champ 54503, Black List Reason Desc. */
      /** @r IHM30 @d 15/03/10 @a ISAT.ZW @v IMH6.01.004 @s GED @c Ajout champ <Code cat‚gorie visite> */
      /** @r IHM29 @d 04/03/10 @a ISAT.ZW @v IMH6.01.004 @s GED @c renomer interaction report‚ en Brouillons */
      /** @r IMH28 @d 03/03/11 @a ISAT.ZW @v IMH6.01.020 @s Gestion prestataire
          @c Ajout champ Next Visit interlocutor et Last Visit interlocutor */
      /** @r IMH27 @d 23/02/11 @a ISAT.NFO @v IMH6.01.020 @s Gestion prestataire
          @c Suppression du champ condition relance documents */
      /** @r IMH26 @d 23/02/11 @a ISAT.ZW @v IMH6.01.020 @s Gestion prestataire
          @c Rafraichir champs calendrier aprŠs modification */
      /** @r IMH25 @d 22/02/11 @a ISAT.PC @v IMH6.01.020 @s Gestion prestataire
          @c Ajout des fonctions : CreateTrayLine */
      /** @r IMH24 @d 22/02/11 @a ISAT.NF @v IMH6.01.020 @s Gestion prestataire
          @c Ajout des fonctions
          @c SetTurnOverDateEditable()
          @c SetManpowerCheckDateEditable() */
      /** @r IMH23 @d 21/02/11 @a ISAT.PC @v IMH6.01.020 @s Gestion prestataire
          @c Ajout du champ 54250, Network Facilitator Name
          @c Ajout du champ 54251, Regional Coordinator Name
          @c Ajout du champ 54252, Network Assistant Name */
      /** @r IMH18 @d 14/02/11 @a ISAT.NFO @v IMH6.01.020 @s Gestion prestataire
          @c Ajout de l'affichage du commentaire */
      /** @r IMH17 @d 14/02/11 @a ISAT.ZW @v IMH6.01.020 @s Gestion prestataire
          @c Ajout de l'affichage de standard au niveau calendrier */
      /** @r IMH16 @d 02/02/11 @a ISAT.ZW @v IMH6.01.105 @s Gestion scoring
          @c Ajout fonction imprimer scoring prestataire */
      /** @r IMH15 @d 01/02/11 @a ISAT.LLT @v IMH6.01.020 @s Gestion prestataire
          @c Ajout du champ 54406 Period Between Two Visits */
      /** @r IMH14 @d 26/01/11 @a ISAT.LLT @v IMH6.01.020 @s Gestion prestataire @c Design des actions */
      /** @r IMH13 @d 24/01/11 @a ISAT.ST @v IMH6.01.102 @s Gestion des statuts
          @c Etape suivante conditionn‚e */
      /** @r IMH12 @d 04/01/11 @a ISAT.NFO @v IMH6.01.020 @s Gestion prestataire
          @c Ne pas faire de reset de l'adresse rapide */
      /** @r IMH11 @d 16/12/10 @a ISAT.ZW @v IMH6.01.020 @s Gestion prestataire
          @c Ajout Fonctions Interaction + Fonction Statut Suivant*/
      /** @r IHM10 @d 16/12/10 @a ISAT.ZW @v IMH6.01.020 @s Fiche prestataire @c Ajout fonctions Interaction */
      /** @r IHM09 @d 06/12/10 @a ISAT.LLT @v IMH6.01.020 @s Fiche prestataire @c Gestion url vers societe.com */
      /** @r IMH08 @d 06/12/10 @a ISAT.NFO @v IMH6.01.020 @s Gestion prestataire
          @c Ajout du champ "Exclusion" */
      /** @r IMH07 @d 03/12/10 @a ISAT.MA @v IMH6.01.020 @s Gestion prestataire
          @c Ajout des champs "Send to Mission Without Call","Recruitment Origin" */
      /** @r IMH06 @d 16/11/10 @a ISAT.LLT @v IMH6.01.002 @s Gestion des contacts @c Modification des captions */
      /** @r IMH05 @d 10/11/10 @a ISAT.LLT @v IMH6.01.002 @s Gestion des contacts
          @c Ajout saisie rapide d'adresse */
      /** @r IMH04 @d 10/11/10 @a ISAT.MA @v IMH6.01.020 @s Gestion prestataire
          @c  Gestion des modifications */
      /** @r IMH03 @d 21/10/10 @a ISAT.ZW @v IMH6.01.001 @s Normalisation des donn‚es
          @c Adresse non editable si Normalisation adresse pays + AssitEdit Adresse*/
      /** @r IHM02 @d 21/10/10 @a ISAT.cc @v IMH6.01.021 @s Compl‚tude
          @c Ajout du sous-forme Compl‚tude
          @c Ajout du champ 1127 Doc. Reminder Terms
          @c Ajout du champ 5065 Communication Mode (onglet communication) */
      /** @r IHM01 @d 23/09/10 @a ISAT.PC @v IMH6.01.020 @s Fiche prestataire @c Creation */
    }
    END.
  }
}