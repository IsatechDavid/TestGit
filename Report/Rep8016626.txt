OBJECT Report 8016626 Customer Financial Situation
{
  OBJECT-PROPERTIES
  {
    Date=18/09/12;
    Time=15:18:18;
    Modified=Yes;
    Version List=ISA6.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Customer Financial Situation;
               FRA=Situation financiŠre client];
    OnPreReport=BEGIN
                  CltFiltre := Customer.GETFILTERS;
                  CltFiltreDate := Customer.GETFILTER("Date Filter");

                  IF (Num_Etat <> Num_Etat::Clients) THEN
                    Devise_compte := FALSE;

                  Devise_cpte := '';
                END;

  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table18;
        DataItemTableView=SORTING(No.);
        DataItemVarName=Customer;
        PrintOnlyIfDetail=Yes;
        OnPreDataItem=BEGIN
                        CurrReport.NEWPAGEPERRECORD := ImprUnParPage;
                        Num_seq := 0;
                        Temp_ecr.RESET;
                        Datemini := 31129999D;
                        Datemaxi := 0D;
                      END;

        OnAfterGetRecord=BEGIN
                           DateMax := GETRANGEMAX("Date Filter");
                           Datedebut := GETRANGEMIN("Date Filter");
                           Datefin := GETRANGEMAX("Date Filter");
                         END;

        ReqFilterFields=No.,Search Name,Blocked,Date Filter;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18300;
            SectionHeight=1692;
            KeepWithNext=No;
            OnPreSection=BEGIN
                           IF Num_Etat <> Num_Etat::Clients THEN CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 1   ;Label        ;0    ;0    ;7500 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=FRA=Etat financier par client }
            { 2   ;TextBox      ;15000;0    ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 3   ;TextBox      ;0    ;423  ;7500 ;423  ;SourceExpr=STRSUBSTNO('Solde au %1',FORMAT(Customer.GETRANGEMAX("Date Filter"))) }
            { 4   ;Label        ;16950;423  ;750  ;423  ;ParentControl=5 }
            { 5   ;TextBox      ;17700;423  ;450  ;423  ;CaptionML=FRA=Page;
                                                         SourceExpr=CurrReport.PAGENO }
            { 6   ;TextBox      ;0    ;846  ;7500 ;423  ;SourceExpr=COMPANYNAME }
            { 7   ;TextBox      ;15900;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18300;
            SectionHeight=423;
            OnPreSection=BEGIN
                           IF Num_Etat <> Num_Etat::Clients THEN CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18300;
            SectionHeight=846;
            OnPreSection=BEGIN
                           IF Num_Etat <> Num_Etat::Clients THEN CurrReport.SHOWOUTPUT(FALSE)
                           ELSE
                           CurrReport.SHOWOUTPUT(CltFiltre <> '');
                         END;

          }
          CONTROLS
          {
            { 10  ;TextBox      ;0    ;0    ;18150;423  ;SourceExpr=CltFiltre }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18300;
            SectionHeight=846;
            OnPreSection=BEGIN
                           IF Num_Etat <> Num_Etat::Clients THEN CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 29  ;Label        ;3300 ;0    ;1200 ;846  ;ParentControl=28;
                                                         HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=FRA=Date d'‚ch‚ance }
            { 35  ;Label        ;4650 ;0    ;2250 ;846  ;ParentControl=34;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 37  ;Label        ;7050 ;0    ;3000 ;846  ;ParentControl=36;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 45  ;Label        ;13050;0    ;1800 ;846  ;ParentControl=44;
                                                         HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=FRA=" Montant Cr‚dit" }
            { 53  ;Label        ;15000;0    ;1500 ;846  ;ParentControl=52;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 55  ;Label        ;16650;0    ;1500 ;846  ;ParentControl=54;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=FRA=Mise en place }
            { 27  ;Label        ;300  ;0    ;1500 ;846  ;ParentControl=26;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=FRA=Origine }
            { 20  ;Label        ;1950 ;0    ;1200 ;846  ;HorzGlue=Left;
                                                         VertGlue=Top;
                                                         HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=FRA=Date de comptabilisation }
            { 63  ;Label        ;10200;0    ;1050 ;846  ;HorzGlue=Left;
                                                         VertGlue=Top;
                                                         HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=FRA=Devise }
            { 81  ;Label        ;11250;0    ;1800 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=FRA=" Montant   D‚bit" }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18300;
            SectionHeight=423;
            OnPreSection=BEGIN
                           IF Num_Etat <> Num_Etat::Clients THEN CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 79  ;Shape        ;150  ;0    ;18150;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18300;
            SectionHeight=423;
            KeepWithNext=No;
            OnPreSection=BEGIN
                           IF Num_Etat <> Num_Etat::Clients THEN CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 22  ;TextBox      ;0    ;0    ;1500 ;423  ;HorzAlign=Left;
                                                         FontBold=Yes;
                                                         SourceExpr="No." }
            { 23  ;TextBox      ;1650 ;0    ;4500 ;423  ;FontBold=Yes;
                                                         SourceExpr=Name }
            { 24  ;Label        ;6150 ;0    ;750  ;423  ;ParentControl=25 }
            { 25  ;TextBox      ;7050 ;0    ;2550 ;423  ;SourceExpr="Phone No." }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18300;
            SectionHeight=0;
            OnPreSection=BEGIN
                           IF Num_Etat <> Num_Etat::Clients THEN CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table21;
        DataItemTableView=SORTING(Entry No.);
        DataItemVarName=EcrFSClt3;
        OnPreDataItem=BEGIN

                        SETRANGE(Open,TRUE);
                        SETRANGE("Posting Date",0D,DateMax);
                      END;

        OnAfterGetRecord=BEGIN

                           Cptr2 := 0;
                           CALCFIELDS(Amount,"Remaining Amount","Amount (LCY)","Remaining Amt. (LCY)");

                           IF Amount = 0 THEN CurrReport.SKIP;

                           IF Devise_compte THEN BEGIN
                             MntInitial := Amount;
                             Mnt := "Closed by Amount";
                             MntOuvert := "Remaining Amount";
                             Devise_cpte := "Currency Code";
                           END ELSE BEGIN
                             MntInitial := "Amount (LCY)";
                             Mnt := "Closed by Amount (LCY)";
                             MntOuvert := "Remaining Amt. (LCY)";
                             Devise_cpte := '';
                           END;
                            MntOuvertC:=0;
                            MntOuvertD:=0;

                           IF MntOuvert > 0  THEN
                              MntOuvertD := MntOuvert
                           ELSE
                              MntOuvertC := MntOuvert;
                           CodeDevise := '';

                           TamponTotalDevise.UpdateTotal(
                             CodeDevise,
                             MntOuvert,
                             0,
                             Cptr1);

                           IF "Mise en place" THEN
                             TamponTotalDev4.UpdateTotal(
                               CodeDevise,
                               MntOuvert,
                               0,
                               Cptr1)
                           ELSE
                             TamponTotalDev4.UpdateTotal(
                               CodeDevise,
                               0,
                               0,
                               Cptr1);

                           EcrFSClt3."Reason Code":='COMPTA.';
                           creerTemp(EcrFSClt3);
                         END;

        OnPostDataItem=BEGIN
                         RESET;
                       END;

        DataItemLink=Customer No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18300;
            SectionHeight=423;
            OnPreSection=BEGIN
                           IF Num_Etat <> Num_Etat::Clients THEN CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 28  ;TextBox      ;3300 ;0    ;1200 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Due Date" }
            { 32  ;TextBox      ;4650 ;0    ;300  ;423  ;SourceExpr="Document Type" }
            { 34  ;TextBox      ;5047 ;0    ;1853 ;423  ;SourceExpr="Document No." }
            { 36  ;TextBox      ;7050 ;0    ;3000 ;423  ;SourceExpr=Description }
            { 44  ;TextBox      ;13050;0    ;1800 ;423  ;CaptionML=FRA=Montant / Montant lettr‚;
                                                         BlankNumbers=BlankZero;
                                                         BlankZero=Yes;
                                                         SourceExpr=MntOuvertC;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr=CodeDevise }
            { 48  ;TextBox      ;15000;0    ;300  ;423  ;SourceExpr="Applies-to Doc. Type" }
            { 52  ;TextBox      ;15450;0    ;1500 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Applies-to Doc. No." }
            { 54  ;TextBox      ;17100;0    ;1050 ;423  ;HorzAlign=Right;
                                                         SourceExpr="Mise en place" }
            { 26  ;TextBox      ;300  ;0    ;1500 ;423  ;SourceExpr="Reason Code" }
            { 31  ;TextBox      ;1950 ;0    ;1200 ;423  ;SourceExpr="Posting Date" }
            { 65  ;TextBox      ;10200;0    ;1050 ;423  ;HorzAlign=Center;
                                                         SourceExpr=Devise_cpte }
            { 77  ;TextBox      ;11250;0    ;1800 ;423  ;CaptionML=FRA=Montant / Montant lettr‚;
                                                         BlankZero=Yes;
                                                         SourceExpr=MntOuvertD;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr=CodeDevise }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=integer2;
        OnPreDataItem=BEGIN
                        TamponTotalDevise.SETFILTER("Total Amount",'<>0');
                      END;

        OnAfterGetRecord=BEGIN
                           IF Number = 1 THEN BEGIN
                             OK := TamponTotalDevise.FIND('-');
                             IF NOT TamponTotalDev4.FIND('-') THEN TamponTotalDev4.INIT;
                           END
                           ELSE BEGIN
                             OK := (TamponTotalDevise.NEXT <> 0);
                             IF TamponTotalDev4.NEXT=0 THEN TamponTotalDev4.INIT;
                           END;

                           IF NOT OK THEN
                             CurrReport.BREAK;
                           MntOuvertD:=0;
                           MntOuvertC:=0;
                           IF  TamponTotalDevise."Total Amount" < 0 THEN
                             MntOuvertC:= TamponTotalDevise."Total Amount"
                             ELSE
                              MntOuvertD:= TamponTotalDevise."Total Amount" ;


                           TamponTotalDevise2.UpdateTotal(
                             TamponTotalDevise."Currency Code",
                             TamponTotalDevise."Total Amount",
                             0,
                             Cptr1);
                         END;

        OnPostDataItem=BEGIN
                         TamponTotalDevise.DELETEALL;
                         TamponTotalDev4.DELETEALL;
                       END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18300;
            SectionHeight=423;
            OnPreSection=BEGIN
                           IF Num_Etat <> Num_Etat::Clients THEN CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 157 ;Label        ;8550 ;0    ;2700 ;423  ;FontBold=Yes;
                                                         CaptionML=FRA=Solde compta. }
            { 168 ;TextBox      ;16350;0    ;1800 ;423  ;HorzAlign=Right;
                                                         FontBold=Yes;
                                                         SourceExpr=TamponTotalDev4."Total Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr=TamponTotalDev4."Currency Code" }
            { 83  ;TextBox      ;11100;0    ;1950 ;423  ;CaptionML=FRA=Montant / Montant lettr‚;
                                                         BlankZero=No;
                                                         SourceExpr=MntOuvertD;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr=CodeDevise }
            { 85  ;TextBox      ;13050;0    ;1800 ;423  ;CaptionML=FRA=Montant / Montant lettr‚;
                                                         BlankNumbers=BlankZero;
                                                         BlankZero=Yes;
                                                         SourceExpr=MntOuvertC;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr=CodeDevise }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18300;
            SectionHeight=423;
            OnPreSection=BEGIN
                           IF Num_Etat <> Num_Etat::Clients THEN CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table10866;
        DataItemTableView=SORTING(No.,Line No.)
                          WHERE(Payment in Progress=CONST(Yes),
                                Copied To No.=FILTER(''),
                                Status No.=FILTER(<60000));
        DataItemVarName=Effets_en_Port;
        OnAfterGetRecord=VAR
                           loc_ecr@1000000000 : Record 21;
                         BEGIN
                           loc_ecr.INIT;
                           loc_ecr."Posting Date"         := Effets_en_Port."Posting Date";
                           loc_ecr."Due Date"               := Effets_en_Port."Due Date";
                           loc_ecr."Document No."                   := Effets_en_Port."Document No.";
                           loc_ecr.Description                        := Effets_en_Port."Status Name";

                           IF Devise_compte THEN BEGIN
                             loc_ecr."Original Amt. (LCY)"  := Amount;
                             loc_ecr."Remaining Amt. (LCY)"   := Amount;
                             loc_ecr."Amount (LCY)"           := Amount;
                           END ELSE BEGIN
                             loc_ecr."Original Amt. (LCY)"   := "Amount (LCY)";
                             loc_ecr."Remaining Amt. (LCY)"    := "Amount (LCY)";
                             loc_ecr."Amount (LCY)"           := "Amount (LCY)";
                           END;

                           loc_ecr."Currency Code"                   := Effets_en_Port."Currency Code";
                           loc_ecr."Reason Code"                    := 'Eff.Portef';
                           loc_ecr."Closed by Amount (LCY)":= Effets_en_Port."Amount (LCY)";
                           loc_ecr."Customer No."                     := Effets_en_Port."Account No.";
                           creerTemp(loc_ecr);

                           MntInitial  := - loc_ecr."Original Amt. (LCY)";
                           Mnt         := - loc_ecr."Amount (LCY)";
                           MntOuvert   := - loc_ecr."Remaining Amt. (LCY)" ;
                           Devise_cpte := loc_ecr."Currency Code" ;

                           CodeDevise := '';

                           TamponTotalDevise2.UpdateTotal(
                             CodeDevise,
                             MntOuvert,
                             0,
                             Cptr1);
                         END;

        DataItemLink=Account No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18300;
            SectionHeight=423;
            OnPreSection=BEGIN
                           IF Num_Etat <> Num_Etat::Clients THEN CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 64  ;TextBox      ;11400;0    ;1800 ;423  ;SourceExpr=Temp_ecr."Remaining Amt. (LCY)" }
            { 68  ;TextBox      ;7350 ;0    ;3000 ;423  ;SourceExpr=Temp_ecr.Description }
            { 70  ;TextBox      ;5700 ;0    ;1500 ;423  ;SourceExpr=Temp_ecr."Document No." }
            { 74  ;TextBox      ;3900 ;0    ;1200 ;423  ;SourceExpr=Temp_ecr."Due Date" }
            { 76  ;TextBox      ;900  ;0    ;1500 ;423  ;SourceExpr=Temp_ecr."Reason Code" }
            { 47  ;TextBox      ;2550 ;0    ;1200 ;423  ;SourceExpr=Temp_ecr."Posting Date" }
            { 67  ;TextBox      ;10350;0    ;1050 ;423  ;HorzAlign=Center;
                                                         SourceExpr=Devise_cpte }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table10866;
        DataItemTableView=SORTING(No.,Line No.)
                          WHERE(Payment in Progress=CONST(Yes),
                                Status No.=FILTER(60000..70000),
                                Copied To No.=FILTER(''));
        DataItemVarName=Effet_a_encaissement;
        OnAfterGetRecord=VAR
                           loc_ecr@1000000000 : Record 21;
                         BEGIN
                           loc_ecr.INIT;
                           loc_ecr."Posting Date"         := Effet_a_encaissement."Posting Date";
                           loc_ecr."Due Date"               := Effet_a_encaissement."Due Date";
                           loc_ecr."Document No."                   := Effet_a_encaissement."Document No.";
                           loc_ecr.Description                         := Effet_a_encaissement."Status Name";

                           IF Devise_compte THEN BEGIN
                             loc_ecr."Original Amt. (LCY)"   := Effet_a_encaissement.Amount;
                             loc_ecr."Remaining Amt. (LCY)"   := Effet_a_encaissement.Amount;
                             loc_ecr."Amount (LCY)"         := Effet_a_encaissement.Amount;
                           END ELSE BEGIN
                             loc_ecr."Original Amt. (LCY)"   := Effet_a_encaissement."Amount (LCY)";
                             loc_ecr."Remaining Amt. (LCY)"    := Effet_a_encaissement."Amount (LCY)";
                             loc_ecr."Amount (LCY)"            := Effet_a_encaissement."Amount (LCY)";
                           END;

                           loc_ecr."Currency Code"                   := Effets_en_Port."Currency Code";
                           loc_ecr."Reason Code"                    := 'Eff.REMIS';
                           loc_ecr."Closed by Amount (LCY)":= Effet_a_encaissement."Amount (LCY)";
                           loc_ecr."Customer No."                     := Effet_a_encaissement."Account No.";
                           creerTemp(loc_ecr);

                           MntInitial  := - loc_ecr."Original Amt. (LCY)";
                           Mnt         := - loc_ecr."Amount (LCY)" ;
                           MntOuvert   := - loc_ecr."Remaining Amt. (LCY)" ;
                           Devise_cpte := loc_ecr."Currency Code";

                           CodeDevise := '';

                           TamponTotalDevise2.UpdateTotal(
                             CodeDevise,
                             Mnt,
                             0,
                             Cptr1);
                         END;

        DataItemLink=Account No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18300;
            SectionHeight=423;
            OnPreSection=BEGIN
                           IF Num_Etat <> Num_Etat::Clients THEN CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 8   ;TextBox      ;11400;0    ;1800 ;423  ;SourceExpr=Effet_a_encaissement."Amount (LCY)" }
            { 12  ;TextBox      ;7350 ;0    ;3000 ;423  ;SourceExpr=Temp_ecr.Description }
            { 15  ;TextBox      ;5700 ;0    ;1500 ;423  ;SourceExpr=Temp_ecr."Document No." }
            { 16  ;TextBox      ;2550 ;0    ;1200 ;423  ;SourceExpr=Temp_ecr."Posting Date" }
            { 17  ;TextBox      ;900  ;0    ;1500 ;423  ;SourceExpr=Temp_ecr."Reason Code" }
            { 59  ;TextBox      ;3900 ;0    ;1200 ;423  ;SourceExpr=Temp_ecr."Due Date" }
            { 69  ;TextBox      ;10350;0    ;1050 ;423  ;HorzAlign=Center;
                                                         SourceExpr=Devise_cpte }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table10866;
        DataItemTableView=SORTING(No.,Line No.)
                          WHERE(Account Type=CONST(Customer),
                                Payment in Progress=CONST(No),
                                Status No.=FILTER(80000..90000),
                                Copied To No.=FILTER(''));
        DataItemVarName=Effet_encaiss‚;
        OnPreDataItem=BEGIN
                        SETRANGE("Due Date",CALCDATE('-10J',WORKDATE),31122999D);
                      END;

        OnAfterGetRecord=VAR
                           loc_ecr@1000000000 : Record 21;
                         BEGIN
                           loc_ecr.INIT;
                           loc_ecr."Posting Date"         := Effet_encaiss‚."Posting Date";
                           loc_ecr."Due Date"               := Effet_encaiss‚."Due Date";
                           loc_ecr."Document No."                   := Effet_encaiss‚."Document No.";
                           loc_ecr.Description                         := Effet_encaiss‚."Status Name";

                           IF Devise_compte THEN BEGIN
                             loc_ecr."Original Amt. (LCY)"   := Effet_encaiss‚.Amount;
                             loc_ecr."Remaining Amt. (LCY)"   := Effet_encaiss‚.Amount;
                             loc_ecr."Amount (LCY)"         := Effet_encaiss‚.Amount;
                           END ELSE BEGIN
                             loc_ecr."Original Amt. (LCY)"   := Effet_encaiss‚."Amount (LCY)";
                             loc_ecr."Remaining Amt. (LCY)"    := Effet_encaiss‚."Amount (LCY)";
                             loc_ecr."Amount (LCY)"            := Effet_encaiss‚."Amount (LCY)";
                           END;

                           loc_ecr."Currency Code"                   := Effets_en_Port."Currency Code";
                           loc_ecr."Reason Code"                    := 'Eff.ENCAIS';
                           loc_ecr."Closed by Amount (LCY)":= Effet_encaiss‚."Amount (LCY)";
                           loc_ecr."Customer No."                     := Effet_encaiss‚."Account No.";
                           creerTemp(loc_ecr);

                           MntInitial  := - loc_ecr."Original Amt. (LCY)";
                           Mnt         := - loc_ecr."Amount (LCY)" ;
                           MntOuvert   := - loc_ecr."Remaining Amt. (LCY)" ;
                           Devise_cpte := loc_ecr."Currency Code";

                           CodeDevise := '';

                           TamponTotalDevise2.UpdateTotal(
                             CodeDevise,
                             Mnt,
                             0,
                             Cptr1);
                         END;

        DataItemLink=Account No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18300;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1000000000;TextBox;900  ;0    ;1500 ;423  ;SourceExpr=Temp_ecr."Reason Code" }
            { 1000000001;TextBox;2550 ;0    ;1200 ;423  ;SourceExpr=Temp_ecr."Posting Date" }
            { 1000000002;TextBox;3900 ;0    ;1200 ;423  ;SourceExpr=Temp_ecr."Due Date" }
            { 1000000003;TextBox;5700 ;0    ;1500 ;423  ;SourceExpr=Temp_ecr."Document No." }
            { 1000000004;TextBox;7350 ;0    ;3000 ;423  ;SourceExpr=Temp_ecr.Description }
            { 1000000005;TextBox;10350;0    ;1050 ;423  ;HorzAlign=Center;
                                                         SourceExpr=Devise_cpte }
            { 1000000006;TextBox;11400;0    ;1800 ;423  ;SourceExpr=Effet_encaiss‚."Amount (LCY)" }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=integer3;
        OnPreDataItem=BEGIN
                        TamponTotalDevise2.SETFILTER("Total Amount",'<>0');
                        Temp_ecr.RESET;
                      END;

        OnAfterGetRecord=BEGIN
                           IF Number = 1 THEN
                             OK := TamponTotalDevise2.FIND('-')
                           ELSE
                             OK := TamponTotalDevise2.NEXT <> 0;
                           IF NOT OK THEN
                             CurrReport.BREAK;
                         END;

        OnPostDataItem=BEGIN
                         TamponTotalDevise2.DELETEALL;
                       END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18300;
            SectionHeight=846;
            OnPreSection=BEGIN
                           IF Num_Etat <> Num_Etat::Clients THEN CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 169 ;TextBox      ;11400;423  ;1800 ;423  ;FontBold=Yes;
                                                         SourceExpr=Customer."Credit Limit (LCY)";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr=TamponTotalDevise2."Currency Code" }
            { 170 ;Label        ;7800 ;423  ;3600 ;423  ;FontBold=Yes;
                                                         CaptionML=FRA=Cr‚dit autoris‚ (dev soc) }
            { 171 ;Label        ;7800 ;0    ;3600 ;423  ;FontBold=Yes;
                                                         CaptionML=FRA=Total risque }
            { 180 ;TextBox      ;11400;0    ;1800 ;423  ;FontBold=Yes;
                                                         SourceExpr=TamponTotalDevise2."Total Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr=TamponTotalDevise2."Currency Code" }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemTable=Table2000000007;
        DataItemTableView=SORTING(Period Type,Period Start)
                          ORDER(Ascending)
                          WHERE(Period Type=CONST(Date));
        PrintOnlyIfDetail=Yes;
        OnPreDataItem=VAR
                        filtre@1000000000 : Text[30];
                      BEGIN
                          IF Datedebut=0D THEN Datedebut:=Datemini;
                          IF Datefin  =0D THEN Datefin:=Datemaxi;
                          Date.SETFILTER( "Period Start",( FORMAT(Datedebut) + '..' + FORMAT(Datefin)));
                          IF Datemaxi=0D THEN CurrReport.BREAK;
                          Total_compta:=0;
                          Total_effremis:=0;
                          Total_effport:=0;
                          Total_effenc:=0;
                      END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18300;
            SectionHeight=2991;
            OnPreSection=BEGIN
                           IF Num_Etat <> Num_Etat::D‚taill‚ THEN CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 119 ;Label        ;13200;2538 ;1782 ;423  ;VertAlign=Center;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=FRA=Montant }
            { 122 ;Label        ;10350;2538 ;1800 ;423  ;VertAlign=Center;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=FRA=Libell‚ }
            { 124 ;Label        ;7200 ;2538 ;2400 ;423  ;VertAlign=Center;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=FRA=Nø de document }
            { 126 ;Label        ;1650 ;2538 ;1350 ;423  ;VertAlign=Center;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=FRA="Date  " }
            { 128 ;Label        ;0    ;2538 ;1350 ;423  ;VertAlign=Center;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=FRA=Origine }
            { 129 ;TextBox      ;15900;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
            { 130 ;TextBox      ;0    ;846  ;7500 ;423  ;SourceExpr=COMPANYNAME }
            { 132 ;TextBox      ;0    ;423  ;7500 ;423  ;SourceExpr=STRSUBSTNO('Solde au %1',FORMAT(Customer.GETRANGEMAX("Date Filter"))) }
            { 133 ;Label        ;16950;423  ;750  ;423  ;ParentControl=134 }
            { 134 ;TextBox      ;17700;423  ;450  ;423  ;CaptionML=FRA=Page;
                                                         SourceExpr=CurrReport.PAGENO }
            { 135 ;Label        ;0    ;0    ;7500 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=FRA=Etat financier client d‚taill‚ par ‚ch‚ances }
            { 136 ;TextBox      ;15000;0    ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 158 ;Label        ;3900 ;2538 ;900  ;423  ;VertAlign=Center;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=FRA=Nøclt }
            { 159 ;Label        ;5100 ;2538 ;1500 ;423  ;VertAlign=Center;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=FRA=Client }
            { 1000000007;Shape  ;0    ;2961 ;15000;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000011;TextBox;0    ;1692 ;18150;423  ;SourceExpr=Customer.TABLENAME + ': ' + CltFiltre }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18300;
            SectionHeight=3384;
            OnPreSection=BEGIN
                           IF Num_Etat <> Num_Etat::Ech‚ances THEN CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 18  ;TextBox      ;15900;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
            { 21  ;TextBox      ;0    ;846  ;7500 ;423  ;SourceExpr=COMPANYNAME }
            { 60  ;TextBox      ;0    ;423  ;7500 ;423  ;SourceExpr=STRSUBSTNO('Solde au %1',FORMAT(Customer.GETRANGEMAX("Date Filter"))) }
            { 66  ;Label        ;16950;423  ;750  ;423  ;ParentControl=72 }
            { 72  ;TextBox      ;17700;423  ;450  ;423  ;CaptionML=FRA=Page;
                                                         SourceExpr=CurrReport.PAGENO }
            { 78  ;Label        ;0    ;0    ;7500 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=FRA=Etat financier client par ‚ch‚ances }
            { 80  ;TextBox      ;15000;0    ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 82  ;Label        ;0    ;2508 ;2100 ;846  ;VertAlign=Center;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=FRA=Dates d'‚ch‚ances }
            { 84  ;Label        ;8250 ;2508 ;1650 ;846  ;VertAlign=Center;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=FRA=Effets remis }
            { 86  ;Label        ;2700 ;2508 ;2100 ;846  ;VertAlign=Center;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=FRA=Ecritures ouvertes }
            { 88  ;Label        ;5400 ;2508 ;2250 ;846  ;VertAlign=Center;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=FRA=Effets en portefeuille }
            { 90  ;Label        ;10500;2508 ;2250 ;846  ;VertAlign=Center;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=FRA=Effets en encaissement }
            { 1000000008;Shape  ;0    ;3354 ;12750;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000012;TextBox;0    ;1692 ;18150;423  ;SourceExpr=Customer.TABLENAME + ': ' + CltFiltre }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18300;
            SectionHeight=0;
            OnPreSection=BEGIN
                             CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18300;
            SectionHeight=423;
            OnPreSection=BEGIN
                           IF Num_Etat <> Num_Etat::D‚taill‚ THEN CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18300;
            SectionHeight=1269;
            OnPreSection=BEGIN
                           IF Num_Etat <> Num_Etat::Ech‚ances THEN CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 113 ;Label        ;0    ;423  ;1950 ;423  ;VertAlign=Center;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=FRA=Totaux }
            { 114 ;TextBox      ;8250 ;423  ;1800 ;423  ;SourceExpr=Total_effremis }
            { 115 ;TextBox      ;2700 ;423  ;1800 ;423  ;SourceExpr=Total_compta }
            { 116 ;TextBox      ;5400 ;423  ;1800 ;423  ;SourceExpr=Total_effport }
            { 117 ;TextBox      ;10500;423  ;1800 ;423  ;SourceExpr=Total_effenc }
            { 1000000010;Shape  ;0    ;0    ;12450;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=<integer4>;
        OnPreDataItem=BEGIN
                        Temp_ecr.SETFILTER( "Posting Date",('=' + FORMAT(Date."Period Start")));
                      END;

        OnAfterGetRecord=BEGIN

                           IF Number = 1 THEN
                             OK := Temp_ecr.FIND('-')
                           ELSE
                             OK := Temp_ecr.NEXT <> 0;
                           IF NOT OK THEN
                             CurrReport.BREAK;
                           IF NOT Rec_clt.GET(Temp_ecr."Customer No.") THEN Rec_clt.INIT;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=18300;
            SectionHeight=423;
            OnPreSection=BEGIN
                             Memo_compta:=0;
                             Memo_effremis:=0;
                             Memo_effport:=0;
                             Memo_effenc:=0;
                           IF Num_Etat <> Num_Etat::D‚taill‚ THEN CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18300;
            SectionHeight=423;
            OnPreSection=BEGIN
                            IF Temp_ecr."Reason Code"='COMPTA.'    THEN BEGIN
                             Memo_compta  :=Memo_compta   + Temp_ecr."Remaining Amt. (LCY)";
                             Total_compta :=Total_compta  + Temp_ecr."Remaining Amt. (LCY)";
                             END;
                            IF Temp_ecr."Reason Code"='EFF.REMIS'     THEN BEGIN
                             Memo_effremis  :=Memo_effremis   + Temp_ecr."Remaining Amt. (LCY)";
                             Total_effremis :=Total_effremis  + Temp_ecr."Remaining Amt. (LCY)";
                             END;
                            IF Temp_ecr."Reason Code"='EFF.PORTEF' THEN BEGIN
                             Memo_effport  :=Memo_effport   + Temp_ecr."Remaining Amt. (LCY)";
                             Total_effport :=Total_effport  + Temp_ecr."Remaining Amt. (LCY)";
                             END;
                            IF Temp_ecr."Reason Code"='EFF.ENCAIS' THEN BEGIN
                             Memo_effenc  :=Memo_effenc   - Temp_ecr."Amount (LCY)";
                             Total_effenc :=Total_effenc  - Temp_ecr."Amount (LCY)";
                             Temp_ecr."Remaining Amt. (LCY)":=0-Temp_ecr."Amount (LCY)";
                             END;
                           IF Num_Etat <> Num_Etat::D‚taill‚ THEN CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 13  ;TextBox      ;0    ;0    ;1500 ;423  ;SourceExpr=Temp_ecr."Reason Code" }
            { 14  ;TextBox      ;1950 ;0    ;1350 ;423  ;SourceExpr=Temp_ecr."Posting Date" }
            { 49  ;TextBox      ;7500 ;0    ;1950 ;423  ;SourceExpr=Temp_ecr. "Document No." }
            { 73  ;TextBox      ;9750 ;0    ;3300 ;423  ;SourceExpr=Temp_ecr.Description }
            { 75  ;TextBox      ;13200;0    ;1800 ;423  ;SourceExpr=Temp_ecr."Remaining Amt. (LCY)" }
            { 160 ;TextBox      ;3600 ;0    ;1200 ;423  ;SourceExpr=Temp_ecr."Customer No." }
            { 164 ;TextBox      ;4950 ;0    ;2400 ;423  ;SourceExpr=Rec_clt.Name }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18300;
            SectionHeight=846;
            OnPreSection=BEGIN
                           IF Num_Etat <> Num_Etat::D‚taill‚ THEN CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 11  ;TextBox      ;13200;0    ;1800 ;423  ;SourceExpr=Memo_compta + Memo_effport + Memo_effremis +   Memo_effenc }
            { 51  ;TextBox      ;1800 ;0    ;1500 ;423  ;SourceExpr=Date."Period Start" }
            { 58  ;Label        ;300  ;0    ;1200 ;423  ;VertAlign=Bottom;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=FRA=Total }
            { 1000000009;Shape  ;0    ;816  ;15000;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18300;
            SectionHeight=423;
            OnPreSection=BEGIN
                           IF Num_Etat <> Num_Etat::Ech‚ances THEN CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 62  ;TextBox      ;0    ;0    ;1500 ;423  ;SourceExpr=Date."Period Start" }
            { 43  ;TextBox      ;10500;0    ;1800 ;423  ;SourceExpr=Memo_effenc }
            { 92  ;TextBox      ;8250 ;0    ;1800 ;423  ;SourceExpr=Memo_effremis }
            { 93  ;TextBox      ;2700 ;0    ;1800 ;423  ;SourceExpr=Memo_compta }
            { 94  ;TextBox      ;5400 ;0    ;1800 ;423  ;SourceExpr=Memo_effport }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=2640;
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 2   ;CheckBox     ;3410 ;110  ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=FRA=Nouvelle page par client;
                                                   SourceExpr=ImprUnParPage;
                                                   OnAfterValidate=BEGIN
                                                                     IF (Num_Etat=Num_Etat::Ech‚ances) OR (Num_Etat = Num_Etat::D‚taill‚) THEN
                                                                       ImprUnParPage := FALSE;
                                                                   END;
                                                                    }
      { 22  ;Label        ;0    ;110  ;3300 ;440  ;ParentControl=2 }
      { 3   ;OptionButton ;1870 ;770  ;2750 ;440  ;CaptionML=FRA=Ech‚ances;
                                                   SourceExpr=Num_Etat;
                                                   OptionValue=Ech‚ances;
                                                   OnAfterValidate=BEGIN
                                                                     IF Num_Etat = Num_Etat::Ech‚ances THEN
                                                                       ImprUnParPage := FALSE;
                                                                   END;
                                                                    }
      { 4   ;Label        ;0    ;770  ;1540 ;440  ;ParentControl=3;
                                                   CaptionML=FRA=Etat par }
      { 5   ;OptionButton ;1870 ;1320 ;2750 ;440  ;CaptionML=FRA=Ech‚ancier d‚taill‚;
                                                   SourceExpr=Num_Etat;
                                                   OptionValue=D‚taill‚;
                                                   OnAfterValidate=BEGIN
                                                                     IF Num_Etat = Num_Etat::D‚taill‚ THEN
                                                                       ImprUnParPage := FALSE;
                                                                   END;
                                                                    }
      { 1   ;OptionButton ;1870 ;1870 ;2750 ;440  ;CaptionML=FRA=Clients;
                                                   SourceExpr=Num_Etat;
                                                   OptionValue=Clients }
      { 11  ;CheckBox     ;5170 ;1870 ;440  ;440  ;Visible=Yes;
                                                   ShowCaption=No;
                                                   CaptionML=FRA=en devise du compte;
                                                   SourceExpr=Devise_compte;
                                                   OnAfterValidate=BEGIN
                                                                     IF (Num_Etat <> Num_Etat::Clients) THEN
                                                                       Devise_compte := FALSE;
                                                                   END;
                                                                    }
      { 12  ;Label        ;5720 ;1870 ;3080 ;440  ;Visible=Yes;
                                                   ParentControl=11 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      TamponTotalDevise@1000000000 : TEMPORARY Record 332;
      TamponTotalDevise2@1000000001 : TEMPORARY Record 332;
      TamponTotalDev4@1000000002 : Record 332;
      EcrClt@1000000003 : Record 21;
      Temp_ecr@1000000004 : TEMPORARY Record 21;
      Rec_clt@1000000005 : Record 18;
      ImprUnParPage@1000000006 : Boolean;
      Num_Etat@1000000007 : 'Ech‚ances,D‚taill‚,Clients';
      CltFiltre@1000000008 : Text[100];
      CltFiltreDate@1000000009 : Text[50];
      DateMax@1000000010 : Date;
      MntInitial@1000000011 : Decimal;
      Mnt@1000000012 : Decimal;
      MntOuvert@1000000013 : Decimal;
      MntOuvertD@1000000014 : Decimal;
      MntOuvertC@1000000015 : Decimal;
      Cptr1@1000000016 : Integer;
      Cptr2@1000000017 : Integer;
      OK@1000000018 : Boolean;
      CodeDevise@1000000019 : Code[10];
      Num_seq@1000000020 : Integer;
      Datemini@1000000021 : Date;
      Datemaxi@1000000022 : Date;
      Datedebut@1000000023 : Date;
      Datefin@1000000024 : Date;
      Memo_compta@1000000025 : Decimal;
      Memo_effremis@1000000026 : Decimal;
      Memo_effport@1000000027 : Decimal;
      Memo_effenc@1000000028 : Decimal;
      Total_compta@1000000029 : Decimal;
      Total_effremis@1000000030 : Decimal;
      Total_effport@1000000031 : Decimal;
      Total_effenc@1000000032 : Decimal;
      Devise_compte@1000000033 : Boolean;
      Devise_cpte@1000000034 : Code[10];

    PROCEDURE creerTemp@1(VAR loc_ecr@1000000000 : Record 21);
    BEGIN
      //g‚n‚ration de la table ecriture par date
      IF loc_ecr."Due Date" = 0D THEN
        loc_ecr."Due Date" := TODAY;

      IF Datemini > loc_ecr."Due Date" THEN
        Datemini := loc_ecr."Due Date";

      IF Datemaxi<loc_ecr."Due Date" THEN
        Datemaxi := loc_ecr."Due Date";

      Temp_ecr.INIT;
      Num_seq := Num_seq + 1;
      Temp_ecr."Document Type" := loc_ecr."Document Type" ;
      Temp_ecr."Document No." := loc_ecr."Document No.";
      Temp_ecr."Customer No." := loc_ecr."Customer No.";
      Temp_ecr.Description := loc_ecr.Description;
      Temp_ecr."Entry No." := Num_seq;
      Temp_ecr."Posting Date" := loc_ecr."Posting Date";
      Temp_ecr."Original Amt. (LCY)" := loc_ecr."Original Amt. (LCY)";
      Temp_ecr."Remaining Amt. (LCY)" := loc_ecr."Remaining Amt. (LCY)";
      Temp_ecr."Amount (LCY)" := loc_ecr."Amount (LCY)";
      Temp_ecr."Due Date" := loc_ecr."Due Date";
      Temp_ecr."Reason Code" := loc_ecr."Reason Code";
      Temp_ecr."Closed by Amount (LCY)" := loc_ecr."Closed by Amount (LCY)";
      Temp_ecr.INSERT;
    END;

    BEGIN
    {
      /** @r IMH01 @d 06/01/11 @a ISAT.MA @v IMH6.01.040 @s Isatech+ */
    }
    END.
  }
  RDLDATA
  {
  }
}