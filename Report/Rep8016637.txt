OBJECT Report 8016637 Cust-Detail Trial Bal. ISA+
{
  OBJECT-PROPERTIES
  {
    Date=18/09/12;
    Time=15:17:29;
    Modified=Yes;
    Version List=ISA6.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Customer - Detail Trial Bal.;
               FRA=Clients : Grand livre client];
    TopMargin=1000;
    BottomMargin=500;
    LeftMargin=50;
    OnPreReport=BEGIN
                  CustFilter := Customer.GETFILTER("No.");
                  FiltreDate := Customer.GETFILTER("Date Filter");
                  //FiltreGestion := Customer.GETFILTER("Responsibility Center Filter");
                  EndDate := Customer.GETRANGEMAX("Date Filter");
                END;

  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table18;
        DataItemTableView=SORTING(No.);
        PrintOnlyIfDetail=Yes;
        OnPreDataItem=BEGIN
                        CurrReport.NEWPAGEPERRECORD := PrintOnlyOnePerPage;
                        CurrReport.CREATETOTALS("Cust. Ledger Entry"."Amount (LCY)",
                                                "Cust. Ledger Entry"."Debit Amount (LCY)",
                                                "Cust. Ledger Entry"."Credit Amount (LCY)",
                                                StartBalanceLCY);

                        IF ExportExcel THEN BEGIN
                          ExcelLineNo := 1;
                          CreateExcelBuffer;
                          InsertRow(ExcelLineNo,1,Text0001,'');
                          InsertRow(ExcelLineNo,2,Text0002,'');
                          InsertRow(ExcelLineNo,3,Text001,'');
                          InsertRow(ExcelLineNo,4,Text002,'');
                          InsertRow(ExcelLineNo,5,Text003,'');
                          InsertRow(ExcelLineNo,6,Text004,'');
                          InsertRow(ExcelLineNo,7,Text005,'');
                          InsertRow(ExcelLineNo,8,Text006,'');
                          InsertRow(ExcelLineNo,9,Text007,'');
                          InsertRow(ExcelLineNo,10,Text008,'');
                          InsertRow(ExcelLineNo,11,Text009,'');
                          InsertRow(ExcelLineNo,12,Text010,'');
                        END;
                      END;

        OnAfterGetRecord=VAR
                           LocDetLedgEntry@1000000001 : Record 379;
                           LocLedgEntry@1000000000 : Record 21;
                         BEGIN
                           StartBalanceLCY := 0;
                           IF NOT ToutesEcr THEN
                              SETFILTER("Date Filter",'01011990..%1',EndDate);

                           LocDetLedgEntry.RESET;
                           LocDetLedgEntry.SETCURRENTKEY("Customer No.","Posting Date");
                           LocDetLedgEntry.SETRANGE("Customer No.",Customer."No.");
                           LocDetLedgEntry.SETRANGE("Posting Date",0D,GETRANGEMIN("Date Filter") - 1);
                           IF LocDetLedgEntry.FIND('-') THEN
                              REPEAT
                               LocLedgEntry.SETFILTER("Global Dimension 1 Code","Global Dimension 1 Filter");
                               LocLedgEntry.SETFILTER("Global Dimension 2 Code","Global Dimension 2 Filter");
                               LocLedgEntry.SETRANGE("Entry No.",LocDetLedgEntry."Cust. Ledger Entry No.");
                               IF  LocLedgEntry.FIND('-') THEN
                                StartBalanceLCY :=StartBalanceLCY + LocDetLedgEntry."Amount (LCY)";
                              UNTIL LocDetLedgEntry.NEXT=0;


                           CurrReport.PRINTONLYIFDETAIL := NOT (PrintAllHavingBal AND (StartBalanceLCY <> 0));
                           CustBalanceLCY := StartBalanceLCY;

                           PrintOne := TRUE;
                         END;

        OnPostDataItem=BEGIN
                         IF ExportExcel THEN BEGIN
                           ViewExcel('ExportExcel');
                         END;
                       END;

        ReqFilterFields=No.,Search Name,Customer Posting Group,Date Filter;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19800;
            SectionHeight=1692;
          }
          CONTROLS
          {
            { 2   ;TextBox      ;16650;0    ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 3   ;TextBox      ;150  ;423  ;7500 ;423  ;SourceExpr=STRSUBSTNO(Text000,FiltreDate) }
            { 4   ;Label        ;18600;423  ;750  ;423  ;ParentControl=5 }
            { 5   ;TextBox      ;19350;423  ;450  ;423  ;CaptionML=[ENU=Page;
                                                                    FRA=Page];
                                                         SourceExpr=CurrReport.PAGENO }
            { 6   ;TextBox      ;150  ;846  ;7500 ;423  ;SourceExpr=COMPANYNAME }
            { 7   ;TextBox      ;17550;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
            { 1000000014;Label  ;150  ;0    ;7500 ;423  ;HorzAlign=Left;
                                                         FontSize=12;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Customer Detail Trial Balance;
                                                                    FRA=Grand livre clients] }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19800;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(PrintAllHavingBal);
                         END;

          }
          CONTROLS
          {
            { 9   ;Label        ;150  ;0    ;12000;423  ;CaptionML=[ENU=This report also includes customers that only have balances.;
                                                                    FRA=Cet ‚tat inclut aussi les clients ayant un solde ouvert.] }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19800;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(ToutesEcr);
                         END;

          }
          CONTROLS
          {
            { 1000000035;Label  ;150  ;0    ;12000;423  ;CaptionML=FRA=Cet ‚tat inclut aussi les ‚critures lettr‚es. }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19800;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(CustFilter <> '');
                         END;

          }
          CONTROLS
          {
            { 10  ;TextBox      ;150  ;0    ;18900;423  ;SourceExpr=Customer.TABLECAPTION + ': ' + CustFilter }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19800;
            SectionHeight=1299;
          }
          CONTROLS
          {
            { 1100281000;Shape  ;19500;423  ;300  ;876  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281001;Shape  ;150  ;423  ;19500;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1100281002;Shape  ;150  ;1269 ;19500;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1100281003;Label  ;18000;423  ;1500 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Apply Ref.;
                                                                    FRA=Ref. lettrage] }
            { 1100281004;Shape  ;17700;423  ;300  ;846  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281005;Label  ;15750;423  ;1950 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Balance;
                                                                    FRA=Solde] }
            { 1100281006;Shape  ;15450;423  ;300  ;846  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281007;Label  ;13500;423  ;1950 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Credit;
                                                                    FRA=Cr‚dit] }
            { 1100281008;Shape  ;13200;423  ;300  ;846  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281009;Label  ;11250;423  ;1950 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Debit;
                                                                    FRA=D‚bit] }
            { 1100281010;Shape  ;10950;423  ;300  ;846  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281011;Label  ;7500 ;423  ;3450 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=FRA=D‚signation }
            { 1100281012;Shape  ;7200 ;423  ;300  ;846  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281013;Label  ;5700 ;423  ;1500 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Document No.;
                                                                    FRA=Nø document] }
            { 1100281014;Shape  ;5400 ;423  ;300  ;846  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281015;Label  ;4350 ;423  ;1050 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=FRA=Type doc. }
            { 1100281016;Shape  ;4050 ;423  ;300  ;846  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281017;Label  ;3000 ;423  ;1050 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Source Code;
                                                                    FRA=Code journal] }
            { 1100281018;Shape  ;2700 ;423  ;300  ;846  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281019;Label  ;1650 ;423  ;1050 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Due Date;
                                                                    FRA=Date ‚ch‚ance] }
            { 1100281020;Shape  ;1350 ;423  ;300  ;846  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281021;Label  ;300  ;423  ;1050 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Posting Date;
                                                                    FRA=Date compta.] }
            { 1100281022;Shape  ;0    ;423  ;300  ;876  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=19800;
            SectionHeight=453;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(AllowCustTransHead);
                         END;

          }
          CONTROLS
          {
            { 1100281023;Shape  ;19500;0    ;300  ;453  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281024;Shape  ;150  ;423  ;19500;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1100281025;Shape  ;17700;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281026;Shape  ;15450;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281027;Shape  ;13200;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281028;Shape  ;10950;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281029;Shape  ;7200 ;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281030;TextBox;1800 ;0    ;5400 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=Customer."Search Name" }
            { 1100281031;TextBox;300  ;0    ;1350 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=Customer."No." }
            { 1100281032;Shape  ;0    ;0    ;300  ;453  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19800;
            SectionHeight=453;
            KeepWithNext=No;
            OnPreSection=BEGIN
                           AllowCustTransHead := FALSE;
                         END;

            OnPostSection=BEGIN
                            AllowCustTransHead := TRUE;
                          END;

          }
          CONTROLS
          {
            { 1100281033;Shape  ;19500;0    ;300  ;453  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281034;Shape  ;17700;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281035;Shape  ;15450;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281036;Shape  ;13200;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281037;Shape  ;10950;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281038;TextBox;1800 ;0    ;5400 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr="Search Name" }
            { 1100281039;Shape  ;7200 ;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281040;TextBox;300  ;0    ;1350 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr="No." }
            { 1100281041;Shape  ;0    ;0    ;300  ;453  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281042;Shape  ;150  ;423  ;19500;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19800;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1100281043;Shape  ;19500;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281044;Shape  ;17700;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281045;TextBox;15750;0    ;1950 ;423  ;HorzAlign=Right;
                                                         FontSize=6;
                                                         FontBold=Yes;
                                                         SourceExpr=StartBalanceLCY;
                                                         AutoFormatType=1 }
            { 1100281046;Shape  ;15450;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281047;Shape  ;13200;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281048;Shape  ;10950;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281049;Shape  ;7200 ;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281050;Shape  ;5400 ;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281051;Shape  ;4050 ;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281052;Shape  ;2700 ;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281053;Shape  ;1350 ;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281054;Shape  ;0    ;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=19800;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1000000095;Shape  ;150  ;0    ;19500;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19800;
            SectionHeight=846;
            OnPreSection=BEGIN
                           IF ExportExcel THEN BEGIN
                             ExcelLineNo += 2;
                             InsertRowWithBold(ExcelLineNo,8,Text011,'');
                             InsertRow(ExcelLineNo,11,ConvertNumber(StartBalanceLCY),'');
                             ExcelLineNo += 1;
                             InsertRowWithBold(ExcelLineNo,8,'Total','');
                             InsertRow(ExcelLineNo,9,ConvertNumber("Cust. Ledger Entry"."Debit Amount (LCY)"),'');
                             InsertRow(ExcelLineNo,10,ConvertNumber("Cust. Ledger Entry"."Credit Amount (LCY)"),'');
                             InsertRow(ExcelLineNo,11,ConvertNumber(StartBalanceLCY + "Cust. Ledger Entry"."Amount (LCY)"),'');
                           END;
                         END;

          }
          CONTROLS
          {
            { 1100281114;TextBox;15700;0    ;1950 ;423  ;HorzAlign=Right;
                                                         FontBold=Yes;
                                                         SourceExpr=StartBalanceLCY;
                                                         AutoFormatType=1 }
            { 1100281115;Label  ;1800 ;0    ;3600 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Total (LCY) Before Period;
                                                                    FRA=Total avant p‚riode] }
            { 1100281116;Label  ;1800 ;423  ;3600 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Total (LCY);
                                                                    FRA=Total] }
            { 1100281117;TextBox;15700;423  ;1950 ;423  ;HorzAlign=Right;
                                                         FontBold=Yes;
                                                         SourceExpr=StartBalanceLCY + "Cust. Ledger Entry"."Amount (LCY)";
                                                         AutoFormatType=1 }
            { 1100281118;TextBox;13450;423  ;1950 ;423  ;HorzAlign=Right;
                                                         FontBold=Yes;
                                                         SourceExpr="Cust. Ledger Entry"."Credit Amount (LCY)";
                                                         AutoFormatType=1 }
            { 1100281119;TextBox;11200;423  ;1950 ;423  ;HorzAlign=Right;
                                                         FontBold=Yes;
                                                         SourceExpr="Cust. Ledger Entry"."Debit Amount (LCY)";
                                                         AutoFormatType=1 }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table21;
        DataItemTableView=SORTING(Customer No.,Posting Date);
        OnPreDataItem=BEGIN
                        //<<ISA02.isat.PC
                        //CustLedgEntryExists := FALSE;
                        IF NOT ToutesEcr THEN BEGIN
                          CustLedgEntryExists := FALSE;
                        END ELSE BEGIN
                          CustLedgEntryExists := StartBalanceLCY <> 0;
                        END;
                        //>>ISA02.isat.PC
                        CurrReport.CREATETOTALS("Debit Amount (LCY)","Credit Amount (LCY)","Amount (LCY)");
                      END;

        OnAfterGetRecord=VAR
                           i@1100281000 : Integer;
                         BEGIN
                           IF NOT ToutesEcr  THEN BEGIN
                             SETFILTER("Date Filter",'%1..%2',0D,EndDate);
                             CALCFIELDS("Debit Amount (LCY)","Credit Amount (LCY)","Amount (LCY)");
                             IF ("Debit Amount (LCY)"=0) AND ("Credit Amount (LCY)"=0) THEN CurrReport.SKIP;

                             //=======Test si ecriture ouverte a date de fin de periode
                             Glo_apply:="Cust. Ledger Entry";

                             Glo_cumul.RESET;
                             Glo_cumul.INIT;
                             Glo_cumul.SETCURRENTKEY("Customer No.","Posting Date");
                             Glo_cumul.SETRANGE("Customer No.","Customer No.");
                             Glo_cumul.SETFILTER(Glo_cumul."Date Filter",'%1..%2',0D,EndDate);

                             IF NOT existe("Entry No.") THEN BEGIN  //si l'ecriture courante appartient deja au filtre precedent
                               FOR i:=1 TO 10 DO BEGIN              //on ne refait pas la recherche les lien de lettrage.
                                 FilterEntry[i]:='0';
                               END;
                               SetFilterLedger("Entry No.");
                             END;

                             TotalLettre:=0;
                             FOR i:=1 TO 10 DO BEGIN
                               IF STRLEN(FilterEntry[i])>1 THEN BEGIN
                                 Glo_cumul.SETFILTER("Entry No.",FilterEntry[i]);
                                 IF   Glo_cumul.FIND('-') THEN
                                    REPEAT
                                      Glo_cumul.CALCFIELDS(Glo_cumul."Amount (LCY)");
                                      TotalLettre:=TotalLettre+Glo_cumul."Amount (LCY)";
                                    UNTIL Glo_cumul.NEXT=0;
                               END;
                             END;

                             IF TotalLettre =  0 THEN CurrReport.SKIP;
                             //=======================================================
                           END;

                           CALCFIELDS("Debit Amount (LCY)","Credit Amount (LCY)","Amount (LCY)");
                           CustLedgEntryExists := TRUE;
                           CustCurrencyCode := '';
                           CustBalanceLCY := CustBalanceLCY + "Amount (LCY)";

                           IF PrintOne THEN BEGIN
                             IF ExportExcel THEN BEGIN
                               ExcelLineNo += 1;
                               InsertRowWithBold(ExcelLineNo,4,Customer."No.",'');
                               InsertRowWithBold(ExcelLineNo,5,Customer."Search Name",'');
                               ExcelLineNo += 1;
                               InsertRow(ExcelLineNo,1,Customer."No.",'');
                               InsertRow(ExcelLineNo,2,Customer."Search Name",'');
                               InsertRow(ExcelLineNo,8,Text0003,'');
                               InsertRow(ExcelLineNo,11,ConvertNumber(StartBalanceLCY),'');
                             END;
                             PrintOne := FALSE;
                           END;
                         END;

        ReqFilterFields=Open;
        DataItemLink=Customer No.=FIELD(No.),
                     Posting Date=FIELD(Date Filter),
                     Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                     Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                     Date Filter=FIELD(Date Filter);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=19800;
            SectionHeight=453;
          }
          CONTROLS
          {
            { 1100281055;Shape  ;19500;0    ;300  ;453  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281056;Shape  ;17700;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281057;TextBox;15750;0    ;1950 ;423  ;HorzAlign=Right;
                                                         FontSize=6;
                                                         FontBold=Yes;
                                                         SourceExpr=StartBalanceLCY + "Amount (LCY)";
                                                         AutoFormatType=1 }
            { 1100281058;Shape  ;15450;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281059;Shape  ;13200;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281060;Shape  ;10950;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281061;Label  ;7500 ;0    ;3450 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Continued;
                                                                    FRA="Report "] }
            { 1100281062;Shape  ;7200 ;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281063;TextBox;1800 ;0    ;5400 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=Customer."Search Name" }
            { 1100281064;TextBox;300  ;0    ;1350 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=Customer."No." }
            { 1100281065;Shape  ;0    ;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281066;Shape  ;150  ;423  ;19500;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19800;
            SectionHeight=0;
            OnPreSection=VAR
                           locCustLedgerEntry@1000000001 : Record 21;
                           locDetCustLedgEntry@1000000000 : Record 379;
                         BEGIN
                           TransfooterLedger:=FALSE;

                           Indication := '';
                           RefApply := '';
                           IF ShowRefApply THEN BEGIN
                             locDetCustLedgEntry.RESET;
                             locDetCustLedgEntry.SETRANGE("Cust. Ledger Entry No.","Entry No.");
                             locDetCustLedgEntry.SETRANGE("Entry Type",locDetCustLedgEntry."Entry Type"::Application);
                             IF locDetCustLedgEntry.FIND('+') THEN BEGIN
                               IF locDetCustLedgEntry."Posting Date" > Customer.GETRANGEMAX("Date Filter") THEN BEGIN
                                 Indication := '*';
                               END;
                               RefApply := locDetCustLedgEntry."Document No.";
                             END;
                           END;
                           IF ExportExcel THEN BEGIN
                             ExcelLineNo += 1;
                             InsertRow(ExcelLineNo,1,Customer."No.",'');
                             InsertRow(ExcelLineNo,2,Customer."Search Name",'');
                             InsertRow(ExcelLineNo,3,FORMAT("Posting Date"),'');
                             InsertRow(ExcelLineNo,4,FORMAT("Due Date"),'');
                             InsertRow(ExcelLineNo,5,"Source Code",'');
                             InsertRow(ExcelLineNo,6,FORMAT("Document Type"),'');
                             InsertRow(ExcelLineNo,7,"Document No.",'');
                             InsertRow(ExcelLineNo,8,Description,'');
                             InsertRow(ExcelLineNo,9,ConvertNumber("Debit Amount (LCY)"),'');
                             InsertRow(ExcelLineNo,10,ConvertNumber("Credit Amount (LCY)"),'');
                             InsertRow(ExcelLineNo,11,ConvertNumber(CustBalanceLCY),'');
                             InsertRow(ExcelLineNo,12,RefApply,'');
                             InsertRow(ExcelLineNo,13,Indication,'');
                           END;
                         END;

          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=19800;
            SectionHeight=453;
            OnPreSection=BEGIN
                                  TransfooterLedger:=TRUE;
                         END;

          }
          CONTROLS
          {
            { 1100281089;Shape  ;19500;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281090;TextBox;15750;0    ;1950 ;423  ;HorzAlign=Right;
                                                         FontSize=6;
                                                         FontBold=Yes;
                                                         SourceExpr=StartBalanceLCY + "Amount (LCY)";
                                                         AutoFormatType=1 }
            { 1100281091;Shape  ;17700;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281092;Shape  ;15450;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281093;Shape  ;13200;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281094;Shape  ;10950;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281095;Label  ;7500 ;0    ;3450 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Continued;
                                                                    FRA=Report] }
            { 1100281096;Shape  ;7200 ;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281097;Shape  ;5400 ;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281098;Shape  ;4050 ;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281099;Shape  ;2700 ;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281100;Shape  ;1350 ;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281101;Shape  ;0    ;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table379;
        DataItemTableView=SORTING(Cust. Ledger Entry No.,Posting Date)
                          WHERE(Entry Type=FILTER(<>Application));
        OnPreDataItem=BEGIN
                        IF ToutesEcr THEN
                          SETFILTER("Posting Date",'%1..%2',Customer.GETRANGEMIN("Date Filter") ,EndDate)
                        ELSE
                          SETFILTER("Posting Date",'%1..%2',0D ,EndDate);
                      END;

        DataItemLink=Cust. Ledger Entry No.=FIELD(Entry No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19800;
            SectionHeight=423;
            OnPreSection=BEGIN
                           AllowCustTransHead := FALSE;
                         END;

          }
          CONTROLS
          {
            { 1100281120;Shape  ;19500;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281121;TextBox;18000;0    ;1500 ;423  ;FontSize=6;
                                                         CaptionML=[ENU=Balance (LCY);
                                                                    FRA=Solde DS];
                                                         SourceExpr=RefApply;
                                                         AutoFormatType=1 }
            { 1100281122;Shape  ;17700;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281123;TextBox;17850;0    ;300  ;423  ;FontSize=6;
                                                         CaptionML=[ENU=Balance (LCY);
                                                                    FRA=Solde DS];
                                                         SourceExpr=Indication;
                                                         AutoFormatType=1 }
            { 1100281124;TextBox;15750;0    ;1950 ;423  ;HorzAlign=Right;
                                                         FontSize=6;
                                                         CaptionML=[ENU=Balance (LCY);
                                                                    FRA=Solde DS];
                                                         SourceExpr=CustBalanceLCY;
                                                         AutoFormatType=1 }
            { 1100281125;Shape  ;15450;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281126;TextBox;13500;0    ;1950 ;423  ;HorzAlign=Right;
                                                         FontSize=6;
                                                         SourceExpr="Credit Amount (LCY)";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr=CustCurrencyCode }
            { 1100281127;Shape  ;13200;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281128;TextBox;11250;0    ;1950 ;423  ;HorzAlign=Right;
                                                         FontSize=6;
                                                         CaptionML=[ENU=Amount;
                                                                    FRA=Montant];
                                                         SourceExpr="Debit Amount (LCY)";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr=CustCurrencyCode }
            { 1100281129;TextBox;7500 ;0    ;3450 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Cust. Ledger Entry".Description }
            { 1100281130;Shape  ;10950;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281131;Shape  ;7200 ;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281132;TextBox;5650 ;0    ;1650 ;423  ;HorzAlign=Left;
                                                         FontSize=6;
                                                         SourceExpr="Document No." }
            { 1100281133;Shape  ;5400 ;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281134;TextBox;4350 ;0    ;1050 ;423  ;HorzAlign=Left;
                                                         CaptionML=[ENU=Document Type;
                                                                    FRA=Type document];
                                                         SourceExpr="Document Type" }
            { 1100281135;Shape  ;4050 ;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281136;TextBox;3000 ;0    ;1050 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Source Code" }
            { 1100281137;Shape  ;2700 ;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281138;TextBox;1650 ;0    ;1050 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Cust. Ledger Entry"."Due Date" }
            { 1100281139;Shape  ;1350 ;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281140;TextBox;300  ;0    ;1050 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Posting Date" }
            { 1100281141;Shape  ;0    ;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        OnAfterGetRecord=BEGIN
                           IF NOT CustLedgEntryExists AND ((StartBalanceLCY = 0) OR NOT PrintAllHavingBal) THEN BEGIN
                             StartBalanceLCY := 0;
                             CurrReport.SKIP;
                           END;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19800;
            SectionHeight=453;
            OnPreSection=BEGIN
                           IF ExportExcel THEN BEGIN
                             ExcelLineNo += 1;
                             InsertRowWithBold(ExcelLineNo,8,'Total ' + Customer."Search Name",'');
                             InsertRow(ExcelLineNo,9,ConvertNumber("Cust. Ledger Entry"."Debit Amount (LCY)"),'');
                             InsertRow(ExcelLineNo,10,ConvertNumber("Cust. Ledger Entry"."Credit Amount (LCY)"),'');
                             InsertRow(ExcelLineNo,11,ConvertNumber(StartBalanceLCY + "Cust. Ledger Entry"."Amount (LCY)"),'');
                           END;
                         END;

          }
          CONTROLS
          {
            { 1000000009;Shape  ;150  ;0    ;19500;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1100281102;Shape  ;19500;0    ;300  ;453  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281103;Shape  ;17700;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281104;TextBox;15750;0    ;1950 ;423  ;HorzAlign=Right;
                                                         FontSize=6;
                                                         FontBold=Yes;
                                                         SourceExpr=StartBalanceLCY + "Cust. Ledger Entry"."Amount (LCY)";
                                                         AutoFormatType=1 }
            { 1100281105;TextBox;13500;0    ;1950 ;423  ;HorzAlign=Right;
                                                         FontSize=6;
                                                         FontBold=Yes;
                                                         SourceExpr="Cust. Ledger Entry"."Credit Amount (LCY)";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr=CustCurrencyCode }
            { 1100281106;Shape  ;15450;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281107;Shape  ;13200;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281108;TextBox;11250;0    ;1950 ;423  ;HorzAlign=Right;
                                                         FontSize=6;
                                                         FontBold=Yes;
                                                         SourceExpr="Cust. Ledger Entry"."Debit Amount (LCY)";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr=CustCurrencyCode }
            { 1100281109;Shape  ;10950;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281110;Shape  ;7200 ;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281111;TextBox;1500 ;0    ;5700 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr='Total '+Customer."Search Name" }
            { 1100281112;Shape  ;0    ;0    ;300  ;453  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281113;Shape  ;150  ;423  ;19500;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=4180;
      Height=3300;
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 2   ;CheckBox     ;3740 ;660  ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=[ENU=New Page per Customer;
                                                              FRA=Nouvelle page par client];
                                                   SourceExpr=PrintOnlyOnePerPage }
      { 22  ;Label        ;0    ;660  ;3630 ;440  ;ParentControl=2 }
      { 3   ;CheckBox     ;3740 ;1650 ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=[ENU=Include Customers That Have a Balance Only;
                                                              FRA=Inclure seulement les clients ayant un solde];
                                                   SourceExpr=PrintAllHavingBal }
      { 23  ;Label        ;0    ;1210 ;3630 ;880  ;ParentControl=3;
                                                   VertAlign=Bottom;
                                                   MultiLine=Yes }
      { 1000000000;Label  ;0    ;2200 ;3630 ;440  ;ParentControl=1000000001 }
      { 1000000001;CheckBox;3740;2200 ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=FRA=Toutes les ‚critures;
                                                   SourceExpr=ToutesEcr }
      { 1100281000;CheckBox;3740;2860 ;440  ;440  ;ShowCaption=No;
                                                   SourceExpr=ShowRefApply }
      { 1100281001;Label  ;0    ;2860 ;3630 ;440  ;CaptionML=[ENU=Show Ref. Apply;
                                                              FRA=Afficher r‚f. lettrage] }
      { 1100281002;CheckBox;3740;0    ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=[ENU=Excel export;
                                                              FRA=Export excel];
                                                   SourceExpr=ExportExcel }
      { 1100281003;Label  ;0    ;0    ;3630 ;440  ;ParentControl=1100281002 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=Period: %1;FRA=P‚riode : %1';
      CreateCustLedgEntry@1000000002 : Record 21;
      ExcelBuffer@1000000010 : TEMPORARY Record 370;
      CustLedEntryCumul@1100281001 : Record 21;
      CustLedEntryApply@1100281000 : Record 21;
      PrintOnlyOnePerPage@1002 : Boolean;
      PrintAllHavingBal@1003 : Boolean;
      ShowRefApply@1000000011 : Boolean;
      AllowCustTransHead@1000000007 : Boolean;
      TransfooterLedger@1000000004 : Boolean;
      CustLedgEntryExists@1000000003 : Boolean;
      ToutesEcr@1000000000 : Boolean;
      ExportExcel@1000000015 : Boolean;
      PrintOne@1100281004 : Boolean;
      EndDate@1000000001 : Date;
      CustCurrencyCode@1000000014 : Code[10];
      CustFilter@1004 : Text[250];
      FiltreDate@1000000005 : Text[30];
      FiltreGestion@1000000006 : Text[30];
      RefApply@1000000008 : Text[50];
      Indication@1000000009 : Text[1];
      CustBalanceLCY@1000000013 : Decimal;
      StartBalanceLCY@1000000012 : Decimal;
      Text0001@1000000028 : TextConst 'ENU=Customer No.;FRA=Nø client';
      Text0002@1000000029 : TextConst 'ENU=Customer Search Name;FRA=Nom recherche client';
      Text0003@1000000030 : TextConst 'ENU=Starting Balance;FRA=Solde d‚but';
      Text001@1000000016 : TextConst 'ENU=Posting Date;FRA=Date de comptabilisation';
      Text002@1000000017 : TextConst 'ENU=Due Date;FRA=Date d''‚ch‚ance';
      Text003@1000000018 : TextConst 'ENU=Source Code;FRA=Code journal';
      Text004@1000000019 : TextConst 'ENU=Doc. Type;FRA=Type doc.';
      Text005@1000000020 : TextConst 'ENU=Document No.;FRA=Nø document';
      Text006@1000000021 : TextConst 'ENU=Description;FRA=D‚signation';
      Text007@1000000022 : TextConst 'ENU=Debit;FRA=D‚bit';
      Text008@1000000023 : TextConst 'ENU=Credit;FRA=Cr‚dit';
      Text009@1000000024 : TextConst 'ENU=Balance;FRA=Solde';
      Text010@1000000025 : TextConst 'ENU=Apply Ref.;FRA=Ref. lettrage';
      TotalLettre@1100281002 : Decimal;
      ExcelLineNo@1000000026 : Integer;
      Text011@1000000027 : TextConst 'ENU=Total (LCY) Before Period;FRA=Total avant p‚riode';
      Glo_cumul@1100281006 : Record 21;
      Glo_apply@1100281003 : Record 21;
      FilterEntry@1100281005 : ARRAY [10] OF Text[1024];

    PROCEDURE ConvertNumber@1000000005(Number@1000000000 : Decimal) : Text[50];
    VAR
      locFormat@1000000001 : Text[50];
      locFromCar@1000000004 : TextConst 'FRA=.';
      locToCar@1000000005 : TextConst 'FRA=,';
    BEGIN
      locFormat := '<Sign><Integer><Decimals>';

      EXIT(FORMAT(Number,0,locFormat));
      //EXIT(CONVERTSTR(FORMAT(Number,0,locFormat),locFromCar,locToCar));
    END;

    PROCEDURE InsertRow@1000000000(RowNo@1000000000 : Integer;ColumnNo@1000000001 : Integer;CellValue@1000000002 : Text[250];NbFormat@1000000003 : Text[30]);
    BEGIN
      ExcelBuffer.INIT;
      ExcelBuffer.VALIDATE("Row No.",RowNo);
      ExcelBuffer.VALIDATE("Column No.",ColumnNo);
      ExcelBuffer."Cell Value as Text" := CellValue;
      ExcelBuffer.NumberFormat := NbFormat;
      ExcelBuffer.Formula := '';
      ExcelBuffer.INSERT;
    END;

    PROCEDURE InsertRowWithBold@1000000001(RowNo@1000000000 : Integer;ColumnNo@1000000001 : Integer;CellValue@1000000002 : Text[250];NbFormat@1000000003 : Text[30]);
    BEGIN
      ExcelBuffer.INIT;
      ExcelBuffer.VALIDATE("Row No.",RowNo);
      ExcelBuffer.VALIDATE("Column No.",ColumnNo);
      ExcelBuffer."Cell Value as Text" := CellValue;
      ExcelBuffer.NumberFormat := NbFormat;
      ExcelBuffer.Bold := TRUE;
      ExcelBuffer.Formula := '';
      ExcelBuffer.INSERT;
    END;

    PROCEDURE ViewExcel@1000000002(Name@1000000000 : Text[30]);
    BEGIN
      ExcelBuffer.CreateBook;
      ExcelBuffer.CreateSheet(Name,Name,'','');
      ExcelBuffer.GiveUserControl;
      CLEAR(ExcelBuffer);
    END;

    PROCEDURE CreateExcelBuffer@1000000004();
    BEGIN
      ExcelBuffer.DELETEALL;
      CLEAR(ExcelBuffer);
    END;

    PROCEDURE SetFilterLedger@1000000006(ByInit@1000000000 : Integer);
    VAR
      Loc_apply2@1000000001 : Record 21;
    BEGIN
      //Cette fonction doit permettre de constituer le filtre qui va bien pour l'ensemble des ‚criture li‚ par un lettrage
      //FilterEntry:=STRSUBSTNO('%1',ByInit);
          IF NOT existe(ByInit) THEN  BEGIN
            descendant(ByInit);
            ascendant(ByInit);
          END;
    END;

    PROCEDURE descendant@1000000007(ByInit@1000000002 : Integer);
    VAR
      loc_apply2@1000000001 : Record 21;
    BEGIN
         Ajout(ByInit);
         loc_apply2.GET(ByInit);
         IF loc_apply2."Closed by Entry No."<>0 THEN
            IF NOT existe(loc_apply2."Closed by Entry No.") THEN
              SetFilterLedger(loc_apply2."Closed by Entry No.")
         ELSE
            Glo_apply:=loc_apply2;
    END;

    PROCEDURE ascendant@1000000008(ByInit@1000000000 : Integer);
    VAR
      loc_apply2@1000000001 : Record 21;
    BEGIN
         Ajout(ByInit);
         loc_apply2.SETCURRENTKEY("Customer No.","Posting Date");
         loc_apply2.SETRANGE("Customer No.",Customer."No.");
         loc_apply2.SETRANGE("Closed by Entry No.",ByInit);
         IF loc_apply2.FIND('-') THEN BEGIN
           REPEAT
            IF loc_apply2."Closed by Entry No."=0 THEN Glo_apply:=loc_apply2;
            IF NOT existe(loc_apply2."Entry No.") THEN
              SetFilterLedger(loc_apply2."Entry No.");
           UNTIL loc_apply2.NEXT=0;
         END;
    END;

    PROCEDURE existe@1000000009(ByInit@1000000000 : Integer) : Boolean;
    VAR
      loc_filter@1000000001 : Text[1000];
      i@1100281000 : Integer;
    BEGIN
      FOR i := 1 TO 10 DO BEGIN
         loc_filter:=FilterEntry[i] + '|';
         IF STRPOS(loc_filter,STRSUBSTNO('|%1|',FORMAT(ByInit)))<>0 THEN
            EXIT(TRUE);
      END;
      EXIT(FALSE);
    END;

    PROCEDURE Ajout@1100281000(ByInit@1100281000 : Integer);
    VAR
      i@1100281001 : Integer;
    BEGIN
      IF NOT existe(ByInit) THEN BEGIN
         FOR i:=1 TO 10 DO BEGIN
           IF STRLEN(FilterEntry[i])<500 THEN BEGIN
            FilterEntry[i]:=STRSUBSTNO('%1|%2',FilterEntry[i],ByInit);
              EXIT;
           END;
         END;
      END;
    END;

    BEGIN
    {
      /** @r IMH01 @d 06/01/11 @a ISAT.MA @v IMH6.01.040 @s Isatech+ */
    }
    END.
  }
  RDLDATA
  {
  }
}