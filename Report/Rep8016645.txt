OBJECT Report 8016645 Fiche Immo - loi d'amt
{
  OBJECT-PROPERTIES
  {
    Date=18/09/12;
    Time=15:21:34;
    Modified=Yes;
    Version List=ISA6.00,IMISAT6.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Fixed Asset - Card;
               FRA=Immobilisations - Fiche lois];
    OnPreReport=BEGIN
                  FAFilter := "Fixed Asset".GETFILTERS;
                END;

    Orientation=Landscape;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table5600;
        DataItemTableView=SORTING(No.);
        NewPagePerGroup=No;
        NewPagePerRecord=Yes;
        PrintOnlyIfDetail=Yes;
        OnPreDataItem=BEGIN
                        R370.DELETEALL;
                        CreateHeader := TRUE;
                        IF CreateXl THEN
                           IF (COUNT > 1) THEN
                              ERROR('Vous ne pouvez s‚lectionner qu''une seule immobilisation en mode Excel !');
                      END;

        OnAfterGetRecord=BEGIN
                           IF NOT Vendor.GET("Vendor No.") THEN
                             CLEAR(Vendor);

                           IF Inactive THEN
                             CurrReport.SKIP;
                           IF "Main Asset/Component" <> "Main Asset/Component"::" " THEN
                             ComponentFieldname := FIELDCAPTION("Component of Main Asset")
                           ELSE
                             ComponentFieldname := '';
                           IF "Budgeted Asset" THEN
                             BudgetedAssetFieldname := FIELDCAPTION("Budgeted Asset")
                           ELSE
                             BudgetedAssetFieldname := '';
                           IF "Serial No." <> '' THEN
                             SerialNoFieldname := FIELDCAPTION("Serial No.")
                           ELSE
                             SerialNoFieldname := '';

                           RecFALedgerEntry.SETFILTER("FA No.","Fixed Asset"."No.");
                           RecFALedgerEntry.SETFILTER(RecFALedgerEntry."FA Posting Type",'%1',RecFALedgerEntry."FA Posting Type"::"Acquisition Cost");
                           IF RecFALedgerEntry.FIND('-') THEN
                              BEGIN
                              NoDoc := RecFALedgerEntry."Document No.";
                              END
                           ELSE
                              NoDoc := '';

                           IF RecFAPostingGroup.GET("Fixed Asset"."FA Posting Group") THEN
                              NoCompte := RecFAPostingGroup."Acquisition Cost Account"
                           ELSE
                              NoCompte := '';

                           FADeprBook.SETRANGE("FA No.","Fixed Asset"."No.");
                           FADeprBook.SETFILTER("Disposal Date",'<>%1',0D);
                           IF FADeprBook.FIND('-') THEN
                             SOld := TRUE
                           ELSE
                             SOld := FALSE;
                         END;

        OnPostDataItem=BEGIN
                         IF CreateXl THEN BEGIN
                           FASetup.GET;
                           IF ((FASetup."R50043.Filemane" <> '') AND (FASetup."R50043.Sheet" <> '')) THEN
                              R370.OpenBook(FASetup."R50043.Filemane",FASetup."R50043.Sheet")
                           ELSE
                              R370.CreateBook;
                           R370.CreateSheet('50043','Immobilisation',COMPANYNAME,USERID);
                           R370.GiveUserControl;
                         END;
                       END;

        ReqFilterFields=No.,FA Class Code,FA Subclass Code,Budgeted Asset;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=25800;
            SectionHeight=1692;
          }
          CONTROLS
          {
            { 1   ;Label        ;0    ;0    ;7500 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Fixed Asset - List;
                                                                    FRA=Fiche Immobilisation] }
            { 2   ;TextBox      ;22650;0    ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 3   ;TextBox      ;0    ;846  ;7500 ;423  ;FontSize=11;
                                                         FontBold=Yes;
                                                         SourceExpr=COMPANYNAME }
            { 4   ;TextBox      ;25350;423  ;450  ;423  ;CaptionML=[ENU=Page;
                                                                    FRA=Page];
                                                         SourceExpr=CurrReport.PAGENO }
            { 5   ;Label        ;24600;423  ;750  ;423  ;ParentControl=4 }
            { 6   ;TextBox      ;23550;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=25800;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT((CurrReport.PAGENO = 1) AND (FAFilter <> ''));
                         END;

          }
          CONTROLS
          {
            { 19  ;TextBox      ;0    ;0    ;5700 ;423  ;HorzAlign=Left;
                                                         FontSize=7;
                                                         FontBold=No;
                                                         SourceExpr="Fixed Asset".TABLECAPTION + ': ' + FAFilter }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=25800;
            SectionHeight=2538;
            OnPostSection=BEGIN
                            IF (CreateXl) THEN
                            BEGIN
                               XlLine;
                               VLine += 1;
                               R370.INIT;
                               R370.VALIDATE("Row No.",VLine);
                               R370.VALIDATE("Column No.",3);
                               R370.Bold := TRUE;
                               R370."Cell Value as Text" := 'IMMOBILISATION Nø ' + FORMAT("No.");
                               R370.INSERT;
                               R370.VALIDATE("Column No.",1);
                               R370.VALIDATE("Row No.",VLine+1);
                               R370."Cell Value as Text" := 'Description';
                               R370.INSERT;

                               R370.Bold := TRUE;
                               R370.VALIDATE("Column No.",3);
                               R370.VALIDATE("Row No.",VLine+1);
                               R370."Cell Value as Text" := Description;
                               R370.INSERT;
                               R370.Bold := FALSE;
                               R370.VALIDATE("Row No.",VLine+2);
                               R370."Cell Value as Text" := 'S/N : ' + "Serial No.";
                               R370.INSERT;
                               VLine += 3;
                            END;
                          END;

          }
          CONTROLS
          {
            { 8   ;TextBox      ;3150 ;846  ;2400 ;423  ;Visible=No;
                                                         HorzAlign=Left;
                                                         FontBold=Yes;
                                                         SourceExpr="No." }
            { 9   ;Label        ;0    ;846  ;3000 ;423  ;Visible=No;
                                                         ParentControl=8;
                                                         FontBold=Yes }
            { 11  ;TextBox      ;5550 ;1692 ;12600;423  ;HorzAlign=Left;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=Description }
            { 29  ;TextBox      ;16650;846  ;1500 ;423  ;HorzAlign=Left;
                                                         FontBold=Yes;
                                                         SourceExpr="Main Asset/Component" }
            { 10  ;TextBox      ;14100;846  ;2250 ;423  ;FontBold=Yes;
                                                         SourceExpr=BudgetedAssetFieldname }
            { 38  ;TextBox      ;5550 ;2115 ;9300 ;423  ;HorzAlign=Left;
                                                         FontBold=Yes;
                                                         SourceExpr='S/N : ' +"Serial No." }
            { 1000000002;Label  ;0    ;1692 ;5550 ;423  ;FontSize=10;
                                                         FontBold=Yes;
                                                         FontItalic=No;
                                                         CaptionML=FRA=D‚signation : }
            { 1000000003;Shape  ;0    ;1269 ;25650;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000011;TextBox;11850;0    ;5700 ;846  ;HorzAlign=Left;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         SourceExpr="No." }
            { 1000000001;Shape  ;6750 ;0    ;11250;846  ;BorderWidth=1pt }
            { 1000000013;TextBox;7050 ;0    ;4800 ;846  ;HorzAlign=Right;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         SourceExpr="Fixed Asset".TABLECAPTION + ': ' }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=25800;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT("Main Asset/Component" = "Main Asset/Component"::Component);
                         END;

            OnPostSection=BEGIN
                            IF (CreateXl) THEN
                            BEGIN
                               R370.INIT;
                               R370.VALIDATE("Row No.",VLine);
                               R370.VALIDATE("Column No.",1);
                               R370.Bold := TRUE;
                               R370."Cell Value as Text" := 'Nø composant immo. principal';
                               R370.INSERT;
                               R370.VALIDATE("Column No.",3);
                               R370.Bold := FALSE;
                               R370."Cell Value as Text" := "Component of Main Asset";
                               R370.INSERT;
                               VLine += 1;
                            END;
                          END;

          }
          CONTROLS
          {
            { 32  ;TextBox      ;5550 ;0    ;12450;423  ;HorzAlign=Left;
                                                         FontSize=10;
                                                         SourceExpr="Component of Main Asset" }
            { 7   ;TextBox      ;0    ;0    ;5550 ;423  ;FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=ComponentFieldname }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=25800;
            SectionHeight=5076;
            OnPostSection=BEGIN
                            IF (CreateXl) THEN
                            BEGIN
                               VLine += 1;
                               R370.INIT;
                               R370.VALIDATE("Row No.",VLine);
                               R370.VALIDATE("Column No.",1);
                               R370.Bold := TRUE;
                               R370."Cell Value as Text" := 'Num‚ro du compte :';
                               R370.INSERT;
                               R370.VALIDATE("Row No.",VLine+1);
                               R370."Cell Value as Text" := 'Code classe immo. :';
                               R370.INSERT;
                               R370.VALIDATE("Row No.",VLine+2);
                               R370."Cell Value as Text" := 'Code sous-classe immo. :';
                               R370.INSERT;
                               R370.VALIDATE("Row No.",VLine+3);
                               R370."Cell Value as Text" := 'Code emplacement immo. :';
                               R370.INSERT;
                               R370.VALIDATE("Row No.",VLine+5);
                               R370."Cell Value as Text" := 'Nø docuement :';
                               R370.INSERT;
                               R370.VALIDATE("Row No.",VLine+6);
                               R370."Cell Value as Text" := 'Fournisseur : ';
                               R370.INSERT;
                               R370.VALIDATE("Row No.",VLine+7);
                               R370."Cell Value as Text" := 'C‚d‚';
                               R370.INSERT;

                               R370.VALIDATE("Row No.",VLine);
                               R370.VALIDATE("Column No.",3);
                               R370.Bold := FALSE;
                               R370."Cell Value as Text" := NoCompte;
                               R370.INSERT;
                               R370.VALIDATE("Row No.",VLine+1);
                               R370."Cell Value as Text" := "FA Class Code";
                               R370.INSERT;
                               R370.VALIDATE("Row No.",VLine+2);
                               R370."Cell Value as Text" := "FA Subclass Code";
                               R370.INSERT;
                               R370.VALIDATE("Row No.",VLine+3);
                               R370."Cell Value as Text" := "FA Location Code";
                               R370.INSERT;
                               R370.VALIDATE("Row No.",VLine+5);
                               R370."Cell Value as Text" := NoDoc;
                               R370.INSERT;
                               R370.VALIDATE("Row No.",VLine+6);
                               R370."Cell Value as Text" := "Vendor No." + ' ' + Vendor.Name;
                               R370.INSERT;
                               R370.VALIDATE("Row No.",VLine+7);
                               R370."Cell Value as Text" := FORMAT(SOld);
                               R370.INSERT;


                               R370.VALIDATE("Column No.",7);
                               R370.Bold := TRUE;
                               R370.VALIDATE("Row No.",VLine+2);
                               R370."Cell Value as Text" := 'Code axe principal 1';
                               R370.INSERT;
                               R370.VALIDATE("Row No.",VLine+3);
                               R370."Cell Value as Text" := 'Code axe principal 2';
                               R370.INSERT;

                               R370.VALIDATE("Column No.",8);
                               R370.Bold := FALSE;
                               R370.VALIDATE("Row No.",VLine+1);
                               R370."Cell Value as Text" := "Global Dimension 1 Code";
                               R370.INSERT;
                               R370.VALIDATE("Row No.",VLine+2);
                               R370."Cell Value as Text" := "Global Dimension 2 Code";
                               R370.INSERT;

                               VLine += 9;
                            END;
                          END;

          }
          CONTROLS
          {
            { 20  ;TextBox      ;16650;846  ;1500 ;423  ;Visible=No;
                                                         HorzAlign=Left;
                                                         SourceExpr="Global Dimension 1 Code" }
            { 21  ;Label        ;13500;846  ;3000 ;423  ;Visible=No;
                                                         ParentControl=20 }
            { 23  ;TextBox      ;16650;1269 ;1500 ;423  ;Visible=No;
                                                         HorzAlign=Left;
                                                         SourceExpr="Global Dimension 2 Code" }
            { 24  ;Label        ;13500;1269 ;3000 ;423  ;Visible=No;
                                                         ParentControl=23 }
            { 14  ;TextBox      ;5550 ;846  ;7950 ;423  ;HorzAlign=Left;
                                                         FontSize=10;
                                                         SourceExpr="FA Class Code" }
            { 15  ;Label        ;0    ;846  ;5550 ;423  ;ParentControl=14;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=FRA=Code classe immo. : }
            { 17  ;TextBox      ;5550 ;1269 ;7950 ;423  ;HorzAlign=Left;
                                                         FontSize=10;
                                                         SourceExpr="FA Subclass Code" }
            { 18  ;Label        ;0    ;1269 ;5550 ;423  ;ParentControl=17;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=FRA=Code sous-classe immo. : }
            { 26  ;TextBox      ;5550 ;1692 ;7950 ;423  ;HorzAlign=Left;
                                                         FontSize=10;
                                                         SourceExpr="FA Location Code" }
            { 27  ;Label        ;0    ;1692 ;5550 ;423  ;ParentControl=26;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=FRA=Code emplacement immo. : }
            { 1000000006;Shape  ;0    ;0    ;25650;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000000;TextBox;5550 ;2961 ;7950 ;423  ;FontSize=10;
                                                         SourceExpr="Vendor No." + '  '+Vendor.Name }
            { 1000000004;Label  ;0    ;2961 ;5550 ;423  ;ParentControl=1000000000;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Vendor :;
                                                                    FRA=Fournisseur :] }
            { 1000000007;Label  ;0    ;2538 ;5550 ;423  ;VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=FRA=Nø Document : }
            { 1000000005;TextBox;5550 ;2538 ;7950 ;423  ;HorzAlign=Left;
                                                         FontSize=10;
                                                         SourceExpr=NoDoc }
            { 1000000012;TextBox;5550 ;423  ;7950 ;423  ;HorzAlign=Left;
                                                         FontSize=10;
                                                         FontBold=No;
                                                         SourceExpr=NoCompte }
            { 1000000014;Label  ;0    ;423  ;5550 ;423  ;ParentControl=1000000012;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=FRA=Num‚ro du compte : }
            { 1000000008;Shape  ;0    ;2115 ;25650;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1100281003;Shape  ;0    ;3807 ;25650;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1100281004;TextBox;5550 ;3384 ;7950 ;423  ;FontSize=10;
                                                         CaptionML=[ENU=Sold;
                                                                    FRA=C‚d‚];
                                                         SourceExpr=SOld }
            { 1100281005;Label  ;0    ;3384 ;5550 ;423  ;ParentControl=1100281004;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Sold :;
                                                                    FRA=C‚d‚ :] }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table5612;
        DataItemTableView=SORTING(FA No.,Depreciation Book Code);
        OnPreDataItem=BEGIN
                        SETRANGE("FA No.","Fixed Asset"."No.");
                      END;

        OnAfterGetRecord=BEGIN
                           CLEAR(Method);
                           IF ("No. of Depreciation Years" <> 0) THEN
                           CASE "Depreciation Method" OF
                              "Depreciation Method"::"Straight-Line": Method := 'L ' +
                                         FORMAT(ROUND(100 / "No. of Depreciation Years",0.01),0,'<Precision,1:1><Standard Format,0>');
                              "Depreciation Method"::"Declining-Balance 1": Method := 'D ' +
                                         FORMAT("Declining-Balance %",0,'<Precision,1:1><Standard Format,0>');
                              "Depreciation Method"::"DB1/SL": Method := 'DL ' +
                                         FORMAT("Declining-Balance %",0,'<Precision,1:1><Standard Format,0>');
                           END;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=25800;
            SectionHeight=1692;
            OnPostSection=BEGIN
                            IF (CreateXl) THEN
                            BEGIN
                               R370.INIT;
                               R370.VALIDATE("Row No.",VLine);
                               R370.VALIDATE("Column No.",1);
                               R370.Bold := TRUE;
                               R370."Cell Value as Text" := 'Loi';
                               R370.INSERT;
                               R370.VALIDATE("Column No.",2);
                               R370."Cell Value as Text" := 'Date acquisition';
                               R370.INSERT;
                               R370.VALIDATE("Column No.",3);
                               R370."Cell Value as Text" := 'Date D‚but amortissement';
                               R370.INSERT;
                               R370.VALIDATE("Column No.",4);
                               R370."Cell Value as Text" := 'Date fin amortissement';
                               R370.INSERT;
                               R370.VALIDATE("Column No.",5);
                               R370."Cell Value as Text" := 'Date dernier amortissement';
                               R370.INSERT;
                               R370.VALIDATE("Column No.",6);
                               R370."Cell Value as Text" := 'M‚thode amortissement';
                               R370.INSERT;
                               R370.VALIDATE("Column No.",7);
                               R370."Cell Value as Text" := 'Dur‚e de vie (Ann‚e / mois)';
                               R370.INSERT;
                               R370.VALIDATE("Column No.",8);
                               R370."Cell Value as Text" := 'Co–t acquisition';
                               R370.INSERT;
                               R370.VALIDATE("Column No.",9);
                               R370."Cell Value as Text" := 'Amortissements cumul‚s';
                               R370.INSERT;
                               R370.VALIDATE("Column No.",10);
                               R370."Cell Value as Text" := 'VNC';
                               R370.INSERT;
                               VLine += 1;
                            END;
                          END;

          }
          CONTROLS
          {
            { 1100281000;Label  ;0    ;423  ;1500 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Code;
                                                                    FRA=Loi] }
            { 54  ;Label        ;3600 ;423  ;2100 ;846  ;ParentControl=44;
                                                         HorzAlign=Left;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Depr. Starting Date;
                                                                    FRA=Date d‚but amortissement] }
            { 64  ;Label        ;5850 ;423  ;1950 ;846  ;ParentControl=45;
                                                         HorzAlign=Left;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Depr. Ending DAte;
                                                                    FRA=Date fin amortissement] }
            { 53  ;Label        ;10050;423  ;2850 ;846  ;ParentControl=50;
                                                         HorzAlign=Left;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Depreciation Method;
                                                                    FRA=M‚thode amortissement] }
            { 1000000019;Label  ;13050;423  ;4200 ;846  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Duration (Years or Months);
                                                                    FRA=Dur‚e de Vie (Ann‚e/Mois)] }
            { 1000000010;Label  ;17400;423  ;2100 ;846  ;ParentControl=1000000009;
                                                         HorzAlign=Left;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Acquisition Cost;
                                                                    FRA=Co–t acquisition] }
            { 1000000024;Label  ;19800;423  ;2550 ;846  ;ParentControl=1000000023;
                                                         HorzAlign=Left;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Depreciation;
                                                                    FRA=Amortissements cumul‚s] }
            { 1000000026;Label  ;22650;423  ;2850 ;846  ;ParentControl=1000000025;
                                                         HorzAlign=Center;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Book Value;
                                                                    FRA=VNC] }
            { 1100281002;Label  ;7950 ;423  ;1950 ;846  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Last Depr. Date;
                                                                    FRA=Date dernier amortissement] }
            { 1000000016;Label  ;1650 ;423  ;1800 ;846  ;ParentControl=1000000015;
                                                         HorzAlign=Left;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Acquisition Date;
                                                                    FRA=Date acquisition] }
            { 1100281006;Shape  ;0    ;0    ;25650;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1100281007;Shape  ;0    ;1269 ;25650;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1100281008;Shape  ;0    ;210  ;30   ;1482 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281009;Shape  ;1350 ;210  ;300  ;1482 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281010;Shape  ;3300 ;210  ;300  ;1482 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281011;Shape  ;5550 ;210  ;300  ;1482 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281012;Shape  ;7650 ;210  ;300  ;1482 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281013;Shape  ;9750 ;210  ;300  ;1482 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281014;Shape  ;12750;210  ;300  ;1482 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281015;Shape  ;17100;210  ;300  ;1482 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281016;Shape  ;19500;210  ;300  ;1482 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281017;Shape  ;22350;210  ;300  ;1482 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281018;Shape  ;25500;210  ;300  ;1482 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=25800;
            SectionHeight=423;
            OnPostSection=BEGIN
                            IF (CreateXl) THEN
                            BEGIN
                               R370.INIT;
                               R370.VALIDATE("Row No.",VLine);
                               R370.VALIDATE("Column No.",1);
                               R370.Bold := FALSE;
                               R370."Cell Value as Text" := "Depreciation Book Code";
                               R370.INSERT;
                               R370.VALIDATE("Column No.",2);
                               R370."Cell Value as Text" := FORMAT("Acquisition Date");
                               R370.INSERT;
                               R370.VALIDATE("Column No.",3);
                               R370."Cell Value as Text" := FORMAT("Depreciation Starting Date");
                               R370.INSERT;
                               R370.VALIDATE("Column No.",4);
                               R370."Cell Value as Text" := FORMAT("Depreciation Ending Date");
                               R370.INSERT;
                               R370.VALIDATE("Column No.",5);
                               R370."Cell Value as Text" := FORMAT("Last Depreciation Date");
                               R370.INSERT;
                               R370.VALIDATE("Column No.",6);
                               R370."Cell Value as Text" := Method;
                               R370.INSERT;
                               R370.VALIDATE("Column No.",7);
                               R370."Cell Value as Text" :=
                               FORMAT("No. of Depreciation Years",0,'<Precision,0:2><Standard Format,0>') + ' ' + FORMAT(Text50151) + ' - ' +
                               FORMAT("No. of Depreciation Months",0,'<Precision,0:2><Standard Format,0>') + ' ' +  FORMAT(Text50152);
                               R370.INSERT;
                               R370.VALIDATE("Column No.",8);
                               R370."Cell Value as Text" := FORMAT("Acquisition Cost");
                               R370.INSERT;
                               R370.VALIDATE("Column No.",9);
                               R370."Cell Value as Text" := FORMAT(Depreciation);
                               R370.INSERT;
                               R370.VALIDATE("Column No.",10);
                               R370."Cell Value as Text" := FORMAT("Book Value");
                               R370.INSERT;
                               VLine += 1;
                            END;
                          END;

          }
          CONTROLS
          {
            { 1000000015;TextBox;1500 ;0    ;1950 ;423  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         SourceExpr="Acquisition Date" }
            { 44  ;TextBox      ;3600 ;0    ;2100 ;423  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         SourceExpr="Depreciation Starting Date" }
            { 45  ;TextBox      ;5850 ;0    ;1950 ;423  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         SourceExpr="Depreciation Ending Date" }
            { 50  ;TextBox      ;10050;0    ;2850 ;423  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         CaptionML=[ENU=Depr. Method;
                                                                    FRA=M‚thode amt];
                                                         SourceExpr=Method }
            { 25  ;TextBox      ;13050;0    ;1800 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         DecimalPlaces=2:;
                                                         SourceExpr=FORMAT("No. of Depreciation Years",0,'<Precision,0:2><Standard Format,0>') + ' ' + FORMAT(Text50151) }
            { 1000000021;Label  ;15000;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         CaptionML=[ENU=or;
                                                                    FRA=-] }
            { 28  ;TextBox      ;15450;0    ;1650 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         DecimalPlaces=2:;
                                                         SourceExpr=FORMAT("No. of Depreciation Months",0,'<Precision,0:2><Standard Format,0>') + ' ' +  FORMAT(Text50152) }
            { 22  ;TextBox      ;0    ;0    ;1350 ;423  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         SourceExpr="Depreciation Book Code" }
            { 1000000009;TextBox;17400;0    ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr="Acquisition Cost" }
            { 1000000023;TextBox;19800;0    ;2550 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         SourceExpr=Depreciation }
            { 1000000025;TextBox;22500;0    ;3000 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         SourceExpr="Book Value" }
            { 1100281001;TextBox;7950 ;0    ;1950 ;423  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         SourceExpr="Last Depreciation Date" }
            { 1100281019;Shape  ;25500;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281022;Shape  ;22350;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281024;Shape  ;19500;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281025;Shape  ;17100;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281028;Shape  ;12750;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281030;Shape  ;9750 ;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281032;Shape  ;7650 ;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281033;Shape  ;5550 ;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281036;Shape  ;3300 ;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281037;Shape  ;1350 ;0    ;300  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281039;Shape  ;0    ;0    ;30   ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=25800;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 1000000020;Shape  ;0    ;0    ;25650;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table97;
        DataItemTableView=SORTING(Table Name,No.,Line No.)
                          WHERE(Table Name=CONST(Fixed Asset));
        DataItemLink=No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=25800;
            SectionHeight=846;
            OnPostSection=BEGIN
                            IF (CreateXl) THEN
                            BEGIN
                               VLine += 2;
                               R370.INIT;
                               R370.VALIDATE("Row No.",VLine);
                               R370.VALIDATE("Column No.",1);
                               R370.Bold := TRUE;
                               R370."Cell Value as Text" := 'Observations';
                               R370.INSERT;
                               VLine += 1;
                            END;
                          END;

          }
          CONTROLS
          {
            { 1000000029;Label  ;0    ;423  ;5550 ;423  ;HorzAlign=Left;
                                                         VertAlign=Center;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=FRA=Observations: }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=25800;
            SectionHeight=423;
            OnPostSection=BEGIN
                            IF (CreateXl) THEN
                            BEGIN
                               R370.INIT;
                               R370.VALIDATE("Row No.",VLine);
                               R370.VALIDATE("Column No.",1);
                               R370.Bold := FALSE;
                               R370."Cell Value as Text" := FORMAT(Date) + ' - ' + FORMAT(Comment);
                               R370.INSERT;
                               VLine += 1;
                            END;
                          END;

          }
          CONTROLS
          {
            { 1000000030;TextBox;2250 ;0    ;15750;423  ;FontSize=9;
                                                         SourceExpr=Comment }
            { 1000000032;TextBox;0    ;0    ;1800 ;423  ;FontSize=9;
                                                         SourceExpr=Date }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemTable=Table5606;
      }
      SECTIONS
      {
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=6930;
      Height=990;
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1000000000;Label  ;0    ;0    ;3740 ;440  ;ParentControl=1000000001 }
      { 1000000001;CheckBox;3850;0    ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=FRA=Export vers Microsoft Excel;
                                                   SourceExpr=CreateXl }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      FASetup@1000 : Record 5603;
      DeprBook@1001 : Record 5611;
      FADeprBook@1100281004 : Record 5612;
      Vendor@1100281000 : Record 23;
      FAFilter@1004 : Text[250];
      ComponentFieldname@1005 : Text[100];
      BudgetedAssetFieldname@1006 : Text[100];
      SerialNoFieldname@1007 : Text[100];
      NoDoc@1000000000 : Code[20];
      NoCompte@1000000001 : Code[10];
      RecFALedgerEntry@1000000002 : Record 5601;
      RecFAPostingGroup@1000000003 : Record 5606;
      Text50151@1000000004 : TextConst 'FRA=an(s)';
      Text50152@1000000005 : TextConst 'FRA=mois';
      Method@1100281001 : Code[20];
      DeprMethod@1100281002 : 'L,D1,D2,D1L,D2L,P,M';
      SOld@1100281003 : Boolean;
      R370@1100281005 : TEMPORARY Record 370;
      VLine@1100281006 : Integer;
      VColumn@1100281007 : Integer;
      CreateXl@1100281008 : Boolean;
      CreateHeader@1000000006 : Boolean;
      "fa setup"@1000000007 : Record 5603;

    PROCEDURE XlHeader@1100281000();
    VAR
      XlHead1@1100281000 : TextConst 'FRA=Fiche d''immobilisation';
    BEGIN
      R370.INIT;
      R370.VALIDATE("Row No.",1);
      R370.VALIDATE("Column No.",1);
      R370."Cell Value as Text" := XlHead1;
      R370.INSERT;
      R370.VALIDATE("Column No.",10);
      R370."Cell Value as Text" := FORMAT(TODAY,0,'<Day> <Month text> <Year4>');
      R370.Bold := TRUE;
      R370.INSERT;
      R370.VALIDATE("Row No.",2);
      R370.VALIDATE("Column No.",1);
      R370.Bold := TRUE;
      R370."Cell Value as Text" := COMPANYNAME;
      R370.Bold := TRUE;
      R370.INSERT;
      R370.Bold := FALSE;
      R370.VALIDATE("Column No.",10);
      R370."Cell Value as Text" := FORMAT(USERID);
      R370.Bold := TRUE;
      R370.INSERT;
      R370.VALIDATE("Row No.",3);
      R370.VALIDATE("Column No.",1);
      R370."Cell Value as Text" := FORMAT(USERID);
      R370.Bold := TRUE;
      R370.INSERT;
    END;

    PROCEDURE XlLine@1100281001();
    BEGIN
      FASetup.GET;
      IF CreateHeader AND FASetup."R50043.Init" THEN
         XlHeader;
      CreateHeader := FALSE;
      VLine := 4;
    END;

    BEGIN
    {
      /** @r IMH01 @d 06/07/11 @a ISAT.ST @v IMH6.01.151 @s Immobilisation */
    }
    END.
  }
  RDLDATA
  {
  }
}