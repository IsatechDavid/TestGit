OBJECT Report 8016648 Reminder Isatech + V2
{
  OBJECT-PROPERTIES
  {
    Date=20/02/14;
    Time=14:48:50;
    Modified=Yes;
    Version List=ISA6.00,IMH6.01.08;
  }
  PROPERTIES
  {
    CaptionML=[ENU=GMS Reminder;
               FRA=Relance Isatech + V2];
    TopMargin=800;
    BottomMargin=800;
    LeftMargin=800;
    RightMargin=200;
    OnInitReport=BEGIN
                   GLSetup.GET;
                 END;

  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table297;
        DataItemTableView=SORTING(No.);
        NewPagePerRecord=Yes;
        ReqFilterHeadingML=[ENU=Reminder;
                            FRA=Relance];
        OnPreDataItem=BEGIN
                        CompanyInfo.GET;
                        CompanyInfo.CALCFIELDS(Picture);
                        FormatAddrCodeunit.Company(CompanyAddr,CompanyInfo);
                      END;

        OnAfterGetRecord=BEGIN
                           CurrReport.LANGUAGE := Language.GetLanguageID("Language Code");

                           FormatAddr(CustAddr);

                           IF "Your Reference" = '' THEN
                             ReferenceText := ''
                           ELSE
                             ReferenceText := 'V/Ref   :';

                           IF Customer.GET("Customer No.") THEN BEGIN
                             IF Customer."Our Account No." = '' THEN BEGIN
                               ReferenceText := '';
                             END ELSE BEGIN
                               ReferenceText := 'V/Ref : ' ;
                             END;
                           END;

                           IF "Currency Code" = '' THEN BEGIN
                             GLSetup.TESTFIELD("LCY Code");
                             TotalInclVATText := STRSUBSTNO(Text001,GLSetup."LCY Code");
                             Devise := GLSetup."LCY Code";
                           END ELSE BEGIN
                             TotalInclVATText := STRSUBSTNO(Text001,"Currency Code");
                             Devise := "Currency Code";
                           END;
                           CurrReport.PAGENO := 1;


                           IF NOT CurrReport.PREVIEW THEN BEGIN
                             IF LogInteraction THEN
                               SegManagement.LogDocument(
                                 8,"No.",0,0,DATABASE::Customer,"Customer No.",'','',"Posting Description",'');
                             IncrNoPrinted;
                           END;
                         END;

        ReqFilterFields=No.;
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=24450;
            SectionHeight=10152;
            OnPreSection=BEGIN
                           LineCount +=24;  //IMH04
                         END;

          }
          CONTROLS
          {
            { 58  ;TextBox      ;4710 ;8037 ;2520 ;423  ;FontSize=9;
                                                         SourceExpr=Customer."Our Account No." }
            { 27  ;TextBox      ;4710 ;7614 ;2520 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr="Issued Reminder Header"."Customer No." }
            { 26  ;Label        ;2400 ;7614 ;2100 ;423  ;ParentControl=27;
                                                         FontSize=9;
                                                         CaptionML=FRA=Nø/Ref  : }
            { 17  ;TextBox      ;4710 ;5922 ;6300 ;423  ;FontSize=9;
                                                         CaptionML=[ENU=E-Mail :;
                                                                    FRA=E-mail :];
                                                         SourceExpr=CompanyInfo."DFC E-Mail" }
            { 16  ;Label        ;2400 ;5922 ;2100 ;423  ;ParentControl=17;
                                                         FontSize=9 }
            { 46  ;TextBox      ;12900;7191 ;6300 ;423  ;FontSize=9;
                                                         SourceExpr=CustAddr[8] }
            { 3   ;TextBox      ;12900;6768 ;6300 ;423  ;FontSize=9;
                                                         SourceExpr=CustAddr[7] }
            { 15  ;TextBox      ;12900;6345 ;6300 ;423  ;FontSize=9;
                                                         SourceExpr=CustAddr[6] }
            { 12  ;TextBox      ;12900;5922 ;6300 ;423  ;FontSize=9;
                                                         SourceExpr=CustAddr[5] }
            { 49  ;TextBox      ;2400 ;5076 ;6300 ;423  ;FontSize=9;
                                                         SourceExpr=CompanyAddr[5] }
            { 10  ;TextBox      ;12900;5499 ;6300 ;423  ;FontSize=9;
                                                         SourceExpr=CustAddr[4] }
            { 11  ;TextBox      ;2400 ;4653 ;6300 ;423  ;FontSize=9;
                                                         SourceExpr=CompanyAddr[4] }
            { 8   ;TextBox      ;12900;5076 ;6300 ;423  ;FontSize=9;
                                                         SourceExpr=CustAddr[3] }
            { 9   ;TextBox      ;2400 ;4230 ;6300 ;423  ;FontSize=9;
                                                         SourceExpr=CompanyAddr[3] }
            { 6   ;TextBox      ;12900;4653 ;6300 ;423  ;FontSize=9;
                                                         SourceExpr=CustAddr[2] }
            { 7   ;TextBox      ;2400 ;3807 ;6300 ;423  ;FontSize=9;
                                                         SourceExpr=CompanyAddr[2] }
            { 4   ;TextBox      ;12900;4230 ;6300 ;423  ;FontSize=9;
                                                         SourceExpr=CustAddr[1] }
            { 2   ;TextBox      ;17700;0    ;1680 ;423  ;FontSize=9;
                                                         SourceExpr=STRSUBSTNO(Text002,CurrReport.PAGENO) }
            { 1100281000;Label  ;2400 ;5499 ;2100 ;423  ;FontSize=9;
                                                         CaptionML=[ENU=Phone No. :;
                                                                    FRA=Nø t‚l‚phone :] }
            { 1100281001;TextBox;4710 ;5499 ;3990 ;423  ;FontSize=9;
                                                         CaptionML=[ENU=Phone No.;
                                                                    FRA=Nø t‚l‚phone];
                                                         SourceExpr=CompanyInfo."DFC Phone No." }
            { 1100281002;PictureBox;2400;0  ;8190 ;3384 ;SourceExpr=CompanyInfo.Picture }
            { 1100281004;Label  ;2400 ;7191 ;2100 ;423  ;FontSize=9;
                                                         CaptionML=FRA=Nø Rappel : }
            { 1100281005;TextBox;2400 ;8037 ;2100 ;423  ;FontSize=9;
                                                         SourceExpr=ReferenceText }
            { 1100281003;TextBox;4710 ;7191 ;2520 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr="Issued Reminder Header"."Reminder Level" }
            { 1100281008;TextBox;2400 ;8883 ;8400 ;423  ;FontSize=9;
                                                         SourceExpr=Text003 }
            { 1100281009;TextBox;2400 ;9306 ;3150 ;423  ;FontSize=9;
                                                         SourceExpr="Issued Reminder Header".Contact }
            { 1000000000;TextBox;12900;8037 ;8400 ;423  ;FontSize=9;
                                                         SourceExpr=STRSUBSTNO(Text004,CompanyInfo.City) }
            { 1000000001;TextBox;12900;8460 ;8400 ;423  ;FontSize=9;
                                                         SourceExpr=STRSUBSTNO(Text005,FORMAT("Issued Reminder Header"."Document Date",0,'<Standard Format,4>')) }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            PlaceInBottom=Yes;
            SectionWidth=24450;
            SectionHeight=1692;
            OnPreSection=BEGIN
                           LineCount += 4;  //IMH04
                         END;

          }
          CONTROLS
          {
            { 1000000002;TextBox;0    ;0    ;19350;423  ;Visible=Yes;
                                                         HorzAlign=Center;
                                                         FontName=Helvetica;
                                                         FontSize=8;
                                                         SourceExpr=CompanyAddr[1] + ' - '  + CompanyAddr[2] + ' - '  + CompanyAddr[3] + ' - '  + CompanyAddr[4]+ ' - '  + CompanyAddr[5]  + CompanyAddr[6];
                                                         DataSetFieldName=CompanyInfo_Name___________CompanyAddr_1_____CompanyAddr_2_____CompanyAddr_3_____CompanyAddr_4____CompanyAddr_5____CompanyAddr_6_ }
            { 1000000003;TextBox;0    ;423  ;19350;423  ;Visible=Yes;
                                                         HorzAlign=Center;
                                                         FontName=Helvetica;
                                                         FontSize=8;
                                                         SourceExpr=STRSUBSTNO(CompanyDesc,CompanyInfo."Legal Form",CompanyInfo."Stock Capital");
                                                         DataSetFieldName=STRSUBSTNO_CompanyDesc_CompanyInfo__Stock_Capital__ }
            { 1000000004;TextBox;0    ;846  ;19350;423  ;Visible=Yes;
                                                         HorzAlign=Center;
                                                         FontName=Helvetica;
                                                         FontSize=8;
                                                         SourceExpr=STRSUBSTNO(Text008,COPYSTR(CompanyInfo."Registration No.",1,9)  ,CompanyInfo."Registration No.",CompanyInfo."VAT Registration No.") }
            { 1000000005;TextBox;0    ;1269 ;19350;423  ;Visible=Yes;
                                                         HorzAlign=Center;
                                                         FontName=Helvetica;
                                                         FontSize=8;
                                                         SourceExpr=[STRSUBSTNO( PhoneNo,CompanyInfo."Phone No.") + ' - ' + STRSUBSTNO( FaxNo,CompanyInfo."Fax No.") ] }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table298;
        DataItemTableView=SORTING(Reminder No.,Line No.);
        DataItemVarName=Issued Reminder Line3;
        OnPreDataItem=BEGIN
                        IF FIND('-') THEN BEGIN
                          StartLineNo := 0;
                          REPEAT
                            Continue := Type = Type::" ";
                            IF Continue {AND (Description = '')} THEN
                              StartLineNo := "Line No.";
                          UNTIL (NEXT = 0) OR NOT Continue;
                        END;
                        IF FIND('+') THEN BEGIN
                          EndLineNo := "Line No." + 1;
                          REPEAT
                            Continue := Type = Type::" ";
                            IF Continue {AND (Description = '')} THEN
                              EndLineNo := "Line No.";
                          UNTIL (NEXT(-1) = 0) OR NOT Continue;
                        END;

                        SETFILTER("Line No.",'<=%1',StartLineNo);
                      END;

        DataItemLinkReference=Issued Reminder Header;
        DataItemLink=Reminder No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=24450;
            SectionHeight=423;
            OnPreSection=BEGIN
                           LineCount += 1;  //IMH04
                         END;

          }
          CONTROLS
          {
            { 1100281006;TextBox;2400 ;0    ;17850;423  ;HorzAlign=General;
                                                         FontSize=9;
                                                         SourceExpr=Description }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table298;
        DataItemTableView=SORTING(Reminder No.,Line No.);
        OnPreDataItem=BEGIN
                        IF FIND('-') THEN BEGIN
                          StartLineNo := 0;
                          REPEAT
                            Continue := Type = Type::" ";
                            IF Continue AND (Description = '') THEN
                              StartLineNo := "Line No.";
                          UNTIL (NEXT = 0) OR NOT Continue;
                        END;
                        IF FIND('+') THEN BEGIN
                          EndLineNo := "Line No." + 1;
                          REPEAT
                            Continue := Type = Type::" ";
                            IF Continue AND (Description = '') THEN
                              EndLineNo := "Line No.";
                          UNTIL (NEXT(-1) = 0) OR NOT Continue;
                        END;

                        VATAmountLine.DELETEALL;
                        SETFILTER("Line No.",'<%1',EndLineNo);
                        CurrReport.CREATETOTALS("Remaining Amount","VAT Amount",ReminderInterestAmount);
                      END;

        OnAfterGetRecord=BEGIN
                           VATAmountLine.INIT;
                           VATAmountLine."VAT Identifier" := "VAT Identifier";
                           VATAmountLine."VAT Calculation Type" := "VAT Calculation Type";
                           VATAmountLine."Tax Group Code" := "Tax Group Code";
                           VATAmountLine."VAT %" := "VAT %";
                           VATAmountLine."VAT Base" := Amount;
                           VATAmountLine."VAT Amount" := "VAT Amount";
                           VATAmountLine."Amount Including VAT" := Amount + "VAT Amount";
                           VATAmountLine.InsertLine;

                           CASE Type OF
                             Type::"G/L Account":
                               "Remaining Amount" := Amount;
                             Type::"Customer Ledger Entry":
                               ReminderInterestAmount := Amount;
                           END;
                         END;

        DataItemLinkReference=Issued Reminder Header;
        DataItemLink=Reminder No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=24450;
            SectionHeight=846;
            OnPreSection=BEGIN
                           LineCount += 2;  //IMH04
                         END;

          }
          CONTROLS
          {
            { 29  ;Label        ;5340 ;0    ;2520 ;846  ;ParentControl=36;
                                                         HorzAlign=Center;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=FRA=Date Document }
            { 30  ;Label        ;2400 ;0    ;2100 ;846  ;ParentControl=37;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 32  ;Label        ;12900;0    ;2940 ;846  ;ParentControl=39;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1100281010;Label  ;8700 ;0    ;2940 ;846  ;HorzAlign=Center;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=FRA=Montant Ouvert }
          }
           }
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=24450;
            SectionHeight=423;
            OnPreSection=BEGIN
                           LineCount += 1;  //IMH04
                         END;

          }
          CONTROLS
          {
            { 34  ;Label        ;6450 ;0    ;2100 ;423  ;ParentControl=35;
                                                         FontSize=9;
                                                         LeaderDots=Yes }
            { 35  ;TextBox      ;8730 ;0    ;2100 ;423  ;FontSize=9;
                                                         CaptionML=[ENU=Continued;
                                                                    FRA=Report];
                                                         SourceExpr="Remaining Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Issued Reminder Line".GetCurrencyCodeFromHeader }
            { 1100281011;TextBox;10830;0    ;840  ;423  ;FontSize=9;
                                                         SourceExpr=Devise }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=24450;
            SectionHeight=423;
            KeepWithNext=No;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := ("Line No." > StartLineNo) AND (Type = Type::"Customer Ledger Entry");
                           IF CurrReport.SHOWOUTPUT THEN  //IMH04
                             LineCount += 1;  //IMH04
                         END;

          }
          CONTROLS
          {
            { 36  ;TextBox      ;5400 ;0    ;2430 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr="Posting Date" }
            { 37  ;TextBox      ;2400 ;0    ;2100 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr="Document No." }
            { 39  ;TextBox      ;12900;0    ;2940 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         CaptionML=[ENU=Due Date;
                                                                    FRA=Date d'‚ch‚ance];
                                                         SourceExpr="Due Date" }
            { 40  ;TextBox      ;8700 ;0    ;2100 ;423  ;FontSize=9;
                                                         SourceExpr="Remaining Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Issued Reminder Line".GetCurrencyCodeFromHeader }
            { 1100281012;TextBox;10800;0    ;840  ;423  ;FontSize=9;
                                                         SourceExpr=Devise }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=24450;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := ("Line No." > StartLineNo) AND
                             ((Type <> Type::"Customer Ledger Entry") AND (ShowInternalInfo));

                           IF CurrReport.SHOWOUTPUT THEN  //IMH04
                             LineCount += 1;  //IMH04
                         END;

          }
          CONTROLS
          {
            { 31  ;TextBox      ;4290 ;0    ;4410 ;423  ;FontSize=9;
                                                         SourceExpr=Description }
            { 38  ;TextBox      ;8700 ;0    ;2100 ;423  ;FontSize=9;
                                                         SourceExpr="Remaining Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Issued Reminder Line".GetCurrencyCodeFromHeader }
            { 94  ;TextBox      ;2400 ;0    ;1890 ;423  ;FontSize=9;
                                                         SourceExpr="No." }
            { 1100281013;TextBox;10800;0    ;840  ;423  ;FontSize=9;
                                                         SourceExpr=Devise }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=24450;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := ("Line No." > StartLineNo) AND
                             ((Type <> Type::"Customer Ledger Entry") AND (NOT ShowInternalInfo));

                           IF CurrReport.SHOWOUTPUT THEN  //IMH04
                             LineCount += 1;  //IMH04
                         END;

          }
          CONTROLS
          {
            { 95  ;TextBox      ;8760 ;0    ;2100 ;423  ;FontSize=9;
                                                         SourceExpr="Remaining Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Issued Reminder Line".GetCurrencyCodeFromHeader }
            { 96  ;TextBox      ;4350 ;0    ;4200 ;423  ;FontSize=9;
                                                         SourceExpr=Description }
            { 1100281014;TextBox;10860;0    ;840  ;423  ;FontSize=9;
                                                         SourceExpr=Devise }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=24450;
            SectionHeight=423;
            OnPreSection=BEGIN
                           IF CurrReport.SHOWOUTPUT THEN  //IMH04
                             LineCount += 1;  //IMH04
                         END;

          }
          CONTROLS
          {
            { 41  ;Label        ;6300 ;0    ;2100 ;423  ;ParentControl=42;
                                                         FontSize=9;
                                                         LeaderDots=Yes }
            { 42  ;TextBox      ;8700 ;0    ;2100 ;423  ;FontSize=9;
                                                         CaptionML=[ENU=Continued;
                                                                    FRA=Report];
                                                         SourceExpr="Remaining Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Issued Reminder Line".GetCurrencyCodeFromHeader }
            { 1100281015;TextBox;10800;0    ;840  ;423  ;FontSize=9;
                                                         SourceExpr=Devise }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=24450;
            SectionHeight=423;
            OnPreSection=BEGIN
                           IF CurrReport.SHOWOUTPUT THEN  //IMH04
                             LineCount += 1;  //IMH04
                         END;

          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=24450;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := ReminderInterestAmount <> 0;

                           IF CurrReport.SHOWOUTPUT THEN  //IMH04
                             LineCount += 1;  //IMH04
                         END;

          }
          CONTROLS
          {
            { 45  ;TextBox      ;8340 ;0    ;2520 ;423  ;FontSize=9;
                                                         CaptionML=[ENU=Interest Amount;
                                                                    FRA=Montant int‚rˆts];
                                                         SourceExpr=ReminderInterestAmount;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Issued Reminder Line".GetCurrencyCodeFromHeader }
            { 47  ;Label        ;5400 ;0    ;2730 ;423  ;ParentControl=45;
                                                         FontSize=9 }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=24450;
            SectionHeight=423;
            OnPreSection=BEGIN
                           IF CurrReport.SHOWOUTPUT THEN  //IMH04
                             LineCount += 1;  //IMH04
                         END;

          }
          CONTROLS
          {
            { 44  ;TextBox      ;9000 ;0    ;1890 ;423  ;HorzAlign=General;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Total;
                                                                    FRA=Total];
                                                         SourceExpr="Remaining Amount" + ReminderInterestAmount;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Issued Reminder Line".GetCurrencyCodeFromHeader }
            { 1100281016;TextBox;10950;0    ;930  ;423  ;FontSize=9;
                                                         SourceExpr=Devise }
            { 1100281017;Label  ;6900 ;0    ;1890 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=FRA=Total }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=24450;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := "VAT Amount" <> 0;
                           IF CurrReport.SHOWOUTPUT THEN  //IMH04
                             LineCount += 2;  //IMH04
                         END;

          }
          CONTROLS
          {
            { 59  ;TextBox      ;10710;423  ;2520 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr="Remaining Amount" + ReminderInterestAmount + "VAT Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Issued Reminder Line".GetCurrencyCodeFromHeader }
            { 60  ;TextBox      ;6090 ;423  ;4200 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=TotalInclVATText }
            { 63  ;TextBox      ;10710;0    ;2520 ;423  ;FontSize=9;
                                                         SourceExpr="VAT Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Issued Reminder Line".GetCurrencyCodeFromHeader }
            { 64  ;Label        ;6090 ;0    ;4200 ;423  ;ParentControl=63;
                                                         FontSize=9 }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=24450;
            SectionHeight=0;
          }
          CONTROLS
          {
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table298;
        DataItemTableView=SORTING(Reminder No.,Line No.);
        DataItemVarName=IssuedReminderLine2;
        OnPreDataItem=VAR
                        lCount@1100281000 : Integer;
                      BEGIN
                        SETFILTER("Line No.",'>=%1',EndLineNo);

                        //<<IMH04
                        lCount := COUNT;
                        IF (LineCount MOD 66) + lCount + 4 > 66 THEN
                          CurrReport.NEWPAGE;
                        //>>IMH04
                      END;

        DataItemLinkReference=Issued Reminder Header;
        DataItemLink=Reminder No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=24450;
            SectionHeight=423;
            KeepWithNext=Yes;
            OnPreSection=BEGIN
                           LineCount += 1;  //IMH04
                         END;

          }
          CONTROLS
          {
            { 52  ;TextBox      ;2400 ;0    ;17850;423  ;FontSize=9;
                                                         SourceExpr=Description }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=24450;
            SectionHeight=846;
            OnPreSection=BEGIN
                             LineCount += 2;  //IMH04
                         END;

          }
          CONTROLS
          {
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=VATCounter;
        OnPreDataItem=BEGIN
                        IF "Issued Reminder Line"."VAT Amount" = 0 THEN
                          CurrReport.BREAK;
                        SETRANGE(Number,1,VATAmountLine.COUNT);
                        CurrReport.CREATETOTALS(VATAmountLine."VAT Base",VATAmountLine."VAT Amount",VATAmountLine."Amount Including VAT");
                      END;

        OnAfterGetRecord=BEGIN
                           VATAmountLine.GetLine(Number);
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=24450;
            SectionHeight=1692;
            OnPreSection=BEGIN
                             LineCount += 4;  //IMH04
                         END;

          }
          CONTROLS
          {
            { 69  ;Label        ;10170;846  ;2520 ;846  ;ParentControl=70;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 65  ;Label        ;7440 ;846  ;2520 ;846  ;ParentControl=71;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 66  ;Label        ;4710 ;846  ;2520 ;846  ;ParentControl=72;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 68  ;Label        ;2400 ;846  ;2100 ;846  ;ParentControl=73;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 67  ;Label        ;2400 ;0    ;6300 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=VAT Amount Specification;
                                                                    FRA=D‚tail TVA] }
          }
           }
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=24450;
            SectionHeight=423;
            OnPreSection=BEGIN
                             LineCount += 1;  //IMH04
                         END;

          }
          CONTROLS
          {
            { 74  ;TextBox      ;10170;0    ;2520 ;423  ;FontSize=9;
                                                         CaptionML=[ENU=VAT Amount;
                                                                    FRA=Montant TVA];
                                                         SourceExpr=VATAmountLine."Amount Including VAT";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Issued Reminder Line".GetCurrencyCodeFromHeader }
            { 75  ;TextBox      ;7440 ;0    ;2520 ;423  ;FontSize=9;
                                                         SourceExpr=VATAmountLine."VAT Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Issued Reminder Line".GetCurrencyCodeFromHeader }
            { 76  ;TextBox      ;4710 ;0    ;2520 ;423  ;FontSize=9;
                                                         CaptionML=[ENU=Continued;
                                                                    FRA=Report];
                                                         SourceExpr=VATAmountLine."VAT Base";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Issued Reminder Line".GetCurrencyCodeFromHeader }
            { 77  ;Label        ;2400 ;0    ;2100 ;423  ;ParentControl=76;
                                                         FontSize=9;
                                                         LeaderDots=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=24450;
            SectionHeight=423;
            OnPreSection=BEGIN
                             LineCount += 1;  //IMH04
                         END;

          }
          CONTROLS
          {
            { 70  ;TextBox      ;10170;0    ;2520 ;423  ;FontSize=9;
                                                         CaptionML=[ENU=Amount Including VAT;
                                                                    FRA=Montant TTC];
                                                         SourceExpr=VATAmountLine."Amount Including VAT";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Issued Reminder Line".GetCurrencyCodeFromHeader }
            { 71  ;TextBox      ;7440 ;0    ;2520 ;423  ;FontSize=9;
                                                         CaptionML=[ENU=VAT Amount;
                                                                    FRA=Montant TVA];
                                                         SourceExpr=VATAmountLine."VAT Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Issued Reminder Line".GetCurrencyCodeFromHeader }
            { 72  ;TextBox      ;4710 ;0    ;2520 ;423  ;FontSize=9;
                                                         CaptionML=[ENU=VAT Base;
                                                                    FRA=Base TVA];
                                                         SourceExpr=VATAmountLine."VAT Base";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Issued Reminder Line".GetCurrencyCodeFromHeader }
            { 73  ;TextBox      ;2400 ;0    ;2100 ;423  ;FontSize=9;
                                                         CaptionML=[ENU=VAT %;
                                                                    FRA=% TVA];
                                                         SourceExpr=VATAmountLine."VAT %" }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=24450;
            SectionHeight=846;
            OnPreSection=BEGIN
                           IF CurrReport.SHOWOUTPUT THEN  //IMH04
                             LineCount += 1;  //IMH04
                         END;

          }
          CONTROLS
          {
            { 78  ;TextBox      ;10170;423  ;2520 ;423  ;FontSize=9;
                                                         CaptionML=[ENU=VAT Amount;
                                                                    FRA=Montant TVA];
                                                         SourceExpr=VATAmountLine."Amount Including VAT";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Issued Reminder Line".GetCurrencyCodeFromHeader }
            { 79  ;TextBox      ;7440 ;423  ;2520 ;423  ;FontSize=9;
                                                         SourceExpr=VATAmountLine."VAT Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Issued Reminder Line".GetCurrencyCodeFromHeader }
            { 80  ;TextBox      ;4710 ;423  ;2520 ;423  ;FontSize=9;
                                                         CaptionML=[ENU=Continued;
                                                                    FRA=Report];
                                                         SourceExpr=VATAmountLine."VAT Base";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Issued Reminder Line".GetCurrencyCodeFromHeader }
            { 81  ;Label        ;2400 ;423  ;2100 ;423  ;ParentControl=80;
                                                         FontSize=9;
                                                         LeaderDots=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=24450;
            SectionHeight=846;
            OnPreSection=BEGIN
                           LineCount += 2;  //IMH04
                         END;

          }
          CONTROLS
          {
            { 82  ;TextBox      ;7440 ;423  ;2520 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=VATAmountLine."VAT Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Issued Reminder Line".GetCurrencyCodeFromHeader }
            { 83  ;TextBox      ;4710 ;423  ;2520 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Total;
                                                                    FRA=Total];
                                                         SourceExpr=VATAmountLine."VAT Base";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Issued Reminder Line".GetCurrencyCodeFromHeader }
            { 84  ;Label        ;2400 ;423  ;2100 ;423  ;ParentControl=83;
                                                         FontSize=9;
                                                         FontBold=Yes }
            { 85  ;TextBox      ;10170;423  ;2520 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=VAT Amount;
                                                                    FRA=Montant TVA];
                                                         SourceExpr=VATAmountLine."Amount Including VAT";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Issued Reminder Line".GetCurrencyCodeFromHeader }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=3850;
      Height=990;
      SaveValues=Yes;
      OnOpenForm=BEGIN
                   LogInteraction := SegManagement.FindInteractTmplCode(8) <> '';
                   RequestOptionsForm.LogInteraction.ENABLED(LogInteraction);
                 END;

    }
    CONTROLS
    {
      { 1   ;CheckBox     ;3410 ;0    ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=[ENU=Show Internal Information;
                                                              FRA=Afficher info. internes];
                                                   SourceExpr=ShowInternalInfo }
      { 2   ;Label        ;0    ;0    ;3300 ;440  ;ParentControl=1 }
      { 5   ;CheckBox     ;3410 ;550  ;440  ;440  ;Name=LogInteraction;
                                                   ShowCaption=No;
                                                   CaptionML=[ENU=Log Interaction;
                                                              FRA=Journal interaction];
                                                   SourceExpr=LogInteraction }
      { 6   ;Label        ;0    ;550  ;3300 ;440  ;ParentControl=5 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=Total %1;FRA=Total %1';
      Text001@1001 : TextConst 'ENU=Total %1 Incl. VAT;FRA=Total %1 TTC';
      Text002@1002 : TextConst 'ENU=Page %1;FRA=Page %1';
      GLSetup@1003 : Record 98;
      CompanyInfo@1004 : Record 79;
      VATAmountLine@1005 : TEMPORARY Record 290;
      Language@1007 : Record 8;
      Customer@1000000000 : Record 18;
      FormatAddrCodeunit@1008 : Codeunit 365;
      SegManagement@1009 : Codeunit 5051;
      CustAddr@1010 : ARRAY [8] OF Text[50];
      CompanyAddr@1011 : ARRAY [8] OF Text[50];
      VATNoText@1012 : Text[30];
      ReferenceText@1013 : Text[30];
      Devise@1100281001 : Text[30];
      TotalInclVATText@1015 : Text[50];
      ReminderInterestAmount@1016 : Decimal;
      StartLineNo@1017 : Integer;
      EndLineNo@1018 : Integer;
      Continue@1019 : Boolean;
      ShowInternalInfo@1022 : Boolean;
      LogInteraction@1023 : Boolean;
      Text003@1100281000 : TextConst 'FRA=A l''attention de la comptabilit‚ fournisseurs';
      Text004@1000000006 : TextConst 'FRA=A %1';
      Text005@1000000005 : TextConst 'FRA=Le %1';
      Text008@1000000004 : TextConst 'FRA=%1RDC Niort - Siret : %2 - TVA Intracommunautaireÿ: %3';
      PhoneNo@1000000003 : TextConst 'FRA=T‚l. : %1';
      FaxNo@1000000002 : TextConst 'FRA=Fax : %1';
      CompanyDesc@1000000001 : TextConst 'FRA=%1 au capital de %2 euros';
      LineCount@1100281002 : Integer;

    BEGIN
    {
      /** @r IMH04 @d 20/02/14 @a ISAT.ZW @v IMH6.01.4813 @s Modification courrier de relance @h 4813 */
      /** @r IMH04 @d 06/02/14 @a ISAT.ZW @v IMH6.01.151 @s Modification courrier de relance @h 4813 */
      /** @r IMH03 @d 21/01/14 @a ISAT.SB @v IMH6.01.151 @s Modification courrier de relance @h 4813 */
      /** @r IMH02 @d 17/10/13 @a ISAT.EBA @v IMH6.01.151 @s Modification courrier de relance @h 4813 */
      /** @r IMH01 @d 06/07/11 @a ISAT.ST @v IMH6.01.151 @s Immobilisation */
    }
    END.
  }
  RDLDATA
  {
  }
}