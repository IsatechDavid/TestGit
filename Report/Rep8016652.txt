OBJECT Report 8016652 Purchases Order Isatech+
{
  OBJECT-PROPERTIES
  {
    Date=18/09/12;
    Time=15:19:47;
    Modified=Yes;
    Version List=ISA6.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Purchase Order Isatech+;
               FRA=Achats - Commande Isatech+];
    TopMargin=0;
    BottomMargin=0;
    LeftMargin=500;
    RightMargin=500;
    OnInitReport=BEGIN
                   GLSetup.GET;
                   CompanyInfo.GET;
                   CompanyInfo.CALCFIELDS(CompanyInfo.Picture);
                   PurchasesSetup.GET;
                 END;

    HorzGrid=210;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table38;
        DataItemTableView=SORTING(Document Type,No.)
                          WHERE(Document Type=CONST(Order));
        NewPagePerRecord=Yes;
        PrintOnlyIfDetail=No;
        ReqFilterHeadingML=FRA=Commande achat;
        OnPreDataItem=BEGIN
                        FormatAddress.Company(CompanyAddress,CompanyInfo);
                      END;

        OnAfterGetRecord=VAR
                           LocLanguage@1000000000 : Record 8;
                         BEGIN

                           Vendor.INIT;
                           IF Vendor.GET("Purchase Header"."Buy-from Vendor No.") AND (Vendor."Language Code" <> '') THEN BEGIN
                             IF LocLanguage.GET(Vendor."Language Code") THEN
                               CurrReport.LANGUAGE(LocLanguage."Windows Language ID");
                           END;

                           IF "Purchaser Code" = '' THEN BEGIN
                             Purchaser.INIT;
                             PurchaserText := '';
                           END ELSE BEGIN
                             Purchaser.GET("Purchaser Code");
                             PurchaserText := 'Text001';
                           END;

                           IF Purchaser."Phone No." <> '' THEN
                             PurchaserPhoneText := TextPhone + Purchaser."Phone No.";
                           IF CompanyInfo."Phone No." <> '' THEN
                             CompanyPhoneText := TextPhone + CompanyInfo."Phone No.";

                           IF Purchaser."E-Mail"<>'' THEN
                             PurchaserEmailText := TextEmail + Purchaser."E-Mail";
                           IF CompanyInfo."E-Mail" <> '' THEN
                             CompanyEmailText := TextEmail + CompanyInfo."E-Mail";

                           IF "Currency Code" = '' THEN BEGIN
                             GLSetup.TESTFIELD("LCY Code");
                             AmountText := STRSUBSTNO(TextAmount,GLSetup."LCY Code");
                             AmountIncludingVATText := STRSUBSTNO(TextAmountIncludingVAT,GLSetup."LCY Code");
                             AccountCurrency := '';
                           END ELSE BEGIN
                             AmountText := STRSUBSTNO(TextAmount,"Currency Code");
                             AmountIncludingVATText := STRSUBSTNO(TextAmountIncludingVAT,"Currency Code");
                             AccountCurrency := '';
                           END;

                           IF "Purchase Header"."Payment Terms Code" = '' THEN
                             PaymentTerms.INIT
                           ELSE
                             PaymentTerms.GET("Purchase Header"."Payment Terms Code");

                           IF "Purchase Header"."Shipment Method Code" = '' THEN
                             ShipmentMethod.INIT
                           ELSE
                             ShipmentMethod.GET("Purchase Header"."Shipment Method Code");


                           IF "Purchase Header"."Payment Method Code" = '' THEN
                             PaymentMethod.INIT
                           ELSE
                             PaymentMethod.GET("Purchase Header"."Payment Method Code");

                           FormatAddress.PurchHeaderBuyFrom(BuyFromVendorAddr,"Purchase Header");

                           Country.INIT;
                           IF Country.GET("Purchase Header"."Ship-to Country/Region Code") THEN;
                         END;

        ReqFilterFields=No.,Buy-from Vendor No.,No. Printed;
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        NewPagePerRecord=Yes;
        DataItemVarName=CopyLoop;
        PrintOnlyIfDetail=No;
        OnPreDataItem=BEGIN
                        NbLoop := ABS(NbCopy) + 1;
                        CopyText := '';
                        SETRANGE(Number,1,NbLoop);
                      END;

        OnAfterGetRecord=BEGIN
                           CLEAR(PurchaseLine);
                           CLEAR(PurchPost);
                           PurchPost.GetPurchLines("Purchase Header",PurchaseLine,0);

                           IF Number > 1 THEN
                             CopyText := TextCopy;
                           CurrReport.PAGENO := 1;
                         END;

        OnPostDataItem=BEGIN
                         IF NOT CurrReport.PREVIEW THEN
                           PurchHeaderPrinted.RUN("Purchase Header");
                       END;

      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=PageLoop;
        PrintOnlyIfDetail=No;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19530;
            SectionHeight=10998;
          }
          CONTROLS
          {
            { 4   ;TextBox      ;10920;2961 ;8190 ;846  ;HorzAlign=Left;
                                                         FontSize=11;
                                                         FontBold=Yes;
                                                         SourceExpr=BuyFromVendorAddr[1] }
            { 6   ;TextBox      ;10920;3807 ;8190 ;423  ;HorzAlign=Left;
                                                         FontSize=10;
                                                         SourceExpr=BuyFromVendorAddr[2] }
            { 7   ;TextBox      ;210  ;2115 ;6510 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo.Address }
            { 8   ;TextBox      ;10920;4230 ;8190 ;423  ;HorzAlign=Left;
                                                         FontSize=10;
                                                         SourceExpr=BuyFromVendorAddr[3] }
            { 10  ;TextBox      ;10920;4653 ;8190 ;423  ;HorzAlign=Left;
                                                         FontSize=10;
                                                         SourceExpr=BuyFromVendorAddr[4] }
            { 12  ;TextBox      ;10920;5076 ;8190 ;423  ;HorzAlign=Left;
                                                         FontSize=10;
                                                         SourceExpr=BuyFromVendorAddr[5] }
            { 15  ;TextBox      ;10920;5499 ;8190 ;423  ;HorzAlign=Left;
                                                         FontSize=10;
                                                         SourceExpr=BuyFromVendorAddr[6] }
            { 19  ;TextBox      ;210  ;4230 ;6510 ;423  ;FontSize=7;
                                                         FontBold=No;
                                                         CaptionML=FRA=Nø Siret;
                                                         SourceExpr=TextRegistrationNo+CompanyInfo."Registration No." }
            { 3   ;TextBox      ;10920;5922 ;8190 ;423  ;HorzAlign=Left;
                                                         FontSize=10;
                                                         SourceExpr=BuyFromVendorAddr[7] }
            { 2   ;TextBox      ;210  ;2538 ;6510 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo."Post Code" + ' ' + CompanyInfo.City }
            { 16  ;TextBox      ;210  ;5076 ;6510 ;423  ;FontSize=7;
                                                         FontBold=No;
                                                         CaptionML=FRA=Nø id. intracomm.;
                                                         SourceExpr='Nø intracommunautaire : '+CompanyInfo."VAT Registration No." }
            { 59  ;PictureBox   ;210  ;0    ;6510 ;2115 ;SourceExpr=CompanyInfo.Picture }
            { 201 ;TextBox      ;210  ;2961 ;6510 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=FRA=Nø t‚l‚phone;
                                                         SourceExpr=CompanyPhoneText }
            { 202 ;TextBox      ;210  ;3384 ;6510 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=FRA=Nø t‚l‚phone;
                                                         SourceExpr=CompanyFaxText }
            { 203 ;TextBox      ;210  ;3807 ;8610 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=FRA=Nø t‚l‚phone;
                                                         SourceExpr=CompanyEmailText }
            { 1000000002;TextBox;10920;0    ;2100 ;846  ;HorzAlign=Left;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=TextVendorNo }
            { 1000000003;TextBox;10920;846  ;2100 ;423  ;HorzAlign=Left;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=TextPhone }
            { 1000000004;TextBox;13020;0    ;3570 ;846  ;HorzAlign=Left;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=Vendor."No." }
            { 1000000005;TextBox;13020;846  ;6090 ;423  ;HorzAlign=Left;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=Vendor."Phone No." }
            { 1000000006;TextBox;10920;1269 ;2100 ;423  ;HorzAlign=Left;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=TextFax }
            { 1000000007;TextBox;13020;1269 ;6090 ;423  ;HorzAlign=Left;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=Vendor."Fax No." }
            { 1000000008;TextBox;10920;1692 ;2100 ;423  ;HorzAlign=Left;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=TextAccountNo }
            { 1000000009;TextBox;13020;1692 ;6090 ;423  ;HorzAlign=Left;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=Vendor."Our Account No." }
            { 1000000010;TextBox;17430;0    ;1680 ;423  ;FontSize=8;
                                                         SourceExpr=TextPage + FORMAT(CurrReport.PAGENO) }
            { 1000000011;Shape  ;10920;6345 ;8460 ;4230 ;BorderWidth=1pt }
            { 1000000012;Shape  ;10920;7614 ;8425 ;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000013;TextBox;11340;8037 ;7770 ;423  ;FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr="Purchase Header"."Ship-to Name" }
            { 1000000014;TextBox;10920;6345 ;8400 ;1269 ;HorzAlign=Center;
                                                         FontSize=16;
                                                         FontBold=Yes;
                                                         SourceExpr=UPPERCASE(TextShipTo) }
            { 1000000015;TextBox;11340;8460 ;7770 ;423  ;FontSize=9;
                                                         SourceExpr="Purchase Header"."Ship-to Address" }
            { 1000000016;TextBox;11340;8883 ;7770 ;423  ;FontSize=9;
                                                         SourceExpr="Purchase Header"."Ship-to Address 2" }
            { 1000000017;TextBox;11340;9306 ;7770 ;423  ;FontSize=9;
                                                         SourceExpr="Purchase Header"."Ship-to Post Code" +' '+ "Purchase Header"."Ship-to City" }
            { 1000000018;TextBox;11340;9729 ;7770 ;423  ;FontSize=9;
                                                         SourceExpr=Country.Name }
            { 1000000019;Shape  ;210  ;6768 ;8460 ;3807 ;BorderWidth=1pt }
            { 1000000020;Shape  ;210  ;8460 ;8425 ;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000021;Shape  ;210  ;7614 ;8425 ;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000022;TextBox;4325 ;9729 ;4200 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=FRA=Nø t‚l‚copie;
                                                         SourceExpr=PurchaserFaxText }
            { 1000000023;TextBox;4955 ;7614 ;3570 ;846  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         SourceExpr="Purchase Header"."Order Date" }
            { 1000000024;TextBox;4830 ;8460 ;3695 ;423  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         FontBold=No;
                                                         SourceExpr="Purchase Header"."Requested Receipt Date" }
            { 1000000025;TextBox;335  ;10152;8190 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=FRA=Nø t‚l‚copie;
                                                         SourceExpr=PurchaserEmailText }
            { 1000000026;TextBox;4955 ;6768 ;3570 ;846  ;HorzAlign=Center;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=TextDate }
            { 1000000028;Shape  ;4745 ;6768 ;210  ;1692 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000030;TextBox;335  ;8460 ;4620 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=FRA=Nø t‚l‚phone;
                                                         SourceExpr=TextExpectedReceiptDate }
            { 1000000031;TextBox;335  ;7614 ;4410 ;846  ;HorzAlign=Center;
                                                         FontSize=12;
                                                         FontBold=Yes;
                                                         SourceExpr="Purchase Header"."No." }
            { 1000000032;TextBox;335  ;6768 ;4410 ;846  ;HorzAlign=Center;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=TextOrderNo }
            { 1000000033;TextBox;335  ;9729 ;3990 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=FRA=Nø t‚l‚phone;
                                                         SourceExpr=PurchaserPhoneText }
            { 1000000034;TextBox;335  ;9306 ;3360 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=Purchaser.Name }
            { 1000000035;TextBox;210  ;5499 ;8610 ;846  ;HorzAlign=Left;
                                                         FontSize=16;
                                                         FontBold=Yes;
                                                         CaptionML=FRA=Nø t‚l‚phone;
                                                         SourceExpr=TextPurchaseOrder }
            { 1000000029;TextBox;1680 ;4653 ;2100 ;423  ;FontSize=7;
                                                         FontBold=No;
                                                         CaptionML=FRA=Nø Siret;
                                                         SourceExpr=CompanyInfo."APE Code" }
            { 1000000027;Label  ;210  ;4653 ;1470 ;423  ;CaptionML=[ENU=EP code:;
                                                                    FRA=Code APE :] }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19530;
            SectionHeight=2115;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT((LegalText[1] <> '') AND (CurrReport.PAGENO=1));
                         END;

            OnPostSection=BEGIN
                            IF CurrReport.SHOWOUTPUT THEN
                              NbLegalTExt := 5
                            ELSE
                              NbLegalTExt := 0;
                          END;

          }
          CONTROLS
          {
            { 34  ;TextBox      ;1890 ;0    ;16590;423  ;SourceExpr=LegalText[1] }
            { 73  ;TextBox      ;1890 ;423  ;16590;423  ;SourceExpr=LegalText[2] }
            { 86  ;Shape        ;1680 ;0    ;16800;1692  }
            { 204 ;TextBox      ;1890 ;846  ;16590;423  ;SourceExpr=LegalText[3] }
            { 210 ;TextBox      ;1890 ;1269 ;16590;423  ;SourceExpr=LegalText[4] }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19530;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 1000000036;Shape  ;105  ;0    ;19360;846  ;BackColor=12632256;
                                                         BackTransparent=Yes;
                                                         Border=Yes;
                                                         BorderWidth=1pt }
            { 1000000037;TextBox;17220;0    ;1890 ;846  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=TextAmountExcludingVAT }
            { 1000000038;Shape  ;17010;0    ;210  ;846  ;ShapeStyle=VertLine }
            { 1000000039;Label  ;16170;0    ;1050 ;846  ;Name=P.U. NET;
                                                         HorzAlign=Center;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=FRA=% }
            { 1000000040;Shape  ;15750;0    ;210  ;846  ;ShapeStyle=VertLine }
            { 1000000041;TextBox;14280;0    ;1470 ;846  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=TextUnitPrice }
            { 1000000042;Shape  ;14070;0    ;210  ;846  ;ShapeStyle=VertLine }
            { 1000000043;TextBox;12810;0    ;1260 ;846  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=TextQuantity }
            { 1000000044;Shape  ;12600;0    ;210  ;846  ;ShapeStyle=VertLine }
            { 1000000045;TextBox;11340;0    ;1260 ;846  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=TextLineExpectedReceiptDate }
            { 1000000046;Shape  ;11130;0    ;210  ;846  ;ShapeStyle=VertLine }
            { 1000000047;TextBox;10080;0    ;1050 ;846  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=TextUnit }
            { 1000000049;TextBox;5040 ;0    ;5040 ;846  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=TextItemDesc }
            { 1000000050;Shape  ;2310 ;0    ;210  ;846  ;ShapeStyle=VertLine }
            { 1000000051;TextBox;210  ;0    ;2100 ;846  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=TextItemNo }
            { 1000000072;Shape  ;4830 ;0    ;210  ;846  ;ShapeStyle=VertLine }
            { 1000000073;TextBox;2520 ;0    ;2310 ;846  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=TextVendorItemNo }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table39;
        DataItemTableView=SORTING(Document Type,Document No.,Line No.);
        PrintOnlyIfDetail=No;
        OnPreDataItem=BEGIN
                        CurrReport.BREAK;
                      END;

        OnAfterGetRecord=BEGIN
                           Index:= ' ' ;
                         END;

        DataItemLinkReference=Purchase Header;
        DataItemLink=Document Type=FIELD(Document Type),
                     Document No.=FIELD(No.);
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=CircularLoop;
        PrintOnlyIfDetail=No;
        OnPreDataItem=BEGIN
                        LineCounter := 0;

                        VATAmountLine.DELETEALL;
                        MoreLines := PurchaseLine.FIND('+');
                        WHILE MoreLines AND (PurchaseLine.Description = '') AND
                              (PurchaseLine."No." = '') AND (PurchaseLine.Quantity = 0) AND
                              (PurchaseLine.Amount = 0) DO
                          MoreLines := PurchaseLine.NEXT(-1) <> 0;

                        IF NOT MoreLines THEN
                          CurrReport.BREAK;
                        PurchaseLine.SETRANGE("Line No.",0,PurchaseLine."Line No.");
                        SETRANGE(Number,1,PurchaseLine.COUNT);
                        CurrReport.CREATETOTALS(PurchaseLine.Amount,PurchaseLine."Amount Including VAT",PurchaseLine."Inv. Discount Amount");
                      END;

        OnAfterGetRecord=BEGIN
                           IF Number = 1 THEN
                             PurchaseLine.FIND('-')
                           ELSE
                             PurchaseLine.NEXT;
                           "Purchase Line" := PurchaseLine;

                           VATAmountLine.INIT;
                           VATAmountLine."VAT %" := "Purchase Line"."VAT %";
                           VATAmountLine."VAT Base" := "Purchase Line".Amount;
                           VATAmountLine."Amount Including VAT" := "Purchase Line"."Amount Including VAT";
                           VATAmountLine.InsertLine;

                           ItemNo :='';
                           Item.INIT;

                           IF "Purchase Line"."Vendor Item No." <> '' THEN
                             VendorItemNo := "Purchase Line"."Vendor Item No."
                           ELSE
                             VendorItemNo := "Purchase Line"."No.";

                           LineCounter += 1;
                         END;

        OnPostDataItem=BEGIN
                         PurchaseLine.DELETEALL;
                       END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=19530;
            SectionHeight=846;
            OnPreSection=BEGIN
                           LineCounter := 3;
                         END;

          }
          CONTROLS
          {
            { 143 ;Shape        ;19320;0    ;210  ;846  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 140 ;TextBox      ;17220;0    ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=FRA=Report;
                                                         SourceExpr="Purchase Line".Amount+"Purchase Line"."Inv. Discount Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Purchase Line"."Currency Code" }
            { 142 ;Label        ;14280;0    ;1470 ;423  ;ParentControl=140;
                                                         HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         LeaderDots=No }
            { 145 ;Shape        ;17010;0    ;210  ;846  ;ShapeStyle=VertLine }
            { 153 ;Shape        ;15750;0    ;210  ;846  ;ShapeStyle=VertLine }
            { 152 ;Shape        ;14070;0    ;210  ;846  ;ShapeStyle=VertLine }
            { 191 ;Shape        ;12600;0    ;210  ;846  ;ShapeStyle=VertLine }
            { 190 ;Shape        ;11130;0    ;210  ;846  ;ShapeStyle=VertLine }
            { 151 ;Shape        ;2310 ;0    ;210  ;846  ;ShapeStyle=VertLine }
            { 144 ;Shape        ;0    ;0    ;210  ;846  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000048;Shape  ;4830 ;0    ;210  ;846  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19530;
            SectionHeight=423;
            OnPreSection=BEGIN
                           IF  (PurchaseLine.Type <> 0) AND (LineCounter > 1) THEN BEGIN
                             LineCounter += 1;
                             CurrReport.SHOWOUTPUT(TRUE);
                           END ELSE
                             CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 81  ;Shape        ;19320;0    ;210  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 82  ;Shape        ;17010;0    ;210  ;423  ;ShapeStyle=VertLine }
            { 123 ;Shape        ;15750;0    ;210  ;423  ;ShapeStyle=VertLine }
            { 124 ;Shape        ;14070;0    ;210  ;423  ;ShapeStyle=VertLine }
            { 125 ;Shape        ;12600;0    ;210  ;423  ;ShapeStyle=VertLine }
            { 126 ;Shape        ;11130;0    ;210  ;423  ;ShapeStyle=VertLine }
            { 127 ;Shape        ;2310 ;0    ;210  ;423  ;ShapeStyle=VertLine }
            { 134 ;Shape        ;0    ;0    ;210  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000060;Shape  ;4830 ;0    ;210  ;423  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19530;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(PurchaseLine.Type = PurchaseLine.Type::"G/L Account");
                         END;

          }
          CONTROLS
          {
            { 56  ;TextBox      ;5040 ;0    ;6090 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Purchase Line".Description }
            { 57  ;TextBox      ;12810;0    ;1260 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr="Purchase Line".Quantity }
            { 60  ;TextBox      ;11340;0    ;1260 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=PurchaseLine."Planned Receipt Date" }
            { 61  ;TextBox      ;17220;0    ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr="Purchase Line".Amount+"Purchase Line"."Inv. Discount Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Purchase Line"."Currency Code" }
            { 112 ;Shape        ;19320;0    ;210  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 147 ;Shape        ;0    ;0    ;210  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 155 ;Shape        ;15750;0    ;210  ;423  ;ShapeStyle=VertLine }
            { 156 ;Shape        ;2310 ;0    ;210  ;423  ;ShapeStyle=VertLine }
            { 158 ;Shape        ;11130;0    ;210  ;423  ;ShapeStyle=VertLine }
            { 159 ;Shape        ;14070;0    ;210  ;423  ;ShapeStyle=VertLine }
            { 160 ;Shape        ;12600;0    ;210  ;423  ;ShapeStyle=VertLine }
            { 161 ;Shape        ;17010;0    ;210  ;423  ;ShapeStyle=VertLine }
            { 58  ;TextBox      ;14280;0    ;1470 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr="Purchase Line"."Direct Unit Cost";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Purchase Line"."Currency Code" }
            { 177 ;TextBox      ;15960;0    ;1050 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr="Purchase Line"."Line Discount %" }
            { 1000000000;TextBox;210  ;0    ;2100 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr=PurchaseLine."No." }
            { 1000000001;Shape  ;4830 ;0    ;210  ;423  ;ShapeStyle=VertLine }
            { 1000000070;TextBox;2520 ;0    ;2310 ;423  ;FontSize=8;
                                                         SourceExpr=PurchaseLine."Vendor Item No." }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19530;
            SectionHeight=423;
            OnPreSection=BEGIN

                           CurrReport.SHOWOUTPUT((PurchaseLine.Type = PurchaseLine.Type::Item) OR
                                                 (PurchaseLine.Type = PurchaseLine.Type::"Fixed Asset"));
                         END;

          }
          CONTROLS
          {
            { 62  ;TextBox      ;210  ;0    ;2100 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr=PurchaseLine."No." }
            { 63  ;TextBox      ;5040 ;0    ;5040 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Purchase Line".Description }
            { 64  ;TextBox      ;12810;0    ;1260 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr="Purchase Line".Quantity }
            { 67  ;TextBox      ;11340;0    ;1260 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=PurchaseLine."Planned Receipt Date" }
            { 136 ;Shape        ;19320;0    ;210  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 148 ;Shape        ;0    ;0    ;210  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 162 ;Shape        ;2310 ;0    ;210  ;423  ;ShapeStyle=VertLine }
            { 163 ;Shape        ;15750;0    ;210  ;423  ;ShapeStyle=VertLine }
            { 165 ;Shape        ;11130;0    ;210  ;423  ;ShapeStyle=VertLine }
            { 166 ;Shape        ;12600;0    ;210  ;423  ;ShapeStyle=VertLine }
            { 167 ;Shape        ;14070;0    ;210  ;423  ;ShapeStyle=VertLine }
            { 168 ;Shape        ;17010;0    ;210  ;423  ;ShapeStyle=VertLine }
            { 46  ;TextBox      ;10080;0    ;1050 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr="Purchase Line"."Unit of Measure Code" }
            { 65  ;TextBox      ;14280;0    ;1470 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr="Purchase Line"."Direct Unit Cost";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Purchase Line"."Currency Code" }
            { 68  ;TextBox      ;17220;0    ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr="Purchase Line".Amount+"Purchase Line"."Inv. Discount Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Purchase Line"."Currency Code" }
            { 178 ;TextBox      ;15960;0    ;1050 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr="Purchase Line"."Line Discount %" }
            { 1000000066;Shape  ;4830 ;0    ;210  ;423  ;ShapeStyle=VertLine }
            { 1000000074;TextBox;2520 ;0    ;2310 ;423  ;FontSize=8;
                                                         SourceExpr=PurchaseLine."Vendor Item No." }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19530;
            SectionHeight=423;
            OnPreSection=BEGIN
                           IF (PurchaseLine."Description 2"<>'') AND (PurchaseLine.Type <> 0) THEN BEGIN
                             LineCounter += 1;
                             CurrReport.SHOWOUTPUT(TRUE);
                           END ELSE
                             CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 22  ;TextBox      ;5040 ;0    ;6090 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Purchase Line".Description }
            { 24  ;Shape        ;19320;0    ;210  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 29  ;Shape        ;0    ;0    ;210  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 30  ;Shape        ;2310 ;0    ;210  ;423  ;ShapeStyle=VertLine }
            { 37  ;Shape        ;17010;0    ;210  ;423  ;ShapeStyle=VertLine }
            { 47  ;Shape        ;11130;0    ;210  ;423  ;ShapeStyle=VertLine }
            { 49  ;Shape        ;12600;0    ;210  ;423  ;ShapeStyle=VertLine }
            { 51  ;Shape        ;14070;0    ;210  ;423  ;ShapeStyle=VertLine }
            { 53  ;Shape        ;15750;0    ;210  ;423  ;ShapeStyle=VertLine }
            { 1000000067;Shape  ;4830 ;0    ;210  ;423  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=19530;
            SectionHeight=4653;
          }
          CONTROLS
          {
            { 76  ;TextBox      ;17220;423  ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=FRA=Report;
                                                         SourceExpr=PurchaseLine.Amount+PurchaseLine."Inv. Discount Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Purchase Line"."Currency Code" }
            { 77  ;Label        ;14280;423  ;1470 ;423  ;ParentControl=76;
                                                         HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         LeaderDots=No }
            { 83  ;Shape        ;19320;0    ;210  ;846  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 117 ;Shape        ;17010;0    ;210  ;846  ;ShapeStyle=VertLine }
            { 122 ;Shape        ;15750;0    ;210  ;846  ;ShapeStyle=VertLine }
            { 121 ;Shape        ;14070;0    ;210  ;846  ;ShapeStyle=VertLine }
            { 129 ;Shape        ;12600;0    ;210  ;846  ;ShapeStyle=VertLine }
            { 128 ;Shape        ;11130;0    ;210  ;846  ;ShapeStyle=VertLine }
            { 120 ;Shape        ;2310 ;0    ;210  ;846  ;ShapeStyle=VertLine }
            { 84  ;Shape        ;0    ;0    ;210  ;846  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 20  ;Shape        ;105  ;816  ;19320;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000068;Shape  ;4830 ;0    ;210  ;846  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19530;
            SectionHeight=846;
            OnPreSection=BEGIN
                           IF PurchaseLine."Inv. Discount Amount" <> 0 THEN BEGIN
                             LineCounter += 2;
                             CurrReport.SHOWOUTPUT(TRUE);
                           END ELSE
                             CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 179 ;Shape        ;19320;0    ;210  ;846  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 180 ;TextBox      ;17220;423  ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         CaptionML=FRA=Montant remise facture;
                                                         SourceExpr=- PurchaseLine."Inv. Discount Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Purchase Line"."Currency Code" }
            { 183 ;Shape        ;17010;0    ;210  ;846  ;ShapeStyle=VertLine }
            { 188 ;Shape        ;15960;0    ;210  ;846  ;ShapeStyle=VertLine }
            { 189 ;Shape        ;14070;0    ;210  ;846  ;ShapeStyle=VertLine }
            { 192 ;Shape        ;12600;0    ;210  ;846  ;ShapeStyle=VertLine }
            { 193 ;Shape        ;11130;0    ;210  ;846  ;ShapeStyle=VertLine }
            { 196 ;Shape        ;2310 ;0    ;210  ;846  ;ShapeStyle=VertLine }
            { 197 ;Shape        ;0    ;0    ;210  ;846  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000069;TextBox;5040 ;423  ;6090 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=TextInvoiceDiscountAmount }
            { 1000000071;Shape  ;4830 ;0    ;210  ;846  ;ShapeStyle=VertLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=Line;
        OnPreDataItem=BEGIN
                        SETRANGE(Number,LineCounter + NbLegalTExt,26);
                      END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19530;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 5   ;Shape        ;19320;0    ;210  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 21  ;Shape        ;15750;0    ;210  ;423  ;ShapeStyle=VertLine }
            { 23  ;Shape        ;14070;0    ;210  ;423  ;ShapeStyle=VertLine }
            { 25  ;Shape        ;12600;0    ;210  ;423  ;ShapeStyle=VertLine }
            { 31  ;Shape        ;11130;0    ;210  ;423  ;ShapeStyle=VertLine }
            { 38  ;Shape        ;17010;0    ;210  ;423  ;ShapeStyle=VertLine }
            { 48  ;Shape        ;2310 ;0    ;210  ;423  ;ShapeStyle=VertLine }
            { 50  ;Shape        ;0    ;0    ;210  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000075;Shape  ;4830 ;0    ;210  ;423  ;ShapeStyle=VertLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=Amount;
        OnPreDataItem=BEGIN
                        IF VATAmountLine.COUNT < 1 THEN
                             SETRANGE(Number,1,1)
                        ELSE
                            SETRANGE(Number,1,VATAmountLine.COUNT);

                        CurrReport.CREATETOTALS(VATAmountLine."VAT Base",VATAmountLine."VAT Amount");
                         NbVATLine := 0;
                      END;

        OnAfterGetRecord=BEGIN
                           IF VATAmountLine.COUNT > 0 THEN BEGIN
                                 VATAmountLine.GetLine(Number);
                                 NbVATLine += 1;
                           END;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19530;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 118 ;Shape        ;105  ;0    ;19320;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000052;Shape  ;19320;423  ;210  ;846  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000053;Shape  ;105  ;423  ;19320;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000054;TextBox;11760;423  ;2310 ;846  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=TextAmounts;
                                                         AutoFormatType=2 }
            { 1000000055;Shape  ;11130;423  ;210  ;846  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000056;TextBox;5670 ;423  ;2520 ;846  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=TextVATAmount;
                                                         AutoFormatType=2 }
            { 1000000057;TextBox;2940 ;423  ;2520 ;846  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=TextVATBase;
                                                         AutoFormatType=2 }
            { 1000000058;TextBox;630  ;423  ;2100 ;846  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=TextVATPercent;
                                                         AutoFormatType=2 }
            { 1000000059;Shape  ;0    ;423  ;210  ;846  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19530;
            SectionHeight=423;
            OnPreSection=BEGIN
                           //  LigneMontantTVA.COUNT
                           CurrReport.SHOWOUTPUT(NbVATLine = 1);
                         END;

          }
          CONTROLS
          {
            { 41  ;TextBox      ;630  ;0    ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         CaptionML=FRA=% TVA;
                                                         SourceExpr=VATAmountLine."VAT %" }
            { 42  ;TextBox      ;2940 ;0    ;2520 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         CaptionML=FRA=Base TVA;
                                                         SourceExpr=VATAmountLine."VAT Base";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Purchase Header"."Currency Code" }
            { 43  ;TextBox      ;5670 ;0    ;2520 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         CaptionML=FRA=Montant TVA;
                                                         SourceExpr=VATAmountLine."VAT Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Purchase Header"."Currency Code" }
            { 44  ;TextBox      ;11760;0    ;3780 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=AmountText }
            { 205 ;TextBox      ;17220;0    ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=PurchaseLine.Amount;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Purchase Header"."Currency Code" }
            { 211 ;Shape        ;19320;0    ;210  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 212 ;Shape        ;0    ;0    ;210  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 217 ;Shape        ;11130;0    ;210  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19530;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(NbVATLine = 2);
                         END;

          }
          CONTROLS
          {
            { 101 ;TextBox      ;630  ;0    ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         CaptionML=FRA=% TVA;
                                                         SourceExpr=VATAmountLine."VAT %" }
            { 102 ;TextBox      ;2940 ;0    ;2520 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         CaptionML=FRA=Base TVA;
                                                         SourceExpr=VATAmountLine."VAT Base";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Purchase Header"."Currency Code" }
            { 103 ;TextBox      ;5670 ;0    ;2520 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         CaptionML=FRA=Montant TVA;
                                                         SourceExpr=VATAmountLine."VAT Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Purchase Header"."Currency Code" }
            { 206 ;TextBox      ;11760;0    ;3780 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr=VATAmountLine.VATAmountText }
            { 207 ;TextBox      ;17220;0    ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=PurchaseLine."Amount Including VAT" - PurchaseLine.Amount;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Purchase Header"."Currency Code" }
            { 220 ;Shape        ;0    ;0    ;210  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 221 ;Shape        ;11130;0    ;210  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 222 ;Shape        ;19320;0    ;210  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19530;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(NbVATLine = 3);
                         END;

          }
          CONTROLS
          {
            { 109 ;TextBox      ;630  ;0    ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         CaptionML=FRA=% TVA;
                                                         SourceExpr=VATAmountLine."VAT %" }
            { 110 ;TextBox      ;2940 ;0    ;2520 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         CaptionML=FRA=Base TVA;
                                                         SourceExpr=VATAmountLine."VAT Base";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Purchase Header"."Currency Code" }
            { 111 ;TextBox      ;5670 ;0    ;2520 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         CaptionML=FRA=Montant TVA;
                                                         SourceExpr=VATAmountLine."VAT Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Purchase Header"."Currency Code" }
            { 208 ;TextBox      ;11760;0    ;3780 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=AmountIncludingVATText }
            { 209 ;TextBox      ;17220;0    ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=PurchaseLine."Amount Including VAT";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Purchase Header"."Currency Code" }
            { 223 ;Shape        ;0    ;0    ;210  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 224 ;Shape        ;11130;0    ;210  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 225 ;Shape        ;19320;0    ;210  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19530;
            SectionHeight=423;
            OnPreSection=BEGIN
                              CurrReport.SHOWOUTPUT(NbVATLine > 3);
                         END;

          }
          CONTROLS
          {
            { 235 ;Shape        ;19320;0    ;210  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 238 ;Shape        ;11130;0    ;210  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 239 ;TextBox      ;5670 ;0    ;2520 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         CaptionML=FRA=Montant TVA;
                                                         SourceExpr=VATAmountLine."VAT Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Purchase Header"."Currency Code" }
            { 240 ;TextBox      ;2940 ;0    ;2520 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         CaptionML=FRA=Base TVA;
                                                         SourceExpr=VATAmountLine."VAT Base";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Purchase Header"."Currency Code" }
            { 241 ;TextBox      ;630  ;0    ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         CaptionML=FRA=% TVA;
                                                         SourceExpr=VATAmountLine."VAT %" }
            { 242 ;Shape        ;0    ;0    ;210  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=19530;
            SectionHeight=30;
          }
          CONTROLS
          {
            { 39  ;Shape        ;105  ;0    ;19320;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PlaceInBottom=No;
            SectionWidth=19530;
            SectionHeight=1269;
            OnPreSection=BEGIN
                               CurrReport.SHOWOUTPUT(NbVATLine = 0);
                         END;

          }
          CONTROLS
          {
            { 52  ;TextBox      ;11760;0    ;3780 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=AmountText }
            { 89  ;TextBox      ;17220;0    ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=PurchaseLine.Amount;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Purchase Header"."Currency Code" }
            { 105 ;TextBox      ;11760;423  ;3780 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr=VATAmountLine.VATAmountText }
            { 106 ;TextBox      ;17220;423  ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=PurchaseLine."Amount Including VAT" - PurchaseLine.Amount;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Purchase Header"."Currency Code" }
            { 107 ;TextBox      ;11760;846  ;3780 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=AmountIncludingVATText }
            { 154 ;TextBox      ;17220;846  ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=PurchaseLine."Amount Including VAT";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Purchase Header"."Currency Code" }
            { 226 ;Shape        ;0    ;0    ;210  ;1269 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 227 ;Shape        ;11130;0    ;210  ;1269 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 228 ;Shape        ;19320;0    ;210  ;1269 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PlaceInBottom=No;
            SectionWidth=19530;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(NbVATLine = 1);
                         END;

          }
          CONTROLS
          {
            { 213 ;TextBox      ;11760;0    ;3780 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr=VATAmountLine.VATAmountText }
            { 214 ;TextBox      ;11760;423  ;3780 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=AmountIncludingVATText }
            { 215 ;TextBox      ;17220;423  ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=PurchaseLine."Amount Including VAT";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Purchase Header"."Currency Code" }
            { 216 ;TextBox      ;17220;0    ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=PurchaseLine."Amount Including VAT"-PurchaseLine.Amount;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Purchase Header"."Currency Code" }
            { 229 ;Shape        ;0    ;0    ;210  ;846  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 230 ;Shape        ;11130;0    ;210  ;846  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 231 ;Shape        ;19320;0    ;210  ;846  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PlaceInBottom=No;
            SectionWidth=19530;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(NbVATLine = 2);
                         END;

          }
          CONTROLS
          {
            { 218 ;TextBox      ;11760;0    ;3780 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=AmountIncludingVATText }
            { 219 ;TextBox      ;17220;0    ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=PurchaseLine."Amount Including VAT";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Purchase Header"."Currency Code" }
            { 232 ;Shape        ;0    ;0    ;210  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 233 ;Shape        ;11130;0    ;210  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 234 ;Shape        ;19320;0    ;210  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PlaceInBottom=No;
            SectionWidth=19530;
            SectionHeight=30;
          }
          CONTROLS
          {
            { 243 ;Shape        ;105  ;0    ;19320;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=Document Footer;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            PlaceInBottom=Yes;
            SectionWidth=19530;
            SectionHeight=2115;
          }
          CONTROLS
          {
            { 1000000061;TextBox;210  ;423  ;2520 ;423  ;HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=No;
                                                         SourceExpr=TextShipment }
            { 1000000062;TextBox;210  ;846  ;2520 ;423  ;HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=No;
                                                         SourceExpr=TextPayment }
            { 1000000063;TextBox;210  ;1269 ;19320;846  ;HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontSize=9;
                                                         MultiLine=Yes;
                                                         SourceExpr=DocFooter[1]+DocFooter[2]+DocFooter[3]+DocFooter[4]+DocFooter[5]+DocFooter[6]+DocFooter[7]+DocFooter[8]+DocFooter[9]+DocFooter[10] }
            { 1000000064;TextBox;2730 ;846  ;16800;423  ;HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=No;
                                                         SourceExpr=PaymentMethod.Description+'   '+PaymentTerms.Description }
            { 1000000065;TextBox;2730 ;423  ;16800;423  ;HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=No;
                                                         SourceExpr=ShipmentMethod.Description }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=6270;
      Height=1320;
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1   ;TextBox      ;3410 ;0    ;1650 ;440  ;CaptionML=FRA=Nombre de copies;
                                                   SourceExpr=NbCopy }
      { 21  ;Label        ;0    ;0    ;3300 ;440  ;ParentControl=1 }
      { 1000000001;TextBox;3410 ;660  ;1700 ;440  ;CaptionML=[ENU=Order Footer Comment;
                                                              FRA=Commentaire fin de commande];
                                                   SourceExpr=OrderFooterComment;
                                                   TableRelation="Standard Text".Code;
                                                   LookupFormID=Standard Text Codes }
      { 1000000002;Label  ;0    ;660  ;3300 ;440  ;ParentControl=1000000001 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      GLSetup@1000000002 : Record 98;
      ShipmentMethod@1000000003 : Record 10;
      PaymentTerms@1000000004 : Record 3;
      Purchaser@1000000005 : Record 13;
      CompanyInfo@1000000006 : Record 79;
      VATAmountLine@1000000007 : TEMPORARY Record 290;
      PurchaseLine@1000000008 : TEMPORARY Record 39;
      Vendor@1000000009 : Record 23;
      PurchasesSetup@1000000010 : Record 312;
      Item@1000000011 : Record 27;
      Country@1000000013 : Record 9;
      PaymentMethod@1000000014 : Record 289;
      PurchHeaderPrinted@1000000016 : Codeunit 317;
      FormatAddress@1000000017 : Codeunit 365;
      PurchPost@1000000018 : Codeunit 90;
      LegalText@1000000019 : ARRAY [5] OF Text[150];
      BuyFromVendorAddr@1000000021 : ARRAY [8] OF Text[50];
      CompanyAddress@1000000022 : ARRAY [8] OF Text[50];
      PurchaserText@1000000023 : Text[30];
      AmountText@1000000024 : Text[50];
      AmountIncludingVATText@1000000025 : Text[50];
      AccountCurrency@1000000040 : Text[30];
      MoreLines@1000000026 : Boolean;
      NbCopy@1000000027 : Integer;
      NbLoop@1000000028 : Integer;
      NbLegalTExt@1000000029 : Integer;
      CopyText@1000000030 : Text[30];
      i@1000000031 : Integer;
      NbVATLine@1000000032 : Integer;
      LineCounter@1000000033 : Integer;
      RecExiste@1000000034 : Boolean;
      OrderFooterComment@1000000035 : Code[10];
      VendorItemNo@1000000036 : Text[30];
      ItemNo@1000000037 : Text[50];
      DocFooter@1000000038 : ARRAY [10] OF Text[50];
      PurchaserPhoneText@1000000041 : Text[50];
      CompanyPhoneText@1000000042 : Text[50];
      PurchaserFaxText@1000000043 : Text[50];
      CompanyFaxText@1000000044 : Text[50];
      PurchaserEmailText@1000000045 : Text[150];
      CompanyEmailText@1000000046 : Text[150];
      Index@1000000047 : Text[30];
      TextPurchaser@1000000082 : TextConst 'ENU=Purchaser;FRA=Acheteur';
      TextPhone@1000000081 : TextConst 'ENU=Phone :;FRA="T‚l : "';
      TextFax@1000000080 : TextConst 'ENU="Fax : ";FRA="Fax : "';
      TextEmail@1000000079 : TextConst 'ENU="E-Mail : ";FRA=E-mail :';
      TextAmount@1000000078 : TextConst 'ENU=Amount %1;FRA=Total %1';
      TextAmountIncludingVAT@1000000077 : TextConst 'ENU=Amount including VAT %1;FRA=Total %1 TTC';
      TextCopy@1000000076 : TextConst 'ENU=COPY;FRA=COPIE';
      TextRegistrationNo@1000000075 : TextConst 'ENU="Registration No. : ";FRA="Nø Siret : "';
      TextIndex@1000000074 : TextConst 'ENU=Index :;FRA="Indice : "';
      TextCustomerNo@1000000073 : TextConst 'FRA=TEXTELEGALAES';
      TextPurchaseOrder@1000000072 : TextConst 'ENU=Purchase Order;FRA=Bon de commande';
      TextVendorItemNo@1000000071 : TextConst 'ENU=Your Item Ref.;FRA=V/r‚f article';
      TextOrderNo@1000000070 : TextConst 'ENU=Order No.;FRA=Nø de commande';
      TextVendorOrderNo@1000000069 : TextConst 'ENU=Your Order Reference.;FRA=V/Nø commande';
      TextVendorNo@1000000068 : TextConst 'ENU=Vend. No. :;FRA=Fourn. Nø :';
      TextAccountNo@1000000067 : TextConst 'ENU=Account No. :;FRA=Nø Cpt :';
      TextDate@1000000066 : TextConst 'ENU=Date;FRA=Date';
      TextExpectedReceiptDate@1000000065 : TextConst 'ENU=Expected Receipt Date :;FRA=Date de livraison souhait‚e :';
      TextLineExpectedReceiptDate@1000000064 : TextConst 'ENU=Deliv.;FRA=Livrais.';
      TextShipTo@1000000063 : TextConst 'ENU=Ship To;FRA=A livrer … :';
      TextPage@1000000062 : TextConst 'ENU="Page : ";FRA="Page : "';
      TextItemNo@1000000061 : TextConst 'ENU=Reference;FRA=R‚f‚rence';
      TextItemDesc@1000000060 : TextConst 'ENU=Description;FRA=D‚signation';
      TextShelfNo@1000000059 : TextConst 'ENU=Shelf No.;FRA=Nø Empl.';
      TextUnit@1000000058 : TextConst 'ENU=Unit;FRA=Unit‚';
      TextQuantity@1000000057 : TextConst 'ENU=Qty;FRA=Qt‚';
      TextOrderedQuantity@1000000056 : TextConst 'ENU=Qty / Order;FRA=Qt‚ / Commande';
      TextUnitPrice@1000000055 : TextConst 'ENU=Unit Price;FRA=Prix U.';
      TextAmountExcludingVAT@1000000054 : TextConst 'ENU=Amount;FRA=Montant HT';
      TextVATPercent@1000000053 : TextConst 'ENU=VAT %;FRA=% TVA';
      TextVATBase@1000000052 : TextConst 'ENU=VAT Base;FRA=Base TVA';
      TextVATAmount@1000000051 : TextConst 'ENU=VAT Amount;FRA=Montant TVA';
      TextAmounts@1000000050 : TextConst 'ENU=Amounts;FRA=Totaux';
      TextPostage@1000000049 : TextConst 'ENU=Postage :;FRA="Franco : "';
      TextPayment@1000000048 : TextConst 'ENU=Payment :;FRA=Paiement :';
      TextShipment@1000000039 : TextConst 'ENU=Shipment :;FRA=Port :';
      TextInvoiceDiscountAmount@1000000020 : TextConst 'ENU=Invoice Discount AMount;FRA=Montant remise facture';

    BEGIN
    {
      /** @r IMH01 @d 06/01/11 @a ISAT.MA @v IMH6.01.040 @s Isatech+ */
    }
    END.
  }
  RDLDATA
  {
  }
}