OBJECT Report 8016675 Etat 2054
{
  OBJECT-PROPERTIES
  {
    Date=18/09/12;
    Time=15:23:02;
    Modified=Yes;
    Version List=ISA6.01.00,IMISAT6.00;
  }
  PROPERTIES
  {
    TopMargin=1000;
    BottomMargin=1000;
    LeftMargin=1000;
    OnPreReport=BEGIN
                  DeprBook.GET(DeprBookCode);
                  DeprBookText := STRSUBSTNO('%1%2 %3',DeprBook.TABLECAPTION,':',DeprBookCode);

                  IF StartingDate = 0D THEN
                    ERROR(Text001);

                  IF EndingDate = 0D THEN
                    ERROR(Text002);

                  CompanyInfo.GET;
                END;

    OnPostReport=BEGIN
                   CLEAR(ReportBuffer);
                   ReportBuffer.SETRANGE("Code 1",USERID);
                   ReportBuffer.DELETEALL;
                 END;

  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table5600;
        OnAfterGetRecord=BEGIN
                           CurrReport.BREAK;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18917;
            SectionHeight=846;
          }
          CONTROLS
          {
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemTable=Table5607;
        DataItemTableView=SORTING(Sort);
        OnPreDataItem=BEGIN
                        CLEAR(Total);
                      END;

        ReqFilterFields=Code;
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table5608;
        DataItemTableView=SORTING(Code)
                          WHERE(Display=CONST(Yes));
        OnPreDataItem=BEGIN
                        CLEAR(SubTotal);
                      END;

        OnAfterGetRecord=VAR
                           lAmount@1100481000 : ARRAY [6] OF Decimal;
                           lAmountUnit@1100281000 : ARRAY [6] OF Decimal;
                         BEGIN
                           CLEAR(Amount);
                           ReportBuffer.INIT;
                           ReportBuffer."Code 1" := USERID ;
                           ReportBuffer."Code 2" := FORMAT("FA Class".Sort) ;
                           ReportBuffer."Code 3" := "FA Class".Code ;
                           ReportBuffer."Code 4" := "FA Subclass".Code ;
                           ReportBuffer."Data Text 1" := "FA Class".Name ;
                           ReportBuffer."Data Text 2" := "FA Subclass".Name ;
                           ReportBuffer.INSERT ;

                           FA.COPYFILTERS("Fixed Asset");
                           FA.SETRANGE("FA Class Code","FA Class Code");
                           FA.SETRANGE("FA Subclass Code",Code);
                           IF FA.FINDFIRST THEN
                           BEGIN
                             REPEAT
                               FOR i := 1 TO 6 DO
                                 lAmountUnit[i] := 0;  // ISA02

                               IF FADeprBook.GET(FA."No.",DeprBookCode) THEN
                                 IF (FADeprBook."Disposal Date" >= StartingDate) OR (FADeprBook."Disposal Date" = 0D) THEN
                                 BEGIN
                                   FOR i := 1 TO 6 DO
                                     IF UsePostingDate THEN
                                       lAmountUnit[i] += FAGenReport.GetAmountWithPostingDate(i,FA."No.",FADeprBook."Depreciation Book Code",
                                                                                          StartingDate,EndingDate)
                                     ELSE
                                        // ISA02
                                        lAmountUnit[i] += FAGenReport.GetAmount(i,FA."No.",FADeprBook."Depreciation Book Code",
                                                    StartingDate,EndingDate);

                                       //lAmount[i] += FAGenReport.GetAmount(i,FA."No.",FADeprBook."Depreciation Book Code",
                                       //                                    StartingDate,EndingDate);
                                       //lAmount[i] += GetAmount(i,FA."No.",FADeprBook."Depreciation Book Code");
                                  //<< ISA02
                                 ReportBufferDet.INIT;
                                 ReportBufferDet."Code 1" := USERID ;
                                 ReportBufferDet."Code 2" := "FA Class".Code ;
                                 ReportBufferDet."Code 3" := "FA Subclass".Code ;
                                 ReportBufferDet."Code 4" := FA."No.";
                                 ReportBufferDet."Data Text 1" := FA.Description;
                                 ReportBufferDet."Data Amount 1" := lAmountUnit[1] ;
                                 ReportBufferDet."Data Amount 2" := lAmountUnit[2] ;
                                 ReportBufferDet."Data Amount 3" := lAmountUnit[3] - lAmountUnit[4] - lAmountUnit[5];
                                 ReportBufferDet."Data Amount 4" := lAmountUnit[4] ;
                                 ReportBufferDet."Data Amount 5" := - lAmountUnit[5] ;
                                 ReportBufferDet."Data Amount 6" := - lAmountUnit[6] ;
                                 ReportBufferDet."Data Amount 7" := ReportBufferDet."Data Amount 1" +
                                                                 ReportBufferDet."Data Amount 2" +
                                                                 ReportBufferDet."Data Amount 3" +
                                                                 ReportBufferDet."Data Amount 4" -
                                                                 ReportBufferDet."Data Amount 5" -
                                                                 ReportBufferDet."Data Amount 6";
                                 ReportBufferDet.INSERT;
                                 //>> ISA02
                                 END;
                                 FOR i := 1 TO 6 DO
                                   lAmount[i] += lAmountUnit[i]; // ISA02
                             UNTIL FA.NEXT = 0 ;
                             ReportBuffer."Data Amount 1" := lAmount[1] ;
                             ReportBuffer."Data Amount 2" := lAmount[2] ;
                             ReportBuffer."Data Amount 3" := lAmount[3] - lAmount[4] - lAmount[5];
                             ReportBuffer."Data Amount 4" := lAmount[4] ;
                             ReportBuffer."Data Amount 5" := - lAmount[5] ; // ISA02
                             ReportBuffer."Data Amount 6" := - lAmount[6] ; // ISA02
                             ReportBuffer."Data Amount 7" := ABS(ReportBuffer."Data Amount 1") +
                                                             ABS(ReportBuffer."Data Amount 2") +
                                                             ABS(ReportBuffer."Data Amount 3") +
                                                             ABS(ReportBuffer."Data Amount 4") -
                                                             ABS(ReportBuffer."Data Amount 5") -
                                                             ABS(ReportBuffer."Data Amount 6");
                             ReportBuffer.MODIFY;
                           END;
                         END;

        ReqFilterFields=Code;
        DataItemLink=FA Class Code=FIELD(Code);
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        NewPagePerRecord=Yes;
        DataItemVarName=PageLoop;
        OnPreDataItem=BEGIN
                        SETRANGE(Number,1,2);
                        CLEAR(Total);
                      END;

        OnAfterGetRecord=BEGIN
                           CASE Number OF
                             1 :
                             BEGIN
                               Title[1] := Text011 ;
                               Title[2] := Text012 ;
                               Title[3] := Text013 ;
                               Title[4] := Text014 ;
                             END;
                             2 :
                             BEGIN
                               Title[1] := Text021 ;
                               Title[2] := Text022 ;
                               Title[3] := Text023 ;
                               Title[4] := Text024 ;
                             END;
                           END;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18917;
            SectionHeight=2538;
          }
          CONTROLS
          {
            { 1100481000;TextBox;0    ;1692 ;10050;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr=DeprBookText }
            { 1100481026;TextBox;0    ;1269 ;4800 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr=STRSUBSTNO(TextEndDate,EndingDate) }
            { 1100481027;TextBox;0    ;846  ;4800 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr=STRSUBSTNO(TextStartDate,StartingDate) }
            { 1100481028;TextBox;0    ;423  ;7500 ;423  ;FontSize=9;
                                                         SourceExpr=COMPANYNAME }
            { 1100481029;TextBox;0    ;0    ;11336;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=Text000 }
            { 1100481030;TextBox;14236;0    ;4658 ;423  ;HorzAlign=Right;
                                                         SourceExpr=STRSUBSTNO('%1 %2',FORMAT(TODAY,0,4),FORMAT(TIME)) }
            { 1100481031;TextBox;16644;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
            { 1100481032;Label  ;17702;424  ;750  ;423  ;ParentControl=1100481033 }
            { 1100481033;TextBox;18452;424  ;450  ;423  ;CaptionML=[ENU=Page;
                                                                    FRA=Page];
                                                         SourceExpr=CurrReport.PAGENO }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table8016755;
        DataItemTableView=SORTING(Code 1,Code 2,Code 3,Code 4,Integer 1,Integer 2,Date 1,Date 2,Boolean 1,Boolean 2,Entry No.);
        OnPreDataItem=BEGIN
                        SETRANGE("Code 1",USERID);
                      END;

        TotalFields=Data Amount 1,Data Amount 2,Data Amount 3,Data Amount 4,Data Amount 5,Data Amount 6,Data Amount 7,Data Amount 8;
        GroupTotalFields=Code 3;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18917;
            SectionHeight=1692;
          }
          CONTROLS
          {
            { 1100481073;Shape  ;0    ;0    ;150  ;1692 ;ShapeStyle=VertLine }
            { 1100481074;Shape  ;75   ;1618 ;18767;30   ;ShapeStyle=HorzLine }
            { 1100481075;Label  ;150  ;0    ;5267 ;1617 ;HorzAlign=Center;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=FRA=Nom }
            { 1100481076;TextBox;5566 ;0    ;3150 ;1612 ;HorzAlign=Center;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         MultiLine=Yes;
                                                         SourceExpr=Title[1] }
            { 1100481077;Shape  ;5397 ;0    ;150  ;1692 ;ShapeStyle=VertLine }
            { 1100481078;TextBox;8866 ;0    ;3150 ;1611 ;HorzAlign=Center;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         MultiLine=Yes;
                                                         SourceExpr=Title[2] }
            { 1100481079;Shape  ;8717 ;0    ;150  ;1691 ;ShapeStyle=VertLine }
            { 1100481080;TextBox;12166;0    ;3150 ;1611 ;HorzAlign=Center;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         MultiLine=Yes;
                                                         SourceExpr=Title[3] }
            { 1100481081;Shape  ;12016;0    ;150  ;1692 ;ShapeStyle=VertLine }
            { 1100481082;Shape  ;15316;0    ;150  ;1665 ;ShapeStyle=VertLine }
            { 1100481083;TextBox;15466;0    ;3222 ;1611 ;HorzAlign=Center;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         MultiLine=Yes;
                                                         SourceExpr=Title[4] }
            { 1100481084;Shape  ;18767;0    ;150  ;1691 ;ShapeStyle=VertLine }
            { 1100481085;Shape  ;75   ;2    ;18768;30   ;ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=18917;
            SectionHeight=876;
          }
          CONTROLS
          {
            { 1100481005;Shape  ;0    ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 1100481006;TextBox;150  ;0    ;5241 ;846  ;FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         SourceExpr="Data Text 1" }
            { 1100481007;Shape  ;5397 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 1100481009;Shape  ;8717 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 1100481011;Shape  ;12017;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 1100481013;Shape  ;15317;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 1100481016;Shape  ;18767;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 1100281000;Shape  ;75   ;846  ;18767;30   ;ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18917;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(PageLoop.Number = 1);
                         END;

          }
          CONTROLS
          {
            { 1100481001;Shape  ;0    ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 1100481002;Shape  ;5397 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 1100481003;TextBox;5567 ;0    ;3000 ;846  ;FontSize=9;
                                                         SourceExpr=ABS("Data Amount 1") }
            { 1100481004;Shape  ;8717 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 1100481014;TextBox;8867 ;0    ;3000 ;846  ;FontSize=9;
                                                         SourceExpr=ABS("Data Amount 2") }
            { 1100481044;Shape  ;12017;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 1100481057;TextBox;12167;0    ;3000 ;846  ;FontSize=9;
                                                         SourceExpr="Data Amount 3" }
            { 1100481058;Shape  ;15317;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 1100481059;TextBox;15467;0    ;3150 ;846  ;FontSize=9;
                                                         SourceExpr="Data Amount 4" }
            { 1100481060;Shape  ;18767;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 1100481017;TextBox;150  ;0    ;5241 ;846  ;FontSize=9;
                                                         MultiLine=Yes;
                                                         SourceExpr="Data Text 2" }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18917;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(PageLoop.Number = 2);
                         END;

          }
          CONTROLS
          {
            { 1100481008;Shape  ;0    ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 1100481010;TextBox;150  ;0    ;5241 ;846  ;FontSize=9;
                                                         MultiLine=Yes;
                                                         SourceExpr="Data Text 2" }
            { 1100481012;Shape  ;5397 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 1100481015;TextBox;5567 ;0    ;3000 ;846  ;FontSize=9;
                                                         SourceExpr=ABS("Data Amount 5") }
            { 1100481022;Shape  ;8717 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 1100481024;TextBox;8867 ;0    ;3000 ;846  ;FontSize=9;
                                                         SourceExpr=ABS("Data Amount 6") }
            { 1100481034;Shape  ;12017;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 1100481035;TextBox;12167;0    ;3000 ;846  ;FontSize=9;
                                                         SourceExpr="Data Amount 7" }
            { 1100481036;Shape  ;15317;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 1100481037;TextBox;15467;0    ;3150 ;846  ;FontSize=9;
                                                         SourceExpr="Data Amount 7" }
            { 1100481038;Shape  ;18767;0    ;150  ;846  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=18917;
            SectionHeight=881;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(PageLoop.Number = 1);
                         END;

          }
          CONTROLS
          {
            { 1100481051;Shape  ;0    ;0    ;150  ;876  ;ShapeStyle=VertLine }
            { 1100481052;Shape  ;75   ;851  ;18767;30   ;ShapeStyle=HorzLine }
            { 1100481053;Label  ;150  ;0    ;5250 ;846  ;HorzAlign=Right;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=TOTAL;
                                                                    FRA=TOTAL] }
            { 1100481054;Shape  ;75   ;0    ;18767;30   ;ShapeStyle=HorzLine }
            { 1100481055;Shape  ;5397 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 1100481061;Shape  ;8717 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 1100481063;Shape  ;12017;0    ;150  ;872  ;ShapeStyle=VertLine }
            { 1100481065;Shape  ;15317;0    ;150  ;872  ;ShapeStyle=VertLine }
            { 1100481067;Shape  ;18767;0    ;150  ;872  ;ShapeStyle=VertLine }
            { 1100481114;TextBox;5550 ;0    ;3000 ;846  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=ABS("Data Amount 1") }
            { 1100481116;TextBox;8850 ;0    ;3000 ;846  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=ABS("Data Amount 2") }
            { 1100481118;TextBox;12150;0    ;3000 ;846  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr="Data Amount 3" }
            { 1100481120;TextBox;15450;0    ;3150 ;846  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr="Data Amount 4" }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=18917;
            SectionHeight=881;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(PageLoop.Number = 2);
                         END;

          }
          CONTROLS
          {
            { 1100481039;Shape  ;0    ;0    ;150  ;876  ;ShapeStyle=VertLine }
            { 1100481040;Shape  ;75   ;851  ;18767;30   ;ShapeStyle=HorzLine }
            { 1100481041;Label  ;150  ;0    ;5250 ;846  ;HorzAlign=Right;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=TOTAL;
                                                                    FRA=TOTAL] }
            { 1100481042;Shape  ;75   ;0    ;18767;30   ;ShapeStyle=HorzLine }
            { 1100481043;Shape  ;5397 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 1100481045;TextBox;5550 ;0    ;3000 ;846  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=ABS("Data Amount 5") }
            { 1100481046;Shape  ;8717 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 1100481047;TextBox;8850 ;0    ;3000 ;846  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=ABS("Data Amount 6") }
            { 1100481048;Shape  ;12017;0    ;150  ;872  ;ShapeStyle=VertLine }
            { 1100481049;TextBox;12150;0    ;3000 ;846  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr="Data Amount 7" }
            { 1100481050;Shape  ;15317;0    ;150  ;872  ;ShapeStyle=VertLine }
            { 1100481056;TextBox;15450;0    ;3150 ;846  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr="Data Amount 7" }
            { 1100481062;Shape  ;18767;0    ;150  ;872  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=18917;
            SectionHeight=30;
          }
          CONTROLS
          {
            { 1100481098;Shape  ;75   ;0    ;18767;30   ;ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18917;
            SectionHeight=881;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(PageLoop.Number = 1);
                         END;

          }
          CONTROLS
          {
            { 1100481068;Shape  ;75   ;851  ;18794;30   ;ShapeStyle=HorzLine }
            { 1100481069;Shape  ;12017;0    ;150  ;872  ;ShapeStyle=VertLine }
            { 1100481070;Shape  ;15317;0    ;150  ;872  ;ShapeStyle=VertLine }
            { 1100481071;Shape  ;18767;0    ;150  ;872  ;ShapeStyle=VertLine }
            { 1100481072;Label  ;159  ;0    ;5223 ;846  ;HorzAlign=Right;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=TOTAL GENERAL;
                                                                    FRA=TOTAL GENERAL] }
            { 1100481099;Shape  ;5397 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 1100481101;Shape  ;8717 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 1100481105;Shape  ;0    ;0    ;150  ;876  ;ShapeStyle=VertLine }
            { 1100481115;TextBox;5550 ;0    ;3000 ;846  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=ABS("Data Amount 1") }
            { 1100481117;TextBox;8850 ;0    ;3000 ;846  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=ABS("Data Amount 2") }
            { 1100481119;TextBox;12150;0    ;3000 ;846  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr="Data Amount 3" }
            { 1100481121;TextBox;15450;0    ;3150 ;846  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr="Data Amount 4" }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18917;
            SectionHeight=881;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(PageLoop.Number = 2);
                         END;

          }
          CONTROLS
          {
            { 1100481064;Shape  ;0    ;0    ;150  ;876  ;ShapeStyle=VertLine }
            { 1100481066;Shape  ;75   ;851  ;18794;30   ;ShapeStyle=HorzLine }
            { 1100481086;Label  ;159  ;0    ;5223 ;846  ;HorzAlign=Right;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=TOTAL GENERAL;
                                                                    FRA=TOTAL GENERAL] }
            { 1100481087;Shape  ;5397 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 1100481088;TextBox;5550 ;0    ;3000 ;846  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=ABS("Data Amount 5") }
            { 1100481089;Shape  ;8717 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 1100481090;TextBox;8850 ;0    ;3000 ;846  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=ABS("Data Amount 6") }
            { 1100481091;Shape  ;12017;0    ;150  ;872  ;ShapeStyle=VertLine }
            { 1100481092;TextBox;12150;0    ;3000 ;846  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr="Data Amount 7" }
            { 1100481093;Shape  ;15317;0    ;150  ;872  ;ShapeStyle=VertLine }
            { 1100481094;TextBox;15450;0    ;3150 ;846  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr="Data Amount 7" }
            { 1100481095;Shape  ;18767;0    ;150  ;872  ;ShapeStyle=VertLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=FADetail;
        OnPreDataItem=BEGIN
                        // ISA02
                        ReportBufferDet.RESET;
                        ReportBufferDet.SETRANGE("Code 1","Reporting Buffer"."Code 1");
                        ReportBufferDet.SETRANGE("Code 2","Reporting Buffer"."Code 3");
                        ReportBufferDet.SETRANGE("Code 3","Reporting Buffer"."Code 4");
                        SETRANGE(Number,1,ReportBufferDet.COUNT);
                      END;

        OnAfterGetRecord=BEGIN
                           IF (Number = 1) THEN
                             ReportBufferDet.FINDFIRST
                           ELSE
                             ReportBufferDet.NEXT;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18917;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT((PageLoop.Number = 1) AND ShowDetail);
                         END;

          }
          CONTROLS
          {
            { 1100281001;Shape  ;18767;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 1100281002;TextBox;15467;0    ;3150 ;846  ;FontSize=9;
                                                         FontItalic=Yes;
                                                         SourceExpr=ReportBufferDet."Data Amount 4" }
            { 1100281003;Shape  ;15317;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 1100281004;TextBox;12167;0    ;3000 ;846  ;FontSize=9;
                                                         FontItalic=Yes;
                                                         SourceExpr=ReportBufferDet."Data Amount 3" }
            { 1100281005;Shape  ;12017;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 1100281006;TextBox;8867 ;0    ;3000 ;846  ;FontSize=9;
                                                         FontItalic=Yes;
                                                         SourceExpr=ReportBufferDet."Data Amount 2" }
            { 1100281007;Shape  ;8717 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 1100281008;TextBox;5567 ;0    ;3000 ;846  ;FontSize=9;
                                                         FontItalic=Yes;
                                                         SourceExpr=ReportBufferDet."Data Amount 1" }
            { 1100281009;Shape  ;5397 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 1100281010;TextBox;150  ;0    ;5241 ;846  ;FontSize=9;
                                                         FontItalic=Yes;
                                                         MultiLine=Yes;
                                                         SourceExpr=ReportBufferDet."Code 4" + ' ' + ReportBufferDet."Data Text 1" }
            { 1100281011;Shape  ;0    ;0    ;150  ;846  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18917;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT((PageLoop.Number = 2) AND ShowDetail);
                         END;

          }
          CONTROLS
          {
            { 1100281012;Shape  ;18767;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 1100281013;TextBox;15467;0    ;3150 ;846  ;FontSize=9;
                                                         FontItalic=Yes;
                                                         SourceExpr=ReportBufferDet."Data Amount 7" }
            { 1100281014;Shape  ;15317;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 1100281015;TextBox;12167;0    ;3000 ;846  ;FontSize=9;
                                                         FontItalic=Yes;
                                                         SourceExpr=ReportBufferDet."Data Amount 7" }
            { 1100281016;Shape  ;12017;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 1100281017;TextBox;8867 ;0    ;3000 ;846  ;FontSize=9;
                                                         FontItalic=Yes;
                                                         SourceExpr=ReportBufferDet."Data Amount 6" }
            { 1100281018;Shape  ;8717 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 1100281019;TextBox;5567 ;0    ;3000 ;846  ;FontSize=9;
                                                         FontItalic=Yes;
                                                         SourceExpr=ReportBufferDet."Data Amount 5" }
            { 1100281020;Shape  ;5397 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 1100281021;TextBox;150  ;0    ;5241 ;846  ;FontSize=9;
                                                         FontItalic=Yes;
                                                         MultiLine=Yes;
                                                         SourceExpr=ReportBufferDet."Code 4" + ' ' + ReportBufferDet."Data Text 1" }
            { 1100281022;Shape  ;0    ;0    ;150  ;846  ;ShapeStyle=VertLine }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=7150;
      Height=4070;
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1100481000;TextBox;3410 ;550  ;1700 ;440  ;InPage=-1;
                                                   CaptionML=[ENU=Starting Date;
                                                              FRA=Date d‚but];
                                                   SourceExpr=StartingDate }
      { 1100481001;Label  ;0    ;550  ;3300 ;440  ;ParentControl=1100481000;
                                                   InPage=-1 }
      { 1100481003;TextBox;3410 ;1100 ;1700 ;440  ;InPage=-1;
                                                   CaptionML=[ENU=Ending Date;
                                                              FRA=Date de fin];
                                                   SourceExpr=EndingDate }
      { 1100481004;Label  ;0    ;1100 ;3300 ;440  ;ParentControl=1100481003;
                                                   InPage=-1 }
      { 1100481002;Label  ;0    ;0    ;3300 ;440  ;ParentControl=1100481005;
                                                   InPage=-1 }
      { 1100481005;TextBox;3410 ;0    ;2750 ;440  ;InPage=-1;
                                                   CaptionML=[ENU=Depreciation Book;
                                                              FRA=Lois d'amortissement];
                                                   SourceExpr=DeprBookCode;
                                                   TableRelation="Depreciation Book" }
      { 1100281001;CheckBox;0   ;1760 ;440  ;440  ;InPage=-1;
                                                   ShowCaption=No;
                                                   CaptionML=FRA=Utiliser la date de comptabilisation et non la date de compta. immo. comme r‚f‚rence pour les calculs;
                                                   SourceExpr=UsePostingDate }
      { 1100281002;Label  ;660  ;1760 ;6380 ;1100 ;ParentControl=1100281001;
                                                   MultiLine=Yes }
      { 1100281000;Label  ;660  ;2970 ;6380 ;440  ;ParentControl=1100281003;
                                                   MultiLine=Yes }
      { 1100281003;CheckBox;0   ;2970 ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=FRA=Afficher le d‚tail des acquisitions;
                                                   SourceExpr=ShowDetail }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      CompanyInfo@1100281000 : Record 79;
      Text000@1100481010 : TextConst 'FRA=LIASSE FISCALE 2054 : ETAT DU PATRIMOINE';
      Text001@1100481017 : TextConst 'ENU=You must enter a Begin Date.;FRA=Veuillez entrer une date de d‚but.';
      Text002@1100481018 : TextConst 'ENU=You must enter an Ending Date.;FRA=Veuillez entrer une date de fin.';
      Text010@1100281001 : TextConst;
      Text011@1100281002 : TextConst 'FRA=Valeur brute des immobilisations au d‚but de l''exercice';
      Text012@1100281003 : TextConst 'FRA=Augmentation suite … une r‚evaluation au cours de l''exercice';
      Text013@1100281004 : TextConst 'FRA=Augmentation par acquisitions, cr‚ations ou apports';
      Text014@1100281005 : TextConst 'FRA=Augmentation suite … des virements de poste … poste';
      FA@1100481008 : Record 5600;
      DeprBook@1100481020 : Record 5611;
      FADeprBook@1100481016 : Record 5612;
      ReportBuffer@1100481022 : Record 8016755;
      FAGenReport@1100481013 : Codeunit 5626;
      DeprBookCode@1100481019 : Code[10];
      Title@1100481000 : ARRAY [4] OF Text[100];
      Text021@1100481007 : TextConst 'FRA=Diminution suite … des virements de poste … poste';
      Text022@1100481006 : TextConst 'FRA=Diminution par cessions … des tiers ou mises hors service';
      Text023@1100481005 : TextConst 'FRA=Valeur brute des immobilisations … la fin de l''exercice';
      Text024@1100481004 : TextConst 'FRA=Valeur d''origine des immobilisations en fin d''exercice';
      DeprBookText@1100481021 : Text[100];
      Amount@1100481009 : ARRAY [4] OF Decimal;
      SubTotal@1100481001 : ARRAY [4] OF Decimal;
      Total@1100481002 : ARRAY [4] OF Decimal;
      StartingDate@1100481014 : Date;
      EndingDate@1100481015 : Date;
      i@1100481003 : Integer;
      TextStartDate@1100481011 : TextConst 'FRA=Date d‚but : %1';
      TextEndDate@1100481012 : TextConst 'FRA=Date fin : %1';
      UsePostingDate@1180044000 : Boolean;
      ReportBufferDet@1100281006 : TEMPORARY Record 8016755;
      ShowDetail@1100281008 : Boolean;

    PROCEDURE GetAmount@1100481000(pAmountNo@1100481000 : Integer;pFANo@1100481003 : Code[20];pFADeprBookCode@1100481001 : Code[20]) rAmount : Decimal;
    VAR
      lFADeprBook@1100481006 : Record 5612;
      lAmount1@1100481002 : Decimal;
      lAmount2@1100481005 : Decimal;
      lAmount3@1100481007 : Decimal;
      lAmount4@1100481008 : Decimal;
      lAmount5@1100481009 : Decimal;
    BEGIN
      CASE pAmountNo OF
        1 :   // Mt amort. d‚but d'ex.
        BEGIN
          rAmount := FAGenReport.CalcFAPostedAmount(pFANo,lFADeprBook.FIELDNO("Acquisition Cost"),0,
                                                    StartingDate,EndingDate,pFADeprBookCode,
                                                    0,0,FALSE,TRUE);
        END;
        2 : // Augm. : R‚evaluation
        BEGIN
          rAmount := FAGenReport.CalcFAPostedAmount(pFANo,lFADeprBook.FIELDNO(Appreciation),1,
                                                    StartingDate,EndingDate,pFADeprBookCode,
                                                    0,0,FALSE,TRUE);
        END;
        3 : // Augm. : Acq. , cr‚ation ou apports
        BEGIN
          rAmount := FAGenReport.CalcFAPostedAmount(pFANo,lFADeprBook.FIELDNO("Acquisition Cost"),1,
                                                    StartingDate,EndingDate,pFADeprBookCode,
                                                    0,0,FALSE,TRUE);
        END;
        4 : // Augm. : Virts poste … poste.
        BEGIN
          rAmount := FAGenReport.CalcFAPostedAmount(pFANo,lFADeprBook.FIELDNO("Acquisition Cost"),1,
                                                    StartingDate,EndingDate,pFADeprBookCode,
                                                    0,0,TRUE,TRUE);
          IF rAmount < 0 THEN
            rAmount := 0 ;
        END;
        5 : // Dim. : Virts poste … poste
        BEGIN
          rAmount := FAGenReport.CalcFAPostedAmount(pFANo,lFADeprBook.FIELDNO("Acquisition Cost"),1,
                                                    StartingDate,EndingDate,pFADeprBookCode,
                                                    0,0,TRUE,TRUE);
          IF rAmount > 0 THEN
            rAmount := 0
        END;
        6 : // Dim. : Cession … des tiers ou mises hors services
        BEGIN
          rAmount := FAGenReport.CalcGLPostedAmount(pFANo,lFADeprBook.FIELDNO("Acquisition Cost"),1,
                                                    StartingDate,EndingDate,pFADeprBookCode);
        END;
      END;
    END;

    BEGIN
    {
      /** @r IMH01 @d 06/07/11 @a ISAT.ST @v IMH6.01.151 @s Immobilisation */
    }
    END.
  }
  RDLDATA
  {
  }
}