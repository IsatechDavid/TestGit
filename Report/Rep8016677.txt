OBJECT Report 8016677 Derogatory Report
{
  OBJECT-PROPERTIES
  {
    Date=18/09/12;
    Time=15:23:17;
    Modified=Yes;
    Version List=ISA6.01.00,IMISAT6.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Etat du d‚rogatoire;
               FRA=Etat du d‚rogatoire];
    BottomMargin=0;
    OnPreReport=BEGIN
                  FAFilter := "Fixed Asset".GETFILTERS;
                  GenDeprBook.GET(GenDeprBookCode);
                  GenDeprBookText := STRSUBSTNO(Text001,GenDeprBook.TABLECAPTION,GenDeprBookCode);
                  FiscDeprBook.GET(GenDeprBookCode);
                  FiscDeprBookText := STRSUBSTNO(Text002,FiscDeprBook.TABLECAPTION,FDeprBookCode);

                  CompanyInfo.GET;
                END;

    Orientation=Landscape;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table5600;
        DataItemTableView=SORTING(FA Subclass Code);
        PrintOnlyIfDetail=No;
        OnPreDataItem=BEGIN
                        CurrReport.CREATETOTALS(GenFADeprBook.Depreciation,GenFADeprBook."Acquisition Cost",GenFADeprBook."Book Value");
                        CurrReport.CREATETOTALS(FiscFADeprBook.Depreciation,FiscFADeprBook."Acquisition Cost",FiscFADeprBook."Book Value");
                        CurrReport.CREATETOTALS(DeprAmount[1],DeprAmount[2],DeprAmount[3],DeprAmount[4]);
                      END;

        OnAfterGetRecord=BEGIN
                           IF Inactive THEN
                             CurrReport.SKIP;

                           GenFADeprBook.SETFILTER("FA Posting Date Filter",'%1..%2',StartingDate,EndingDate);
                           GenFADeprBook.SETRANGE("FA No.","No.");
                           GenFADeprBook.SETRANGE("Depreciation Book Code",GenDeprBookCode);
                           IF NOT GenFADeprBook.FIND('-') THEN
                             CurrReport.SKIP;

                           FiscFADeprBook.SETFILTER("FA Posting Date Filter",'%1..%2',StartingDate,EndingDate);
                           FiscFADeprBook.SETRANGE("FA No.","No.");
                           FiscFADeprBook.SETRANGE("Depreciation Book Code",FDeprBookCode);
                           IF NOT FiscFADeprBook.FIND('-') THEN
                             CurrReport.SKIP;

                           GenFADeprBook.CALCFIELDS(Depreciation,"Acquisition Cost","Book Value");
                           FiscFADeprBook.CALCFIELDS(Depreciation,"Acquisition Cost","Book Value");

                           IF (GenFADeprBook."Book Value" = FiscFADeprBook."Book Value") THEN
                             CurrReport.SKIP;

                           CalcDeprValue;

                           CASE GenFADeprBook."Depreciation Method" OF
                             GenFADeprBook."Depreciation Method"::"Straight-Line" :
                               GenDeprMethodText := STRSUBSTNO(Text010, FORMAT(GenFADeprBook."No. of Depreciation Years",0,'<Integer>'));
                             GenFADeprBook."Depreciation Method"::"DB1/SL",
                             GenFADeprBook."Depreciation Method"::"DB2/SL" :
                               GenDeprMethodText := STRSUBSTNO(Text011, FORMAT(GenFADeprBook."No. of Depreciation Years",0,'<Integer>'),
                                                                       GenFADeprBook."Declining-Balance %") ;
                             ELSE
                               GenDeprMethodText := STRSUBSTNO('%1.%2',FORMAT(GenFADeprBook."Depreciation Method",GenFADeprBook."No. of Depreciation Years"))
                           ;
                           END;

                           CASE FiscFADeprBook."Depreciation Method" OF
                             FiscFADeprBook."Depreciation Method"::"Straight-Line" :
                               FiscDeprMethodText := STRSUBSTNO(Text010,FORMAT(FiscFADeprBook."No. of Depreciation Years",0,'<Integer>')) ;
                             FiscFADeprBook."Depreciation Method"::"DB1/SL",
                             FiscFADeprBook."Depreciation Method"::"DB2/SL" :
                               FiscDeprMethodText := STRSUBSTNO(Text011,FORMAT(FiscFADeprBook."No. of Depreciation Years",0,'<Integer>')
                                                                       ,FiscFADeprBook."Declining-Balance %") ;
                             ELSE
                               FiscDeprMethodText := STRSUBSTNO('%1.%2',FORMAT(FiscFADeprBook."Depreciation Method"),
                                                                        FORMAT(FiscFADeprBook."No. of Depreciation Years",0,'<Integer>'));
                           END;

                           IF FASubclass.GET("FA Subclass Code") THEN;

                           GenFADeprBook.SETFILTER("FA Posting Date Filter",'..%1',EndingDate);
                           GenFADeprBook.SETRANGE("FA No.","No.");
                           GenFADeprBook.SETRANGE("Depreciation Book Code",GenDeprBookCode);
                           IF NOT GenFADeprBook.FIND('-') THEN
                             CurrReport.SKIP;

                           FiscFADeprBook.SETFILTER("FA Posting Date Filter",'..%1',EndingDate);
                           FiscFADeprBook.SETRANGE("FA No.","No.");
                           FiscFADeprBook.SETRANGE("Depreciation Book Code",FDeprBookCode);
                           IF NOT FiscFADeprBook.FIND('-') THEN
                             CurrReport.SKIP;
                           GenFADeprBook.CALCFIELDS(Depreciation,"Acquisition Cost","Book Value");
                           FiscFADeprBook.CALCFIELDS(Depreciation,"Acquisition Cost","Book Value");

                           IF (rupture <> "Fixed Asset"."FA Subclass Code") AND
                              (rupture <> '') THEN
                              CurrReport.NEWPAGE;

                           rupture := "Fixed Asset"."FA Subclass Code";
                         END;

        ReqFilterFields=No.,FA Class Code,FA Subclass Code;
        GroupTotalFields=FA Subclass Code;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=25941;
            SectionHeight=2961;
          }
          CONTROLS
          {
            { 1100281069;TextBox;0    ;1692 ;8100 ;423  ;FontSize=9;
                                                         SourceExpr=GenDeprBookText }
            { 1100481000;TextBox;0    ;1269 ;4800 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr=STRSUBSTNO(textenddate,EndingDate) }
            { 1100481001;TextBox;0    ;846  ;4800 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr=STRSUBSTNO(textstartdate,StartingDate) }
            { 1100481002;TextBox;0    ;423  ;5400 ;423  ;FontSize=11;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo.Name }
            { 1100481003;TextBox;0    ;0    ;9000 ;423  ;HorzAlign=Center;
                                                         FontSize=12;
                                                         FontBold=Yes;
                                                         SourceExpr=Text000 }
            { 1100481004;TextBox;22606;0    ;3150 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 1100481005;TextBox;22606;423  ;3150 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         SourceExpr=FORMAT(TIME) }
            { 1100481006;TextBox;23506;846  ;2250 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         SourceExpr=USERID }
            { 1100481007;Label  ;24256;1269 ;1050 ;423  ;ParentControl=1100481008;
                                                         HorzAlign=Right;
                                                         FontSize=9;
                                                         CaptionML=[ENU=Page :;
                                                                    FRA="Page : "] }
            { 1100481008;TextBox;25306;1269 ;450  ;423  ;FontSize=9;
                                                         CaptionML=[ENU=Page;
                                                                    FRA=Page];
                                                         SourceExpr=CurrReport.PAGENO }
            { 1000000000;TextBox;0    ;2088 ;8100 ;423  ;FontSize=9;
                                                         SourceExpr=FiscDeprBookText }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=25941;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT((CurrReport.PAGENO = 1) AND (FAFilter <> ''));
                         END;

          }
          CONTROLS
          {
            { 19  ;TextBox      ;0    ;0    ;19800;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         FontBold=No;
                                                         SourceExpr="Fixed Asset".TABLECAPTION + ': ' + FAFilter }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=25941;
            SectionHeight=2115;
          }
          CONTROLS
          {
            { 1100281006;Shape  ;0    ;633  ;30   ;1482 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281008;Label  ;0    ;846  ;1650 ;846  ;HorzAlign=Center;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=No.;
                                                                    FRA=Nø] }
            { 1100281009;Shape  ;27   ;423  ;25650;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1100281010;Shape  ;1650 ;633  ;300  ;1482 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281011;Label  ;1950 ;846  ;5550 ;846  ;FontSize=9;
                                                         FontBold=Yes;
                                                         FontItalic=No;
                                                         CaptionML=[ENU=Description;
                                                                    FRA=D‚signation] }
            { 1100281024;Shape  ;7500 ;633  ;300  ;1482 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281025;Label  ;7800 ;846  ;1500 ;449  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=First Depr. Date;
                                                                    FRA=D‚but Comptable] }
            { 1100281026;Shape  ;9300 ;633  ;300  ;1482 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281027;Label  ;9600 ;846  ;2400 ;423  ;HorzAlign=Left;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Depreciation Method;
                                                                    FRA=M‚thode amortissement] }
            { 1100281028;Shape  ;12012;633  ;300  ;1455 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281029;Label  ;12300;846  ;2400 ;449  ;HorzAlign=Left;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Period Depreciation;
                                                                    FRA=Valeur actif Cpt] }
            { 1100281030;Label  ;15000;846  ;2400 ;423  ;HorzAlign=Left;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Gen. Acquisition Cost;
                                                                    FRA=Dotation Comptable] }
            { 1100281032;Shape  ;14711;633  ;300  ;1482 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281033;Shape  ;17400;633  ;300  ;1482 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281034;Label  ;17700;846  ;2400 ;423  ;HorzAlign=Left;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Period Depreciation;
                                                                    FRA=Cumul provision] }
            { 1100281035;Shape  ;20100;660  ;300  ;1455 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281036;Label  ;20400;846  ;2400 ;423  ;HorzAlign=Left;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Period Depreciation;
                                                                    FRA=Provision d‚rog.] }
            { 1100281038;Shape  ;22800;633  ;300  ;1482 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281039;Label  ;23100;846  ;2400 ;846  ;HorzAlign=Center;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Book Value;
                                                                    FRA=Solde d‚rog.] }
            { 1100281040;Label  ;12300;1269 ;2400 ;423  ;HorzAlign=Left;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Period Depreciation;
                                                                    FRA=Valeur Actif Fisc] }
            { 1100281042;Label  ;15000;1269 ;2400 ;423  ;HorzAlign=Left;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Fiscal Acquisition Cost;
                                                                    FRA=Dotation Fiscale] }
            { 1100281044;Label  ;17700;1269 ;2400 ;423  ;HorzAlign=Left;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Period Depreciation;
                                                                    FRA=Cumul reprise] }
            { 1100281046;Label  ;20400;1269 ;2400 ;423  ;HorzAlign=Left;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Period Depreciation;
                                                                    FRA=Reprise d‚rog.] }
            { 1100281047;Label  ;9600 ;1269 ;2400 ;423  ;HorzAlign=Left;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Depreciation Method;
                                                                    FRA=M‚thode amortissement] }
            { 1100281048;Label  ;7800 ;1269 ;1500 ;449  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=First Depr. Date;
                                                                    FRA=D‚but Fiscale] }
            { 1100281049;Shape  ;25500;633  ;300  ;1482 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281050;Shape  ;0    ;1692 ;25650;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=25941;
            SectionHeight=2115;
            KeepWithNext=Yes;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := FALSE;
                         END;

          }
          CONTROLS
          {
            { 1000000030;Shape  ;0    ;633  ;30   ;1482 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000031;Label  ;0    ;846  ;1650 ;846  ;HorzAlign=Center;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=No.;
                                                                    FRA=Nø] }
            { 1000000032;Shape  ;27   ;423  ;25650;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000033;Shape  ;1650 ;633  ;300  ;1482 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000034;Label  ;1950 ;846  ;5550 ;846  ;FontSize=9;
                                                         FontBold=Yes;
                                                         FontItalic=No;
                                                         CaptionML=[ENU=Description;
                                                                    FRA=D‚signation] }
            { 1000000035;Shape  ;7500 ;633  ;300  ;1482 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000036;Label  ;7800 ;846  ;1500 ;449  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=First Depr. Date;
                                                                    FRA=D‚but Comptable] }
            { 1000000037;Shape  ;9300 ;633  ;300  ;1482 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000038;Label  ;9600 ;846  ;2400 ;423  ;HorzAlign=Left;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Depreciation Method;
                                                                    FRA=M‚thode amortissement] }
            { 1000000040;Shape  ;12012;633  ;300  ;1455 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000047;Label  ;12300;846  ;2400 ;449  ;HorzAlign=Left;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Period Depreciation;
                                                                    FRA=Valeur actif Cpt] }
            { 1000000050;Label  ;15000;846  ;2400 ;423  ;HorzAlign=Left;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Gen. Acquisition Cost;
                                                                    FRA=Dotation Comptable] }
            { 1000000056;Shape  ;14711;633  ;300  ;1482 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000057;Shape  ;17400;633  ;300  ;1482 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000058;Label  ;17700;846  ;2400 ;423  ;HorzAlign=Left;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Period Depreciation;
                                                                    FRA=Cumul provision] }
            { 1000000059;Shape  ;20100;660  ;300  ;1455 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000060;Label  ;20400;846  ;2400 ;423  ;HorzAlign=Left;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Period Depreciation;
                                                                    FRA=Provision d‚rog.] }
            { 1000000061;Shape  ;22800;633  ;300  ;1482 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000062;Label  ;23100;846  ;2400 ;846  ;HorzAlign=Center;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Book Value;
                                                                    FRA=Solde d‚rog.] }
            { 1000000063;Label  ;12300;1269 ;2400 ;423  ;HorzAlign=Left;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Period Depreciation;
                                                                    FRA=Valeur Actif Fisc] }
            { 1000000064;Label  ;15000;1269 ;2400 ;423  ;HorzAlign=Left;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Fiscal Acquisition Cost;
                                                                    FRA=Dotation Fiscale] }
            { 1000000065;Label  ;17700;1269 ;2400 ;423  ;HorzAlign=Left;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Period Depreciation;
                                                                    FRA=Cumul reprise] }
            { 1000000070;Label  ;20400;1269 ;2400 ;423  ;HorzAlign=Left;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Period Depreciation;
                                                                    FRA=Reprise d‚rog.] }
            { 1000000071;Label  ;9600 ;1269 ;2400 ;423  ;HorzAlign=Left;
                                                         VertAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Depreciation Method;
                                                                    FRA=M‚thode amortissement] }
            { 1000000088;Label  ;7800 ;1269 ;1500 ;449  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=First Depr. Date;
                                                                    FRA=D‚but Fiscale] }
            { 1000000089;Shape  ;25500;633  ;300  ;1482 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000090;Shape  ;0    ;1692 ;25650;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=25941;
            SectionHeight=877;
          }
          CONTROLS
          {
            { 1000000026;TextBox;0    ;0    ;1650 ;423  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         FontBold=No;
                                                         SourceExpr="Fixed Asset"."No." }
            { 1000000039;Shape  ;0    ;0    ;30   ;846  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000041;Shape  ;1650 ;0    ;300  ;846  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000042;TextBox;1950 ;0    ;5550 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         FontBold=No;
                                                         SourceExpr="Fixed Asset".Description }
            { 1000000043;Shape  ;7500 ;0    ;300  ;846  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000044;TextBox;7800 ;0    ;1500 ;423  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         SourceExpr=GenFADeprBook."Depreciation Starting Date" }
            { 1000000045;Shape  ;9300 ;0    ;300  ;846  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000046;TextBox;9600 ;0    ;2400 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr=GenDeprMethodText }
            { 1000000048;Shape  ;12000;0    ;300  ;846  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000049;TextBox;12300;0    ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=GenFADeprBook."Acquisition Cost" }
            { 1000000051;Shape  ;14700;0    ;300  ;846  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000052;TextBox;15000;0    ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         SourceExpr=-GenFADeprBook.Depreciation }
            { 1000000053;Shape  ;20100;0    ;300  ;846  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000055;Shape  ;25500;0    ;300  ;846  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000001;TextBox;7800 ;423  ;1500 ;423  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         SourceExpr=FiscFADeprBook."Depreciation Starting Date" }
            { 1000000002;TextBox;9600 ;423  ;2400 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr=FiscDeprMethodText }
            { 1000000010;Shape  ;0    ;847  ;25650;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000011;TextBox;12300;423  ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=FiscFADeprBook."Acquisition Cost" }
            { 1000000012;TextBox;15000;423  ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         SourceExpr=-FiscFADeprBook.Depreciation }
            { 1000000021;Shape  ;17400;0    ;300  ;846  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000079;Shape  ;22800;0    ;300  ;846  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000080;TextBox;17700;0    ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         SourceExpr=DeprAmount[1] }
            { 1000000081;TextBox;17700;423  ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         SourceExpr=DeprAmount[2] }
            { 1100281002;TextBox;20400;0    ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         SourceExpr=DeprAmount[3] }
            { 1100281013;TextBox;20400;423  ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         SourceExpr=DeprAmount[4] }
            { 1100281014;TextBox;23100;0    ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         SourceExpr=DeprAmount[1] + DeprAmount[3] }
            { 1100281015;TextBox;23100;423  ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         SourceExpr=DeprAmount[2] + DeprAmount[4] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=25941;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := FALSE;
                         END;

          }
          CONTROLS
          {
            { 1100281037;Shape  ;0    ;0    ;25650;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1100281051;TextBox;12300;423  ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=FiscFADeprBook."Acquisition Cost" }
            { 1100281052;Label  ;0    ;0    ;1650 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=TOTAl;
                                                                    FRA=Total] }
            { 1100281054;TextBox;12300;0    ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=GenFADeprBook."Acquisition Cost" }
            { 1100281055;TextBox;15012;423  ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=-FiscFADeprBook.Depreciation }
            { 1100281056;TextBox;15000;0    ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=-GenFADeprBook.Depreciation }
            { 1100281057;Shape  ;25491;0    ;300  ;846  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281058;TextBox;17700;423  ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=DeprAmount[2] }
            { 1100281059;TextBox;17700;0    ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=DeprAmount[1] }
            { 1100281060;TextBox;20400;423  ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=DeprAmount[4] }
            { 1100281061;TextBox;20400;0    ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=DeprAmount[3] }
            { 1100281062;TextBox;23100;423  ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=DeprAmount[2] + DeprAmount[4] }
            { 1100281063;TextBox;23100;0    ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=DeprAmount[1] + DeprAmount[3] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=25941;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             CurrReport.TOTALSCAUSEDBY = "Fixed Asset".FIELDNO("FA Subclass Code");
                         END;

          }
          CONTROLS
          {
            { 1000000020;Shape  ;0    ;0    ;25650;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1100281078;TextBox;12300;423  ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=FiscFADeprBook."Acquisition Cost" }
            { 1000000018;Label  ;0    ;0    ;1650 ;423  ;ParentControl=1000000022;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=TOTAl;
                                                                    FRA=Total] }
            { 1000000022;TextBox;1800 ;0    ;7050 ;423  ;HorzAlign=Left;
                                                         FontSize=10;
                                                         SourceExpr=STRSUBSTNO('%1 %2',FASubclass.Code,FASubclass.Name) }
            { 1000000025;TextBox;12300;0    ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=GenFADeprBook."Acquisition Cost" }
            { 1000000082;TextBox;15012;423  ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=-FiscFADeprBook.Depreciation }
            { 1000000083;TextBox;15000;0    ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=-GenFADeprBook.Depreciation }
            { 1100281000;Shape  ;25491;0    ;300  ;846  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281001;TextBox;17700;423  ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=DeprAmount[2] }
            { 1100281003;TextBox;17700;0    ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=DeprAmount[1] }
            { 1100281004;TextBox;20400;423  ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=DeprAmount[4] }
            { 1100281005;TextBox;20400;0    ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=DeprAmount[3] }
            { 1100281016;TextBox;23100;423  ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=DeprAmount[2] + DeprAmount[4] }
            { 1100281017;TextBox;23100;0    ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=DeprAmount[1] + DeprAmount[3] }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=25941;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1100281007;Shape  ;0    ;0    ;25650;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=25941;
            SectionHeight=1345;
          }
          CONTROLS
          {
            { 1100281043;Label  ;0    ;0    ;6900 ;423  ;FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=PERIOD ACQUISITIONS TOTAL;
                                                                    FRA=TOTAL ACQUISITIONS DE LA PERIODE] }
            { 1100281045;Shape  ;0    ;0    ;25650;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1100281068;Shape  ;12197;0    ;13650;423  ;BorderWidth=1pt;
                                                         ShapeStyle=Rectangle }
            { 1100281041;TextBox;12300;0    ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=GenFADeprBook."Acquisition Cost" }
            { 1000000003;Shape  ;12197;396  ;13650;423  ;BorderWidth=1pt;
                                                         ShapeStyle=Rectangle }
            { 1000000004;TextBox;12300;423  ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=FiscFADeprBook."Acquisition Cost" }
            { 1000000005;Shape  ;17400;0    ;300  ;846  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000007;Shape  ;20100;0    ;300  ;846  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000084;TextBox;15000;0    ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=-GenFADeprBook.Depreciation }
            { 1000000085;TextBox;15000;423  ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=-FiscFADeprBook.Depreciation }
            { 1000000086;Shape  ;14700;0    ;300  ;846  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281012;Shape  ;22800;0    ;300  ;846  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1100281018;TextBox;17700;423  ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=DeprAmount[2] }
            { 1100281019;TextBox;17700;0    ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=DeprAmount[1] }
            { 1100281020;TextBox;20400;423  ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=DeprAmount[4] }
            { 1100281021;TextBox;20400;0    ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=DeprAmount[3] }
            { 1100281022;TextBox;23100;423  ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=DeprAmount[2] + DeprAmount[4] }
            { 1100281023;TextBox;23100;0    ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=DeprAmount[1] + DeprAmount[3] }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=7040;
      Height=2750;
      SaveValues=Yes;
      OnOpenForm=BEGIN
                   FASetup.GET;
                   GenDeprBookCode := FASetup."Default Depr. Book";
                   FDeprBookCode := FASetup."Fiscal Depr. Book";

                   CompInfo.GET;
                 END;

    }
    CONTROLS
    {
      { 1100281004;TextBox;3410 ;1760 ;1650 ;440  ;InPage=-1;
                                                   CaptionML=[ENU=End Date;
                                                              FRA=Date fin];
                                                   SourceExpr=EndingDate }
      { 1100281005;Label  ;0    ;1760 ;3300 ;440  ;ParentControl=1100281004;
                                                   InPage=-1 }
      { 1100281006;Label  ;0    ;1210 ;3300 ;440  ;ParentControl=1100281007;
                                                   InPage=-1 }
      { 1100281007;TextBox;3410 ;1210 ;1650 ;440  ;InPage=-1;
                                                   CaptionML=[ENU=Starting Date;
                                                              FRA=Date d‚but];
                                                   SourceExpr=StartingDate }
      { 1100281000;TextBox;3410 ;0    ;2750 ;440  ;InPage=-1;
                                                   CaptionML=[ENU=Depreciation Book;
                                                              FRA=Lois d'amortissement];
                                                   SourceExpr=GenDeprBookCode;
                                                   TableRelation="Depreciation Book" }
      { 1100281001;Label  ;0    ;0    ;3300 ;440  ;ParentControl=1100281000;
                                                   InPage=-1;
                                                   CaptionML=[ENU=General Depreciation Book;
                                                              FRA=Loi d'amortissement comptable] }
      { 1000000000;TextBox;3410 ;550  ;2750 ;440  ;InPage=-1;
                                                   CaptionML=[ENU=Depreciation Book;
                                                              FRA=Lois d'amortissement];
                                                   SourceExpr=FDeprBookCode;
                                                   TableRelation="Depreciation Book" }
      { 1000000001;Label  ;0    ;550  ;3300 ;440  ;ParentControl=1000000000;
                                                   InPage=-1;
                                                   CaptionML=[ENU=Fiscal depreciation book;
                                                              FRA=Loi d'amortissement fiscale] }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      FASubclass@1100481002 : Record 5608;
      CompanyInfo@1100481001 : Record 79;
      FASetup@1000 : Record 5603;
      GenDeprBook@1001 : Record 5611;
      FiscDeprBook@1000000003 : Record 5611;
      GenDeprBookText@1100281007 : Text[50];
      FiscDeprBookText@1000000002 : Text[50];
      GenDeprMethodText@1000000009 : Text[50];
      FiscDeprMethodText@1000000012 : Text[50];
      GenFADeprBook@1100281005 : Record 5612;
      FiscFADeprBook@1000000008 : Record 5612;
      GenDeprBookCode@1100281006 : Code[10];
      FDeprBookCode@1000000001 : Code[10];
      Vendor@1100281000 : Record 23;
      FAFilter@1004 : Text[250];
      Text000@1100481000 : TextConst 'ENU=Fixed Asset - Acquisitions List;FRA=Amortissement d‚rogatoire';
      Text001@1000000006 : TextConst 'ENU=General %1 : %2;FRA=%1 comptable : %2';
      Text002@1000000007 : TextConst 'ENU=Fiscal %1 : %2;FRA=%1 fiscale : %2';
      Text50151@1000000004 : TextConst 'FRA=an(s)';
      Text50152@1000000005 : TextConst 'FRA=Mois';
      DeprMethod@1100281002 : 'L,D1,D2,D1L,D2L,P,M';
      StartingDate@1100281003 : Date;
      EndingDate@1100281004 : Date;
      textstartdate@1100281010 : TextConst 'ENU=Starting Date : %1;FRA=Date d‚but : %1';
      textenddate@1100281011 : TextConst 'ENU=Ending Date : %1;FRA=Date fin : %1';
      CreateHeader@1000000000 : Boolean;
      Text010@1000000010 : TextConst 'ENU=Lin;FRA=Lin-%1';
      Text011@1000000011 : TextConst 'FRA=Deg.Lin-%1(%2)';
      DeprAmount@1100281001 : ARRAY [4] OF Decimal;
      i@1100281008 : Integer;
      AccountingPeriod@1100281009 : Record 50;
      StartAccountingPeriod@1100281012 : Date;
      StartingPeriodDate@1100281014 : Date;
      EndingPeriodDate@1100281013 : Date;
      CompInfo@1100281017 : Record 79;
      rupture@1100281018 : Code[10];

    PROCEDURE CalcDeprValue@1100281004();
    BEGIN
      GenFADeprBook.SETFILTER("FA Posting Date Filter",'%1..%2',StartingDate,EndingDate);
      FiscFADeprBook.SETFILTER("FA Posting Date Filter",'%1..%2',StartingDate,EndingDate);

      AccountingPeriod.RESET;
      AccountingPeriod.SETRANGE("New Fiscal Year",TRUE);
      AccountingPeriod.SETRANGE(AccountingPeriod."Starting Date",0D,StartingDate);
      IF AccountingPeriod.FINDFIRST THEN
        StartAccountingPeriod := AccountingPeriod."Starting Date";

      AccountingPeriod.RESET;
      AccountingPeriod.SETRANGE("New Fiscal Year",TRUE);
      AccountingPeriod.SETRANGE(AccountingPeriod."Starting Date",StartAccountingPeriod,EndingDate);
      IF AccountingPeriod.FINDFIRST THEN
      BEGIN
        StartingPeriodDate := AccountingPeriod."Starting Date";
        IF (AccountingPeriod.NEXT = 0) THEN;
        REPEAT
          EndingPeriodDate := CALCDATE('-1J',AccountingPeriod."Starting Date");
          GenFADeprBook.SETFILTER("FA Posting Date Filter",'%1..%2',
          StartingPeriodDate,EndingPeriodDate);
          FiscFADeprBook.SETFILTER("FA Posting Date Filter",'%1..%2',
          StartingPeriodDate,EndingPeriodDate);
          GenFADeprBook.CALCFIELDS(Depreciation);
          FiscFADeprBook.CALCFIELDS(Depreciation);

          IF (-GenFADeprBook.Depreciation > -FiscFADeprBook.Depreciation) THEN
            DeprAmount[2] += - GenFADeprBook.Depreciation + FiscFADeprBook.Depreciation
          ELSE
            DeprAmount[1] += - FiscFADeprBook.Depreciation + GenFADeprBook.Depreciation;

          StartingPeriodDate := AccountingPeriod."Starting Date";
        UNTIL (AccountingPeriod.NEXT = 0);
      END;

      EndingPeriodDate := EndingDate;
      GenFADeprBook.SETFILTER("FA Posting Date Filter",'%1..%2',
      StartingPeriodDate,EndingPeriodDate);
      FiscFADeprBook.SETFILTER("FA Posting Date Filter",'%1..%2',
      StartingPeriodDate,EndingPeriodDate);
      GenFADeprBook.CALCFIELDS(Depreciation);
      FiscFADeprBook.CALCFIELDS(Depreciation);

      IF (- GenFADeprBook.Depreciation > - FiscFADeprBook.Depreciation) THEN
        DeprAmount[4] := - GenFADeprBook.Depreciation + FiscFADeprBook.Depreciation
      ELSE
        DeprAmount[3] := - FiscFADeprBook.Depreciation + GenFADeprBook.Depreciation;
    END;

    BEGIN
    {
      /** @r IMH01 @d 06/07/11 @a ISAT.ST @v IMH6.01.151 @s Immobilisation */
    }
    END.
  }
  RDLDATA
  {
  }
}