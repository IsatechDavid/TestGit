OBJECT Table 225 Post Code
{
  OBJECT-PROPERTIES
  {
    Date=15/10/13;
    Time=18:18:16;
    Modified=Yes;
    Version List=NAVW16.00.01,IMH6.01.08;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               //<<IMH13.isat.PC
               //<<IMH04.isat.PC
               //IF NOT CreatePostCode(Code,City,"Country/Region Code",'') THEN BEGIN
               //  ERROR(Text006);
               //END;
               //>>IMH04.isat.PC

               //<<IMH17.isat.PC
               GetUserSetup;
               IF NOT DisableLinked AND NOT UserSetup."Allowed To Change Post Code" THEN BEGIN
                 IF NOT Linked THEN BEGIN
                   ERROR(Text007);
                 END;
               END;
               //>>IMH17.isat.PC

               TouchRecord(TRUE);
               //>>IMH13.isat.PC
             END;

    OnModify=BEGIN
               //<<IMH13.isat.PC
               //<<IMH17.isat.PC
               GetUserSetup;
               IF NOT DisableLinked AND NOT UserSetup."Allowed To Change Post Code" THEN BEGIN
                 IF NOT Linked THEN BEGIN
                   ERROR(Text007);
                 END;
               END;
               //>>IMH17.isat.PC

               TouchRecord(FALSE);
               //>>IMH13.isat.PC
             END;

    OnDelete=BEGIN
               //<<IMH13.isat.PC
               //<<IMH17.isat.PC
               GetUserSetup;
               IF NOT DisableLinked AND NOT UserSetup."Allowed To Change Post Code" THEN BEGIN
                 IF NOT Linked THEN BEGIN
                   ERROR(Text007);
                 END;
               END;
               //>>IMH17.isat.PC
               //>>IMH13.isat.PC
             END;

    OnRename=BEGIN
               //<<IMH13.isat.PC
               //<<IMH17.isat.PC
               GetUserSetup;
               IF NOT DisableLinked AND NOT UserSetup."Allowed To Change Post Code" THEN BEGIN
                 IF NOT Linked THEN BEGIN
                   ERROR(Text007);
                 END;
               END;
               //>>IMH17.isat.PC

               TouchRecord(FALSE);
               //>>IMH13.isat.PC
             END;

    CaptionML=[ENU=Post Code;
               FRA=Code postal];
    LookupFormID=Form367;
    DrillDownFormID=Form367;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code20        ;OnValidate=VAR
                                                                PostCode@1000 : Record 225;
                                                              BEGIN
                                                                PostCode.SETCURRENTKEY("Search City");
                                                                PostCode.SETRANGE("Search City","Search City");
                                                                PostCode.SETRANGE(Code,Code);
                                                                IF PostCode.FIND('-') THEN
                                                                  ERROR(Text000,FIELDCAPTION(Code),Code);
                                                              END;

                                                   CaptionML=[ENU=Code;
                                                              FRA=Code];
                                                   NotBlank=Yes }
    { 2   ;   ;City                ;Text30        ;OnValidate=VAR
                                                                PostCode@1000 : Record 225;
                                                              BEGIN
                                                                TESTFIELD(Code);
                                                                //"Search City" := City;
                                                                "Search City" := ToolsMgt.GetSearchString(City);
                                                                //<<IMH15.isat.PC
                                                                //"City (Without Accent)" := CityWithoutAccent(City);
                                                                "City (Without Accent)" := CityWithoutAccent(City,MAXSTRLEN(City));
                                                                "City 2" := PostCode.CreateSimplyCity(City);
                                                                //>>IMH15.isat.PC
                                                                IF NOT SkipSearchCity THEN
                                                                IF xRec."Search City" <> "Search City" THEN BEGIN
                                                                  PostCode.SETCURRENTKEY("Search City");
                                                                  PostCode.SETRANGE("Search City","Search City");
                                                                  PostCode.SETRANGE(Code,Code);
                                                                  IF PostCode.FINDFIRST THEN
                                                                    ERROR(Text000,FIELDCAPTION(City),City);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=City;
                                                              FRA=Ville] }
    { 3   ;   ;Search City         ;Code30        ;CaptionML=[ENU=Search City;
                                                              FRA=Ville de recherche] }
    { 50000;  ;Geo. Reference Code ;Code10        ;TableRelation="Geographical Reference";
                                                   CaptionML=[ENU=Geographical Reference Code;
                                                              FRA=Code r‚f‚rence g‚ographique] }
    { 50001;  ;Area Code           ;Code10        ;TableRelation=Area;
                                                   OnValidate=VAR
                                                                lArea@1100281000 : Record 284;
                                                              BEGIN
                                                                IF lArea.GET("Area Code") THEN BEGIN
                                                                  "IMH Territory Code" := lArea."IMH Territory Code";
                                                                  "Admin. Territory Code" := lArea."Admin. Territory Code";
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Area Code;
                                                              FRA=Code d‚partement] }
    { 50002;  ;IMH Territory Code  ;Code10        ;TableRelation=Territory WHERE (Type=CONST(IMH));
                                                   CaptionML=[ENU=IMH Territory Code;
                                                              FRA=Zone IMH] }
    { 50003;  ;Admin. Territory Code;Code10       ;TableRelation=Territory WHERE (Type=CONST(Administratif));
                                                   CaptionML=[ENU=Admin. Territory Code;
                                                              FRA=Code r‚gion admin.] }
    { 50010;  ;Latitude Lambert 2E ;Integer       ;CaptionML=[ENU=Latitude;
                                                              FRA=Latitude Lambert 2E] }
    { 50011;  ;Longitude Lambert 2E;Integer       ;CaptionML=[ENU=Longitude;
                                                              FRA=Longitude Lambert 2E] }
    { 50012;  ;Latitude WGS64      ;Decimal       ;CaptionML=[ENU=Latitude;
                                                              FRA=Latitude WGS64] }
    { 50013;  ;Longitude WGS64     ;Decimal       ;CaptionML=[ENU=Longitude;
                                                              FRA=Longitude WGS64] }
    { 50020;  ;Country/Region Code ;Code10        ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Country/Region Code;
                                                              FRA=Code pays/r‚gion] }
    { 50030;  ;Link Post Code      ;Code20        ;OnValidate=BEGIN
                                                                //<<IMH13.isat.PC
                                                                VALIDATE(Linked,"Link Post Code" <> '');
                                                                //>>IMH13.isat.PC
                                                              END;

                                                   CaptionML=[ENU=Link Post Code;
                                                              FRA=Code postal li‚] }
    { 50031;  ;Link City           ;Text30        ;OnValidate=BEGIN
                                                                //<<IMH13.isat.PC
                                                                VALIDATE(Linked,"Link Post Code" <> '');
                                                                //>>IMH13.isat.PC
                                                              END;

                                                   CaptionML=[ENU=Link City;
                                                              FRA=Ville li‚] }
    { 50032;  ;Linked              ;Boolean       ;CaptionML=[ENU=Linked;
                                                              FRA=Li‚] }
    { 50033;  ;City 2              ;Text30         }
    { 50050;  ;Large Description   ;Text50        ;OnValidate=BEGIN
                                                                //<<IMH15.isat.PC
                                                                "Large Des. (Without Accent)" := CityWithoutAccent("Large Description",MAXSTRLEN("Large Description"));
                                                                //>>IMH15.isat.PC
                                                              END;

                                                   CaptionML=[ENU=Large Description;
                                                              FRA=D‚signation longue] }
    { 50100;  ;City (Without Accent);Text30       ;OnValidate=VAR
                                                                PostCode@1000 : Record 225;
                                                              BEGIN
                                                              END;

                                                   CaptionML=[ENU=City (Without Accent);
                                                              FRA=Ville (sans accent)] }
    { 50101;  ;Large Des. (Without Accent);Text50 ;CaptionML=[ENU=Large Des. (Without Accent);
                                                              FRA=D‚signation longue sans accent] }
    { 50200;  ;IMH Territory Description;Text50   ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Territory.Name WHERE (Code=FIELD(IMH Territory Code)));
                                                   CaptionML=[ENU=IMH Territory Description;
                                                              FRA=Zone IMH];
                                                   Editable=No }
    { 50201;  ;Admin. Territory Description;Text50;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Territory.Name WHERE (Code=FIELD(Admin. Territory Code)));
                                                   CaptionML=[ENU=Admin. Territory Description;
                                                              FRA=R‚gion administrative];
                                                   Editable=No }
    { 50202;  ;Area Description    ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Area.Text WHERE (Code=FIELD(Area Code)));
                                                   CaptionML=[ENU=Area Description;
                                                              FRA=Description d‚partement];
                                                   Editable=No }
    { 50203;  ;Country/Region Description;Text50  ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Country/Region.Name WHERE (Code=FIELD(Country/Region Code)));
                                                   CaptionML=[ENU=Country/Region Description;
                                                              FRA=Description code pays/r‚gion];
                                                   Editable=No }
    { 50500;  ;Creation Date       ;DateTime      ;CaptionML=[ENU=Creation Date;
                                                              FRA=Date de cr‚ation];
                                                   Editable=No }
    { 50501;  ;Creation User ID    ;Text30        ;CaptionML=[ENU=Creation User ID;
                                                              FRA=Utilisateur cr‚ation];
                                                   Editable=No }
    { 50502;  ;Last Modification Date;DateTime    ;CaptionML=[ENU=Last Modification Date;
                                                              FRA=Date derniŠre modification];
                                                   Editable=No }
    { 50503;  ;Last Modification User ID;Text30   ;CaptionML=[ENU=Last Modification User ID;
                                                              FRA=Utilisateur derniŠre modification];
                                                   Editable=No }
    { 60000;  ;LastUpdateFile      ;Date           }
  }
  KEYS
  {
    {    ;Code,City                               ;Clustered=Yes }
    {    ;City,Code                                }
    {    ;Search City                              }
    {    ;Geo. Reference Code                      }
    {    ;City (Without Accent)                    }
    {    ;Large Des. (Without Accent)              }
    {    ;Code,Area Code                           }
    {    ;City,Area Code                           }
    {    ;Link Post Code,Link City                 }
    {    ;Code,City 2                              }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;Code,City,Search City                    }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=%1 %2 already exists.;FRA=L''enregistrement %1 %2 existe d‚j….';
      Text001@1100281000 : TextConst 'ENU=Post code %1 does not exist;FRA=Le code postal %1 n''existe pas';
      Text002@1100281001 : TextConst 'ENU=Post code %1 does not exist.\Please, link it to a existing post code.;FRA=Le code postal %1 n''existe pas.\Veuillez le rattacher … un code postal existant.';
      Text003@1100281002 : TextConst 'ENU=City %1 don''t exist in area %2;FRA=La ville %1 n''existe pas dans le d‚partement %2';
      Text004@1100281003 : TextConst 'ENU=Post code must be fill.;FRA=Le code postal est obligatoire.';
      Text005@1100281004 : TextConst 'ENU=City must be fill.;FRA=Le nom de ville est obligatoire.';
      Text006@1100281005 : TextConst 'ENU=You must link to a exists post code.;FRA=Le rattachement … un code postal existant est obligatoire.';
      Text007@1100281006 : TextConst 'ENU=You can''t delete/modify a link post code - city;FRA=Vous ne pouvez pas supprimer/modifier un code postal - ville de lien';
      Text008@1100281007 : TextConst 'ENU=Post code and city must be fill;FRA=Un code postal et une ville sont obligatoires';
      Text009@1100281008 : TextConst 'ENU=Post code %1, city %2 has been created.;FRA=Le code postal %1, ville %2 a ‚t‚ cr‚‚.';
      UserSetup@1100281010 : Record 91;
      UserSetupOK@1100281011 : Boolean;
      DisableLinked@1100281009 : Boolean;
      ToolsMgt@1100281012 : Codeunit 8016602;
      SkipSearchCity@1100281013 : Boolean;
      Text010@1000000000 : TextConst 'ENU=Do you want to link\post code %1, city %2\with post code %3, city %4.;FRA=Souhaitez-vous cr‚er %2 (CP %1) et lier avec %4 (CP %3) ?';

    PROCEDURE ValidateCity@5(VAR pCity@1000 : Text[30];VAR pPostCode@1001 : Code[20];VAR pCountryRegionCode@1100281000 : Code[10]);
    VAR
      lPostCodeRec@1002 : Record 225;
      lPostCodeRec2@1004 : Record 225;
    BEGIN
      //<<IMH13.ISAT.PC
      IF pCity = '' THEN BEGIN
        pPostCode := '';
        pCountryRegionCode := '';
        EXIT;
      END;

      lPostCodeRec.SETCURRENTKEY("Search City");
      lPostCodeRec.SETFILTER("Search City",pCity);

      IF pPostCode <> '' THEN BEGIN
        lPostCodeRec.SETFILTER(Code,pPostCode)
      END;

      IF lPostCodeRec.ISEMPTY THEN BEGIN
        IF LinkPostCode(pPostCode,pCity,pCountryRegionCode) THEN BEGIN
          lPostCodeRec.FINDFIRST;
        END ELSE BEGIN
          EXIT;
        END;
      END ELSE BEGIN
        lPostCodeRec.FINDFIRST;
        lPostCodeRec2.COPY(lPostCodeRec);
        IF (lPostCodeRec2.NEXT = 1) AND GUIALLOWED THEN BEGIN
          IF FORM.RUNMODAL(FORM::"Post Codes",lPostCodeRec,lPostCodeRec.Code) <> ACTION::LookupOK THEN BEGIN
      //<<IMH14.isat.PC
      //      CreatePostCode(pPostCode,pCity,pCountryRegionCode,'');
      //>>IMH14.isat.PC
            lPostCodeRec.FINDFIRST;
          END;
        END;
      END;

      pPostCode := lPostCodeRec.Code;
      pCity := lPostCodeRec.City;
      pCountryRegionCode := lPostCodeRec."Country/Region Code";
      {
      IF NOT GUIALLOWED THEN
        EXIT;
      IF City <> '' THEN BEGIN
        SearchCity := City;
        PostCodeRec.SETCURRENTKEY("Search City");
        IF STRPOS(SearchCity,'*') = STRLEN(SearchCity) THEN
          PostCodeRec.SETFILTER("Search City",SearchCity)
        ELSE
          PostCodeRec.SETRANGE("Search City",SearchCity);
        IF NOT PostCodeRec.FIND('-') THEN
          EXIT;
        PostCodeRec2.COPY(PostCodeRec);
        IF PostCodeRec2.NEXT = 1 THEN
          IF FORM.RUNMODAL(FORM::"Post Codes",PostCodeRec,PostCodeRec.Code) <> ACTION::LookupOK THEN
            EXIT;
        PostCode := PostCodeRec.Code;
        City := PostCodeRec.City;
        //<<IMH09
        IF PostCodeRec."Country/Region Code" <> '' THEN
          pCountryRegionCode := PostCodeRec."Country/Region Code";
        //>>IMH09
      END ELSE BEGIN
      //<<IMH07
        PostCode := '';
      //>>IMH07
        //<<IMH09
        pCountryRegionCode := '';
        //>>IMH09
      END;
      }
      //>>IMH13.ISAT.PC
    END;

    PROCEDURE ValidatePostCode@6(VAR pCity@1001 : Text[30];VAR pPostCode@1000 : Code[20];VAR pCountryRegionCode@1100281000 : Code[10]);
    VAR
      lPostCodeRec@1002 : Record 225;
      lPostCodeRec2@1003 : Record 225;
    BEGIN
      //<<IMH13.ISAT.PC

      IF pPostCode = '' THEN BEGIN
        pCity := '';
        pCountryRegionCode := '';
        EXIT;
      END;

      lPostCodeRec.SETFILTER(Code,pPostCode);

      IF pCity <> '' THEN BEGIN
        lPostCodeRec.SETFILTER(City,pCity)
      END;

      IF lPostCodeRec.ISEMPTY THEN BEGIN
        IF LinkPostCode(pPostCode,pCity,pCountryRegionCode) THEN BEGIN
          lPostCodeRec.FINDFIRST;
        END ELSE BEGIN
          EXIT;
        END;
      END ELSE BEGIN
        lPostCodeRec.FINDFIRST;
        lPostCodeRec2.COPY(lPostCodeRec);
        IF (lPostCodeRec2.NEXT = 1) AND GUIALLOWED THEN BEGIN
          IF FORM.RUNMODAL(FORM::"Post Codes",lPostCodeRec,lPostCodeRec.Code) <> ACTION::LookupOK THEN BEGIN
      //<<IMH14.isat.PC
      //      CreatePostCode(pPostCode,pCity,pCountryRegionCode,'');
      //>>IMH14.isat.PC
            lPostCodeRec.FINDFIRST;
          END;
        END;
      END;

      pPostCode := lPostCodeRec.Code;
      pCity := lPostCodeRec.City;
      pCountryRegionCode := lPostCodeRec."Country/Region Code";

      {
      IF PostCode <> '' THEN BEGIN
        IF STRPOS(PostCode,'*') = STRLEN(PostCode) THEN
          PostCodeRec.SETFILTER(Code,PostCode)
        ELSE
          PostCodeRec.SETRANGE(Code,PostCode);
        IF NOT PostCodeRec.FIND('-') THEN
          //<<IMH07
          //EXIT;
          ERROR(STRSUBSTNO(Text001,PostCode));
      //<<IMH09.ST
      { d‚sactiv‚
        IF City <> '' THEN BEGIN
          IF STRPOS(City,'*') = STRLEN(City) THEN
            PostCodeRec.SETFILTER(City,City)
          ELSE
            PostCodeRec.SETRANGE(City,City);
        END;
      }
      //>>IMH09.ST
          //>>IMH07
        PostCodeRec2.COPY(PostCodeRec);
        IF (PostCodeRec2.NEXT = 1) AND GUIALLOWED THEN
          IF FORM.RUNMODAL(FORM::"Post Codes",PostCodeRec,PostCodeRec.Code) <> ACTION::LookupOK THEN
            EXIT;
        PostCode := PostCodeRec.Code;
        City := PostCodeRec.City;
        //<<IMH09
        IF PostCodeRec."Country/Region Code" <> '' THEN
          pCountryRegionCode := PostCodeRec."Country/Region Code";
        //>>IMH09
      END ELSE BEGIN
      //<<IMH07
        City := '';
      //>>IMH07
        //<<IMH09
        pCountryRegionCode := '';
        //>>IMH09
      END;
      }
      //>>IMH13.ISAT.PC
    END;

    PROCEDURE LookUpCity@7(VAR City@1001 : Text[30];VAR PostCode@1000 : Code[20];VAR pCountryRegionCode@1100281000 : Code[10];ReturnValues@1002 : Boolean);
    VAR
      PostCodeRec@1003 : Record 225;
    BEGIN
      IF NOT GUIALLOWED THEN
        EXIT;
      PostCodeRec.SETCURRENTKEY(City,Code);
      PostCodeRec.Code := PostCode;
      PostCodeRec.City := City;
      IF (FORM.RUNMODAL(FORM::"Post Codes",PostCodeRec,PostCodeRec.City) = ACTION::LookupOK) AND ReturnValues THEN BEGIN
        PostCode := PostCodeRec.Code;
        City := PostCodeRec.City;
        //<<IMH09
        IF PostCodeRec."Country/Region Code" <> '' THEN
          pCountryRegionCode := PostCodeRec."Country/Region Code";
        //>>IMH09
      END;
    END;

    PROCEDURE LookUpPostCode@8(VAR City@1001 : Text[30];VAR PostCode@1000 : Code[20];VAR pCountryRegionCode@1100281000 : Code[10];ReturnValues@1002 : Boolean);
    VAR
      PostCodeRec@1003 : Record 225;
    BEGIN
      IF NOT GUIALLOWED THEN
        EXIT;
      PostCodeRec.SETCURRENTKEY(Code,City);
      PostCodeRec.Code := PostCode;
      PostCodeRec.City := City;
      IF (FORM.RUNMODAL(FORM::"Post Codes",PostCodeRec,PostCodeRec.Code) = ACTION::LookupOK) AND ReturnValues THEN BEGIN
        PostCode := PostCodeRec.Code;
        City := PostCodeRec.City;
        //<<IMH09
        IF PostCodeRec."Country/Region Code" <> '' THEN
          pCountryRegionCode := PostCodeRec."Country/Region Code";
        //>>IMH09
      END;
    END;

    PROCEDURE GetReferenceGeoCode@1100281003(pPostCode@1001 : Code[20];pCity@1100281000 : Text[30]) : Code[10];
    VAR
      lPostCode@1002 : Record 225;
    BEGIN
      //<<IMH01.isat.PC
      IF NOT GUIALLOWED THEN BEGIN
        EXIT;
      END;

      IF (pPostCode = '') OR (pCity = '') THEN BEGIN
        EXIT;
      END;

      IF NOT lPostCode.GET(pPostCode,pCity) THEN BEGIN
        EXIT;
      END;

      EXIT(lPostCode."Geo. Reference Code");
      //>>IMH01.isat.PC
    END;

    PROCEDURE ValidateCity2@1100281005(VAR pCity@1000 : Text[30];VAR pPostCode@1001 : Code[20];VAR pAreaCode@1100281003 : Code[10];VAR pTerritoryCode@1100281002 : Code[10];VAR pIMHTerritoryCode@1100281007 : Code[10];VAR pRegionalCoordinator@1100281001 : Code[20];VAR pNetworkFacilitator@1100281005 : Code[20];VAR pNetworkAssistant@1100281006 : Code[20];VAR pCountryRegionCode@1100281000 : Code[10]);
    VAR
      lPostCodeRec@1002 : Record 225;
      lPostCodeRec2@1004 : Record 225;
      lArea@1100281004 : Record 284;
      lSearchCity@1003 : Code[30];
    BEGIN
      //<<IMH13.ISAT.PC

      IF pCity = '' THEN BEGIN
        pPostCode := '';
        pCountryRegionCode := '';
        pAreaCode := '';
        pTerritoryCode := '';
        pIMHTerritoryCode := '';
        pRegionalCoordinator := '';
        pNetworkFacilitator := '';
        pNetworkAssistant := '';
        EXIT;
      END;

      lPostCodeRec.SETCURRENTKEY("Search City");
      lPostCodeRec.SETFILTER("Search City",pCity);

      IF pPostCode <> '' THEN BEGIN
        lPostCodeRec.SETFILTER(Code,pPostCode)
      END;

      IF lPostCodeRec.ISEMPTY THEN BEGIN
        IF LinkPostCode(pPostCode,pCity,pCountryRegionCode) THEN BEGIN
          lPostCodeRec.FINDFIRST;
        END ELSE BEGIN
          EXIT;
        END;
      END ELSE BEGIN
        lPostCodeRec.FINDFIRST;
        lPostCodeRec2.COPY(lPostCodeRec);
        IF (lPostCodeRec2.NEXT = 1) AND GUIALLOWED THEN BEGIN
          IF FORM.RUNMODAL(FORM::"Post Codes",lPostCodeRec,lPostCodeRec.Code) <> ACTION::LookupOK THEN BEGIN
      //<<IMH14.isat.PC
      //      CreatePostCode(pPostCode,pCity,pCountryRegionCode,'');
      //>>IMH14.isat.PC
            lPostCodeRec.FINDFIRST;
          END;
        END;
      END;

      pPostCode := lPostCodeRec.Code;
      pCity := lPostCodeRec.City;
      pAreaCode := lPostCodeRec."Area Code";
      pTerritoryCode := lPostCodeRec."Admin. Territory Code";
      pIMHTerritoryCode := lPostCodeRec."IMH Territory Code";
      pCountryRegionCode := lPostCodeRec."Country/Region Code";
      IF lArea.GET(lPostCodeRec."Area Code") THEN BEGIN
        pRegionalCoordinator := lArea."Regional Coordinator";
        pNetworkAssistant := lArea."Network Assistant";
        pNetworkFacilitator := lArea."Network Facilitator";
      END;
      //>>IMH13.ISAT.PC
    END;

    PROCEDURE ValidatePostCode2@1100281000(VAR pCity@1001 : Text[30];VAR pPostCode@1000 : Code[20];VAR pAreaCode@1100281000 : Code[10];VAR pTerritoryCode@1100281001 : Code[10];VAR pIMHTerritoryCode@1100281008 : Code[10];VAR pRegionalCoordinator@1100281004 : Code[20];VAR pNetworkFacilitator@1100281005 : Code[20];VAR pNetworkAssistant@1100281007 : Code[20];VAR pCountryRegionCode@1100281003 : Code[10]);
    VAR
      lPostCodeRec@1002 : Record 225;
      lPostCodeRec2@1003 : Record 225;
      lArea@1100281002 : Record 284;
      lCounter@1100281006 : Integer;
    BEGIN
      //<<IMH13.ISAT.PC

      IF pPostCode = '' THEN BEGIN
        pCity := '';
        pCountryRegionCode := '';
        pAreaCode := '';
        pTerritoryCode := '';
        pIMHTerritoryCode := '';
        pRegionalCoordinator := '';
        pNetworkFacilitator := '';
        pNetworkAssistant := '';
        EXIT;
      END;

      lPostCodeRec.SETFILTER(Code,pPostCode);

      IF pCity <> '' THEN BEGIN
        lPostCodeRec.SETFILTER(City,pCity)
      END;

      IF lPostCodeRec.ISEMPTY THEN BEGIN
        IF LinkPostCode(pPostCode,pCity,pCountryRegionCode) THEN BEGIN
          lPostCodeRec.FINDFIRST;
        END ELSE BEGIN
          EXIT;
        END;
      END ELSE BEGIN
        lPostCodeRec.FINDFIRST;
        lPostCodeRec2.COPY(lPostCodeRec);
        IF (lPostCodeRec2.NEXT = 1) AND GUIALLOWED THEN BEGIN
          IF FORM.RUNMODAL(FORM::"Post Codes",lPostCodeRec,lPostCodeRec.Code) <> ACTION::LookupOK THEN BEGIN
      //<<IMH14.isat.PC
      //      CreatePostCode(pPostCode,pCity,pCountryRegionCode,'');
      //>>IMH14.isat.PC
            lPostCodeRec.FINDFIRST;
          END;
        END;
      END;

      pPostCode := lPostCodeRec.Code;
      pCity := lPostCodeRec.City;
      pAreaCode := lPostCodeRec."Area Code";
      pTerritoryCode := lPostCodeRec."Admin. Territory Code";
      pIMHTerritoryCode := lPostCodeRec."IMH Territory Code";
      pCountryRegionCode := lPostCodeRec."Country/Region Code";
      IF lArea.GET(lPostCodeRec."Area Code") THEN BEGIN
        pRegionalCoordinator := lArea."Regional Coordinator";
        pNetworkAssistant := lArea."Network Assistant";
        pNetworkFacilitator := lArea."Network Facilitator";
      END;
      //>>IMH13.ISAT.PC
    END;

    PROCEDURE LookUpCity2@1100281002(VAR pCity@1001 : Text[30];VAR pPostCode@1000 : Code[20];VAR pAreaCode@1100281003 : Code[10];VAR pTerritoryCode@1100281002 : Code[10];VAR pIMHTerritoryCode@1100281007 : Code[10];VAR pRegionalCoordinator@1100281001 : Code[20];VAR pNetworkFacilitator@1100281005 : Code[20];VAR pNetworkAssistant@1100281004 : Code[20];VAR pCountryRegionCode@1100281000 : Code[10];ReturnValues@1002 : Boolean);
    VAR
      PostCodeRec@1003 : Record 225;
      lArea@1100281006 : Record 284;
    BEGIN
      // IMH06.ISAT.MA

      IF NOT GUIALLOWED THEN
        EXIT;
      PostCodeRec.SETCURRENTKEY(City,Code);
      PostCodeRec.Code := pPostCode;
      PostCodeRec.City := pCity;
      IF (FORM.RUNMODAL(FORM::"Post Codes",PostCodeRec,PostCodeRec.City) = ACTION::LookupOK) AND ReturnValues THEN BEGIN
        pPostCode := PostCodeRec.Code;
        pCity := PostCodeRec.City;
        pAreaCode := PostCodeRec."Area Code";
        pTerritoryCode := PostCodeRec."Admin. Territory Code";
        pIMHTerritoryCode := PostCodeRec."IMH Territory Code";
        lArea.GET(PostCodeRec."Area Code");
        pRegionalCoordinator := lArea."Regional Coordinator";
        pNetworkAssistant := lArea."Network Assistant";
        pNetworkFacilitator := lArea."Network Facilitator";
        //<<IMH09
        IF PostCodeRec."Country/Region Code" <> '' THEN
          pCountryRegionCode := PostCodeRec."Country/Region Code";
        //>>IMH09
      END;
    END;

    PROCEDURE LookUpPostCode2@1100281001(VAR pCity@1001 : Text[30];VAR pPostCode@1000 : Code[20];VAR pAreaCode@1100281003 : Code[10];VAR pTerritoryCode@1100281002 : Code[10];VAR pIMHTerritoryCode@1100281007 : Code[10];VAR pRegionalCoordinator@1100281001 : Code[20];VAR pNetworkFacilitator@1100281005 : Code[20];VAR pNetworkAssistant@1100281000 : Code[20];VAR pCountryRegionCode@1100281004 : Code[10];ReturnValues@1002 : Boolean);
    VAR
      PostCodeRec@1003 : Record 225;
      lArea@1100281006 : Record 284;
    BEGIN
      // IMH06.ISAT.MA

      IF NOT GUIALLOWED THEN
        EXIT;
      PostCodeRec.SETCURRENTKEY(Code,City);
      PostCodeRec.Code := pPostCode;
      PostCodeRec.City := pCity;
      IF (FORM.RUNMODAL(FORM::"Post Codes",PostCodeRec,PostCodeRec.Code) = ACTION::LookupOK) AND ReturnValues THEN BEGIN
        pPostCode := PostCodeRec.Code;
        pCity := PostCodeRec.City;
        pAreaCode := PostCodeRec."Area Code";
        pTerritoryCode := PostCodeRec."Admin. Territory Code";
        pIMHTerritoryCode := PostCodeRec."IMH Territory Code";
        lArea.GET(PostCodeRec."Area Code");
        pRegionalCoordinator := lArea."Regional Coordinator";
        pNetworkAssistant := lArea."Network Assistant";
        pNetworkFacilitator := lArea."Network Facilitator";
        //<<IMH09
        IF PostCodeRec."Country/Region Code" <> '' THEN
          pCountryRegionCode := PostCodeRec."Country/Region Code";
        //>>IMH09
      END;
    END;

    PROCEDURE GetCoordinate@1100281004();
    VAR
      lAbilityGeoMgt@1100281000 : Codeunit 50011;
      lLatitude@1100281001 : Decimal;
      lLongitude@1100281002 : Decimal;
    BEGIN
      //<<IMH08.isat.PC
      // Pour r‚cup‚rer les latitude et longitude

      lAbilityGeoMgt.GetGeoCodeWGS84(Code,City,lLatitude,lLongitude);
      "Latitude Lambert 2E" := lLatitude;
      "Longitude Lambert 2E" := lLongitude;
      //>>IMH08.isat.PC
    END;

    PROCEDURE CityWithoutAccent@1100281006(pCity@1100281000 : Text[50];pLength@1100281003 : Integer) : Text[50];
    VAR
      lFromChar@1100281002 : Text[100];
      lToChar@1100281001 : Text[100];
      lTempCity@1100281004 : Text[50];
    BEGIN
      //<<IMH12.isat.PC
      // Conversion des noms de ville sans accent
      lFromChar := '·µ¶ÇŽ€ÔÒÓÞÖ×Øãàâå™ëéêš… ƒÆ„†‡Š‚ˆ‰¡Œ‹•¢“ä”—£–';
      lToChar := 'AAAAAACEEEEIIIIOOOOOUUUUaaaaaaceeeeiiiiooooouuuu';

      //<<IMH15.isat.PC
      //EXIT((CONVERTSTR(pCity,lFromChar,lToChar));
      lTempCity := COPYSTR(CONVERTSTR(pCity,lFromChar,lToChar),1,pLength);
      EXIT(lTempCity);
      //>>IMH15.isat.PC
      //>>IMH12.isat.PC
    END;

    PROCEDURE GetDescriptionCountry@1100281012(pCountryRegionCode@1100281001 : Code[10]) rValue : Text[50];
    VAR
      lCountryRegion@1100281000 : Record 9;
    BEGIN
      // IMH17
      rValue := '';

      IF NOT lCountryRegion.GET(pCountryRegionCode) THEN BEGIN
        EXIT;
      END;

      rValue := lCountryRegion.Name;
    END;

    PROCEDURE RefreshCoordinate@1100281011(VAR pPostCode@1100281000 : Record 225);
    VAR
      lAbilityGeo@1100281005 : Codeunit 50011;
      lLatitude@1100281003 : Decimal;
      lLongitude@1100281002 : Decimal;
      lRecordsUpdated@1100281001 : Integer;
      lText001@1100281004 : TextConst 'ENU=%1 lines updated on %2;FRA=%1 lignes mises … jour sur %2';
      lTotal@1100281006 : Integer;
    BEGIN
      // IMH17
      IF pPostCode.ISEMPTY THEN BEGIN
        EXIT;
      END;

      lTotal := pPostCode.COUNT;
      lRecordsUpdated := 0;

      IF pPostCode.FINDSET THEN BEGIN
        REPEAT
          lLatitude := 0;
          lLongitude := 0;
          lAbilityGeo.GetGeoCodeWGS84(pPostCode.Code, pPostCode.City, lLatitude, lLongitude);
          IF (lLatitude <> 0) AND (lLongitude <> 0) THEN BEGIN
            IF (lLatitude <> pPostCode."Latitude Lambert 2E") OR
               (lLongitude <> pPostCode."Longitude Lambert 2E")
            THEN BEGIN
              pPostCode."Latitude Lambert 2E"  := lLatitude;
              pPostCode."Longitude Lambert 2E" := lLongitude;
              pPostCode.MODIFY;
              lRecordsUpdated += 1;
            END;
          END;
        UNTIL pPostCode.NEXT = 0;
      END;
      MESSAGE(lText001,lRecordsUpdated,lTotal);
    END;

    PROCEDURE SetDisableLinked@1100281010(pDisableLinked@1100281000 : Boolean);
    BEGIN
      //<<IMH17.isat.PC
      DisableLinked := pDisableLinked;
      //>>IMH17.isat.PC
    END;

    PROCEDURE LinkPostCode@1100281007(pPostCode@1100281000 : Code[20];pCity@1100281001 : Text[30];pCountryCode@1100281005 : Code[10]) rValue : Boolean;
    VAR
      lPostCode@1100281002 : Record 225;
      lPostCode2@1100281004 : Record 225;
      lCounter@1100281003 : Integer;
    BEGIN
      // IMH13.isat.PC
      // permettre la liaison d'un nouveau code postal vers un code postal existant pour g‚ocodage

      rValue := FALSE;

      IF pPostCode <> '' THEN BEGIN
        lPostCode.SETFILTER(Code,pPostCode);
      END;
      IF pCity <> '' THEN BEGIN
        IF pPostCode = '' THEN BEGIN
          lPostCode.SETCURRENTKEY(City);
        END;
        lPostCode.SETFILTER(City,pCity)
      END;

      IF pCountryCode <> '' THEN BEGIN
        lPostCode.SETFILTER("Country/Region Code",pCountryCode);
      END;

      lCounter := lPostCode.COUNT;
      CASE lCounter OF
        // Cr‚ation et rattachement … un code de r‚f‚rence g‚o existant
        0 : BEGIN
          //<<IMH04.isat.PC
          //IF NOT CreatePostCode(pPostCode,pCity,pCountryCode,'') THEN BEGIN
          //>>IMH04.isat.PC
            EXIT;
          //END;
        END;
        1 : ;
        ELSE BEGIN
          FORM.RUNMODAL(FORM::"Post Codes",lPostCode,lPostCode.Code);
          //<<IMH04.isat.PC
          //IF NOT CreatePostCode(pPostCode,pCity,pCountryCode,lPostCode."Geo. Reference Code") THEN BEGIN
          //>>IMH04.isat.PC
            EXIT;
          //END;
        END;
      END;

      rValue := TRUE;
    END;

    PROCEDURE CreatePostCode@1100281008(pPostCode@1100281008 : Record 225;pPostCodeToCreate@1100281000 : Code[20];pCityToCreate@1100281001 : Text[50]) rValue : Boolean;
    VAR
      lPostCode@1100281002 : Record 225;
      lPostCode2@1100281003 : Record 225;
      lPostCodesForm@1100281005 : Form 367;
      lText001@1100281006 : TextConst 'ENU=Please fill a linking post code;FRA=Veuillez s‚lectionner un code postal de rattachement';
      lGeoReferenceCode@1100281004 : Code[10];
    BEGIN
      // IMH13.ISAT.PC
      // Cr‚ation d'un nouveau code postal - ville

      rValue := FALSE;

      IF (pPostCodeToCreate = '') OR (pCityToCreate = '') THEN BEGIN
        ERROR(Text008);
      END;
      //<<IMH20.PC
      IF NOT CONFIRM(STRSUBSTNO(Text010,pPostCodeToCreate,pCityToCreate,pPostCode.Code,pPostCode.City)) THEN BEGIN
        EXIT;
      END;
      //>>IMH20.PC

      lPostCode2.INIT;
      lPostCode2.VALIDATE(Code,pPostCodeToCreate);
      IF STRLEN(pCityToCreate) <= 30 THEN BEGIN
        lPostCode2.VALIDATE(City,UPPERCASE(pCityToCreate));
        lPostCode2.VALIDATE("Large Description",pCityToCreate);
      END ELSE BEGIN
        lPostCode2.VALIDATE(City,COPYSTR(UPPERCASE(pCityToCreate),1,30));
        lPostCode2.VALIDATE("Large Description",pCityToCreate);
      END;
      lPostCode2.VALIDATE("Geo. Reference Code",pPostCode."Geo. Reference Code");
      lPostCode2.VALIDATE("Country/Region Code",pPostCode."Country/Region Code");
      lPostCode2.VALIDATE("Area Code",pPostCode."Area Code");
      lPostCode2.VALIDATE("IMH Territory Code",pPostCode."IMH Territory Code");
      lPostCode2.VALIDATE("Admin. Territory Code",pPostCode."Admin. Territory Code");
      lPostCode2.VALIDATE("Link Post Code",pPostCode.Code);
      lPostCode2.VALIDATE("Link City",pPostCode.City);
      lPostCode2.VALIDATE("Latitude Lambert 2E",pPostCode."Latitude Lambert 2E");
      lPostCode2.VALIDATE("Longitude Lambert 2E",pPostCode."Longitude Lambert 2E");
      lPostCode2.TouchRecord(TRUE);
      lPostCode2.INSERT;

      // On valide la cr‚ation du nouveau code postal
      COMMIT;

      MESSAGE(Text009,pPostCodeToCreate,pCityToCreate);

      rValue := TRUE;
    END;

    PROCEDURE GetUserSetup@1100281013();
    BEGIN
      // IMH17
      IF UserSetupOK THEN BEGIN
        EXIT;
      END;

      UserSetupOK := UserSetup.GET(USERID);
    END;

    PROCEDURE AllowedToChangePostCode@1100281015() : Boolean;
    BEGIN
      // IMH17
      EXIT(UserSetup."Allowed To Change Post Code");
    END;

    PROCEDURE TouchRecord@1100281009(pInsert@1100281000 : Boolean);
    BEGIN
      IF pInsert THEN BEGIN
        "Creation Date" := CURRENTDATETIME;
        "Creation User ID" := USERID;
      END;

      "Last Modification Date" := CURRENTDATETIME;
      "Last Modification User ID" := USERID;
    END;

    PROCEDURE CreateSimplyCity@1100281014(pCity@1100281000 : Text[50]) lCity : Text[50];
    VAR
      lPos@1100281001 : Integer;
    BEGIN
      lCity := pCity;
      lCity := CONVERTSTR(lCity,'-',' ');
      lCity := CityWithoutAccent(lCity,50);

      IF STRPOS(lCity,'SAINTE ') >0 THEN
      BEGIN
         lPos := STRPOS(lCity,'SAINTE ');
         IF (lPos = 1) THEN
           lCity := 'STE ' + COPYSTR(lCity,lPos+7)
         ELSE
           lCity := COPYSTR(lCity,1,lPos-1) + 'STE ' + COPYSTR(lCity,lPos+7);
      END;

      IF STRPOS(lCity,'SAINT ') >0 THEN
      BEGIN
         lPos := STRPOS(lCity,'SAINT ');
         IF (lPos = 1) THEN
           lCity := 'ST ' + COPYSTR(lCity,lPos+6)
         ELSE
           lCity := COPYSTR(lCity,1,lPos-1) + 'ST ' + COPYSTR(lCity,lPos+6);
      END;
      lCity := COPYSTR(lCity,1,30);
    END;

    PROCEDURE GetGeoCode@1100281016(pPostCode@1100281000 : Code[20];pCity@1100281001 : Text[30]) GeoCode : Code[10];
    VAR
      lPostCode@1100281002 : Record 225;
    BEGIN
      lPostCode.RESET;
      lPostCode.SETFILTER("Geo. Reference Code",'<>%1','');
      lPostCode.SETRANGE(Code,pPostCode);
      lPostCode.SETRANGE(City,pCity);
      IF lPostCode.FINDFIRST THEN
        EXIT(lPostCode."Geo. Reference Code");

      lPostCode.RESET;
      lPostCode.SETCURRENTKEY("Search City");
      lPostCode.SETFILTER("Geo. Reference Code",'<>%1','');
      lPostCode.SETRANGE(Code,pPostCode);
      lPostCode.SETRANGE("Search City",ToolsMgt.GetSearchString(pCity));
      IF lPostCode.FINDFIRST THEN
        EXIT(lPostCode."Geo. Reference Code");

      lPostCode.RESET;
      lPostCode.SETCURRENTKEY(Code,"City 2");
      lPostCode.SETRANGE(Code,pPostCode);
      lPostCode.SETRANGE("City 2",lPostCode.CreateSimplyCity(pCity));
      lPostCode.SETFILTER("Geo. Reference Code",'<>%1','');
      IF lPostCode.FINDFIRST THEN
        EXIT(lPostCode."Geo. Reference Code");

      lPostCode.RESET;
      lPostCode.SETCURRENTKEY(Code,"City 2");
      lPostCode.SETFILTER(Code,'%1',COPYSTR(pPostCode,1,2) + '*');
      lPostCode.SETRANGE("City 2",lPostCode.CreateSimplyCity(pCity));
      lPostCode.SETFILTER("Geo. Reference Code",'<>%1','');
      IF lPostCode.FINDFIRST THEN
        EXIT(lPostCode."Geo. Reference Code");

      lPostCode.RESET;
      lPostCode.SETRANGE(Code,pPostCode);
      lPostCode.SETFILTER("Geo. Reference Code",'<>%1','');
      IF lPostCode.FINDFIRST THEN
        EXIT(lPostCode."Geo. Reference Code");
    END;

    PROCEDURE SetSkipSearchCity@1100281017(pSkipSearchCity@1100281000 : Boolean);
    BEGIN
      SkipSearchCity := pSkipSearchCity;
    END;

    PROCEDURE ValidatePostCode3@1100281018(VAR pCity@1001 : Text[30];VAR pPostCode@1000 : Code[20];VAR pCountryRegionCode@1100281000 : Code[10]) : Boolean;
    VAR
      lPostCodeRec@1002 : Record 225;
      lPostCodeRec2@1003 : Record 225;
    BEGIN
      //IMH19
      IF pPostCode = '' THEN BEGIN
        pCity := '';
        pCountryRegionCode := '';
        EXIT;
      END;

      lPostCodeRec.SETFILTER(Code,'%1',pPostCode+'*');

      IF pCity <> '' THEN BEGIN
        lPostCodeRec.SETFILTER(City,'%1',pCity+'*')
      END;

      IF NOT lPostCodeRec.ISEMPTY THEN BEGIN
        IF lPostCodeRec.COUNT = 1 THEN BEGIN
          lPostCodeRec.FINDFIRST;
          pPostCode := lPostCodeRec.Code;
          pCity := lPostCodeRec.City;
          pCountryRegionCode := lPostCodeRec."Country/Region Code";
          EXIT(TRUE);
        END ELSE BEGIN
       {   IF GUIALLOWED THEN BEGIN
            IF FORM.RUNMODAL(FORM::"Post Codes",lPostCodeRec,lPostCodeRec.Code) = ACTION::LookupOK THEN BEGIN
              pPostCode := lPostCodeRec.Code;
              pCity := lPostCodeRec.City;
              pCountryRegionCode := lPostCodeRec."Country/Region Code";
              EXIT(true);
            END;
          END;}
        END;
      END ELSE BEGIN
        lPostCodeRec.SETRANGE(City);
        IF NOT lPostCodeRec.ISEMPTY THEN BEGIN
          IF lPostCodeRec.COUNT = 1 THEN BEGIN
            lPostCodeRec.FINDFIRST;
            pPostCode := lPostCodeRec.Code;
            pCity := lPostCodeRec.City;
            pCountryRegionCode := lPostCodeRec."Country/Region Code";
            EXIT(TRUE);
          END;
        END;
      END;
      pCity := '';
    END;

    PROCEDURE ValidateCity3@1100281020(VAR pCity@1001 : Text[30];VAR pPostCode@1000 : Code[20];VAR pCountryRegionCode@1100281000 : Code[10]);
    VAR
      lPostCodeRec@1002 : Record 225;
      lPostCodeRec2@1003 : Record 225;
    BEGIN
      //IMH19
      IF pCity = '' THEN BEGIN
        pPostCode := '';
        pCountryRegionCode := '';
        EXIT;
      END;

      lPostCodeRec.SETFILTER(City,'%1',pCity+'*');

      IF pPostCode <> '' THEN BEGIN
        lPostCodeRec.SETFILTER(Code,'%1',pPostCode+'*')
      END;

      IF NOT lPostCodeRec.ISEMPTY THEN BEGIN
        IF lPostCodeRec.COUNT = 1 THEN BEGIN
          lPostCodeRec.FINDFIRST;
          pPostCode := lPostCodeRec.Code;
          pCity := lPostCodeRec.City;
          pCountryRegionCode := lPostCodeRec."Country/Region Code";
          EXIT;
        END ELSE BEGIN
          IF GUIALLOWED THEN BEGIN
            IF FORM.RUNMODAL(FORM::"Post Codes",lPostCodeRec,lPostCodeRec.Code) = ACTION::LookupOK THEN BEGIN
              pPostCode := lPostCodeRec.Code;
              pCity := lPostCodeRec.City;
              pCountryRegionCode := lPostCodeRec."Country/Region Code";
              EXIT;
            END;
          END;
        END;
      END ELSE BEGIN
        lPostCodeRec.SETRANGE(Code);
        IF NOT lPostCodeRec.ISEMPTY THEN BEGIN
          IF lPostCodeRec.COUNT = 1 THEN BEGIN
            lPostCodeRec.FINDFIRST;
            pPostCode := lPostCodeRec.Code;
            pCity := lPostCodeRec.City;
            pCountryRegionCode := lPostCodeRec."Country/Region Code";
            EXIT;
          END;
        END;
      //  pPostCode := '';
      END;
    END;

    BEGIN
    {
      /** @r IMH21 @d 15/10/13 @a ISAT.ST @v IMH6.01.353 @s Reorganisation region IMH @h 4760 @c Renommage CR / AR / R‚gion */
      /** @r IHM20 @d 08/02/12 @a ISAT.PC @v IMH6.01.099 @s Divers
          @c Ajout message de confirmation dans fonction CreatePostCode @h Mantis 1728*/
      /** @r IMH19 @d 30/08/11 @a ISAT.ST @v IMH6.01.002 @s recherche contact @c Fonctions */
      /** @r IMH18 @d 05/08/11 @a ISAT.ST @v IMH6.01.099 @s Divers @c Finalisation fonction GetGeoCode */
      /** @r IMH17 @d 11/07/11 @a ISAT.PC @v IMH6.01.099 @s Divers @c Blocage de cr‚ation et ajout fonction DisableLinked
          @c Ajout fonction RefreshCoordinate
          @c Ajout champ 50200, IMH Territory Description
          @c Ajout champ 50201, Admin. Territory Description
          @c Ajout champ 50202, Area Description
          @c Ajout champ 50203, Country/Region Description
          @c ajout fonction GetDescriptionCountry*/
      /** @r IMH16 @d 06/07/11 @a ISAT.PC @v IMH6.01.099 @s Divers
          @c Ajout champ 50003, Admin. Territory Code */
      /** @r IMH15 @d 04/07/11 @a ISAT.PC @v IMH6.01.099 @s Divers
          @c fonction CityWithouaccent de 30 a 50 carac
          @c Ajout champ 50101, Large Des. (Without Accent)
          @c ajout cl‚ Large Des. (Without Accent) pour la recherche dans Codeunit ToolsManagement CheckCity*/
      /** @r IMH14 @d 29/06/11 @a ISAT.PC @v IMH6.01.099 @s Divers
          @c Pas de cr‚ation automatique */
      /** @r IMH13 @d 13/05/11 @a ISAT.PC @v IMH6.01.099 @s Divers
          @c gestion du rattachement d'un post code … un autre (g‚ocodage)
          @c Ajout du champs 50030, Link Post Code
          @c Ajout du champs 50031, Link City
          @c Ajout du champs 50032, Linked
          @c ajout cl‚ : Code,Area Code
          @c ajout cl‚ : City,Area Code
          @c ajout cl‚ : Link Post Code,Link City */
      /** @r IMH12 @d 09/03/11 @a ISAT.PC @v IMH6.01.099 @s Divers
          @c Ajout du champs 50100, City (Without Accent)
          @c Ajout fonction CityWithoutAccent
          @c Ajout cl‚ City (Without Accent) */
      /** @r IMH11 @d 23/02/11 @a ISAT.NFO @v IMH6.01.002 @s Gestion des contacts @c Ajout du champs 50050 Description */
      /** @r IMH10 @d 16/02/11 @a ISAT.ST @v IMH6.01.002 @s Gestion des contacts @c Correction IMH07 */
      /** @r IHM09 @d 10/02/11 @a ISAT.ZW @v IMH6.01.001 @s Normalisation des donn‚es
          @c Associer les Pays au code postaux - descendre le code pays automatiquement*/
      /** @r IHM08 @d 03/02/11 @a ISAT.PC @v IMH6.01.022 @s Comp‚tence g‚ographique @c ajout fonction getcoordinate */
      /** @r IHM07 @d 04/01/11 @a ISAT.LLT @v IMH6.01.002 @s gestion des contacts @c Contr“le du code postal */
      /** @r IMH06 @d 09/12/10 @a ISAT.MA @v IMH6.01.030 @s Gestion coordonnateur
          @c Ajout Fonctions ValidateCity2(), ValidatePostCode2(), LookUpCity2() et LookUpPostCode2() */
      /** @r IHM05 @d 25/11/10 @a ISAT.PC @v IMH6.01.022 @s Comp‚tence G‚ographique
          @c Ajout champ 50001, Area Code
          @c Ajout champ 50002, Territory Code */
      /** @r IHM04 @d 26/10/10 @a ISAT.ST @v IMH6.01.002 @s Gestion des contacts @c Changement du DropDown : code en premier */
      /** @r IHM03 @d 25/10/10 @a ISAT.PC @v IMH6.01.022 @s Comp‚tence g‚ographique @c DrillDownID */
      /** @r IHM02 @d 18/10/10 @a ISAT.LLT @v IMH6.01.002 @s gestion des contacts @c Ajout du DropDown */
      /** @r IHM01 @d 29/09/10 @a ISAT.PC @v IMH6.01.022 @s Comp‚tence g‚ographique
          @c ajout champ 50000, Insee Code
          @c ajout champ 50010, Latitude
          @c ajout champ 50011, Longitude
          @c Ajout fonction getReferenceGeoCode
          @c ajout cl‚ Insee Code pour toutes la partie comp‚tence geographique*/
    }
    END.
  }
}