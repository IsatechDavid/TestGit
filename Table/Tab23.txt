OBJECT Table 23 Vendor
{
  OBJECT-PROPERTIES
  {
    Date=18/09/12;
    Time=14:58:36;
    Modified=Yes;
    Version List=NAVW16.00,NAVFR4.00.02,ISA6.00,IMH6.01;
  }
  PROPERTIES
  {
    Permissions=TableData 25=r;
    DataCaptionFields=No.,Name;
    OnInsert=BEGIN
               IF "No." = '' THEN BEGIN
                 PurchSetup.GET;
                 PurchSetup.TESTFIELD("Vendor Nos.");
                 NoSeriesMgt.InitSeries(PurchSetup."Vendor Nos.",xRec."No. Series",0D,"No.","No. Series");
               END;
               IF "Invoice Disc. Code" = '' THEN
                 "Invoice Disc. Code" := "No.";

               IF NOT InsertFromContact THEN
                 UpdateContFromVend.OnInsert(Rec);

               DimMgt.UpdateDefaultDim(
                 DATABASE::Vendor,"No.",
                 "Global Dimension 1 Code","Global Dimension 2 Code");
             END;

    OnModify=BEGIN
               "Last Date Modified" := TODAY;

               IF (Name <> xRec.Name) OR
                  ("Search Name" <> xRec."Search Name") OR
                  ("Name 2" <> xRec."Name 2") OR
                  (Address <> xRec.Address) OR
                  ("Address 2" <> xRec."Address 2") OR
                  (City <> xRec.City) OR
                  ("Phone No." <> xRec."Phone No.") OR
                  ("Mobile Phone No. 2" <> xRec."Mobile Phone No. 2") OR
                  ("Territory Code" <> xRec."Territory Code") OR
                  ("Currency Code" <> xRec."Currency Code") OR
                  ("Language Code" <> xRec."Language Code") OR
                  ("Purchaser Code" <> xRec."Purchaser Code") OR
                  ("Country/Region Code" <> xRec."Country/Region Code") OR
                  ("Fax No." <> xRec."Fax No.") OR
                  ("Business Phone No." <> xRec."Business Phone No.") OR
                  ("VAT Registration No." <> xRec."VAT Registration No.") OR
                  ("Registration No." <> xRec."Registration No.") OR//IMH6.01.140.JC
                  ("Post Code" <> xRec."Post Code") OR
                  (County <> xRec.County) OR
                  ("E-Mail" <> xRec."E-Mail") OR
                  ("Home Page" <> xRec."Home Page")
               THEN BEGIN
                 MODIFY;
                 UpdateContFromVend.OnModify(Rec);
               END;
             END;

    OnDelete=VAR
               ItemVendor@1000 : Record 99;
               PurchPrice@1001 : Record 7012;
               PurchLineDiscount@1002 : Record 7014;
               PurchPrepmtPct@1003 : Record 460;
             BEGIN
               MoveEntries.MoveVendorEntries(Rec);

               CommentLine.SETRANGE("Table Name",CommentLine."Table Name"::Vendor);
               CommentLine.SETRANGE("No.","No.");
               CommentLine.DELETEALL;

               VendBankAcc.SETRANGE("Vendor No.","No.");
               VendBankAcc.DELETEALL;

               OrderAddr.SETRANGE("Vendor No.","No.");
               OrderAddr.DELETEALL;

               ItemCrossReference.SETCURRENTKEY("Cross-Reference Type","Cross-Reference Type No.");
               ItemCrossReference.SETRANGE("Cross-Reference Type",ItemCrossReference."Cross-Reference Type"::Vendor);
               ItemCrossReference.SETRANGE("Cross-Reference Type No.","No.");
               ItemCrossReference.DELETEALL;

               PurchOrderLine.SETCURRENTKEY("Document Type","Pay-to Vendor No.");
               PurchOrderLine.SETFILTER(
                 "Document Type",'%1|%2',
                 PurchOrderLine."Document Type"::Order,
                 PurchOrderLine."Document Type"::"Return Order");
               PurchOrderLine.SETRANGE("Pay-to Vendor No.","No.");
               IF PurchOrderLine.FIND('-') THEN
                 ERROR(
                   Text000,
                   TABLECAPTION,"No.",
                   PurchOrderLine."Document Type");

               PurchOrderLine.SETRANGE("Pay-to Vendor No.");
               PurchOrderLine.SETRANGE("Buy-from Vendor No.","No.");
               IF PurchOrderLine.FIND('-') THEN
                 ERROR(
                   Text000,
                   TABLECAPTION,"No.");


               UpdateContFromVend.OnDelete(Rec);

               DimMgt.DeleteDefaultDim(DATABASE::Vendor,"No.");

               ServiceItem.SETRANGE("Vendor No.","No.");
               ServiceItem.MODIFYALL("Vendor No.",'');

               ItemVendor.SETRANGE("Vendor No.","No.");
               ItemVendor.DELETEALL(TRUE);

               PurchPrice.SETCURRENTKEY("Purchases Code");
               PurchPrice.SETRANGE("Purchases Code","No.");
               PurchPrice.DELETEALL(TRUE);

               PurchLineDiscount.SETCURRENTKEY("Vendor No.");
               PurchLineDiscount.SETRANGE("Vendor No.","No.");
               PurchLineDiscount.DELETEALL(TRUE);

               PurchPrepmtPct.SETCURRENTKEY("Vendor No.");
               PurchPrepmtPct.SETRANGE("Vendor No.","No.");
               PurchPrepmtPct.DELETEALL(TRUE);
             END;

    OnRename=BEGIN
               "Last Date Modified" := TODAY;
             END;

    CaptionML=[ENU=Vendor;
               FRA=Fournisseur];
    LookupFormID=Form27;
    DrillDownFormID=Form27;
  }
  FIELDS
  {
    { 1   ;   ;No.                 ;Code20        ;AltSearchField=Search Name;
                                                   OnValidate=BEGIN
                                                                IF "No." <> xRec."No." THEN BEGIN
                                                                  PurchSetup.GET;
                                                                  NoSeriesMgt.TestManual(PurchSetup."Vendor Nos.");
                                                                  "No. Series" := '';
                                                                END;
                                                                IF "Invoice Disc. Code" = '' THEN
                                                                  "Invoice Disc. Code" := "No.";
                                                              END;

                                                   CaptionML=[ENU=No.;
                                                              FRA=Nø] }
    { 2   ;   ;Name                ;Text50        ;OnValidate=BEGIN
                                                                //<<IMH06
                                                                fNulUpdateInformationDAS (2);
                                                                //>>IMH06

                                                                IF ("Search Name" = UPPERCASE(xRec.Name)) OR ("Search Name" = '') THEN
                                                                  "Search Name" := Name;
                                                              END;

                                                   CaptionML=[ENU=Name;
                                                              FRA=Nom] }
    { 3   ;   ;Search Name         ;Code50        ;CaptionML=[ENU=Search Name;
                                                              FRA=Nom de recherche] }
    { 4   ;   ;Name 2              ;Text50        ;OnValidate=BEGIN
                                                                //<<IMH06
                                                                fNulUpdateInformationDAS (2);
                                                                //>>IMH06
                                                              END;

                                                   CaptionML=[ENU=Name 2;
                                                              FRA=Nom 2] }
    { 5   ;   ;Address             ;Text50        ;OnValidate=BEGIN
                                                                //<<IMH06
                                                                fNulUpdateInformationDAS (12);
                                                                //>>IMH06
                                                              END;

                                                   CaptionML=[ENU=Address;
                                                              FRA=Adresse] }
    { 6   ;   ;Address 2           ;Text50        ;OnValidate=BEGIN
                                                                //<<IMH06
                                                                fNulUpdateInformationDAS (12);
                                                                //>>IMH06
                                                              END;

                                                   CaptionML=[ENU=Address 2;
                                                              FRA=Adresse (2Šme ligne)] }
    { 7   ;   ;City                ;Text30        ;OnValidate=BEGIN
                                                                PostCode.ValidateCity(City,"Post Code", "Country/Region Code");         //IMH03 Ajout Code pays
                                                              END;

                                                   OnLookup=BEGIN
                                                              PostCode.LookUpCity(City,"Post Code","Country/Region Code",TRUE);      //IMH03 Ajout Code pays
                                                            END;

                                                   CaptionML=[ENU=City;
                                                              FRA=Ville] }
    { 8   ;   ;Contact             ;Text50        ;OnValidate=BEGIN
                                                                IF RMSetup.GET THEN
                                                                  IF RMSetup."Bus. Rel. Code for Vendors" <> '' THEN
                                                                    IF (xRec.Contact = '') AND (xRec."Primary Contact No." = '') THEN BEGIN
                                                                      MODIFY;
                                                                      UpdateContFromVend.OnModify(Rec);
                                                                      UpdateContFromVend.InsertNewContactPerson(Rec,FALSE);
                                                                      MODIFY(TRUE);
                                                                    END
                                                              END;

                                                   CaptionML=[ENU=Contact;
                                                              FRA=Contact] }
    { 9   ;   ;Phone No.           ;Text30        ;OnValidate=VAR
                                                                lPhoneStandardization@1100281000 : Codeunit 50099;
                                                              BEGIN
                                                                //<<IMH01
                                                                lPhoneStandardization.ValidatePhoneNo(DATABASE::Vendor,9,"Country/Region Code","Phone No.");
                                                                //>>IMH01
                                                              END;

                                                   ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Phone No.;
                                                              FRA=Nø t‚l‚phone] }
    { 10  ;   ;Mobile Phone No. 2  ;Text30        ;OnValidate=VAR
                                                                lPhoneStandardization@1100281000 : Codeunit 50099;
                                                              BEGIN
                                                                //<<IMH01
                                                                lPhoneStandardization.ValidatePhoneNo(DATABASE::Vendor,10,"Country/Region Code","Mobile Phone No. 2");
                                                                //>>IMH01
                                                              END;

                                                   CaptionML=[ENU=Mobile Phone No. 2;
                                                              FRA=Nø t‚l‚phone mobile 2] }
    { 14  ;   ;Our Account No.     ;Text20        ;CaptionML=[ENU=Our Account No.;
                                                              FRA=Notre nø cpte/fourn.] }
    { 15  ;   ;Territory Code      ;Code10        ;TableRelation=Territory;
                                                   CaptionML=[ENU=Territory Code;
                                                              FRA=Code secteur] }
    { 16  ;   ;Global Dimension 1 Code;Code20     ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(1,"Global Dimension 1 Code");
                                                              END;

                                                   CaptionML=[ENU=Global Dimension 1 Code;
                                                              FRA=Code axe principal 1];
                                                   CaptionClass='1,1,1' }
    { 17  ;   ;Global Dimension 2 Code;Code20     ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(2,"Global Dimension 2 Code");
                                                              END;

                                                   CaptionML=[ENU=Global Dimension 2 Code;
                                                              FRA=Code axe principal 2];
                                                   CaptionClass='1,1,2' }
    { 19  ;   ;Budgeted Amount     ;Decimal       ;CaptionML=[ENU=Budgeted Amount;
                                                              FRA=Montant budg‚t‚];
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 21  ;   ;Vendor Posting Group;Code10        ;TableRelation="Vendor Posting Group";
                                                   CaptionML=[ENU=Vendor Posting Group;
                                                              FRA=Groupe compta. fournisseur] }
    { 22  ;   ;Currency Code       ;Code10        ;TableRelation=Currency;
                                                   CaptionML=[ENU=Currency Code;
                                                              FRA=Code devise] }
    { 24  ;   ;Language Code       ;Code10        ;TableRelation=Language;
                                                   CaptionML=[ENU=Language Code;
                                                              FRA=Code langue] }
    { 26  ;   ;Statistics Group    ;Integer       ;CaptionML=[ENU=Statistics Group;
                                                              FRA=Groupe statistiques] }
    { 27  ;   ;Payment Terms Code  ;Code10        ;TableRelation="Payment Terms";
                                                   CaptionML=[ENU=Payment Terms Code;
                                                              FRA=Code condition paiement] }
    { 28  ;   ;Fin. Charge Terms Code;Code10      ;TableRelation="Finance Charge Terms";
                                                   CaptionML=[ENU=Fin. Charge Terms Code;
                                                              FRA=Code condition int‚rˆts] }
    { 29  ;   ;Purchaser Code      ;Code10        ;TableRelation=Salesperson/Purchaser;
                                                   CaptionML=[ENU=Purchaser Code;
                                                              FRA=Code acheteur] }
    { 30  ;   ;Shipment Method Code;Code10        ;TableRelation="Shipment Method";
                                                   CaptionML=[ENU=Shipment Method Code;
                                                              FRA=Code condition livraison] }
    { 31  ;   ;Shipping Agent Code ;Code10        ;TableRelation="Shipping Agent";
                                                   CaptionML=[ENU=Shipping Agent Code;
                                                              FRA=Code transporteur] }
    { 33  ;   ;Invoice Disc. Code  ;Code20        ;TableRelation=Vendor;
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Invoice Disc. Code;
                                                              FRA=Code remise facture] }
    { 35  ;   ;Country/Region Code ;Code10        ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Country/Region Code;
                                                              FRA=Code pays/r‚gion] }
    { 38  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Comment Line" WHERE (Table Name=CONST(Vendor),
                                                                                           No.=FIELD(No.)));
                                                   CaptionML=[ENU=Comment;
                                                              FRA=Commentaires];
                                                   Editable=No }
    { 39  ;   ;Blocked             ;Option        ;CaptionML=[ENU=Blocked;
                                                              FRA=Bloqu‚];
                                                   OptionCaptionML=[ENU=" ,Payment,All";
                                                                    FRA=" ,RŠglement,Tous"];
                                                   OptionString=[ ,Payment,All] }
    { 45  ;   ;Pay-to Vendor No.   ;Code20        ;TableRelation=Vendor;
                                                   CaptionML=[ENU=Pay-to Vendor No.;
                                                              FRA=Nø fournisseur … payer] }
    { 46  ;   ;Priority            ;Integer       ;CaptionML=[ENU=Priority;
                                                              FRA=Priorit‚] }
    { 47  ;   ;Payment Method Code ;Code10        ;TableRelation="Payment Method";
                                                   CaptionML=[ENU=Payment Method Code;
                                                              FRA=Code mode de rŠglement] }
    { 54  ;   ;Last Date Modified  ;Date          ;CaptionML=[ENU=Last Date Modified;
                                                              FRA=Date dern. modification];
                                                   Editable=No }
    { 55  ;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              FRA=Filtre date] }
    { 56  ;   ;Global Dimension 1 Filter;Code20   ;FieldClass=FlowFilter;
                                                   TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   CaptionML=[ENU=Global Dimension 1 Filter;
                                                              FRA=Filtre axe principal 1];
                                                   CaptionClass='1,3,1' }
    { 57  ;   ;Global Dimension 2 Filter;Code20   ;FieldClass=FlowFilter;
                                                   TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   CaptionML=[ENU=Global Dimension 2 Filter;
                                                              FRA=Filtre axe principal 2];
                                                   CaptionClass='1,3,2' }
    { 58  ;   ;Balance             ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry".Amount WHERE (Vendor No.=FIELD(No.),
                                                                                                                Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                Currency Code=FIELD(Currency Filter),
                                                                                                                Entry Type=FILTER(<Application|Unrealized Loss..'Payment Discount (VAT Adjustment)'|>Appln. Rounding)));
                                                   CaptionML=[ENU=Balance;
                                                              FRA=Solde];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 59  ;   ;Balance (LCY)       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Vendor No.=FIELD(No.),
                                                                                                                        Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                        Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                        Currency Code=FIELD(Currency Filter),
                                                                                                                        Entry Type=FILTER(<Application|Unrealized Loss..'Payment Discount (VAT Adjustment)'|>Appln. Rounding)));
                                                   CaptionML=[ENU=Balance (LCY);
                                                              FRA=Solde DS];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 60  ;   ;Net Change          ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry".Amount WHERE (Vendor No.=FIELD(No.),
                                                                                                                Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                Posting Date=FIELD(Date Filter),
                                                                                                                Currency Code=FIELD(Currency Filter),
                                                                                                                Entry Type=FILTER(<Application|Unrealized Loss..'Payment Discount (VAT Adjustment)'|>Appln. Rounding)));
                                                   CaptionML=[ENU=Net Change;
                                                              FRA=Solde p‚riode];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 61  ;   ;Net Change (LCY)    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Vendor No.=FIELD(No.),
                                                                                                                        Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                        Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                        Posting Date=FIELD(Date Filter),
                                                                                                                        Currency Code=FIELD(Currency Filter),
                                                                                                                        Entry Type=FILTER(<Application|Unrealized Loss..'Payment Discount (VAT Adjustment)'|>Appln. Rounding)));
                                                   CaptionML=[ENU=Net Change (LCY);
                                                              FRA=Solde p‚riode DS];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 62  ;   ;Purchases (LCY)     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Vendor Ledger Entry"."Purchase (LCY)" WHERE (Vendor No.=FIELD(No.),
                                                                                                                  Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                  Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                  Posting Date=FIELD(Date Filter),
                                                                                                                  Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[ENU=Purchases (LCY);
                                                              FRA=Achats DS];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 64  ;   ;Inv. Discounts (LCY);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Vendor Ledger Entry"."Inv. Discount (LCY)" WHERE (Vendor No.=FIELD(No.),
                                                                                                                       Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                       Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                       Posting Date=FIELD(Date Filter),
                                                                                                                       Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[ENU=Inv. Discounts (LCY);
                                                              FRA=Remises facture DS];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 65  ;   ;Pmt. Discounts (LCY);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Vendor No.=FIELD(No.),
                                                                                                                       Entry Type=FILTER(Payment Discount..'Payment Discount (VAT Adjustment)'),
                                                                                                                       Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                       Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                       Posting Date=FIELD(Date Filter),
                                                                                                                       Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[ENU=Pmt. Discounts (LCY);
                                                              FRA=Escomptes DS];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 66  ;   ;Balance Due         ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry".Amount WHERE (Vendor No.=FIELD(No.),
                                                                                                                Posting Date=FIELD(UPPERLIMIT(Date Filter)),
                                                                                                                Initial Entry Due Date=FIELD(Date Filter),
                                                                                                                Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[ENU=Balance Due;
                                                              FRA=Solde d–];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 67  ;   ;Balance Due (LCY)   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Vendor No.=FIELD(No.),
                                                                                                                        Posting Date=FIELD(UPPERLIMIT(Date Filter)),
                                                                                                                        Initial Entry Due Date=FIELD(Date Filter),
                                                                                                                        Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                        Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                        Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[ENU=Balance Due (LCY);
                                                              FRA=Solde d– DS];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 69  ;   ;Payments            ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Vendor Ledg. Entry".Amount WHERE (Initial Document Type=CONST(Payment),
                                                                                                               Entry Type=CONST(Initial Entry),
                                                                                                               Vendor No.=FIELD(No.),
                                                                                                               Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                               Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                               Posting Date=FIELD(Date Filter),
                                                                                                               Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[ENU=Payments;
                                                              FRA=Paiements];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 70  ;   ;Invoice Amounts     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry".Amount WHERE (Initial Document Type=CONST(Invoice),
                                                                                                                Entry Type=CONST(Initial Entry),
                                                                                                                Vendor No.=FIELD(No.),
                                                                                                                Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                Posting Date=FIELD(Date Filter),
                                                                                                                Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[ENU=Invoice Amounts;
                                                              FRA=Montants factures];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 71  ;   ;Cr. Memo Amounts    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Vendor Ledg. Entry".Amount WHERE (Initial Document Type=CONST(Credit Memo),
                                                                                                               Entry Type=CONST(Initial Entry),
                                                                                                               Vendor No.=FIELD(No.),
                                                                                                               Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                               Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                               Posting Date=FIELD(Date Filter),
                                                                                                               Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[ENU=Cr. Memo Amounts;
                                                              FRA=Montants avoirs];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 72  ;   ;Finance Charge Memo Amounts;Decimal;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry".Amount WHERE (Initial Document Type=CONST(Finance Charge Memo),
                                                                                                                Entry Type=CONST(Initial Entry),
                                                                                                                Vendor No.=FIELD(No.),
                                                                                                                Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                Posting Date=FIELD(Date Filter),
                                                                                                                Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[ENU=Finance Charge Memo Amounts;
                                                              FRA=Montants int‚rˆts de retard];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 74  ;   ;Payments (LCY)      ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Initial Document Type=CONST(Payment),
                                                                                                                       Entry Type=CONST(Initial Entry),
                                                                                                                       Vendor No.=FIELD(No.),
                                                                                                                       Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                       Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                       Posting Date=FIELD(Date Filter),
                                                                                                                       Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[ENU=Payments (LCY);
                                                              FRA=Paiements DS];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 75  ;   ;Inv. Amounts (LCY)  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Initial Document Type=CONST(Invoice),
                                                                                                                        Entry Type=CONST(Initial Entry),
                                                                                                                        Vendor No.=FIELD(No.),
                                                                                                                        Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                        Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                        Posting Date=FIELD(Date Filter),
                                                                                                                        Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[ENU=Inv. Amounts (LCY);
                                                              FRA=Montants factures DS];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 76  ;   ;Cr. Memo Amounts (LCY);Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Initial Document Type=CONST(Credit Memo),
                                                                                                                       Entry Type=CONST(Initial Entry),
                                                                                                                       Vendor No.=FIELD(No.),
                                                                                                                       Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                       Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                       Posting Date=FIELD(Date Filter),
                                                                                                                       Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[ENU=Cr. Memo Amounts (LCY);
                                                              FRA=Montants avoirs DS];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 77  ;   ;Fin. Charge Memo Amounts (LCY);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Initial Document Type=CONST(Finance Charge Memo),
                                                                                                                        Entry Type=CONST(Initial Entry),
                                                                                                                        Vendor No.=FIELD(No.),
                                                                                                                        Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                        Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                        Posting Date=FIELD(Date Filter),
                                                                                                                        Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[ENU=Fin. Charge Memo Amounts (LCY);
                                                              FRA=Montants int. retard DS];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 78  ;   ;Outstanding Orders  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Line"."Outstanding Amount" WHERE (Document Type=CONST(Order),
                                                                                                               Pay-to Vendor No.=FIELD(No.),
                                                                                                               Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                               Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                               Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[ENU=Outstanding Orders;
                                                              FRA=Commandes ouvertes];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 79  ;   ;Amt. Rcd. Not Invoiced;Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Line"."Amt. Rcd. Not Invoiced" WHERE (Document Type=CONST(Order),
                                                                                                                   Pay-to Vendor No.=FIELD(No.),
                                                                                                                   Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                   Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                   Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[ENU=Amt. Rcd. Not Invoiced;
                                                              FRA=Montant re‡u non factur‚];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 80  ;   ;Application Method  ;Option        ;CaptionML=[ENU=Application Method;
                                                              FRA=Mode de lettrage];
                                                   OptionCaptionML=[ENU=Manual,Apply to Oldest;
                                                                    FRA=Manuel,Au plus ancien];
                                                   OptionString=Manual,Apply to Oldest }
    { 82  ;   ;Prices Including VAT;Boolean       ;OnValidate=VAR
                                                                PurchPrice@1000 : Record 7012;
                                                                Item@1001 : Record 27;
                                                                VATPostingSetup@1002 : Record 325;
                                                                Currency@1003 : Record 4;
                                                              BEGIN
                                                                PurchPrice.SETCURRENTKEY("Purchases Code");
                                                                PurchPrice.SETRANGE("Purchases Code","No.");
                                                                IF PurchPrice.FIND('-') THEN BEGIN
                                                                  IF VATPostingSetup.GET('','') THEN;
                                                                  IF CONFIRM(
                                                                       STRSUBSTNO(
                                                                         Text002,
                                                                         FIELDCAPTION("Prices Including VAT"),"Prices Including VAT",PurchPrice.TABLECAPTION),TRUE)
                                                                  THEN
                                                                    REPEAT
                                                                      IF PurchPrice."Item No." <> Item."No." THEN
                                                                        Item.GET(PurchPrice."Item No.");
                                                                      IF ("VAT Bus. Posting Group" <> VATPostingSetup."VAT Bus. Posting Group") OR
                                                                         (Item."VAT Prod. Posting Group" <> VATPostingSetup."VAT Prod. Posting Group")
                                                                      THEN
                                                                        VATPostingSetup.GET("VAT Bus. Posting Group",Item."VAT Prod. Posting Group");
                                                                      IF PurchPrice."Currency Code" = '' THEN
                                                                        Currency.InitRoundingPrecision
                                                                      ELSE
                                                                        IF PurchPrice."Currency Code" <> Currency.Code THEN
                                                                          Currency.GET(PurchPrice."Currency Code");
                                                                      IF VATPostingSetup."VAT %" <> 0 THEN BEGIN
                                                                        IF "Prices Including VAT" THEN
                                                                          PurchPrice."Direct Unit Cost" :=
                                                                            ROUND(
                                                                              PurchPrice."Direct Unit Cost" * (1 + VATPostingSetup."VAT %" / 100),
                                                                              Currency."Unit-Amount Rounding Precision")
                                                                        ELSE
                                                                          PurchPrice."Direct Unit Cost" :=
                                                                            ROUND(
                                                                              PurchPrice."Direct Unit Cost" / (1 + VATPostingSetup."VAT %" / 100),
                                                                              Currency."Unit-Amount Rounding Precision");
                                                                        PurchPrice.MODIFY;
                                                                      END;
                                                                    UNTIL PurchPrice.NEXT = 0;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Prices Including VAT;
                                                              FRA=Prix TTC] }
    { 84  ;   ;Fax No.             ;Text30        ;OnValidate=VAR
                                                                lPhoneStandardization@1100281000 : Codeunit 50099;
                                                              BEGIN
                                                                //<<IMH01
                                                                lPhoneStandardization.ValidatePhoneNo(DATABASE::Vendor,84,"Country/Region Code","Fax No.");
                                                                //>>IMH01
                                                              END;

                                                   CaptionML=[ENU=Fax No.;
                                                              FRA=Nø t‚l‚copie] }
    { 85  ;   ;Business Phone No.  ;Text30        ;OnValidate=VAR
                                                                lPhoneStandardization@1100281000 : Codeunit 50099;
                                                              BEGIN
                                                                //<<IMH02
                                                                lPhoneStandardization.ValidatePhoneNo(DATABASE::Vendor,85,"Country/Region Code","Business Phone No.");
                                                                //>>IMH02
                                                              END;

                                                   CaptionML=[ENU=Business Phone No.;
                                                              FRA=Nø t‚l‚phone affaire] }
    { 86  ;   ;VAT Registration No.;Text20        ;OnValidate=VAR
                                                                VATRegNoFormat@1000 : Record 381;
                                                              BEGIN

                                                                VATRegNoFormat.Test("VAT Registration No.","Country/Region Code","No.",DATABASE::Vendor);
                                                              END;

                                                   CaptionML=[ENU=VAT Registration No.;
                                                              FRA=Nø identif. intracomm.] }
    { 88  ;   ;Gen. Bus. Posting Group;Code10     ;TableRelation="Gen. Business Posting Group";
                                                   OnValidate=BEGIN
                                                                IF xRec."Gen. Bus. Posting Group" <> "Gen. Bus. Posting Group" THEN
                                                                  IF GenBusPostingGrp.ValidateVatBusPostingGroup(GenBusPostingGrp,"Gen. Bus. Posting Group") THEN
                                                                    VALIDATE("VAT Bus. Posting Group",GenBusPostingGrp."Def. VAT Bus. Posting Group");
                                                              END;

                                                   CaptionML=[ENU=Gen. Bus. Posting Group;
                                                              FRA=Groupe compta. march‚] }
    { 89  ;   ;Picture             ;BLOB          ;CaptionML=[ENU=Picture;
                                                              FRA=Image];
                                                   SubType=Bitmap }
    { 91  ;   ;Post Code           ;Code20        ;TableRelation="Post Code";
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(City,"Post Code","Country/Region Code");           //IMH03 Ajout Code pays
                                                              END;

                                                   OnLookup=BEGIN
                                                              PostCode.LookUpPostCode(City,"Post Code","Country/Region Code",TRUE);     //IMH03 Ajout Code pays
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Post Code;
                                                              FRA=Code postal] }
    { 92  ;   ;County              ;Text30        ;CaptionML=[ENU=County;
                                                              FRA=R‚gion] }
    { 97  ;   ;Debit Amount        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Vendor Ledg. Entry"."Debit Amount" WHERE (Vendor No.=FIELD(No.),
                                                                                                                       Entry Type=FILTER(<Application|Unrealized Loss..'Payment Discount (VAT Adjustment)'|>Appln. Rounding),
                                                                                                                       Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                       Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                       Posting Date=FIELD(Date Filter),
                                                                                                                       Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[ENU=Debit Amount;
                                                              FRA=Montant d‚bit];
                                                   BlankZero=Yes;
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 98  ;   ;Credit Amount       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Vendor Ledg. Entry"."Credit Amount" WHERE (Vendor No.=FIELD(No.),
                                                                                                                        Entry Type=FILTER(<Application|Unrealized Loss..'Payment Discount (VAT Adjustment)'|>Appln. Rounding),
                                                                                                                        Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                        Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                        Posting Date=FIELD(Date Filter),
                                                                                                                        Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[ENU=Credit Amount;
                                                              FRA=Montant cr‚dit];
                                                   BlankZero=Yes;
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 99  ;   ;Debit Amount (LCY)  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Vendor Ledg. Entry"."Debit Amount (LCY)" WHERE (Vendor No.=FIELD(No.),
                                                                                                                             Entry Type=FILTER(<Application|Unrealized Loss..'Payment Discount (VAT Adjustment)'|>Appln. Rounding),
                                                                                                                             Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                             Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                             Posting Date=FIELD(Date Filter),
                                                                                                                             Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[ENU=Debit Amount (LCY);
                                                              FRA=Montant d‚bit DS];
                                                   BlankZero=Yes;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 100 ;   ;Credit Amount (LCY) ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Vendor Ledg. Entry"."Credit Amount (LCY)" WHERE (Vendor No.=FIELD(No.),
                                                                                                                              Entry Type=FILTER(<Application|Unrealized Loss..'Payment Discount (VAT Adjustment)'|>Appln. Rounding),
                                                                                                                              Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                              Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                              Posting Date=FIELD(Date Filter),
                                                                                                                              Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[ENU=Credit Amount (LCY);
                                                              FRA=Montant cr‚dit DS];
                                                   BlankZero=Yes;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 102 ;   ;E-Mail              ;Text80        ;OnValidate=VAR
                                                                lEmailStandardization@1100281000 : Codeunit 50096;
                                                              BEGIN
                                                                lEmailStandardization.ValidateEmail("E-Mail"); //IMH04
                                                              END;

                                                   ExtendedDatatype=E-Mail;
                                                   CaptionML=[ENU=E-Mail;
                                                              FRA=E-mail] }
    { 103 ;   ;Home Page           ;Text80        ;ExtendedDatatype=URL;
                                                   CaptionML=[ENU=Home Page;
                                                              FRA=Page d'accueil] }
    { 104 ;   ;Reminder Amounts    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry".Amount WHERE (Initial Document Type=CONST(Reminder),
                                                                                                                Entry Type=CONST(Initial Entry),
                                                                                                                Vendor No.=FIELD(No.),
                                                                                                                Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                Posting Date=FIELD(Date Filter),
                                                                                                                Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[ENU=Reminder Amounts;
                                                              FRA=Montants relances];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 105 ;   ;Reminder Amounts (LCY);Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Initial Document Type=CONST(Reminder),
                                                                                                                        Entry Type=CONST(Initial Entry),
                                                                                                                        Vendor No.=FIELD(No.),
                                                                                                                        Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                        Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                        Posting Date=FIELD(Date Filter),
                                                                                                                        Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[ENU=Reminder Amounts (LCY);
                                                              FRA=Montants relances DS];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 107 ;   ;No. Series          ;Code10        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=No. Series;
                                                              FRA=Souches de nø];
                                                   Editable=No }
    { 108 ;   ;Tax Area Code       ;Code20        ;TableRelation="Tax Area";
                                                   CaptionML=[ENU=Tax Area Code;
                                                              FRA=Code zone recouvrement] }
    { 109 ;   ;Tax Liable          ;Boolean       ;CaptionML=[ENU=Tax Liable;
                                                              FRA=Soumis … recouvrement] }
    { 110 ;   ;VAT Bus. Posting Group;Code10      ;TableRelation="VAT Business Posting Group";
                                                   CaptionML=[ENU=VAT Bus. Posting Group;
                                                              FRA=Groupe compta. march‚ TVA] }
    { 111 ;   ;Currency Filter     ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation=Currency;
                                                   CaptionML=[ENU=Currency Filter;
                                                              FRA=Filtre devise] }
    { 113 ;   ;Outstanding Orders (LCY);Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Line"."Outstanding Amount (LCY)" WHERE (Document Type=CONST(Order),
                                                                                                                     Pay-to Vendor No.=FIELD(No.),
                                                                                                                     Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                     Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                     Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[ENU=Outstanding Orders (LCY);
                                                              FRA=Commandes ouvertes DS];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 114 ;   ;Amt. Rcd. Not Invoiced (LCY);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Line"."Amt. Rcd. Not Invoiced (LCY)" WHERE (Document Type=CONST(Order),
                                                                                                                         Pay-to Vendor No.=FIELD(No.),
                                                                                                                         Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                         Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                         Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[ENU=Amt. Rcd. Not Invoiced (LCY);
                                                              FRA=Montant re‡u non fact. DS];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 116 ;   ;Block Payment Tolerance;Boolean    ;CaptionML=[ENU=Block Payment Tolerance;
                                                              FRA=Bloquer ‚cart de rŠglement] }
    { 117 ;   ;Pmt. Disc. Tolerance (LCY);Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Vendor No.=FIELD(No.),
                                                                                                                       Entry Type=FILTER(Payment Discount Tolerance|'Payment Discount Tolerance (VAT Adjustment)'|'Payment Discount Tolerance (VAT Excl.)'),
                                                                                                                       Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                       Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                       Posting Date=FIELD(Date Filter),
                                                                                                                       Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[ENU=Pmt. Disc. Tolerance (LCY);
                                                              FRA=Ecart d'escompte DS];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 118 ;   ;Pmt. Tolerance (LCY);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Vendor No.=FIELD(No.),
                                                                                                                       Entry Type=FILTER(Payment Tolerance|'Payment Tolerance (VAT Adjustment)'|'Payment Tolerance (VAT Excl.)'),
                                                                                                                       Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                       Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                       Posting Date=FIELD(Date Filter),
                                                                                                                       Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[ENU=Pmt. Tolerance (LCY);
                                                              FRA=Ecart de rŠglement DS];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 119 ;   ;IC Partner Code     ;Code20        ;TableRelation="IC Partner";
                                                   OnValidate=VAR
                                                                VendLedgEntry@1001 : Record 25;
                                                                AccountingPeriod@1000 : Record 50;
                                                                ICPartner@1002 : Record 413;
                                                              BEGIN
                                                                IF xRec."IC Partner Code" <> "IC Partner Code" THEN BEGIN
                                                                  VendLedgEntry.SETCURRENTKEY("Vendor No.","Posting Date");
                                                                  VendLedgEntry.SETRANGE("Vendor No.","No.");
                                                                  AccountingPeriod.SETRANGE(Closed,FALSE);
                                                                  IF AccountingPeriod.FIND('-') THEN
                                                                    VendLedgEntry.SETFILTER("Posting Date",'>=%1',AccountingPeriod."Starting Date");
                                                                  IF VendLedgEntry.FIND('-') THEN
                                                                    IF NOT CONFIRM(Text009,FALSE,TABLECAPTION) THEN
                                                                      "IC Partner Code" := xRec."IC Partner Code";

                                                                  VendLedgEntry.RESET;
                                                                  IF NOT VendLedgEntry.SETCURRENTKEY("Vendor No.",Open) THEN
                                                                    VendLedgEntry.SETCURRENTKEY("Vendor No.");
                                                                  VendLedgEntry.SETRANGE("Vendor No.","No.");
                                                                  VendLedgEntry.SETRANGE(Open,TRUE);
                                                                  IF VendLedgEntry.FIND('+') THEN
                                                                    ERROR(Text010,FIELDCAPTION("IC Partner Code"),TABLECAPTION);
                                                                END;

                                                                IF "IC Partner Code" <> '' THEN BEGIN
                                                                  ICPartner.GET("IC Partner Code");
                                                                  IF (ICPartner."Vendor No." <> '') AND (ICPartner."Vendor No." <> "No.") THEN
                                                                    ERROR(Text008,FIELDCAPTION("IC Partner Code"),"IC Partner Code",TABLECAPTION,ICPartner."Vendor No.");
                                                                  ICPartner."Vendor No." := "No.";
                                                                  ICPartner.MODIFY;
                                                                END;

                                                                IF (xRec."IC Partner Code" <> "IC Partner Code") AND ICPartner.GET(xRec."IC Partner Code") THEN BEGIN
                                                                  ICPartner."Vendor No." := '';
                                                                  ICPartner.MODIFY;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=IC Partner Code;
                                                              FRA=Code du partenaire IC] }
    { 120 ;   ;Refunds             ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry".Amount WHERE (Initial Document Type=CONST(Refund),
                                                                                                                Entry Type=CONST(Initial Entry),
                                                                                                                Vendor No.=FIELD(No.),
                                                                                                                Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                Posting Date=FIELD(Date Filter),
                                                                                                                Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[ENU=Refunds;
                                                              FRA=Remboursements] }
    { 121 ;   ;Refunds (LCY)       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Initial Document Type=CONST(Refund),
                                                                                                                        Entry Type=CONST(Initial Entry),
                                                                                                                        Vendor No.=FIELD(No.),
                                                                                                                        Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                        Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                        Posting Date=FIELD(Date Filter),
                                                                                                                        Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[ENU=Refunds (LCY);
                                                              FRA=Remboursements DS] }
    { 122 ;   ;Other Amounts       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry".Amount WHERE (Initial Document Type=CONST(" "),
                                                                                                                Entry Type=CONST(Initial Entry),
                                                                                                                Vendor No.=FIELD(No.),
                                                                                                                Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                Posting Date=FIELD(Date Filter),
                                                                                                                Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[ENU=Other Amounts;
                                                              FRA=Autres montants] }
    { 123 ;   ;Other Amounts (LCY) ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Initial Document Type=CONST(" "),
                                                                                                                        Entry Type=CONST(Initial Entry),
                                                                                                                        Vendor No.=FIELD(No.),
                                                                                                                        Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                        Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                        Posting Date=FIELD(Date Filter),
                                                                                                                        Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[ENU=Other Amounts (LCY);
                                                              FRA=Autres montants DS] }
    { 124 ;   ;Prepayment %        ;Decimal       ;CaptionML=[ENU=Prepayment %;
                                                              FRA=% acompte];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 125 ;   ;Outstanding Invoices;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Line"."Outstanding Amount" WHERE (Document Type=CONST(Invoice),
                                                                                                               Pay-to Vendor No.=FIELD(No.),
                                                                                                               Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                               Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                               Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[ENU=Outstanding Invoices;
                                                              FRA=Factures en attente];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 126 ;   ;Outstanding Invoices (LCY);Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Line"."Outstanding Amount (LCY)" WHERE (Document Type=CONST(Invoice),
                                                                                                                     Pay-to Vendor No.=FIELD(No.),
                                                                                                                     Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                     Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                     Currency Code=FIELD(Currency Filter)));
                                                   CaptionML=[ENU=Outstanding Invoices (LCY);
                                                              FRA=Factures en attente DS];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 130 ;   ;Pay-to No. Of Archived Doc.;Integer;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header Archive" WHERE (Document Type=CONST(Order),
                                                                                                      Pay-to Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=Pay-to No. Of Archived Doc.;
                                                              FRA=Paiement - Nbre de doc. archiv‚s] }
    { 131 ;   ;Buy-from No. Of Archived Doc.;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header Archive" WHERE (Document Type=CONST(Order),
                                                                                                      Buy-from Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=Buy-from No. Of Archived Doc.;
                                                              FRA=Achat - Nbre de doc. archiv‚s] }
    { 5049;   ;Primary Contact No. ;Code20        ;TableRelation=Contact;
                                                   OnValidate=VAR
                                                                Cont@1001 : Record 5050;
                                                                ContBusRel@1000 : Record 5054;
                                                              BEGIN
                                                                Contact := '';
                                                                IF "Primary Contact No." <> '' THEN BEGIN
                                                                  Cont.GET("Primary Contact No.");

                                                                  ContBusRel.SETCURRENTKEY("Link to Table","No.");
                                                                  ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Vendor);
                                                                  ContBusRel.SETRANGE("No.","No.");
                                                                  ContBusRel.FIND('-');

                                                                  IF Cont."Company No." <> ContBusRel."Contact No." THEN
                                                                    ERROR(Text004,Cont."No.",Cont.Name,"No.",Name);

                                                                  IF Cont.Type = Cont.Type::Person THEN
                                                                    Contact := Cont.Name
                                                                END;
                                                              END;

                                                   OnLookup=VAR
                                                              Cont@1001 : Record 5050;
                                                              ContBusRel@1000 : Record 5054;
                                                            BEGIN
                                                              ContBusRel.SETCURRENTKEY("Link to Table","No.");
                                                              ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Vendor);
                                                              ContBusRel.SETRANGE("No.","No.");
                                                              IF ContBusRel.FINDFIRST THEN
                                                                Cont.SETRANGE("Company No.",ContBusRel."Contact No.")
                                                              ELSE
                                                                Cont.SETRANGE("No.",'');

                                                              IF "Primary Contact No." <> '' THEN
                                                                IF Cont.GET("Primary Contact No.") THEN ;
                                                              IF FORM.RUNMODAL(0,Cont) = ACTION::LookupOK THEN
                                                                VALIDATE("Primary Contact No.",Cont."No.");
                                                            END;

                                                   CaptionML=[ENU=Primary Contact No.;
                                                              FRA=Nø contact principal] }
    { 5700;   ;Responsibility Center;Code10       ;TableRelation="Responsibility Center";
                                                   CaptionML=[ENU=Responsibility Center;
                                                              FRA=Centre de gestion] }
    { 5701;   ;Location Code       ;Code10        ;TableRelation=Location WHERE (Use As In-Transit=CONST(No));
                                                   CaptionML=[ENU=Location Code;
                                                              FRA=Code magasin] }
    { 5790;   ;Lead Time Calculation;DateFormula  ;CaptionML=[ENU=Lead Time Calculation;
                                                              FRA=D‚lai de r‚appro.] }
    { 7177;   ;No. of Pstd. Receipts;Integer      ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purch. Rcpt. Header" WHERE (Buy-from Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=No. of Pstd. Receipts;
                                                              FRA=Nbre r‚ceptions enreg.];
                                                   Editable=No }
    { 7178;   ;No. of Pstd. Invoices;Integer      ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purch. Inv. Header" WHERE (Buy-from Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=No. of Pstd. Invoices;
                                                              FRA=Nbre de factures enregistr‚es];
                                                   Editable=No }
    { 7179;   ;No. of Pstd. Return Shipments;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Return Shipment Header" WHERE (Buy-from Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=No. of Pstd. Return Shipments;
                                                              FRA=Nbre exp‚ditions retour enreg.];
                                                   Editable=No }
    { 7180;   ;No. of Pstd. Credit Memos;Integer  ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purch. Cr. Memo Hdr." WHERE (Buy-from Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=No. of Pstd. Credit Memos;
                                                              FRA=Nbre d'avoirs enregistr‚s];
                                                   Editable=No }
    { 7181;   ;Pay-to No. of Orders;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Order),
                                                                                              Pay-to Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=Pay-to No. of Orders;
                                                              FRA=Paiement - Nbre de commandes];
                                                   Editable=No }
    { 7182;   ;Pay-to No. of Invoices;Integer     ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Invoice),
                                                                                              Pay-to Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=Pay-to No. of Invoices;
                                                              FRA=Paiement - Nbre de factures];
                                                   Editable=No }
    { 7183;   ;Pay-to No. of Return Orders;Integer;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Return Order),
                                                                                              Pay-to Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=Pay-to No. of Return Orders;
                                                              FRA=Paiement - Nbre de retours];
                                                   Editable=No }
    { 7184;   ;Pay-to No. of Credit Memos;Integer ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Credit Memo),
                                                                                              Pay-to Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=Pay-to No. of Credit Memos;
                                                              FRA=Paiement - Nbre d'avoirs];
                                                   Editable=No }
    { 7185;   ;Pay-to No. of Pstd. Receipts;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Purch. Rcpt. Header" WHERE (Pay-to Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=Pay-to No. of Pstd. Receipts;
                                                              FRA=Paiement - Nbre de r‚ceptions enreg.];
                                                   Editable=No }
    { 7186;   ;Pay-to No. of Pstd. Invoices;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Purch. Inv. Header" WHERE (Pay-to Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=Pay-to No. of Pstd. Invoices;
                                                              FRA=Paiement - Nbre de factures enreg.];
                                                   Editable=No }
    { 7187;   ;Pay-to No. of Pstd. Return S.;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Return Shipment Header" WHERE (Pay-to Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=Pay-to No. of Pstd. Return S.;
                                                              FRA=Paiement - Nbre d'exp. retour enreg.];
                                                   Editable=No }
    { 7188;   ;Pay-to No. of Pstd. Cr. Memos;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Purch. Cr. Memo Hdr." WHERE (Pay-to Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=Pay-to No. of Pstd. Cr. Memos;
                                                              FRA=Paiement - Nbre d'avoirs enreg.];
                                                   Editable=No }
    { 7189;   ;No. of Quotes       ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Quote),
                                                                                              Buy-from Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=No. of Quotes;
                                                              FRA=Nbre de devis];
                                                   Editable=No }
    { 7190;   ;No. of Blanket Orders;Integer      ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Blanket Order),
                                                                                              Buy-from Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=No. of Blanket Orders;
                                                              FRA=Nbre de commandes ouvertes];
                                                   Editable=No }
    { 7191;   ;No. of Orders       ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Order),
                                                                                              Buy-from Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=No. of Orders;
                                                              FRA=Nbre de commandes] }
    { 7192;   ;No. of Invoices     ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Invoice),
                                                                                              Buy-from Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=No. of Invoices;
                                                              FRA=Nbre de factures];
                                                   Editable=No }
    { 7193;   ;No. of Return Orders;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Return Order),
                                                                                              Buy-from Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=No. of Return Orders;
                                                              FRA=Nbre de retours];
                                                   Editable=No }
    { 7194;   ;No. of Credit Memos ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Credit Memo),
                                                                                              Buy-from Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=No. of Credit Memos;
                                                              FRA=Nbre d'avoirs];
                                                   Editable=No }
    { 7195;   ;No. of Order Addresses;Integer     ;FieldClass=FlowField;
                                                   CalcFormula=Count("Order Address" WHERE (Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=No. of Order Addresses;
                                                              FRA=Nbre d'adresses de commande];
                                                   Editable=No }
    { 7196;   ;Pay-to No. of Quotes;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Quote),
                                                                                              Pay-to Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=Pay-to No. of Quotes;
                                                              FRA=Paiement - Nbre de devis];
                                                   Editable=No }
    { 7197;   ;Pay-to No. of Blanket Orders;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Blanket Order),
                                                                                              Pay-to Vendor No.=FIELD(No.)));
                                                   CaptionML=[ENU=Pay-to No. of Blanket Orders;
                                                              FRA=Paiement - Nbre de commandes ouvertes] }
    { 7600;   ;Base Calendar Code  ;Code10        ;TableRelation="Base Calendar";
                                                   CaptionML=[ENU=Base Calendar Code;
                                                              FRA=Code calendrier principal] }
    { 10810;  ;Default Bank Account Code;Code10   ;TableRelation="Vendor Bank Account".Code WHERE (Vendor No.=FIELD(No.));
                                                   CaptionML=[ENU=Default Bank Account Code;
                                                              FRA=Code compte bancaire par d‚faut] }
    { 10860;  ;Payment in progress (LCY);Decimal  ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Payment Line"."Amount (LCY)" WHERE (Account Type=CONST(Vendor),
                                                                                                        Account No.=FIELD(No.),
                                                                                                        Copied To Line=CONST(0),
                                                                                                        Payment in Progress=CONST(Yes)));
                                                   CaptionML=[ENU=Payment in progress (LCY);
                                                              FRA=RŠglement en cours DS];
                                                   Editable=No }
    { 50001;  ;APE Code            ;Code5         ;CaptionML=[ENU=APE Code;
                                                              FRA=Code APE];
                                                   Description=FR4.03-01 }
    { 50002;  ;Occupation Code     ;Code10        ;CaptionML=[ENU=Occupation Code;
                                                              FRA=Code profession];
                                                   Description=FR4.03-01 }
    { 50007;  ;Include Entries For DAS;Boolean    ;CaptionML=[ENU=Include Entries For DAS;
                                                              FRA=Prise en compte ‚critures pour la DAS] }
    { 50010;  ;Old System No.      ;Code20        ;CaptionML=FRA=Code ancien systŠme }
    { 50300;  ;SIREN No.           ;Code9         ;OnValidate=VAR
                                                                lProviderMgt@1100281000 : Codeunit 50018;
                                                              BEGIN
                                                                //<<IMH06
                                                                fNulUpdateInformationDAS (21);
                                                                //>>IMH06

                                                                lProviderMgt.ValidateSIRENNo("SIREN No.", "NIC No.", TRUE);  //IMH05
                                                              END;

                                                   CaptionML=FRA=Nø SIREN;
                                                   Description=IMH6.01.140 }
    { 50301;  ;NIC No.             ;Code5         ;OnValidate=VAR
                                                                lProviderMgt@1100281000 : Codeunit 50018;
                                                              BEGIN
                                                                //<<IMH06
                                                                fNulUpdateInformationDAS (21);
                                                                //>>IMH06

                                                                lProviderMgt.ValidateSIRENNo("SIREN No.", "NIC No.", TRUE);  //IMH05
                                                              END;

                                                   CaptionML=FRA=Nø NIC;
                                                   Description=IMH6.01.140 }
    { 50302;  ;Legal Personality   ;Option        ;CaptionML=FRA=Personnalit‚ juridique;
                                                   OptionCaptionML=[ENU=" ,Moral,Physical";
                                                                    FRA=" ,Morale,Physique"];
                                                   OptionString=[ ,Moral,Physical];
                                                   Description=IMH6.01.140 }
    { 50303;  ;Surname             ;Text30        ;OnValidate=BEGIN
                                                                //<<IMH06
                                                                fNulUpdateInformationDAS (1);
                                                                //>>IMH06
                                                              END;

                                                   CaptionML=FRA=Nom;
                                                   Description=IMH6.01.140 }
    { 50304;  ;Firstname           ;Text30        ;OnValidate=BEGIN
                                                                //<<IMH06
                                                                fNulUpdateInformationDAS (1);
                                                                //>>IMH06
                                                              END;

                                                   CaptionML=FRA=Pr‚nom;
                                                   Description=IMH6.01.140 }
    { 50305;  ;Further Mention     ;Text50        ;OnValidate=BEGIN
                                                                //<<IMH06
                                                                fNulUpdateInformationDAS (11);
                                                                //>>IMH06
                                                              END;

                                                   CaptionML=FRA=Mention compl‚mentaire;
                                                   Description=IMH6.01.140 }
    { 50306;  ;Road No.            ;Text50        ;OnValidate=BEGIN
                                                                //<<IMH06
                                                                fNulUpdateInformationDAS (11);
                                                                //>>IMH06
                                                              END;

                                                   CaptionML=FRA=Nø voie;
                                                   Description=IMH6.01.140 }
    { 50307;  ;Road No. 2          ;Option        ;OnValidate=BEGIN
                                                                //<<IMH06
                                                                fNulUpdateInformationDAS (11);
                                                                //>>IMH06
                                                              END;

                                                   CaptionML=FRA=Nø voie 2;
                                                   OptionCaptionML=FRA=" ,bis,ter,quater";
                                                   OptionString=[ ,bis,ter,quater];
                                                   Description=IMH6.01.140 }
    { 50308;  ;Road Nature and Name;Text50        ;OnValidate=BEGIN
                                                                //<<IMH06
                                                                fNulUpdateInformationDAS (11);
                                                                //>>IMH06
                                                              END;

                                                   CaptionML=FRA=Nom et nature voie;
                                                   Description=IMH6.01.140 }
    { 50309;  ;Post Office Box / Hamlet;Text50    ;OnValidate=BEGIN
                                                                //<<IMH06
                                                                fNulUpdateInformationDAS (11);
                                                                //>>IMH06
                                                              END;

                                                   CaptionML=FRA=Boite postale / Hameau;
                                                   Description=IMH6.01.140 }
    { 50310;  ;Factor No.          ;Code20        ;TableRelation=Vendor;
                                                   OnValidate=BEGIN
                                                                //<<IMH06
                                                                IF "Factor No." <> xRec."Factor No." THEN
                                                                  IF ("Starting Date Factor" <>0D) AND ("Ending Date Factor" <> 0D) AND ("Factor No."<> '') THEN //IMH09
                                                                    CODEUNIT.RUN(CODEUNIT::"Transfert factor",Rec);
                                                                //<<IMH06
                                                              END;

                                                   CaptionML=[ENU=Factor No.;
                                                              FRA=Nø factor];
                                                   Description=IMH6.01.155 }
    { 50311;  ;Starting Date Factor;Date          ;OnValidate=BEGIN
                                                                //<<IMH09
                                                                IF Rec."Starting Date Factor" <> xRec."Starting Date Factor" THEN
                                                                  IF ("Starting Date Factor" <>0D) AND ("Ending Date Factor" <> 0D) AND ("Factor No."<> '') THEN
                                                                    CODEUNIT.RUN(CODEUNIT::"Transfert factor",Rec);
                                                                //<<IMH09
                                                              END;

                                                   CaptionML=[ENU=Starting Date Factor;
                                                              FRA=Date d‚but factor];
                                                   Description=IMH6.01.155 }
    { 50312;  ;Ending Date Factor  ;Date          ;OnValidate=BEGIN
                                                                //<<IMH09
                                                                IF Rec."Ending Date Factor" <> xRec."Ending Date Factor" THEN
                                                                  IF ("Starting Date Factor" <>0D) AND ("Ending Date Factor" <> 0D) AND ("Factor No."<> '') THEN
                                                                    CODEUNIT.RUN(CODEUNIT::"Transfert factor",Rec);
                                                                //<<IMH09
                                                              END;

                                                   CaptionML=[ENU=Ending Date Factor;
                                                              FRA=Date fin factor];
                                                   Description=IMH6.01.155 }
    { 50313;  ;Contact No.         ;Code20        ;TableRelation=Contact.No.;
                                                   CaptionML=FRA=Nø B‚n‚ficiaire;
                                                   Description=IMH6.01.141;
                                                   Editable=No }
    { 50320;  ;Request reimbursement blocked;Boolean;
                                                   CaptionML=[ENU=Request reimbursement blocked;
                                                              FRA=Bloqu‚ demande de remboursement] }
    { 54135;  ;Registration No.    ;Code20        ;OnValidate=BEGIN
                                                                //<<IMH06
                                                                fNulUpdateInformationDAS (22);
                                                                //>>IMH06
                                                              END;

                                                   CaptionML=[ENU=Registration No.;
                                                              FRA=Nø SIRET];
                                                   Description=IMH6.01.140 }
    { 8016602;;Default Company Bank Account;Code20;TableRelation="Bank Account";
                                                   CaptionML=[ENU=Default Company Bank Account;
                                                              FRA=Banque soci‚t‚ par d‚faut];
                                                   Description=ISA5.00.00.00 }
    { 8016603;;Consolidation       ;Boolean       ;CaptionML=[ENU=Consolidation;
                                                              FRA=Consolidation];
                                                   Description=ISA5.00.00.00 }
    { 8016604;;Default Company Bank Code;Code20   ;TableRelation="Bank Account" WHERE (No.=FIELD(No.));
                                                   CaptionML=[ENU=Default company bank;
                                                              FRA=Banque soci‚t‚ par d‚faut];
                                                   Description=ISA5.00.00.00 domiciliation fournisseur }
    { 8016608;;Address 3           ;Text50        ;CaptionML=[ENU=Address 3;
                                                              FRA=Adresse (3Šme ligne)] }
  }
  KEYS
  {
    {    ;No.                                     ;Clustered=Yes }
    {    ;Search Name                              }
    {    ;Vendor Posting Group                     }
    {    ;Currency Code                            }
    {    ;Priority                                 }
    {    ;Country/Region Code                      }
    {    ;Gen. Bus. Posting Group                  }
    {    ;VAT Registration No.                     }
    { No ;Name                                    ;KeyGroups=SearchCol }
    { No ;City                                    ;KeyGroups=SearchCol }
    { No ;Post Code                               ;KeyGroups=SearchCol }
    { No ;Phone No.                               ;KeyGroups=SearchCol }
    { No ;Contact                                 ;KeyGroups=SearchCol }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;No.,Name,City,Post Code,Phone No.,Contact }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=You cannot delete %1 %2 because there is at least one outstanding Purchase %3 for this vendor.;FRA=Vous ne pouvez pas supprimer %1 %2 car il existe encore au moins une %3 achat ouverte pour ce fournisseur.';
      Text002@1001 : TextConst 'ENU=You have set %1 to %2. Do you want to update the %3 price list accordingly?;FRA=Vous avez param‚tr‚ %1 sur %2. Souhaitez-vous mettre … jour la liste des prix %3 en cons‚quence ?';
      Text003@1002 : TextConst 'ENU=Do you wish to create a contact for %1 %2?;FRA=Souhaitez-vous cr‚er un contact pour %1 %2 ?';
      PurchSetup@1003 : Record 312;
      CommentLine@1005 : Record 97;
      PurchOrderLine@1006 : Record 39;
      PostCode@1007 : Record 225;
      VendBankAcc@1008 : Record 288;
      OrderAddr@1009 : Record 224;
      GenBusPostingGrp@1010 : Record 250;
      ItemCrossReference@1016 : Record 5717;
      RMSetup@1020 : Record 5079;
      ServiceItem@1024 : Record 5940;
      NoSeriesMgt@1011 : Codeunit 396;
      MoveEntries@1012 : Codeunit 361;
      UpdateContFromVend@1013 : Codeunit 5057;
      DimMgt@1014 : Codeunit 408;
      InsertFromContact@1015 : Boolean;
      Text004@1019 : TextConst 'ENU=Contact %1 %2 is not related to vendor %3 %4.;FRA=Le contact %1 %2 n''est pas associ‚ au fournisseur %3 %4.';
      Text005@1021 : TextConst 'ENU=post;FRA=valider';
      Text006@1022 : TextConst 'ENU=create;FRA=cr‚er';
      Text007@1023 : TextConst 'ENU=You cannot %1 this type of document when Vendor %2 is blocked with type %3;FRA=Vous ne pouvez pas %1 ce type de document lorsque le fournisseur %2 est bloqu‚ avec le type %3';
      Text008@1025 : TextConst 'ENU=The %1 %2 has been assigned to %3 %4.\The same %1 cannot be entered on more than one %3.;FRA=La valeur %1 %2 a ‚t‚ affect‚e … %3 %4.\La mˆme valeur %1 ne peut pas ˆtre entr‚e sur plus d''un/une %3.';
      Text009@1027 : TextConst 'ENU=Reconciling IC transactions may be difficult if you change IC Partner Code because this %1 has ledger entries in a fiscal year that has not yet been closed.\ Do you still want to change the IC Partner Code?;FRA=Le rapprochement des transactions IC risque de poser problŠme si vous modifiez le code partenaire IC car ce/cette %1 comporte des ‚critures comptables appartenant … un exercice comptable qui n''a pas encore ‚t‚ cl“tur‚.\ Souhaitez-vous quand mˆme modifier le code partenaire IC ?';
      Text010@1026 : TextConst 'ENU=You cannot change the contents of the %1 field because this %2 has one or more open ledger entries.;FRA=Vous ne pouvez pas modifier la valeur du champ %1 car ce/cette %2 comporte une ou plusieurs ‚critures comptables ouvertes.';
      Text011@1004 : TextConst 'ENU=Before you can use Online Map, you must fill in the Online Map Setup window.\See Setting Up Online Map in Help.;FRA=Avant de pouvoir utiliser Online Map, vous devez compl‚ter la fenˆtre Configuration Online Map.\Consultez la section Configuration d''Online Map dans l''Aide.';

    PROCEDURE AssistEdit@2(OldVend@1000 : Record 23) : Boolean;
    VAR
      Vend@1001 : Record 23;
    BEGIN
      WITH Vend DO BEGIN
        Vend := Rec;
        PurchSetup.GET;
        PurchSetup.TESTFIELD("Vendor Nos.");
        IF NoSeriesMgt.SelectSeries(PurchSetup."Vendor Nos.",OldVend."No. Series","No. Series") THEN BEGIN
          PurchSetup.GET;
          PurchSetup.TESTFIELD("Vendor Nos.");
          NoSeriesMgt.SetSeries("No.");
          Rec := Vend;
          EXIT(TRUE);
        END;
      END;
    END;

    PROCEDURE ValidateShortcutDimCode@29(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      DimMgt.ValidateDimValueCode(FieldNumber,ShortcutDimCode);
      DimMgt.SaveDefaultDim(DATABASE::Vendor,"No.",FieldNumber,ShortcutDimCode);
      MODIFY;
    END;

    PROCEDURE LookupShortcutDimCode@28(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      DimMgt.LookupDimValueCode(FieldNumber,ShortcutDimCode);
      DimMgt.SaveDefaultDim(DATABASE::Vendor,"No.",FieldNumber,ShortcutDimCode);
    END;

    PROCEDURE ShowContact@1();
    VAR
      ContBusRel@1000 : Record 5054;
      Cont@1001 : Record 5050;
    BEGIN
      IF "No." = '' THEN
        EXIT;

      ContBusRel.SETCURRENTKEY("Link to Table","No.");
      ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Vendor);
      ContBusRel.SETRANGE("No.","No.");
      IF NOT ContBusRel.FIND('-') THEN BEGIN
        IF NOT CONFIRM(Text003,FALSE,TABLECAPTION,"No.") THEN
          EXIT;
        UpdateContFromVend.InsertNewContact(Rec,FALSE);
        ContBusRel.FIND('-');
      END;
      COMMIT;

      IF ISSERVICETIER THEN BEGIN
        Cont.SETCURRENTKEY("Company Name","Company No.",Type,Name);
        Cont.SETRANGE("Company No.",ContBusRel."Contact No.");
        FORM.RUN(FORM::"Contact List",Cont);
        EXIT;
      END;

      Cont.GET(ContBusRel."Contact No.");
      FORM.RUN(FORM::"Contact Card",Cont);
    END;

    PROCEDURE SetInsertFromContact@3(FromContact@1000 : Boolean);
    BEGIN
      InsertFromContact := FromContact;
    END;

    PROCEDURE CheckBlockedVendOnDocs@4(Vend2@1003 : Record 23;Transaction@1000 : Boolean);
    BEGIN
      IF Vend2.Blocked = Vend2.Blocked::All THEN
        VendBlockedErrorMessage(Vend2,Transaction);
    END;

    PROCEDURE CheckBlockedVendOnJnls@5(Vend2@1005 : Record 23;DocType@1004 : ' ,Payment,Invoice,Credit Memo,Finance Charge,Reminder,Refund';Transaction@1003 : Boolean);
    BEGIN
      WITH Vend2 DO BEGIN
        IF (Blocked = Blocked::All) OR
           (Blocked = Blocked::Payment) AND (DocType = DocType::Payment)
        THEN
          VendBlockedErrorMessage(Vend2,Transaction);
      END;
    END;

    PROCEDURE VendBlockedErrorMessage@6(Vend2@1001 : Record 23;Transaction@1002 : Boolean);
    VAR
      Action@1000 : Text[30];
    BEGIN
      IF Transaction THEN
        Action := Text005
      ELSE
        Action := Text006;
      ERROR(Text007,Action,Vend2."No.",Vend2.Blocked);
    END;

    PROCEDURE DisplayMap@7();
    VAR
      MapPoint@1001 : Record 800;
      MapMgt@1000 : Codeunit 802;
    BEGIN
      IF MapPoint.FIND('-') THEN
        MapMgt.MakeSelection(DATABASE::Vendor,GETPOSITION)
      ELSE
        MESSAGE(Text011);
    END;

    PROCEDURE fNulUpdateInformationDAS@1100281002(UpdateType@1100281000 : Integer);
    VAR
      ltxtStreetText@1100281001 : Text[250];
      lProviderMgt@1100281002 : Codeunit 50018;
    BEGIN
      //IMH6.01.140
      CASE UpdateType OF
        // SurName
        1 : BEGIN
          IF ((STRLEN(Surname + Firstname) + 1) <= 30) THEN
            Name := Surname + ' ' + Firstname
          ELSE BEGIN
            Name := Surname;
            "Name 2" := Firstname;
          END;
        END;
        // Name
        2 : fNulNameBreakdown;
        // Further Motion
        11 : BEGIN
          IF ("Road Nature and Name" = '') THEN
            EXIT;
          ltxtStreetText := '';
          IF ("Road No." <> '') THEN
            ltxtStreetText += FORMAT("Road No.") + ' ';
          IF ("Road No. 2" > 0) THEN
            ltxtStreetText += FORMAT("Road No. 2") + ' ';
          IF ("Road Nature and Name" <> '') THEN
            ltxtStreetText += FORMAT("Road Nature and Name");
          IF ("Further Mention" <> '') THEN
          BEGIN
            Address := "Further Mention";
            IF ("Post Office Box / Hamlet" = '') THEN
              "Address 2" := COPYSTR(ltxtStreetText,1,30)
            ELSE
              "Address 2" := COPYSTR(ltxtStreetText + ' ' + "Post Office Box / Hamlet",1,30);
          END ELSE BEGIN
              Address := COPYSTR(ltxtStreetText,1,30);
              "Address 2" := "Post Office Box / Hamlet";
          END;
        END;
        // Address
        12 : BEGIN
          ltxtStreetText := COPYSTR(DELCHR(Address,'<>',' '),1,1);
          IF (ltxtStreetText >= '0') AND (ltxtStreetText <= '9') THEN
          BEGIN
            fNulAddressBreakdown(Address);
            "Post Office Box / Hamlet" := "Address 2";
          END ELSE BEGIN
            ltxtStreetText := COPYSTR(DELCHR("Address 2",'<>',' '),1,1);
            IF (ltxtStreetText >= '0') AND (ltxtStreetText <= '9') THEN
            BEGIN
              fNulAddressBreakdown("Address 2");
              "Further Mention" := Address
            END ELSE BEGIN
              "Further Mention" := Address;
              "Post Office Box / Hamlet" := "Address 2";
            END;
          END;
        END;
        // SIREN & NIC
        21 : BEGIN
          IF ("SIREN No." <> '') AND ("NIC No." <> '') THEN
            "Registration No." := "SIREN No." + "NIC No.";
        END;
        // Registration No.
        22 : BEGIN
          IF ("Registration No." <> '') THEN
          BEGIN
            "Registration No." := DELCHR("Registration No.",'=',' ');
            "SIREN No." := COPYSTR("Registration No.",1,9);
            "NIC No." := COPYSTR("Registration No.",10,5);
            lProviderMgt.ValidateSIRENNo("SIREN No.", "NIC No.", TRUE);  //IMH6.JC
          END;
        END;
      END;
    END;

    PROCEDURE fNulNameBreakdown@1100281000();
    VAR
      ltxtNamePart@1100281000 : ARRAY [12] OF Text[250];
      ltxtTempName@1100281001 : Text[250];
      ltxtFirstName250@1100281002 : Text[250];
      inti@1100281003 : Integer;
      intNoOfParts@1100281004 : Integer;
      ltxtText032@1100281005 : TextConst 'FRA=Texte en attente';
    BEGIN
      //IMH6.01.140.JC
      // Separation du nom et pr‚nom
      IF "Legal Personality" <> "Legal Personality"::Physical THEN
        EXIT;

      ltxtTempName := Name;
      WHILE STRPOS(ltxtTempName,' ') > 0 DO BEGIN
        IF STRPOS(ltxtTempName,' ') > 1 THEN BEGIN
          inti := inti + 1;
          ltxtNamePart[inti] := COPYSTR(ltxtTempName,1,STRPOS(ltxtTempName,' ') - 1);
        END;
        ltxtTempName := COPYSTR(ltxtTempName,STRPOS(ltxtTempName,' ') + 1);
      END;
      inti := inti + 1;
      ltxtNamePart[inti] := ltxtTempName;
      intNoOfParts := inti;

      Firstname := '';
      Surname := '';
      FOR inti := 1 TO intNoOfParts DO
      BEGIN
        IF (inti = intNoOfParts) AND (intNoOfParts > 1) THEN
        BEGIN
          IF STRLEN(ltxtNamePart[inti]) > MAXSTRLEN(Surname) THEN
            ERROR(ltxtText032,FIELDCAPTION(Surname),STRLEN(ltxtNamePart[inti]) - MAXSTRLEN(Surname));
          Firstname := ltxtNamePart[inti]
        END ELSE BEGIN
            ltxtFirstName250 := DELCHR(Firstname + ' ' + ltxtNamePart[inti],'<',' ');
            IF STRLEN(ltxtFirstName250) > MAXSTRLEN(Firstname) THEN
              ERROR(ltxtText032,FIELDCAPTION(Firstname),STRLEN(ltxtFirstName250) - MAXSTRLEN(Firstname));
            Surname := ltxtFirstName250;
        END;
      END;
    END;

    PROCEDURE fNulAddressBreakdown@1100281001(pTxtStreetText@1100281000 : Text[250]);
    VAR
      lbooStop@1100281001 : Boolean;
      lTxtRoadText@1100281002 : Text[30];
    BEGIN
      //IMH6.01.140.JC

      // S‚paration de l'adresse
      pTxtStreetText := DELCHR(pTxtStreetText,'<>',' ');
      lbooStop := FALSE;
      lTxtRoadText := '';

      REPEAT
        IF (COPYSTR(pTxtStreetText,1,1) >= '0') AND (COPYSTR(pTxtStreetText,1,1) <= '9') THEN
        BEGIN
          lTxtRoadText += COPYSTR(pTxtStreetText,1,1);
          IF STRLEN(pTxtStreetText) = 1 THEN
          BEGIN
            pTxtStreetText := '';
            lbooStop := TRUE;
          END ELSE
            pTxtStreetText := COPYSTR(pTxtStreetText,2);
        END ELSE
        lbooStop := TRUE;
      UNTIL lbooStop;
      EVALUATE("Road No.",lTxtRoadText);

      pTxtStreetText := DELCHR(pTxtStreetText,'<>',' ');
      CASE TRUE OF
        (UPPERCASE(COPYSTR(pTxtStreetText,1,3)) = 'BIS') : BEGIN
          "Road No. 2" := "Road No. 2"::bis;
          pTxtStreetText := COPYSTR(pTxtStreetText,4);
        END;
        (UPPERCASE(COPYSTR(pTxtStreetText,1,3)) = 'TER') : BEGIN
          "Road No. 2" := "Road No. 2"::ter;
          pTxtStreetText := COPYSTR(pTxtStreetText,4);
        END;
        (UPPERCASE(COPYSTR(pTxtStreetText,1,5)) = 'QUATER') : BEGIN
          "Road No. 2" := "Road No. 2"::quater;
          pTxtStreetText := COPYSTR(pTxtStreetText,6);
        END;
      END;

      pTxtStreetText := DELCHR(pTxtStreetText,'<>',' ');
      IF COPYSTR(pTxtStreetText,1,1) = ',' THEN BEGIN
        pTxtStreetText := COPYSTR(pTxtStreetText,2);
      END;
      "Road Nature and Name" := pTxtStreetText;
    END;

    PROCEDURE fcodfactor@1100281003(pdatecompta@1100281000 : Date) rCodFou : Code[20];
    BEGIN
      //IMH6.01.140.JC
      //Renvoie le code fournisseur factor s'il existe … la date demand‚e, sinon renvoie espace

      IF pdatecompta IN ["Starting Date Factor".."Ending Date Factor"] THEN
        rCodFou := "Factor No."
      ELSE
        rCodFou := ' ';
    END;

    PROCEDURE CreateInteraction@10();
    VAR
      lSegmentLine@1000 : TEMPORARY Record 5077;
      lContact@1100281000 : Record 5050;
    BEGIN
      //IMH09 isat.zw
      //<<IMH32
      //lContact.GET("No.");
      //lSegmentLine.CreateInteractionFromContact(lContact);
      //lSegmentLine.CreateInteractionFromProvider(Rec);
      //>>IMH32
    END;

    PROCEDURE PhoneNoAssistEdit@1100281018(pPhoneNo@1100281000 : Text[30]);
    VAR
      CTIMgt@1100281001 : Codeunit 50138;
    BEGIN
      //<<IMH10.ISAT.EBA
      IF pPhoneNo <> '' THEN
        CTIMgt.MakeCall(pPhoneNo);
      //>>IMH10.ISAT.EBA
    END;

    BEGIN
    {
      /** @r IMH11 @d 06/02/12 @a ISAT.ZW @v IMH6.01.129 @s facturation
          @c Ajout champ "Bloqu‚ demande de remboursement" */
      /** @r IMH10 @d 15/10/11 @a ISAT.EBA @v IMH6.01.129 @s Interface CTI
          @c Ajout fonction "PhoneNoAssistEdit" */
      /** @r IMH09 @d 11/05/11 @a CAP.JC @v IMH6.01.155 @s Comptabilit‚ - gestion factor */
      /** @r IMH08 @d 17/03/11 @a CAP.JC @v IMH6.01.141 @s Comptabilit‚ - gestion fournisseur
          @c Ajout champ 50313 Contact No. */
      /** @r IMH07 @d 21/02/11 @a CAP.JC @v IMH6.01.155 @s Comptabilit‚ - gestion factor
          @c Ajout champ 50310, Factor No.
          @c Ajout champ 50311, starting date factor
          @c Ajout champ 50312, ending date factor
          @c Ajout fonction fcodfactor */
      /** @r IMH06 @d 07/02/11 @a CAP.JC @v IMH6.01.140 @s gestion DAS 1 et DAS 2
          @c Ajout champ 50300, SIREN No.
          @c Ajout champ 50301, NIC No.
          @c Ajout champ 50302, Legal Personality
          @c Ajout champ 50303, Surname
          @c Ajout champ 50304, Fisrtname
          @c Ajout champ 50305, Further
          @c Ajout champ 50306, Road No.
          @c Ajout champ 50307, Road No. 2
          @c Ajout champ 50308, Road Nature and Name
          @c Ajout champ 50309, Post Office Box
          @c Ajout champ 54135, Registration No.
          @c Ajout fNulUpdateInformationDAS, fNulNameBreakdown, fNulAddressBreakdown */
      /** @r IMH05 @d 15/02/2011 @a IMH.ZW @v IMH6.01.001 @s Normalisation des donn‚es @c Contr“le de la saisie SIRET - SIREN */
      /** @r IMH04 @d 11/02/2011 @a IMH.ZW @v IMH6.01.001 @s Normalisation des donn‚es @c normalisation Email */
      /** @r IHM03 @d 10/02/11 @a ISAT.ZW @v IMH6.01.001 @s Normalisation des donn‚es
          @c Associer les Pays au code postaux - descendre le code pays automatiquement*/
      /** @r IMH02 @d 24/09/10 @a IMH.LLT @v IMH6.01.002 @s gestion des contacts
          @c Remplacement du champs 10 Telex No. par Mobile Phone No. 2
          @c Remplacement du champs 85 Telex Answer Back par Business Phone No.
      /** @r IMH01 @d 23/09/10 @a IMH.LLT @v IMH6.01.001 @s Normalisation des donn‚es
          @c Appel de la fonction de normalisation sur les champs de type t‚l‚phonie  */
      /** @r IMH00 @d 23/09/10 @a IMH.PC @v IMH6.01.001 @s Normalisation des donn‚es
          @c Champs 50000 champs contact synchronis‚s
          @c Champs 51000 champs client synchronis‚s
          @c Champs 52000 champs fournisseur synchronis‚s
          @c Champs 53000 champs banque synchronis‚s
          @c Champs 54000 champs prestataire synchronis‚s */
    }
    END.
  }
}