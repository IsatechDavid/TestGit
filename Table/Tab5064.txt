OBJECT Table 5064 Interaction Template
{
  OBJECT-PROPERTIES
  {
    Date=22/01/14;
    Time=17:21:15;
    Modified=Yes;
    Version List=NAVW16.00.01,ISA6.00,IMH6.01.08,MATMUT01;
  }
  PROPERTIES
  {
    OnModify=BEGIN
               //<<IMH03
               IF "Mail Attachment" THEN
                 TESTFIELD("Mail Attachment Name");
               //>>IMH03
             END;

    OnDelete=VAR
               InteractTmplLanguage@1000 : Record 5103;
               lInteractTmpField@1100281000 : Record 50083;
             BEGIN
               InteractTmplLanguage.SETRANGE("Interaction Template Code",Code);
               IF NOT InteractTmplLanguage.ISEMPTY THEN //IMH01
               InteractTmplLanguage.DELETEALL(TRUE);
               //<<IMH01
               lInteractTmpField.SETRANGE("Interaction Template Code",Code);
               IF NOT lInteractTmpField.ISEMPTY THEN
                 //<<IMH23
                 //lInteractTmpField.DELETEALL(TRUE);
                 lInteractTmpField.DELETEALL(FALSE);
                 //>>IMH23
               //>>IMH01
             END;

    CaptionML=[ENU=Interaction Template;
               FRA=ModŠle interaction];
    LookupFormID=Form5075;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code10        ;CaptionML=[ENU=Code;
                                                              FRA=Code];
                                                   NotBlank=Yes }
    { 2   ;   ;Interaction Group Code;Code10      ;TableRelation="Interaction Group";
                                                   CaptionML=[ENU=Interaction Group Code;
                                                              FRA=Code groupe interactions];
                                                   NotBlank=Yes }
    { 3   ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              FRA=D‚signation] }
    { 4   ;   ;Unit Cost (LCY)     ;Decimal       ;CaptionML=[ENU=Unit Cost (LCY);
                                                              FRA=Co–t unitaire DS];
                                                   MinValue=0;
                                                   AutoFormatType=1 }
    { 5   ;   ;Unit Duration (Min.);Decimal       ;CaptionML=[ENU=Unit Duration (Min.);
                                                              FRA=Dur‚e unitaire (min.)];
                                                   DecimalPlaces=0:0;
                                                   MinValue=0 }
    { 6   ;   ;Information Flow    ;Option        ;CaptionML=[ENU=Information Flow;
                                                              FRA=Flux d'informations];
                                                   OptionCaptionML=[ENU=" ,Outbound,Inbound";
                                                                    FRA=" ,Sortant,Entrant"];
                                                   OptionString=[ ,Outbound,Inbound] }
    { 7   ;   ;Initiated By        ;Option        ;CaptionML=[ENU=Initiated By;
                                                              FRA=Initi‚ par];
                                                   OptionCaptionML=[ENU=" ,Us,Them";
                                                                    FRA=" ,Notre soci‚t‚,Le contact"];
                                                   OptionString=[ ,Us,Them] }
    { 8   ;   ;Attachment No.      ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Interaction Tmpl. Language"."Attachment No." WHERE (Interaction Template Code=FIELD(Code),
                                                                                                                           Language Code=FIELD("Language Code (Default)")));
                                                   CaptionML=[ENU=Attachment No.;
                                                              FRA=Nø document joint];
                                                   Editable=No }
    { 9   ;   ;Campaign No.        ;Code20        ;TableRelation=Campaign;
                                                   CaptionML=[ENU=Campaign No.;
                                                              FRA=Nø ‚vŠnement exceptionnel] }
    { 10  ;   ;Campaign Target     ;Boolean       ;CaptionML=[ENU=Campaign Target;
                                                              FRA=Cible campagne] }
    { 11  ;   ;Campaign Response   ;Boolean       ;CaptionML=[ENU=Campaign Response;
                                                              FRA=R‚ponse campagne] }
    { 12  ;   ;Correspondence Type (Default);Option;
                                                   OnValidate=VAR
                                                                Attachment@1001 : Record 5062;
                                                                ErrorText@1000 : Text[80];
                                                              BEGIN
                                                                IF NOT Attachment.GET("Attachment No.") THEN
                                                                  EXIT;

                                                                ErrorText := Attachment.CheckCorrespondenceType("Correspondence Type (Default)");
                                                                IF ErrorText <> '' THEN
                                                                  ERROR(
                                                                    Text003+ErrorText,
                                                                    FIELDCAPTION("Correspondence Type (Default)"),"Correspondence Type (Default)",TABLECAPTION,Code);
                                                              END;

                                                   CaptionML=[ENU=Correspondence Type (Default);
                                                              FRA=Moyen de communication privil‚gi‚ (par d‚faut)];
                                                   OptionCaptionML=[ENU=" ,Hard Copy,E-Mail,Fax,SMS,DARVA";
                                                                    FRA=" ,Impression,E-Mail,T‚l‚copie,SMS,DARVA"];
                                                   OptionString=[ ,Hard Copy,E-Mail,Fax,SMS,DARVA] }
    { 13  ;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              FRA=Filtre date] }
    { 14  ;   ;No. of Interactions ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Interaction Log Entry" WHERE (Interaction Template Code=FIELD(Code),
                                                                                                    Canceled=CONST(No),
                                                                                                    Date=FIELD(Date Filter),
                                                                                                    Postponed=CONST(No)));
                                                   CaptionML=[ENU=No. of Interactions;
                                                              FRA=Nbre interactions];
                                                   Editable=No }
    { 15  ;   ;Cost (LCY)          ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Interaction Log Entry"."Cost (LCY)" WHERE (Interaction Template Code=FIELD(Code),
                                                                                                               Canceled=CONST(No),
                                                                                                               Date=FIELD(Date Filter),
                                                                                                               Postponed=CONST(No)));
                                                   CaptionML=[ENU=Cost (LCY);
                                                              FRA=Co–t DS];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 16  ;   ;Duration (Min.)     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Interaction Log Entry"."Duration (Min.)" WHERE (Interaction Template Code=FIELD(Code),
                                                                                                                    Canceled=CONST(No),
                                                                                                                    Date=FIELD(Date Filter),
                                                                                                                    Postponed=CONST(No)));
                                                   CaptionML=[ENU=Duration (Min.);
                                                              FRA=Dur‚e (min.)];
                                                   DecimalPlaces=0:0;
                                                   Editable=No }
    { 17  ;   ;Language Code (Default);Code10     ;TableRelation=Language;
                                                   OnValidate=VAR
                                                                InteractTmplLanguage@1000 : Record 5103;
                                                              BEGIN
                                                                IF NOT InteractTmplLanguage.GET(Code,"Language Code (Default)") THEN BEGIN
                                                                  IF CONFIRM(Text004,TRUE,InteractTmplLanguage.TABLECAPTION,"Language Code (Default)") THEN BEGIN
                                                                    InteractTmplLanguage.INIT;
                                                                    InteractTmplLanguage."Interaction Template Code" := Code;
                                                                    InteractTmplLanguage."Language Code" := "Language Code (Default)";
                                                                    InteractTmplLanguage.Description := Description;
                                                                    InteractTmplLanguage.INSERT;
                                                                  END ELSE
                                                                    ERROR('');
                                                                END;
                                                                CALCFIELDS("Attachment No.");
                                                              END;

                                                   OnLookup=VAR
                                                              InteractTmplLanguage@1000 : Record 5103;
                                                            BEGIN
                                                              InteractTmplLanguage.SETRANGE("Interaction Template Code",Code);
                                                              IF FORM.RUNMODAL(0,InteractTmplLanguage) = ACTION::LookupOK THEN BEGIN
                                                                "Language Code (Default)" := InteractTmplLanguage."Language Code";
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Language Code (Default);
                                                              FRA=Code langue (par d‚faut)] }
    { 18  ;   ;Wizard Action       ;Option        ;CaptionML=[ENU=Wizard Action;
                                                              FRA=Action assist‚e];
                                                   OptionCaptionML=[ENU=" ,Open,Import";
                                                                    FRA=" ,Ouverture,Import"];
                                                   OptionString=[ ,Open,Import] }
    { 19  ;   ;Ignore Contact Corres. Type;Boolean;CaptionML=[ENU=Ignore Contact Corres. Type;
                                                              FRA=Ignorer moyen de communication privil‚gi‚ contact] }
    { 50000;  ;No. of Merge Fields ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Interaction Template Field" WHERE (Interaction Template Code=FIELD(Code)));
                                                   CaptionML=[ENU=No. of Merge Fields;
                                                              FRA=Nbre champs fusions];
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 50001;  ;Mail Attachment     ;Boolean       ;CaptionML=[ENU=Mail Attachment;
                                                              FRA=PiŠce jointe au mail] }
    { 50002;  ;Mail Attachment Name;Text250       ;CaptionML=[ENU=Mail Attachment Name;
                                                              FRA=Nom piŠce jointe] }
    { 50003;  ;Automatic Send Mail ;Boolean       ;CaptionML=[ENU=Automatic Send Mail;
                                                              FRA=Envoi mail automatique] }
    { 50004;  ;Default Interaction Descr.;Text50  ;CaptionML=[ENU=Default Interaction Description;
                                                              FRA=Description interaction par d‚faut] }
    { 50005;  ;Service Contact Dest.;Option       ;CaptionML=[ENU=Service Contact Dest.;
                                                              FRA=Destinataire service];
                                                   OptionCaptionML=[ENU=" ,Beneficiairy,Corporate,Provider,Declaration Contact,Corporate Region,Princ. Expert Contact,Expert Contact";
                                                                    FRA=" ,B‚n‚ficiaire,Grand-compte,Prestataire,Contact d‚claration,R‚gion grand-compte,Cabinet expert,Expert"];
                                                   OptionString=[ ,Beneficiairy,Corporate,Provider,Declaration Contact,Corporate Region,Princ. Expert Contact,Expert Contact] }
    { 50006;  ;Send To Admin. Contact;Boolean     ;CaptionML=[ENU=Send To Admin. Contact;
                                                              FRA=Envoi au contact admin.] }
    { 50007;  ;Service Contact Dest. CC;Option    ;CaptionML=[ENU=Service Contact Dest. CC;
                                                              FRA=Destinataire service en copie];
                                                   OptionCaptionML=[ENU=" ,Beneficiairy,Corporate,Provider,Declaration Contact,Corporate Region,Network Facilitator,CGF";
                                                                    FRA=" ,B‚n‚ficiaire,Grand-compte,Prestataire,Contact d‚claration,R‚gion grand-compte,Charg‚ de pilotage r‚seau,CGF"];
                                                   OptionString=[ ,Beneficiairy,Corporate,Provider,Declaration Contact,Corporate Region,Network Facilitator,CGF] }
    { 50010;  ;Attachment Read Only;Boolean       ;CaptionML=[ENU=Attachment Read Only;
                                                              FRA=Document joint en lecture seule] }
    { 50011;  ;Description Read Only;Boolean      ;OnValidate=BEGIN
                                                                IF "Description Read Only" THEN
                                                                  TESTFIELD("Default Interaction Descr.");
                                                              END;

                                                   CaptionML=[ENU=Description Read Only;
                                                              FRA=Description en lecture seule] }
    { 50012;  ;Ask For Attachment  ;Boolean       ;CaptionML=[ENU=Ask For Attachment;
                                                              FRA=Demande ajout piŠce jointe] }
    { 50020;  ;Show To Contact     ;Boolean       ;CaptionML=[ENU=Show To Contact;
                                                              FRA=Afficher sur contact] }
    { 50021;  ;Show To Service     ;Boolean       ;CaptionML=[ENU=Show To Service;
                                                              FRA=Afficher sur service] }
    { 50022;  ;Show To Service Header;Boolean     ;CaptionML=[ENU=Show To Service Header;
                                                              FRA=Afficher sur ligne produit] }
    { 50023;  ;Show To Intervention;Boolean       ;CaptionML=[ENU=Show To Intervention;
                                                              FRA=Afficher sur intervention] }
    { 50024;  ;Show To Puchase Header;Boolean     ;CaptionML=[ENU=Show To Intervention;
                                                              FRA=Afficher sur entˆte achat] }
    { 50027;  ;Built Field Nb      ;Integer       ;CaptionML=[ENU=Built Field Code 5;
                                                              FRA=Nb champs construits] }
    { 50028;  ;Quote Formula Nb    ;Integer       ;OnValidate=VAR
                                                                lBuiltMergeFldDetail@1100281000 : Record 50141;
                                                              BEGIN
                                                                //<<IMH13.ISAT.EBA
                                                                IF "Quote Formula" <> '' THEN BEGIN
                                                                  MarketingSetup.GET;
                                                                  MarketingSetup.TESTFIELD("Quote Built Field Code");
                                                                  lBuiltMergeFldDetail.GET(MarketingSetup."Quote Built Field Code","Quote Formula");
                                                                END;
                                                                //>>IMH13.ISAT.EBA
                                                              END;

                                                   OnLookup=VAR
                                                              lBuiltMergeFldDetail@1100281001 : Record 50141;
                                                              lBuiltMergeFldDetailList@1100281000 : Form 50261;
                                                            BEGIN
                                                              //<<IMH13.ISAT.EBA
                                                              MarketingSetup.GET;
                                                              MarketingSetup.TESTFIELD("Quote Built Field Code");

                                                              lBuiltMergeFldDetail.FILTERGROUP(2);
                                                              lBuiltMergeFldDetail.SETRANGE("Built Merge Field Code",MarketingSetup."Quote Built Field Code");
                                                              lBuiltMergeFldDetail.FILTERGROUP(0);

                                                              lBuiltMergeFldDetailList.LOOKUPMODE(TRUE);
                                                              lBuiltMergeFldDetailList.SETTABLEVIEW(lBuiltMergeFldDetail);
                                                              IF lBuiltMergeFldDetailList.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                                                lBuiltMergeFldDetailList.GETRECORD(lBuiltMergeFldDetail);
                                                                "Quote Formula" := lBuiltMergeFldDetail."Sentence No.";
                                                              END;
                                                              //>>IMH13.ISAT.EBA
                                                            END;

                                                   CaptionML=[ENU=Quote Formula;
                                                              FRA=Nb champs de formule devis] }
    { 50029;  ;Location Formula Nb ;Integer       ;OnValidate=VAR
                                                                lBuiltMergeFldDetail@1100281000 : Record 50141;
                                                              BEGIN
                                                                //<<IMH13.ISAT.EBA
                                                                IF "Location Formula" <> '' THEN BEGIN
                                                                  MarketingSetup.GET;
                                                                  MarketingSetup.TESTFIELD("Location Built Field Code");
                                                                  lBuiltMergeFldDetail.GET(MarketingSetup."Location Built Field Code","Location Formula");
                                                                END;
                                                                //>>IMH13.ISAT.EBA
                                                              END;

                                                   OnLookup=VAR
                                                              lBuiltMergeFldDetail@1100281001 : Record 50141;
                                                              lBuiltMergeFldDetailList@1100281000 : Form 50261;
                                                            BEGIN
                                                              //<<IMH13.ISAT.EBA
                                                              MarketingSetup.GET;
                                                              MarketingSetup.TESTFIELD("Location Built Field Code");

                                                              lBuiltMergeFldDetail.FILTERGROUP(2);
                                                              lBuiltMergeFldDetail.SETRANGE("Built Merge Field Code",MarketingSetup."Location Built Field Code");
                                                              lBuiltMergeFldDetail.FILTERGROUP(0);

                                                              lBuiltMergeFldDetailList.LOOKUPMODE(TRUE);
                                                              lBuiltMergeFldDetailList.SETTABLEVIEW(lBuiltMergeFldDetail);
                                                              IF lBuiltMergeFldDetailList.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                                                lBuiltMergeFldDetailList.GETRECORD(lBuiltMergeFldDetail);
                                                                "Location Formula" := lBuiltMergeFldDetail."Sentence No.";
                                                              END;
                                                              //>>IMH13.ISAT.EBA
                                                            END;

                                                   CaptionML=[ENU=Location Formula;
                                                              FRA=Nb champs de formule lieu] }
    { 50030;  ;Quote Formula       ;Code10        ;OnValidate=VAR
                                                                lBuiltMergeFldDetail@1100281000 : Record 50141;
                                                              BEGIN
                                                                //<<IMH13.ISAT.EBA
                                                                IF "Quote Formula" <> '' THEN BEGIN
                                                                  MarketingSetup.GET;
                                                                  MarketingSetup.TESTFIELD("Quote Built Field Code");
                                                                  lBuiltMergeFldDetail.GET(MarketingSetup."Quote Built Field Code","Quote Formula");
                                                                END;
                                                                //>>IMH13.ISAT.EBA
                                                              END;

                                                   OnLookup=VAR
                                                              lBuiltMergeFldDetail@1100281001 : Record 50141;
                                                              lBuiltMergeFldDetailList@1100281000 : Form 50261;
                                                            BEGIN
                                                              //<<IMH13.ISAT.EBA
                                                              MarketingSetup.GET;
                                                              MarketingSetup.TESTFIELD("Quote Built Field Code");

                                                              lBuiltMergeFldDetail.FILTERGROUP(2);
                                                              lBuiltMergeFldDetail.SETRANGE("Built Merge Field Code",MarketingSetup."Quote Built Field Code");
                                                              lBuiltMergeFldDetail.FILTERGROUP(0);

                                                              lBuiltMergeFldDetailList.LOOKUPMODE(TRUE);
                                                              lBuiltMergeFldDetailList.SETTABLEVIEW(lBuiltMergeFldDetail);
                                                              IF lBuiltMergeFldDetailList.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                                                lBuiltMergeFldDetailList.GETRECORD(lBuiltMergeFldDetail);
                                                                "Quote Formula" := lBuiltMergeFldDetail."Sentence No.";
                                                              END;
                                                              //>>IMH13.ISAT.EBA
                                                            END;

                                                   CaptionML=[ENU=Quote Formula;
                                                              FRA=Formule devis] }
    { 50031;  ;Location Formula    ;Code10        ;OnValidate=VAR
                                                                lBuiltMergeFldDetail@1100281000 : Record 50141;
                                                              BEGIN
                                                                //<<IMH13.ISAT.EBA
                                                                IF "Location Formula" <> '' THEN BEGIN
                                                                  MarketingSetup.GET;
                                                                  MarketingSetup.TESTFIELD("Location Built Field Code");
                                                                  lBuiltMergeFldDetail.GET(MarketingSetup."Location Built Field Code","Location Formula");
                                                                END;
                                                                //>>IMH13.ISAT.EBA
                                                              END;

                                                   OnLookup=VAR
                                                              lBuiltMergeFldDetail@1100281001 : Record 50141;
                                                              lBuiltMergeFldDetailList@1100281000 : Form 50261;
                                                            BEGIN
                                                              //<<IMH13.ISAT.EBA
                                                              MarketingSetup.GET;
                                                              MarketingSetup.TESTFIELD("Location Built Field Code");

                                                              lBuiltMergeFldDetail.FILTERGROUP(2);
                                                              lBuiltMergeFldDetail.SETRANGE("Built Merge Field Code",MarketingSetup."Location Built Field Code");
                                                              lBuiltMergeFldDetail.FILTERGROUP(0);

                                                              lBuiltMergeFldDetailList.LOOKUPMODE(TRUE);
                                                              lBuiltMergeFldDetailList.SETTABLEVIEW(lBuiltMergeFldDetail);
                                                              IF lBuiltMergeFldDetailList.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                                                lBuiltMergeFldDetailList.GETRECORD(lBuiltMergeFldDetail);
                                                                "Location Formula" := lBuiltMergeFldDetail."Sentence No.";
                                                              END;
                                                              //>>IMH13.ISAT.EBA
                                                            END;

                                                   CaptionML=[ENU=Location Formula;
                                                              FRA=Formule lieu] }
    { 50032;  ;Built Field Code 1  ;Code10        ;TableRelation="Built Merge Field".Code;
                                                   CaptionML=[ENU=Built Field Code 1;
                                                              FRA=Code champ construit 1] }
    { 50033;  ;Built Field Code 2  ;Code10        ;TableRelation="Built Merge Field".Code;
                                                   CaptionML=[ENU=Built Field Code 2;
                                                              FRA=Code champ construit 2] }
    { 50034;  ;Built Field Code 3  ;Code10        ;TableRelation="Built Merge Field".Code;
                                                   CaptionML=[ENU=Built Field Code 3;
                                                              FRA=Code champ construit 3] }
    { 50035;  ;Built Field Code 4  ;Code10        ;TableRelation="Built Merge Field".Code;
                                                   CaptionML=[ENU=Built Field Code 4;
                                                              FRA=Code champ construit 4] }
    { 50036;  ;Built Field Code 5  ;Code10        ;TableRelation="Built Merge Field".Code;
                                                   CaptionML=[ENU=Built Field Code 5;
                                                              FRA=Code champ construit 5] }
    { 50037;  ;Built Field Code 6  ;Code10        ;TableRelation="Built Merge Field".Code;
                                                   CaptionML=[ENU=Built Field Code 5;
                                                              FRA=Code champ construit 6] }
    { 50038;  ;Built Field Code 7  ;Code10        ;TableRelation="Built Merge Field".Code;
                                                   CaptionML=[ENU=Built Field Code 5;
                                                              FRA=Code champ construit 7] }
    { 50039;  ;Built Field Code 8  ;Code10        ;TableRelation="Built Merge Field".Code;
                                                   CaptionML=[ENU=Built Field Code 5;
                                                              FRA=Code champ construit 8] }
    { 50040;  ;Built Field Code 9  ;Code10        ;TableRelation="Built Merge Field".Code;
                                                   CaptionML=[ENU=Built Field Code 5;
                                                              FRA=Code champ construit 9] }
    { 50041;  ;Built Field Code 10 ;Code10        ;TableRelation="Built Merge Field".Code;
                                                   CaptionML=[ENU=Built Field Code 5;
                                                              FRA=Code champ construit 10] }
    { 50050;  ;Checked             ;Boolean       ;CaptionML=[ENU=Checked;
                                                              FRA=V‚rifi‚];
                                                   Editable=No }
    { 50060;  ;Show To DGS         ;Boolean       ;InitValue=Yes;
                                                   OnValidate=BEGIN
                                                                VALIDATE("Showing Filter");
                                                              END;

                                                   CaptionML=[ENU=Show To Contact;
                                                              FRA=Afficher pour le DGS] }
    { 50061;  ;Show To DPR         ;Boolean       ;InitValue=Yes;
                                                   OnValidate=BEGIN
                                                                VALIDATE("Showing Filter");
                                                              END;

                                                   CaptionML=[ENU=Show To Service;
                                                              FRA=Afficher pour le DPR] }
    { 50062;  ;Show To DFC         ;Boolean       ;InitValue=Yes;
                                                   OnValidate=BEGIN
                                                                VALIDATE("Showing Filter");
                                                              END;

                                                   CaptionML=[ENU=Show To DFC;
                                                              FRA=Afficher pour le DFC] }
    { 50063;  ;Show To DQP         ;Boolean       ;OnValidate=BEGIN
                                                                VALIDATE("Showing Filter");//IMH20
                                                              END;

                                                   CaptionML=[ENU=Show To DQP;
                                                              FRA=Afficher pour le DQP] }
    { 50069;  ;Showing Filter      ;Code4         ;OnValidate=BEGIN
                                                                IF "Show To DGS" THEN
                                                                  "Showing Filter"[1] := '1'
                                                                ELSE
                                                                  "Showing Filter"[1] := '0';
                                                                IF "Show To DPR" THEN
                                                                  "Showing Filter"[2] := '1'
                                                                ELSE
                                                                  "Showing Filter"[2] := '0';
                                                                IF "Show To DFC" THEN
                                                                  "Showing Filter"[3] := '1'
                                                                ELSE
                                                                  "Showing Filter"[3] := '0';
                                                                //<<IMH20
                                                                IF "Show To DQP" THEN
                                                                  "Showing Filter"[4] := '1'
                                                                ELSE
                                                                  "Showing Filter"[4] := '0';
                                                                //>>IMH20
                                                              END;

                                                   CaptionML=[ENU=Showing Filter;
                                                              FRA=Filtre affichage] }
    { 50070;  ;Mail Object Auto    ;Boolean       ;CaptionML=[ENU=Mail Object Auto;
                                                              FRA=Objet mail auto] }
    { 50150;  ;Notify To Extranet  ;Boolean       ;CaptionML=[ENU=Notify To Extranet;
                                                              FRA=Notifier … l'extranet] }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
    {    ;Interaction Group Code                   }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;Code,Description                         }
  }
  CODE
  {
    VAR
      Text003@1003 : TextConst 'ENU="%1 = %2 can not be specified for %3 %4.\";FRA="%1 = %2 ne peut pas ˆtre d‚fini dans une %3 %4.\"';
      Text004@1004 : TextConst 'ENU=Do you want to create %1 %2?;FRA=Souhaitez-vous cr‚er le %1 %2 ?';
      MarketingSetup@1100281000 : Record 5079;

    PROCEDURE HasSalutation@1100281000() : Boolean;
    BEGIN
      CALCFIELDS("No. of Merge Fields", "Attachment No.");

      IF "No. of Merge Fields" = 0 THEN
        IF "Attachment No." <> 0 THEN
          EXIT(TRUE);
      EXIT(FALSE);
    END;

    PROCEDURE CheckAttachWrdFields@1100281001() : Boolean;
    VAR
      InteractTmplLanguage@1100281000 : Record 5103;
    BEGIN
      //IMH16
      IF InteractTmplLanguage.GET(Code,"Language Code (Default)") THEN BEGIN
        IF InteractTmplLanguage."Attachment No." <> 0 THEN
          EXIT(InteractTmplLanguage.CheckAttachWordFields);
      END;
      EXIT(TRUE);
    END;

    PROCEDURE CheckAttWrdFieldsWithModify@1100281002();
    BEGIN
      Checked := CheckAttachWrdFields();
      MODIFY(FALSE);
    END;

    BEGIN
    {
      /** @r IMH25 @d 14/10/13 @a ISAT.ST @v IMH6.01.353 @s Reorganisation region IMH @h 4760 @c Renommage CR / AR */
      /** @r IMH24 @d 16/10/13 @a ISAT.ACO @v IMH6.01.348 @s DARVA MATMUT Lot 1
          @c Ajout option "SMS" dans "correspondence type (default)"
          @c Ajout option "DARVA" dans "Correspondence type (default) */
      /** @r IMH23 @d 14/05/13 @a ISAT.ZW @v IMH6.01.345 @s MAI @h 4180 @c Gestion suppression interaction */
      /** @r IMH22 @d 04/03/13 @a ISAT.ZW @v IMH6.01.340 @s NEP IMH 4 @h 4340 @c Gestion Distinataire service : Expert / cabinet Expert */
      /** @r IMH21 @d 06/09/12 @a ISAT.ZW @v IMH6.01.226 @s version 1.4 @h 3444
          @c Ajout champ Destinataire Service en copie */
      /** @r IMH20 @d 16/05/12 @a ISAT.LLT @v IMH6.01.108 @s Interactions @h 3436
          @c Ajout champ Show to DQP */
      /** @r IMH19 @d 15/05/12 @a ISAT.ST @v IMH6.01.108 @s Interactions @h 2844 @c Ajout champ 50012 Ask For Attachment */
      /** @r IMH18 @d 08/10/11 @a ISAT.PC @v IMH6.01.165 @s Extranet @c Ajout champ 50150, Notify To Extranet */
      /** @r IMH17 @d 06/08/11 @a ISAT.ST @v IMH6.01.108 @s Interactions
          @c Ajout champ 50069 "SHowing Filter" pour accŠs filtr‚ sur les interactions */
      /** @r IMH16 @d 08/07/10 @a ISAT.ZW @v IMH6.01.108 @s Interactions @c AJout fonction CheckAttachWrdFields */
      /** @r IMH15 @d 08/07/11 @a ISAT.ZW @v IMH6.01.108 @s Interactions
          @c Ajout champ 50050 Checked */
      /** @r IMH14 @d 11/04/11 @a ISAT.ZW @v IMH6.01.108 @s Interactions
          @c Supprimer Information Flow du field groups  */
      /** @r IMH13 @d 13/04/11 @a ISAT.EBA @v IMH6.01.108 @s Publipostage - Devis et Lieux
          @c Ajout de champs: "Quote Formula", "Location Formula" */
      /** @r IMH12 @d 13/04/11 @a ISAT.EBA @v IMH6.01.108 @s Publipostage - Champ de fusion construit
          @c Ajout de champs :"Built Field Code 1","Built Field Code 2","Built Field Code 3","Built Field Code 4","Built Field Code 5" */
      /** @r IMH11 @d 24/03/11 @a ISAT.ZW @v IMH6.01.108 @s Interactions
          @c Ajout du Option Contact d‚claraion */
      /** @r IMH10 @d 08/03/11 @a ISAT.LLT @v IMH6.01.108 @s Interactions
          @c Ajout du champ 50006 Send To Admin. Contact */
      /** @r IMH09 @d 28/02/11 @a ISAT.ZW @v IMH6.01.108 @s Interactions
          @c Ajout champ gestion affichage 50020-50023 Affiche sur COntact/service/Ligne produit/intervention */
      /** @r IMH08 @d 16/02/11 @a ISAT.ZW @v IMH6.01.108 @s Interactions @c No Campagne --> Nø ‚vŠnement exceptionnel */
      /** @r IMH07 @d 08/02/11 @a ISAT.ZW @v IMH6.01.108 @s Interactions @c Aout champ 50010 50011 */
      /** @r IMH06 @d 25/01/11 @a ISAT.ST @v IMH6.01.108 @s Interactions @c Ajout fonction HasSalutation */
      /** @r IMH05 @d 25/01/11 @a ISAT.LLT @v IMH6.01.108 @s Interactions @c Renommage champ Correspondance Type */
      /** @r IMH04 @d 05/01/11 @a ISAT.ST @v IMH6.01.108 @s Interactions
          @c Ajout champ 50004 Default Interaction Descr. */
      /** @r IMH03 @d 03/01/11 @a ISAT.LLT @v IMH6.01.108 @s Interactions
          @c Ajout champ 50000 No. of Merge Fields
          @c Ajout champ 50001 Mail Attachment
          @c Ajout champ 50002 Mail Attachment Name
          @c Ajout champ 50003 Automatic Send Mail */
      /** @r IMH02 @d 20/12/10 @a ISAT.LLT @v IMH6.01.108 @s Interactions @c Ajout fonction copie de modŠle */
      /** @r IMH01 @d 15/12/10 @a ISAT.LLT @v IMH6.01.108 @s Interactions @c Suppression de Interaction Template Fields */
    }
    END.
  }
}