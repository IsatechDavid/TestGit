OBJECT Table 5900 Service Header
{
  OBJECT-PROPERTIES
  {
    Date=27/05/14;
    Time=14:46:21;
    Modified=Yes;
    Version List=NAVW16.00.01,IMH6.01,OPTIM,5005,IMH6.01.P010;
  }
  PROPERTIES
  {
    Permissions=TableData 5914=d,
                TableData 5950=rimd,
                TableData 50000=rimd,
                TableData 8016709=rimd,
                TableData 8016710=rimd,
                TableData 8016711=rimd,
                TableData 8016712=rimd;
    DataCaptionFields=No.,Name,Description;
    OnInsert=VAR
               ServShptHeader@1001 : Record 5990;
               lCorporateContract@1100281000 : Record 50057;
               lSalesInvoicingMgt@1100281001 : Codeunit 50079;
               lInterfaceReference@1100281002 : Record 50164;
               lCampaign@1100281003 : Record 5071;
             BEGIN
               //<<IMH02
               IF IsServiceDoc THEN
                 TESTFIELD("Service Order Type");
               VALIDATE("Service Order Type");
               //>>IMH02
               //<<IMH10
               //<<IMH07
               //IF ("Service No." <> '') AND ("Service Order Type" <> '') THEN
                 //"No." := "Service No." + "Service Order Type";
                 IF "No." = '' THEN
                     "No." := GetNextServiceHeaderNo;
               //>>IMH07
               //>>IMH10
               ServSetup.GET;
               IF "No." = '' THEN BEGIN
                 TestNoSeries;
                 NoSeriesMgt.InitSeries(GetNoSeriesCode,xRec."No. Series",0D,"No.","No. Series");
               END;
               //<<IMH17
               TESTFIELD("No.");
               TESTFIELD("Service No.");
               //>>IMH17

               IF NOT IsServiceDoc THEN BEGIN //IMH04.ST
                 ServShptHeader.SETCURRENTKEY("Order No.");
                 ServShptHeader.SETRANGE("Order No.","No.");
               IF ServShptHeader.FINDSET THEN
                 ERROR(Text008,FORMAT(Rec."Document Type"),FIELDCAPTION("No."),"No.");
               END; //IMH04.ST
               InitRecord;

               IF NOT IsServiceDoc THEN BEGIN //IMH04.ST
               CLEAR(ServLogMgt);
               ServLogMgt.ServHeaderCreate(Rec);
               END;

               //<<IMH02
               {
               IF GETFILTER("Customer No.") <> '' THEN
                 IF GETRANGEMIN("Customer No.") = GETRANGEMAX("Customer No.") THEN
                   VALIDATE("Customer No.",GETRANGEMIN("Customer No."));
               }
               //>>IMH02
               IF GETFILTER("Contact No.") <> '' THEN
                 IF GETRANGEMIN("Contact No.") = GETRANGEMAX("Contact No.") THEN
                   VALIDATE("Contact No.",GETRANGEMIN("Contact No."));

               DimMgt.InsertDocDim(
                 DATABASE::"Service Header","Document Type","No.",0,
                 "Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
               InitDiagElementTable;//IMH05
               InitAcommOptionTable;//IMH10
               InitServiceHeaderCosting;//IMH34
               //<<IMH06.ST
               IF "Main Speciality" <> '' THEN
                 VALIDATE("Main Speciality");
               //>>IMH06.ST
               TouchRecord(TRUE); //IMH04.ST

               CalcDepositAmount;


               ServLog.LogServHeader(Rec, 0); //IMH62.ST
               //<<IMH118.PC
               //IF lInterfaceReference.GetServiceHeaderGUID(Rec) = '' THEN
               //  FUSIONInterfaceMgt.CreateSendMQByServiceHeader(Rec, 0); //IMH27
               //>>IMH118.PC

               //<<IMH51.isat.PC
               //lSalesInvoicingMgt.CreateSalesOrderFromService(Rec);
               //>>IMH51.isat.PC
               //<<IMH104.isat.NFO
               lCampaign.UpdateServiceHeaderRelatTables(Rec);
               //>>IMH104.isat.NFO
             END;

    OnModify=VAR
               lInterfaceReference@1100281000 : Record 50164;
               lCampaign@1100281001 : Record 5071;
               lServiceInterLine@1000000000 : Record 50075;
             BEGIN
               IF NOT IsServiceDoc THEN //IMH04.ST
                 UpdateServiceOrderChangeLog(xRec);
               OnModify(xRec);//IMH10
               TouchRecord(FALSE); //IMH04.ST
               //<<IMH120                           lServiceInterLine."Other Phone No. Type"
               //AutoStep;
               IF NOT SkipAutoStep THEN
                 AutoStep;
               //>>IMH120

               ServLog.LogServHeader(Rec, 1); //IMH62.ST

               //IF lInterfaceReference.GetServiceHeaderGUID(Rec) <> '' THEN
               //<<IMH118.PC
               //IF "No." <> '' THEN
               //  FUSIONInterfaceMgt.CreateSendMQByServiceHeader(Rec, 1); //IMH27
               //>>IMH118.PC

               //UpdateFromServiceQuoteExcep; //IMH54
               //<<IMH104.isat.NFO
               lCampaign.UpdateServiceHeaderRelatTables(Rec);
               //>>IMH104.isat.NFO

               //<<IMH126
               lServiceInterLine.SETRANGE("Service Header No.", "No.");
               IF lServiceInterLine.FINDSET THEN BEGIN
                 lServiceInterLine.MODIFYALL("Other Phone No. Type", "Other Phone No. Type");
                 lServiceInterLine.MODIFYALL("Other Phone No.", "Other Phone No.");
               END
               //>>IMH126
             END;

    OnDelete=VAR
               ServDocRegister@1000 : Record 5936;
               ServDocLog@1001 : Record 5912;
               lServiceHeaderClaim@1100281012 : Record 50100;
               lServiceHeaderCosting@1100281013 : Record 50101;
               lServiceHeaderVoucher@1100281014 : Record 50103;
               ServAllocMgt@1002 : Codeunit 5930;
               lServiceHeaderAddress@1100281000 : Record 50068;
               lServiceInterventionLine@1100281001 : Record 50075;
               lServiceHeaderAmount@1100281002 : Record 50069;
               lServiceHeaderCause@1100281003 : Record 50070;
               lServiceAccommOption@1100281004 : Record 50073;
               lServiceDiagnosisElement@1100281005 : Record 50074;
               lServiceHeaderDevice@1100281006 : Record 50072;
               lServCode@1100281007 : Record 50040;
               lAdvCommentLine@1100281008 : Record 50056;
               lDocAttach@1100281010 : Record 50021;
               lTrayLine@1100281011 : Record 50048;
               lProcMgt@1100281009 : Codeunit 50040;
             BEGIN
               IF NOT UserMgt.CheckRespCenter(2,"Responsibility Center") THEN
                 ERROR(
                   Text000,
                   RespCenter.TABLECAPTION,UserMgt.GetServiceFilter);

               IF "Document Type" = "Document Type"::Invoice THEN BEGIN
                 ServLine.RESET;
                 ServLine.SETRANGE("Document Type",ServLine."Document Type"::Invoice);
                 ServLine.SETRANGE("Document No.","No.");
                 ServLine.SETFILTER("Appl.-to Service Entry",'>%1',0);
                 IF NOT ServLine.ISEMPTY THEN
                   ERROR(Text046,"No.");
               END;

               ServPost.DeleteHeader(
                 Rec,ServShptHeader,ServInvHeader,ServCrMemoHeader);
               //<<IMH138
               {
               IF "Applies-to ID" <> '' THEN //IMH28.ST
               VALIDATE("Applies-to ID",'');
               }
               //>>IMH138

               DimMgt.DeleteDocDim(DATABASE::"Service Header","Document Type","No.",0);

               ServLine.RESET;
               ServLine.LOCKTABLE;

               HandleItemTrackingDeletion;

               ServLine.SETRANGE("Document Type","Document Type");
               ServLine.SETRANGE("Document No.","No.");
               IF NOT ServLine.ISEMPTY THEN //IMH04.ST
               ServLine.DELETEALL(TRUE);
               //<<IMH25
               lAdvCommentLine.SETRANGE("Source Table ID",DATABASE::"Service Header");
               lAdvCommentLine.SETRANGE("Source No.","Service No.");
               lAdvCommentLine.SETRANGE("Source No. 2","No.");
               IF NOT lAdvCommentLine.ISEMPTY THEN
                 lAdvCommentLine.DELETEALL;

               lTrayLine.SETCURRENTKEY("Service No.","Service Header No.","Intervention Line No.");
               lTrayLine.SETRANGE("Service No.","Service No.");
               lTrayLine.SETRANGE("Service Header No.","No.");
               lTrayLine.SETRANGE("Source Table No.",DATABASE::"Service Header");
               IF NOT lTrayLine.ISEMPTY THEN
                 lTrayLine.DELETEALL;
               //>>IMH25

               ServCommentLine.RESET;
               ServCommentLine.SETRANGE("Table Name",ServCommentLine."Table Name"::"Service Header");
               ServCommentLine.SETRANGE("Table Subtype","Document Type");
               ServCommentLine.SETRANGE("No.","No.");
               IF NOT ServCommentLine.ISEMPTY THEN //IMH04.ST
               ServCommentLine.DELETEALL;

               ServLog.LogServHeader(Rec, 2); //IMH62.ST

               ServDocRegister.SETCURRENTKEY("Destination Document Type","Destination Document No.");
               CASE "Document Type" OF
                 "Document Type"::Invoice:
                   BEGIN
                     ServDocRegister.SETRANGE("Destination Document Type",ServDocRegister."Destination Document Type"::Invoice);
                     ServDocRegister.SETRANGE("Destination Document No.","No.");
                     IF NOT ServDocRegister.ISEMPTY THEN //IMH04.ST
                     ServDocRegister.DELETEALL;
                   END;
                 "Document Type"::"Credit Memo":
                   BEGIN
                     ServDocRegister.SETRANGE("Destination Document Type",ServDocRegister."Destination Document Type"::"Credit Memo");
                     ServDocRegister.SETRANGE("Destination Document No.","No.");
                     IF NOT ServDocRegister.ISEMPTY THEN //IMH04.ST
                     ServDocRegister.DELETEALL;
                   END;
               END;

               IF (ServShptHeader."No." <> '') OR
                  (ServInvHeader."No." <> '') OR
                  (ServCrMemoHeader."No." <> '')
               THEN BEGIN
                 DELETE;
                 COMMIT;

                 IF ServShptHeader."No." <> '' THEN
                   IF CONFIRM(Text048,TRUE,ServShptHeader."No.") THEN BEGIN
                     ServShptHeader.SETRECFILTER;
                     ServShptHeader.PrintRecords(TRUE);
                   END;

                 IF ServInvHeader."No." <> '' THEN
                   IF CONFIRM(Text049,TRUE,ServInvHeader."No.") THEN BEGIN
                     ServInvHeader.SETRECFILTER;
                     ServInvHeader.PrintRecords(TRUE);
                   END;

                 IF ServCrMemoHeader."No." <> '' THEN
                   IF CONFIRM(Text002,TRUE,ServCrMemoHeader."No.") THEN BEGIN
                     ServCrMemoHeader.SETRECFILTER;
                     ServCrMemoHeader.PrintRecords(TRUE);
                   END;
               END;

               ServOrderAlloc.RESET;
               ServOrderAlloc.SETCURRENTKEY("Document Type");
               ServOrderAlloc.SETRANGE("Document Type","Document Type");
               ServOrderAlloc.SETRANGE("Document No.","No.");
               ServOrderAlloc.SETRANGE(Posted,FALSE);
               IF NOT ServOrderAlloc.ISEMPTY THEN //IMH04.ST
               ServOrderAlloc.DELETEALL;
               ServAllocMgt.SetServOrderAllocStatus(Rec);

               ServItemLine.RESET;
               ServItemLine.SETRANGE("Document Type","Document Type");
               ServItemLine.SETRANGE("Document No.","No.");
               IF ServItemLine.FIND('-') THEN
                 REPEAT
                   IF ServItemLine."Loaner No." <> '' THEN BEGIN
                     Loaner.GET(ServItemLine."Loaner No.");
                     LoanerEntry.RESET;
                     LoanerEntry.SETCURRENTKEY("Document Type", "Document No.","Loaner No.",Lent);
                     LoanerEntry.SETRANGE("Document Type","Document Type" + 1);
                     LoanerEntry.SETRANGE("Document No.","No.");
                     LoanerEntry.SETRANGE("Loaner No.",ServItemLine."Loaner No.");
                     LoanerEntry.SETRANGE(Lent,TRUE);
                     IF LoanerEntry.FIND('-') THEN BEGIN
                       ERROR(
                         Text040,
                         TABLECAPTION,
                         ServItemLine."Document No.",
                         ServItemLine."Line No.",
                         ServItemLine.FIELDCAPTION("Loaner No."),
                         ServItemLine."Loaner No.")
                     END ELSE BEGIN
                       LoanerEntry.SETRANGE(Lent,TRUE);
                       LoanerEntry.DELETEALL;
                     END
                   END;
                   IF NOT IsServiceDoc THEN BEGIN //IMH04.ST
                   CLEAR(ServLogMgt);
                   ServLogMgt.ServItemOffServOrder(ServItemLine);
                   ServItemLine.DELETE;
                   END; //IMH04.ST
                 UNTIL ServItemLine.NEXT = 0;

               ServDocLog.RESET;
               ServDocLog.SETRANGE("Document Type","Document Type");
               ServDocLog.SETRANGE("Document No.","No.");
               IF NOT ServDocLog.ISEMPTY THEN //IMH04.ST
               ServDocLog.DELETEALL;

               ServDocLog.RESET;
               ServDocLog.SETRANGE(Before,"No.");
               ServDocLog.SETFILTER("Document Type",'%1|%2|%3',
                 ServDocLog."Document Type"::Shipment,ServDocLog."Document Type"::"Posted Invoice",
                 ServDocLog."Document Type"::"Posted Credit Memo");
               IF NOT ServDocLog.ISEMPTY THEN //IMH04.ST
               ServDocLog.DELETEALL;

               lProcMgt.DeleteSourceRec(DATABASE::"Service Header", "No.", '', 0, 0); //IMH26.ST

               //<<IMH02
               IF "Document Type" <> "Document Type"::Invoice THEN
                 EXIT;
               lServiceHeaderAddress.SETRANGE("Service Header No.","No.");
               IF NOT lServiceHeaderAddress.ISEMPTY THEN
                 lServiceHeaderAddress.DELETEALL(TRUE);
               lServiceInterventionLine.SETRANGE("Service Header No.","No.");
               IF NOT lServiceInterventionLine.ISEMPTY THEN
                 lServiceInterventionLine.DELETEALL(TRUE);
               lServiceHeaderAmount.SETRANGE("Service Header No.","No.");
               IF NOT lServiceHeaderAmount.ISEMPTY THEN
                 lServiceHeaderAmount.DELETEALL(TRUE);
               lServiceHeaderCause.SETRANGE("Service Header No.","No.");
               IF NOT lServiceHeaderCause.ISEMPTY THEN
                 lServiceHeaderCause.DELETEALL(TRUE);
               lServiceAccommOption.SETRANGE("Service Header No.","No.");
               IF NOT lServiceAccommOption.ISEMPTY THEN
                 lServiceAccommOption.DELETEALL(TRUE);
               lServiceDiagnosisElement.SETRANGE("Service Header No.","No.");
               IF NOT lServiceDiagnosisElement.ISEMPTY THEN
                 lServiceDiagnosisElement.DELETEALL(TRUE);
               lServiceHeaderDevice.SETRANGE("Service Header No.","No.");
               IF NOT lServiceHeaderDevice.ISEMPTY THEN
                 lServiceHeaderDevice.DELETEALL(TRUE);
               //>>IMH02
               //<<IMH06.ST
               lServCode.SETRANGE("Service Type", lServCode."Service Type"::ServiceHeader);
               lServCode.SETRANGE("Service Header No.", "No.");
               IF NOT lServCode.ISEMPTY THEN
                 lServCode.DELETEALL(FALSE);
               //>>IMH06.ST


               //<<IMH27
               lDocAttach.SETRANGE("Referent Table No.",DATABASE::"Service Header");
               //<<IMH122.PC
               lDocAttach.SETRANGE("Key Integer 1","Document Type");
               lDocAttach.SETRANGE("Key Integer 2",0);
               //>>IMH122.PC
               lDocAttach.SETRANGE("Key Code 1","No.");
               IF NOT lDocAttach.ISEMPTY THEN
                 lDocAttach.DELETEALL;
               //>>IMH27

               //<<IMH34
               lServiceHeaderClaim.SETRANGE("Service Header No.","No.");
               IF NOT lServiceHeaderClaim.ISEMPTY THEN
                 lServiceHeaderClaim.DELETEALL;

               lServiceHeaderCosting.SETRANGE("Service Header No.","No.");
               IF NOT lServiceHeaderCosting.ISEMPTY THEN
                 lServiceHeaderCosting.DELETEALL;

               lServiceHeaderVoucher.SETRANGE("Service Header No.","No.");
               IF NOT lServiceHeaderVoucher.ISEMPTY THEN
                 lServiceHeaderVoucher.DELETEALL;
               //>>IMH34
             END;

    OnRename=BEGIN
               ERROR(Text044,TABLECAPTION);
             END;

    CaptionML=[ENU=Service Header;
               FRA=Ligne produit service];
    LookupFormID=Form50075;
    DrillDownFormID=Form50075;
  }
  FIELDS
  {
    { 1   ;   ;Document Type       ;Option        ;CaptionML=[ENU=Document Type;
                                                              FRA=Type document];
                                                   OptionCaptionML=[ENU=Quote,Order,Invoice,Credit Memo;
                                                                    FRA=Devis,Commande,Facture,Avoir];
                                                   OptionString=Quote,Order,Invoice,Credit Memo }
    { 2   ;   ;Customer No.        ;Code20        ;TableRelation=Customer;
                                                   OnValidate=BEGIN
                                                                IF ("Customer No." <> xRec."Customer No.") AND (xRec."Customer No." <> '') THEN BEGIN
                                                                  IF "Contract No." <> '' THEN
                                                                    ERROR(
                                                                      Text003,
                                                                      FIELDCAPTION("Customer No."),
                                                                      "Document Type",FIELDCAPTION("No."),"No.",
                                                                      FIELDCAPTION("Contract No."),"Contract No.");
                                                                  IF HideValidationDialog OR NOT GUIALLOWED THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    IF ServItemLineExists THEN
                                                                      Confirmed :=
                                                                        CONFIRM(
                                                                          Text004 + Text005,
                                                                          FALSE,FIELDCAPTION("Customer No."),
                                                                          ServItemLine.TABLECAPTION,ServLine.TABLECAPTION)
                                                                    ELSE
                                                                      IF ServLineExists THEN
                                                                        Confirmed :=
                                                                          CONFIRM(
                                                                            Text057 + Text005,
                                                                            FALSE,FIELDCAPTION("Customer No."),
                                                                            ServLine.TABLECAPTION)
                                                                      ELSE
                                                                        Confirmed := CONFIRM(Text005,FALSE,FIELDCAPTION("Customer No."));
                                                                  IF Confirmed THEN BEGIN
                                                                    ServLine.SETRANGE("Document Type","Document Type");
                                                                    ServLine.SETRANGE("Document No.","No.");
                                                                    IF "Document Type" = "Document Type"::Order THEN
                                                                      ServLine.SETFILTER("Quantity Shipped",'<>0')
                                                                    ELSE
                                                                      IF "Document Type" = "Document Type"::Invoice THEN BEGIN
                                                                        ServLine.SETRANGE("Customer No.",xRec."Customer No.");
                                                                        ServLine.SETFILTER("Shipment No.",'<>%1','');
                                                                      END;

                                                                    IF ServLine.FINDFIRST THEN BEGIN
                                                                      IF "Document Type" = "Document Type"::Order THEN
                                                                        ServLine.TESTFIELD("Quantity Shipped",0)
                                                                      ELSE
                                                                        ServLine.TESTFIELD("Shipment No.",'');
                                                                    END;
                                                                    MODIFY(TRUE);

                                                                    ServLine.LOCKTABLE;
                                                                    ServLine.RESET;
                                                                    ServLine.SETRANGE("Document Type","Document Type");
                                                                    ServLine.SETRANGE("Document No.","No.");
                                                                    ServLine.DELETEALL(TRUE);

                                                                    ServItemLine.LOCKTABLE;
                                                                    ServItemLine.RESET;
                                                                    ServItemLine.SETRANGE("Document Type","Document Type");
                                                                    ServItemLine.SETRANGE("Document No.","No.");
                                                                    ServItemLine.DELETEALL(TRUE);

                                                                    GET("Document Type","No.");
                                                                    IF "Customer No." = '' THEN BEGIN
                                                                      INIT;
                                                                      ServSetup.GET;
                                                                      "No. Series" := xRec."No. Series";
                                                                      "Service Order Type" := xRec."Service Order Type"; //IMH04.ST
                                                                      InitRecord;
                                                                      IF xRec."Shipping No." <> '' THEN BEGIN
                                                                        "Shipping No. Series" := xRec."Shipping No. Series";
                                                                        "Shipping No." := xRec."Shipping No.";
                                                                      END;
                                                                      IF xRec."Posting No." <> '' THEN BEGIN
                                                                        "Posting No. Series" := xRec."Posting No. Series";
                                                                        "Posting No." := xRec."Posting No.";
                                                                      END;
                                                                      EXIT;
                                                                    END;
                                                                  END ELSE BEGIN
                                                                    Rec := xRec;
                                                                    EXIT;
                                                                  END;
                                                                END;

                                                                GetCust("Customer No.");
                                                                IF "Customer No." <> '' THEN BEGIN
                                                                  Cust.CheckBlockedCustOnDocs(Cust,"Document Type",FALSE,FALSE);
                                                                  Cust.TESTFIELD("Gen. Bus. Posting Group");
                                                                  Name := Cust.Name;
                                                                  "Name 2" := Cust."Name 2";
                                                                  Address := Cust.Address;
                                                                  "Address 2" := Cust."Address 2";

                                                                  City := Cust.City;
                                                                  "Post Code" := Cust."Post Code";
                                                                  County := Cust.County;
                                                                  "Country/Region Code" := Cust."Country/Region Code";
                                                                  IF NOT SkipContact THEN BEGIN
                                                                    "Contact Name" := Cust.Contact;
                                                                    "Phone No." := Cust."Phone No.";
                                                                    "E-Mail" := Cust."E-Mail";
                                                                  END;
                                                                  "Gen. Bus. Posting Group" := Cust."Gen. Bus. Posting Group";
                                                                  "VAT Bus. Posting Group" := Cust."VAT Bus. Posting Group";
                                                                  "Tax Area Code" := Cust."Tax Area Code";
                                                                  "Tax Liable" := Cust."Tax Liable";
                                                                  "VAT Registration No." := Cust."VAT Registration No.";
                                                                  "Shipping Advice" := Cust."Shipping Advice";
                                                                  "Responsibility Center" := UserMgt.GetRespCenter(2,Cust."Responsibility Center");
                                                                  VALIDATE("Location Code",UserMgt.GetLocation(2,Cust."Location Code","Responsibility Center"));
                                                                END;

                                                                IF "Customer No." = xRec."Customer No." THEN BEGIN
                                                                  IF ShippedServLinesExist THEN BEGIN
                                                                    TESTFIELD("VAT Bus. Posting Group",xRec."VAT Bus. Posting Group");
                                                                    TESTFIELD("Gen. Bus. Posting Group",xRec."Gen. Bus. Posting Group");
                                                                  END;
                                                                END;

                                                                COMMIT;
                                                                IF Cust."Bill-to Customer No." <> '' THEN
                                                                  VALIDATE("Bill-to Customer No.",Cust."Bill-to Customer No.")
                                                                ELSE BEGIN
                                                                  IF "Bill-to Customer No." = "Customer No." THEN
                                                                    SkipBillToContact := TRUE;
                                                                  VALIDATE("Bill-to Customer No.","Customer No.");
                                                                  SkipBillToContact := FALSE;
                                                                END;

                                                                VALIDATE("Ship-to Code",'');
                                                                VALIDATE("Service Zone Code");

                                                                IF NOT SkipContact THEN
                                                                  UpdateCont("Customer No.");
                                                              END;

                                                   CaptionML=[ENU=Customer No.;
                                                              FRA=Nø client];
                                                   Editable=No }
    { 3   ;   ;No.                 ;Code20        ;OnValidate=BEGIN
                                                                IF "No." <> xRec."No." THEN BEGIN
                                                                  ServSetup.GET;
                                                                  TestNoSeriesManual;
                                                                  "No. Series" := '';
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=No.;
                                                              FRA=Nø ligne produit];
                                                   Editable=No }
    { 4   ;   ;Bill-to Customer No.;Code20        ;TableRelation=Customer;
                                                   OnValidate=BEGIN
                                                                IF (xRec."Bill-to Customer No." <> "Bill-to Customer No.") AND
                                                                   (xRec."Bill-to Customer No." <> '')
                                                                THEN BEGIN
                                                                  IF HideValidationDialog OR NOT GUIALLOWED THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed := CONFIRM(Text005,FALSE,FIELDCAPTION("Bill-to Customer No."));
                                                                  IF Confirmed THEN BEGIN
                                                                    ServLine.SETRANGE("Document Type","Document Type");
                                                                    ServLine.SETRANGE("Document No.","No.");
                                                                    IF "Document Type" = "Document Type"::Order THEN
                                                                      ServLine.SETFILTER("Quantity Shipped",'<>0')
                                                                    ELSE
                                                                      IF "Document Type" = "Document Type"::Invoice THEN
                                                                        ServLine.SETFILTER("Shipment No.",'<>%1','');

                                                                    IF ServLine.FINDFIRST THEN
                                                                      IF "Document Type" = "Document Type"::Order THEN
                                                                        ServLine.TESTFIELD("Quantity Shipped",0)
                                                                      ELSE
                                                                        ServLine.TESTFIELD("Shipment No.",'');
                                                                    ServLine.RESET
                                                                  END ELSE BEGIN
                                                                    "Bill-to Customer No." := xRec."Bill-to Customer No.";
                                                                    IF "Customer Posting Group" <> '' THEN
                                                                      EXIT;
                                                                  END;
                                                                END;

                                                                GetCust("Bill-to Customer No.");
                                                                Cust.CheckBlockedCustOnDocs(Cust,"Document Type",FALSE,FALSE);
                                                                Cust.TESTFIELD("Customer Posting Group");

                                                                IF GUIALLOWED AND NOT HideValidationDialog AND
                                                                   ("Document Type" IN ["Document Type"::Quote,"Document Type"::Order,"Document Type"::Invoice])
                                                                THEN
                                                                  CustCheckCreditLimit.ServiceHeaderCheck(Rec);

                                                                "Bill-to Name" := Cust.Name;
                                                                "Bill-to Name 2" := Cust."Name 2";
                                                                "Bill-to Address" := Cust.Address;
                                                                "Bill-to Address 2" := Cust."Address 2";
                                                                "Bill-to City" := Cust.City;
                                                                "Bill-to Post Code" := Cust."Post Code";
                                                                "Bill-to County" := Cust.County;
                                                                "Bill-to Country/Region Code" := Cust."Country/Region Code";
                                                                IF NOT SkipBillToContact THEN
                                                                  "Bill-to Contact" := Cust.Contact;
                                                                "Payment Terms Code" := Cust."Payment Terms Code";

                                                                IF "Document Type" = "Document Type"::"Credit Memo" THEN BEGIN
                                                                  "Payment Method Code" := '';
                                                                  IF PaymentTerms.GET("Payment Terms Code") THEN
                                                                    IF PaymentTerms."Calc. Pmt. Disc. on Cr. Memos" THEN
                                                                      "Payment Method Code" := Cust."Payment Method Code"
                                                                END ELSE
                                                                  "Payment Method Code" := Cust."Payment Method Code";

                                                                "Gen. Bus. Posting Group" := Cust."Gen. Bus. Posting Group";
                                                                GLSetup.GET;
                                                                IF GLSetup."Bill-to/Sell-to VAT Calc." = GLSetup."Bill-to/Sell-to VAT Calc."::"Bill-to/Pay-to No." THEN
                                                                  "VAT Bus. Posting Group" := Cust."VAT Bus. Posting Group";
                                                                "Customer Posting Group" := Cust."Customer Posting Group";
                                                                "Currency Code" := Cust."Currency Code";
                                                                "Customer Price Group" := Cust."Customer Price Group";
                                                                "Prices Including VAT" := Cust."Prices Including VAT";
                                                                "Allow Line Disc." := Cust."Allow Line Disc.";
                                                                //"Invoice Disc. Code" := Cust."Invoice Disc. Code";  //IMH138
                                                                "Customer Disc. Group" := Cust."Customer Disc. Group";
                                                                "Language Code" := Cust."Language Code";
                                                                "Salesperson Code" := Cust."Salesperson Code";
                                                                Reserve := Cust.Reserve;
                                                                "VAT Registration No." := Cust."VAT Registration No.";
                                                                ValidateServPriceGrOnServItem;

                                                                IF "Bill-to Customer No." = xRec."Bill-to Customer No." THEN BEGIN
                                                                  IF ShippedServLinesExist THEN BEGIN
                                                                    TESTFIELD("Customer Disc. Group",xRec."Customer Disc. Group");
                                                                    TESTFIELD("Currency Code",xRec."Currency Code");
                                                                  END;
                                                                END;

                                                                CreateDim(
                                                                  DATABASE::"Service Order Type","Service Order Type",
                                                                  DATABASE::Customer,"Bill-to Customer No.",
                                                                  DATABASE::"Salesperson/Purchaser","Salesperson Code",
                                                                  DATABASE::"Responsibility Center","Responsibility Center",
                                                                  DATABASE::"Service Contract Header","Contract No.");

                                                                VALIDATE("Payment Terms Code");
                                                                VALIDATE("Payment Method Code");
                                                                VALIDATE("Currency Code");

                                                                IF (xRec."Customer No." = "Customer No.") AND
                                                                   (xRec."Bill-to Customer No." <> "Bill-to Customer No.")
                                                                THEN
                                                                  RecreateServLines(FIELDCAPTION("Bill-to Customer No."));

                                                                IF NOT SkipBillToContact THEN
                                                                  UpdateBillToCont("Bill-to Customer No.");
                                                              END;

                                                   CaptionML=[ENU=Bill-to Customer No.;
                                                              FRA=Nø client factur‚];
                                                   NotBlank=Yes;
                                                   Editable=No }
    { 5   ;   ;Bill-to Name        ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer.Name WHERE (No.=FIELD(Bill-to Customer No.)));
                                                   CaptionML=[ENU=Bill-to Name;
                                                              FRA=Nom client factur‚];
                                                   Editable=No }
    { 6   ;   ;Bill-to Name 2      ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer."Name 2" WHERE (No.=FIELD(Bill-to Customer No.)));
                                                   CaptionML=[ENU=Bill-to Name 2;
                                                              FRA=Nom client factur‚ 2];
                                                   Editable=No }
    { 7   ;   ;Bill-to Address     ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer.Address WHERE (No.=FIELD(Bill-to Customer No.)));
                                                   CaptionML=[ENU=Bill-to Address;
                                                              FRA=Adresse facturation];
                                                   Editable=No }
    { 8   ;   ;Bill-to Address 2   ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer."Address 2" WHERE (No.=FIELD(Bill-to Customer No.)));
                                                   CaptionML=[ENU=Bill-to Address 2;
                                                              FRA=Adresse facturation 2];
                                                   Editable=No }
    { 9   ;   ;Bill-to City        ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer.City WHERE (No.=FIELD(Bill-to Customer No.)));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity("Bill-to City","Bill-to Post Code", "Bill-to Country/Region Code"); //IMH29 Ajout Code pays
                                                              END;

                                                   OnLookup=BEGIN
                                                              PostCode.LookUpCity("Bill-to City","Bill-to Post Code", "Bill-to Country/Region Code", TRUE); //IMH29 Ajout Code pays
                                                            END;

                                                   CaptionML=[ENU=Bill-to City;
                                                              FRA=Ville facturation];
                                                   Editable=No }
    { 10  ;   ;Bill-to Contact     ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer.Contact WHERE (No.=FIELD(Bill-to Customer No.)));
                                                   CaptionML=[ENU=Bill-to Contact;
                                                              FRA=Contact facturation];
                                                   Editable=No }
    { 11  ;   ;Your Reference      ;Text30        ;CaptionML=[ENU=Your Reference;
                                                              FRA=Votre r‚f‚rence] }
    { 12  ;   ;Ship-to Code        ;Code10        ;TableRelation="Ship-to Address".Code WHERE (Customer No.=FIELD(Customer No.));
                                                   OnValidate=BEGIN
                                                                IF ("Ship-to Code" <> xRec."Ship-to Code") AND
                                                                   ("Customer No." = xRec."Customer No.")
                                                                THEN BEGIN
                                                                  IF ("Contract No." <> '') AND NOT HideValidationDialog THEN
                                                                    ERROR(
                                                                      Text003,
                                                                      FIELDCAPTION("Ship-to Code"),
                                                                      "Document Type",FIELDCAPTION("No."),"No.",
                                                                      FIELDCAPTION("Contract No."),"Contract No.");
                                                                  IF ServItemLineExists THEN BEGIN
                                                                    IF NOT
                                                                       CONFIRM(
                                                                         Text004 + Text005,
                                                                         FALSE,FIELDCAPTION("Ship-to Code"),
                                                                         ServItemLine.TABLECAPTION,ServLine.TABLECAPTION)
                                                                    THEN BEGIN
                                                                      "Ship-to Code" := xRec."Ship-to Code";
                                                                      EXIT;
                                                                    END;
                                                                  END ELSE
                                                                    IF ServLineExists THEN
                                                                      IF NOT
                                                                         CONFIRM(
                                                                           Text057 + Text005,
                                                                           FALSE,FIELDCAPTION("Ship-to Code"),ServLine.TABLECAPTION)
                                                                      THEN BEGIN
                                                                        "Ship-to Code" := xRec."Ship-to Code";
                                                                        EXIT;
                                                                      END;
                                                                END;

                                                                IF "Document Type" <> "Document Type"::"Credit Memo" THEN BEGIN
                                                                  IF "Ship-to Code" <> '' THEN BEGIN
                                                                    IF xRec."Ship-to Code" <> '' THEN BEGIN
                                                                      GetCust("Customer No.");
                                                                      IF Cust."Location Code" <> '' THEN
                                                                        "Location Code" := Cust."Location Code";
                                                                      "Tax Area Code" := Cust."Tax Area Code";
                                                                    END;
                                                                    ShiptoAddr.GET("Customer No.","Ship-to Code");
                                                                    "Ship-to Name" := ShiptoAddr.Name;
                                                                    "Ship-to Name 2" := ShiptoAddr."Name 2";
                                                                    "Ship-to Address" := ShiptoAddr.Address;
                                                                    "Ship-to Address 2" := ShiptoAddr."Address 2";
                                                                    "Ship-to City" := ShiptoAddr.City;
                                                                    "Ship-to Post Code" := ShiptoAddr."Post Code";
                                                                    "Ship-to County" := ShiptoAddr.County;
                                                                    VALIDATE("Ship-to Country/Region Code",ShiptoAddr."Country/Region Code");
                                                                    "Ship-to Contact" := ShiptoAddr.Contact;
                                                                    "Ship-to Phone" := ShiptoAddr."Phone No.";
                                                                    //<<IMH75
                                                                    IF "Ship-to Phone" = '' THEN
                                                                      "Ship-to Phone" := "Phone No.";
                                                                    IF "Ship-to Mobile Phone No." = '' THEN
                                                                      "Ship-to Mobile Phone No." := "Contact Mobile Phone No.";
                                                                    //>>IMH75
                                                                    IF ShiptoAddr."Location Code" <> '' THEN
                                                                      "Location Code" := ShiptoAddr."Location Code";
                                                                    "Ship-to Fax No." := ShiptoAddr."Fax No.";
                                                                    "Ship-to E-Mail" := ShiptoAddr."E-Mail";
                                                                    IF ShiptoAddr."Tax Area Code" <> '' THEN
                                                                      "Tax Area Code" := ShiptoAddr."Tax Area Code";
                                                                    "Tax Liable" := ShiptoAddr."Tax Liable";
                                                                  END ELSE
                                                                    IF "Customer No." <> '' THEN BEGIN
                                                                      GetCust("Customer No.");
                                                                      "Ship-to Name" := Cust.Name;
                                                                      "Ship-to Name 2" := Cust."Name 2";
                                                                      "Ship-to Address" := Cust.Address;
                                                                      "Ship-to Address 2" := Cust."Address 2";
                                                                      "Ship-to City" := Cust.City;
                                                                      "Ship-to Post Code" := Cust."Post Code";
                                                                      "Ship-to County" := Cust.County;
                                                                      VALIDATE("Ship-to Country/Region Code",Cust."Country/Region Code");
                                                                      "Ship-to Contact" := Cust.Contact;
                                                                      "Ship-to Phone" := Cust."Phone No.";
                                                                      "Tax Area Code" := Cust."Tax Area Code";
                                                                      "Tax Liable" := Cust."Tax Liable";
                                                                      IF Cust."Location Code" <> '' THEN
                                                                        "Location Code" := Cust."Location Code";
                                                                      "Ship-to Fax No." := Cust."Fax No.";
                                                                      "Ship-to E-Mail" := Cust."E-Mail";
                                                                    END;
                                                                  "Default Team Code" := GetDefaultTeamCodeByServOrder(Rec); //IMH89.ST
                                                                END;

                                                                IF (xRec."Customer No." = "Customer No.") AND
                                                                   (xRec."Ship-to Code" <> "Ship-to Code")
                                                                THEN
                                                                  IF (xRec."VAT Country/Region Code" <> "VAT Country/Region Code") OR
                                                                     (xRec."Tax Area Code" <> "Tax Area Code")
                                                                  THEN
                                                                    RecreateServLines(FIELDCAPTION("Ship-to Code"))
                                                                  ELSE BEGIN
                                                                    IF xRec."Tax Liable" <> "Tax Liable" THEN
                                                                      VALIDATE("Tax Liable");
                                                                  END;

                                                                VALIDATE("Service Zone Code");

                                                                IF ("Ship-to Code" <> xRec."Ship-to Code") AND
                                                                   ("Customer No." = xRec."Customer No.")
                                                                THEN BEGIN
                                                                  MODIFY(TRUE);
                                                                  ServLine.LOCKTABLE;
                                                                  ServItemLine.LOCKTABLE;
                                                                  ServLine.RESET;
                                                                  ServLine.SETRANGE("Document Type","Document Type");
                                                                  ServLine.SETRANGE("Document No.","No.");
                                                                  ServLine.DELETEALL(TRUE);
                                                                  ServItemLine.RESET;
                                                                  ServItemLine.SETRANGE("Document Type","Document Type");
                                                                  ServItemLine.SETRANGE("Document No.","No.");
                                                                  ServItemLine.DELETEALL(TRUE);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Ship-to Code;
                                                              FRA=Code du destinataire] }
    { 13  ;   ;Ship-to Name        ;Text50        ;CaptionML=[ENU=Ship-to Name;
                                                              FRA=Nom du destinataire];
                                                   Editable=No }
    { 14  ;   ;Ship-to Name 2      ;Text50        ;CaptionML=[ENU=Ship-to Name 2;
                                                              FRA=Nom du destinataire 2] }
    { 15  ;   ;Ship-to Address     ;Text50        ;OnValidate=BEGIN
                                                                //<<IMH76.PC
                                                                //<<IMH123.PC
                                                                IF NOT DisableNotif THEN BEGIN
                                                                //>>IMH123.PC
                                                                  CommentNotificationMgt.CreateNotifFromServHeader(Rec,xRec);
                                                                END;
                                                                //>>IMH76.PC
                                                              END;

                                                   CaptionML=[ENU=Ship-to Address *;
                                                              FRA=Adresse MEO *] }
    { 16  ;   ;Ship-to Address 2   ;Text50        ;OnValidate=BEGIN
                                                                //<<IMH76.PC
                                                                //<<IMH123.PC
                                                                IF NOT DisableNotif THEN BEGIN
                                                                //>>IMH123.PC
                                                                  CommentNotificationMgt.CreateNotifFromServHeader(Rec,xRec);
                                                                END;
                                                                //>>IMH76.PC
                                                              END;

                                                   CaptionML=[ENU=Ship-to Address 2;
                                                              FRA=Adresse MEO 2] }
    { 17  ;   ;Ship-to City        ;Text30        ;OnValidate=BEGIN
                                                                PostCode.ValidateCity("Ship-to City","Ship-to Post Code", "Ship-to Country/Region Code"); //IMH29 Ajout Code pays
                                                                //<<IMH76.PC
                                                                //<<IMH123.PC
                                                                IF NOT DisableNotif THEN BEGIN
                                                                //>>IMH123.PC
                                                                  CommentNotificationMgt.CreateNotifFromServHeader(Rec,xRec);
                                                                END;
                                                                //>>IMH76.PC
                                                                //<<IMH80.PC
                                                                "Ship-to Geo. Reference Code" := PostCode.GetGeoCode("Ship-to Post Code","Ship-to City"); //IMH103.ST
                                                                //>>IMH80.PC
                                                                "Default Team Code" := GetDefaultTeamCodeByServOrder(Rec); //ISAT.ZW IMH94
                                                              END;

                                                   OnLookup=VAR
                                                              lxRec@1000000000 : Record 5900;
                                                            BEGIN
                                                              lxRec := Rec; //IMH96.ST
                                                              PostCode.LookUpCity("Ship-to City","Ship-to Post Code", "Ship-to Country/Region Code", TRUE); //IMH29 Ajout Code pays
                                                              "Ship-to Geo. Reference Code" := PostCode.GetGeoCode("Ship-to Post Code","Ship-to City"); //IMH103.ST
                                                              "Default Team Code" := GetDefaultTeamCodeByServOrder(Rec); //ISAT.ZW IMH94
                                                              CommentNotificationMgt.CreateNotifFromServHeader(Rec,xRec); //IMH96.ST
                                                            END;

                                                   CaptionML=[ENU=Ship-to City *;
                                                              FRA=Ville MEO *] }
    { 18  ;   ;Ship-to Contact     ;Text50        ;CaptionML=[ENU=Ship-to Contact;
                                                              FRA=Contact destinataire] }
    { 19  ;   ;Order Date          ;Date          ;OnValidate=BEGIN
                                                                IF "Order Date" <> xRec."Order Date" THEN BEGIN
                                                                  IF ("Order Date" > "Starting Date") AND
                                                                     ("Starting Date" <> 0D)
                                                                  THEN
                                                                    ERROR(Text007,FIELDCAPTION("Order Date"),FIELDCAPTION("Starting Date"));

                                                                  IF ("Order Date" > "Finishing Date") AND
                                                                     ("Finishing Date" <> 0D)
                                                                  THEN
                                                                    ERROR(Text007,FIELDCAPTION("Order Date"),FIELDCAPTION("Finishing Date"));

                                                                  IF "Starting Time" <> 0T THEN
                                                                    VALIDATE("Starting Time");
                                                                  ServItemLine.RESET;
                                                                  ServItemLine.SETCURRENTKEY("Document Type","Document No.","Starting Date");
                                                                  ServItemLine.SETRANGE("Document Type","Document Type");
                                                                  ServItemLine.SETRANGE("Document No.","No.");
                                                                  ServItemLine.SETFILTER("Starting Date",'<>%1',0D);
                                                                  IF ServItemLine.FIND('-') THEN BEGIN
                                                                    REPEAT
                                                                      IF ServItemLine."Starting Date" < "Order Date" THEN
                                                                        ERROR(
                                                                          Text027,FIELDCAPTION("Order Date"),
                                                                          ServItemLine.FIELDCAPTION("Starting Date"));
                                                                    UNTIL ServItemLine.NEXT = 0;
                                                                  END;

                                                                  ServItemLine.RESET;
                                                                  ServItemLine.SETRANGE("Document Type","Document Type");
                                                                  ServItemLine.SETRANGE("Document No.","No.");
                                                                  IF ServItemLine.FIND('-') THEN
                                                                    REPEAT
                                                                      ServItemLine.CheckWarranty("Order Date");
                                                                      ServItemLine.CalculateResponseDateTime("Order Date","Order Time");
                                                                      ServItemLine.MODIFY;
                                                                    UNTIL ServItemLine.NEXT = 0;
                                                                  UpdateServLines(FIELDCAPTION("Order Date"),FALSE);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Order Date;
                                                              FRA=Date cr‚ation];
                                                   NotBlank=Yes;
                                                   Editable=No }
    { 20  ;   ;Posting Date        ;Date          ;OnValidate=VAR
                                                                NoSeries@1000 : Record 308;
                                                              BEGIN
                                                                IF ("Posting No." <> '') AND ("Posting No. Series" <> '') THEN BEGIN
                                                                  NoSeries.GET("Posting No. Series");
                                                                  IF NoSeries."Date Order" THEN
                                                                    ERROR(
                                                                      Text045,
                                                                      FIELDCAPTION("Posting Date"),FIELDCAPTION("Posting No. Series"),"Posting No. Series",
                                                                      NoSeries.FIELDCAPTION("Date Order"),NoSeries."Date Order","Document Type",
                                                                      FIELDCAPTION("Posting No."),"Posting No.");
                                                                END;

                                                                VALIDATE("Document Date","Posting Date");

                                                                IF ("Document Type" IN ["Document Type"::Invoice,"Document Type"::"Credit Memo"]) AND
                                                                   NOT ("Posting Date" = xRec."Posting Date")
                                                                THEN
                                                                  PriceMsgIfServLinesExist(FIELDCAPTION("Posting Date"));

                                                                IF "Currency Code" <> '' THEN BEGIN
                                                                  UpdateCurrencyFactor;
                                                                  IF "Currency Factor" <> xRec."Currency Factor" THEN
                                                                    ConfirmUpdateCurrencyFactor;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Posting Date;
                                                              FRA=Date comptabilisation] }
    { 22  ;   ;Posting Description ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer.Name WHERE (No.=FIELD(Customer No.)));
                                                   CaptionML=[ENU=Posting Description;
                                                              FRA=Libell‚ ‚criture] }
    { 23  ;   ;Payment Terms Code  ;Code10        ;TableRelation="Payment Terms";
                                                   OnValidate=BEGIN
                                                                IF ("Payment Terms Code" <> '') AND ("Document Date" <> 0D) THEN BEGIN
                                                                  PaymentTerms.GET("Payment Terms Code");
                                                                  IF ("Document Type" IN ["Document Type"::"Credit Memo"]) AND
                                                                     NOT PaymentTerms."Calc. Pmt. Disc. on Cr. Memos"
                                                                  THEN BEGIN
                                                                    VALIDATE("Due Date","Document Date");
                                                                    VALIDATE("Pmt. Discount Date",0D);
                                                                    VALIDATE("Payment Discount %",0);
                                                                  END ELSE BEGIN
                                                                    "Due Date" := CALCDATE(PaymentTerms."Due Date Calculation","Document Date");
                                                                    "Pmt. Discount Date" := CALCDATE(PaymentTerms."Discount Date Calculation","Document Date");
                                                                    VALIDATE("Payment Discount %",PaymentTerms."Discount %")
                                                                  END;
                                                                END ELSE BEGIN
                                                                  VALIDATE("Due Date","Document Date");
                                                                  VALIDATE("Pmt. Discount Date",0D);
                                                                  VALIDATE("Payment Discount %",0);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Payment Terms Code;
                                                              FRA=Code conditions paiement] }
    { 24  ;   ;Due Date            ;Date          ;CaptionML=[ENU=Due Date;
                                                              FRA=Date d'‚ch‚ance] }
    { 25  ;   ;Payment Discount %  ;Decimal       ;OnValidate=BEGIN
                                                                GLSetup.GET;
                                                                IF "Payment Discount %" < GLSetup."VAT Tolerance %" THEN
                                                                  "VAT Base Discount %" := "Payment Discount %"
                                                                ELSE
                                                                  "VAT Base Discount %" := GLSetup."VAT Tolerance %";
                                                                VALIDATE("VAT Base Discount %");
                                                              END;

                                                   CaptionML=[ENU=Payment Discount %;
                                                              FRA=% escompte];
                                                   DecimalPlaces=0:5 }
    { 26  ;   ;Pmt. Discount Date  ;Date          ;CaptionML=[ENU=Pmt. Discount Date;
                                                              FRA=Date d'escompte] }
    { 28  ;   ;Location Code       ;Code10        ;TableRelation=Location;
                                                   OnValidate=BEGIN
                                                                IF ("Location Code" <> xRec."Location Code") AND
                                                                   ("Customer No." = xRec."Customer No.")
                                                                THEN
                                                                  MessageIfServLinesExist(FIELDCAPTION("Location Code"));

                                                                UpdateShipToAddress;
                                                              END;

                                                   CaptionML=[ENU=Location Code;
                                                              FRA=Code magasin] }
    { 29  ;   ;Shortcut Dimension 1 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(1,"Shortcut Dimension 1 Code");
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 1 Code;
                                                              FRA=Code raccourci axe 1];
                                                   CaptionClass='1,2,1' }
    { 30  ;   ;Shortcut Dimension 2 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(2,"Shortcut Dimension 2 Code");
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 2 Code;
                                                              FRA=Code raccourci axe 2];
                                                   CaptionClass='1,2,2' }
    { 31  ;   ;Customer Posting Group;Code10      ;TableRelation="Customer Posting Group";
                                                   CaptionML=[ENU=Customer Posting Group;
                                                              FRA=Groupe compta. client];
                                                   Editable=No }
    { 32  ;   ;Currency Code       ;Code10        ;TableRelation=Currency;
                                                   OnValidate=BEGIN
                                                                IF CurrFieldNo <> FIELDNO("Currency Code") THEN
                                                                  UpdateCurrencyFactor
                                                                ELSE BEGIN
                                                                  IF "Currency Code" <> xRec."Currency Code" THEN BEGIN
                                                                    IF ServLineExists AND ("Contract No." <> '') AND
                                                                       ("Document Type" IN ["Document Type"::Invoice,"Document Type"::"Credit Memo"])
                                                                    THEN
                                                                      ERROR(Text058,FIELDCAPTION("Currency Code"),"Document Type","No.","Contract No.");

                                                                    UpdateCurrencyFactor;
                                                                    ValidateServPriceGrOnServItem;
                                                                    RecreateServLines(FIELDCAPTION("Currency Code"));
                                                                  END ELSE
                                                                    IF "Currency Code" <> '' THEN BEGIN
                                                                      UpdateCurrencyFactor;
                                                                      IF "Currency Factor" <> xRec."Currency Factor" THEN
                                                                        ConfirmUpdateCurrencyFactor;
                                                                    END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Currency Code;
                                                              FRA=Code devise] }
    { 33  ;   ;Currency Factor     ;Decimal       ;OnValidate=BEGIN
                                                                IF "Currency Factor" <> xRec."Currency Factor" THEN
                                                                  UpdateServLines(FIELDCAPTION("Currency Factor"),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Currency Factor;
                                                              FRA=Facteur devise];
                                                   DecimalPlaces=0:15;
                                                   MinValue=0;
                                                   Editable=No }
    { 34  ;   ;Customer Price Group;Code10        ;TableRelation="Customer Price Group";
                                                   OnValidate=BEGIN
                                                                PriceMsgIfServLinesExist(FIELDCAPTION("Customer Price Group"));
                                                              END;

                                                   CaptionML=[ENU=Customer Price Group;
                                                              FRA=Groupe prix client] }
    { 35  ;   ;Prices Including VAT;Boolean       ;OnValidate=VAR
                                                                ServLine@1002 : Record 5902;
                                                                Currency@1001 : Record 4;
                                                                RecalculatePrice@1000 : Boolean;
                                                              BEGIN
                                                                IF "Prices Including VAT" <> xRec."Prices Including VAT" THEN BEGIN
                                                                  TESTFIELD("Max. Labor Unit Price",0);
                                                                  ServLine.SETRANGE("Document Type","Document Type");
                                                                  ServLine.SETRANGE("Document No.","No.");
                                                                  ServLine.SETFILTER(Type,'>0');
                                                                  ServLine.SETFILTER(Quantity,'<>0');
                                                                  IF ServLine.FIND('-') THEN
                                                                    REPEAT
                                                                      ServLine.Amount := 0;
                                                                      ServLine."Amount Including VAT" := 0;
                                                                      ServLine."VAT Base Amount" := 0;
                                                                      ServLine.InitOutstandingAmount;
                                                                      ServLine.MODIFY;
                                                                    UNTIL ServLine.NEXT = 0;
                                                                  ServLine.SETRANGE(Type);
                                                                  ServLine.SETRANGE(Quantity);

                                                                  ServLine.SETFILTER("Unit Price",'<>%1',0);
                                                                  ServLine.SETFILTER("VAT %",'<>%1',0);
                                                                  IF ServLine.FIND('-') THEN BEGIN
                                                                    RecalculatePrice :=
                                                                      CONFIRM(
                                                                        STRSUBSTNO(
                                                                          Text055 +
                                                                          Text056,
                                                                          FIELDCAPTION("Prices Including VAT"),ServLine.FIELDCAPTION("Unit Price")),
                                                                        TRUE);
                                                                    ServLine.SetServHeader(Rec);

                                                                    IF "Currency Code" = '' THEN
                                                                      Currency.InitRoundingPrecision
                                                                    ELSE
                                                                      Currency.GET("Currency Code");

                                                                    REPEAT
                                                                      ServLine.TESTFIELD("Quantity Invoiced",0);
                                                                      IF NOT RecalculatePrice THEN BEGIN
                                                                        ServLine."VAT Difference" := 0;
                                                                        ServLine.InitOutstandingAmount;
                                                                      END ELSE BEGIN
                                                                        IF "Prices Including VAT" THEN BEGIN
                                                                          ServLine."Unit Price" :=
                                                                            ROUND(
                                                                              ServLine."Unit Price" * (1 + (ServLine."VAT %" / 100)),
                                                                              Currency."Unit-Amount Rounding Precision");
                                                                          IF ServLine.Quantity <> 0 THEN BEGIN
                                                                            ServLine."Line Discount Amount" :=
                                                                              ROUND(
                                                                                ServLine.CalcChargeableQty * ServLine."Unit Price" * ServLine."Line Discount %" / 100,
                                                                                Currency."Amount Rounding Precision");
                                                                            ServLine.VALIDATE("Inv. Discount Amount",
                                                                              ROUND(
                                                                                ServLine."Inv. Discount Amount" * (1 + (ServLine."VAT %" / 100)),
                                                                                Currency."Amount Rounding Precision"));
                                                                          END;
                                                                        END ELSE BEGIN
                                                                          ServLine."Unit Price" :=
                                                                            ROUND(
                                                                              ServLine."Unit Price" / (1 + (ServLine."VAT %" / 100)),
                                                                              Currency."Unit-Amount Rounding Precision");
                                                                          IF ServLine.Quantity <> 0 THEN BEGIN
                                                                            ServLine."Line Discount Amount" :=
                                                                              ROUND(
                                                                                ServLine.CalcChargeableQty * ServLine."Unit Price" * ServLine."Line Discount %" / 100,
                                                                                Currency."Amount Rounding Precision");
                                                                            ServLine.VALIDATE("Inv. Discount Amount",
                                                                              ROUND(
                                                                                ServLine."Inv. Discount Amount" / (1 + (ServLine."VAT %" / 100)),
                                                                                Currency."Amount Rounding Precision"));
                                                                          END;
                                                                        END;
                                                                      END;
                                                                      ServLine.MODIFY;
                                                                    UNTIL ServLine.NEXT = 0;
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Prices Including VAT;
                                                              FRA=Prix TTC] }
    { 37  ;   ;Invoice Disc. Code  ;Code20        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer."Invoice Disc. Code" WHERE (No.=FIELD(Customer No.)));
                                                   OnLookup=BEGIN
                                                              MessageIfServLinesExist(FIELDCAPTION("Invoice Disc. Code"));
                                                            END;

                                                   CaptionML=[ENU=Invoice Disc. Code;
                                                              FRA=Code remise facture] }
    { 40  ;   ;Customer Disc. Group;Code10        ;TableRelation="Customer Discount Group";
                                                   OnValidate=BEGIN
                                                                MessageIfServLinesExist(FIELDCAPTION("Customer Disc. Group"));
                                                              END;

                                                   CaptionML=[ENU=Customer Disc. Group;
                                                              FRA=Groupe rem. client] }
    { 41  ;   ;Language Code       ;Code10        ;TableRelation=Language;
                                                   OnValidate=BEGIN
                                                                MessageIfServLinesExist(FIELDCAPTION("Language Code"));
                                                              END;

                                                   CaptionML=[ENU=Language Code;
                                                              FRA=Code langue] }
    { 43  ;   ;Salesperson Code    ;Code10        ;TableRelation=Salesperson/Purchaser;
                                                   OnValidate=BEGIN
                                                                CreateDim(
                                                                  DATABASE::"Salesperson/Purchaser","Salesperson Code",
                                                                  DATABASE::Customer,"Bill-to Customer No.",
                                                                  DATABASE::"Responsibility Center","Responsibility Center",
                                                                  DATABASE::"Service Order Type","Service Order Type",
                                                                  DATABASE::"Service Contract Header","Contract No.");
                                                              END;

                                                   CaptionML=[ENU=Salesperson Code;
                                                              FRA=Code vendeur] }
    { 46  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Service Comment Line" WHERE (Table Name=CONST(Service Header),
                                                                                                   Table Subtype=FIELD(Document Type),
                                                                                                   No.=FIELD(No.),
                                                                                                   Type=CONST(General)));
                                                   CaptionML=[ENU=Comment;
                                                              FRA=Commentaires];
                                                   Editable=No }
    { 47  ;   ;No. Printed         ;Integer       ;CaptionML=[ENU=No. Printed;
                                                              FRA=Nbre impressions];
                                                   Editable=No }
    { 52  ;   ;Applies-to Doc. Type;Option        ;CaptionML=[ENU=Applies-to Doc. Type;
                                                              FRA=Type doc. lettrage];
                                                   OptionCaptionML=[ENU=" ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund";
                                                                    FRA=" ,Paiement,Facture,Avoir,Int‚rˆts,Relance,Remboursement"];
                                                   OptionString=[ ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund] }
    { 53  ;   ;Applies-to Doc. No. ;Code20        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Company Information"."Primary Key");
                                                   OnValidate=BEGIN
                                                                //<<IMH138
                                                                {
                                                                IF "Applies-to Doc. No." <> '' THEN
                                                                  TESTFIELD("Bal. Account No.",'');

                                                                IF (Rec."Applies-to Doc. No." <> xRec."Applies-to Doc. No.") AND (xRec."Applies-to Doc. No." <> '') AND
                                                                   (Rec."Applies-to Doc. No." <> '')
                                                                THEN BEGIN
                                                                  SetAmountToApply(Rec."Applies-to Doc. No.",Rec."Customer No.");
                                                                  SetAmountToApply(xRec."Applies-to Doc. No.",Rec."Customer No.");
                                                                END ELSE
                                                                  IF (Rec."Applies-to Doc. No." <> xRec."Applies-to Doc. No.") AND (xRec."Applies-to Doc. No." = '') THEN
                                                                    SetAmountToApply(Rec."Applies-to Doc. No.",Rec."Customer No.")
                                                                  ELSE
                                                                    IF (Rec."Applies-to Doc. No." <> xRec."Applies-to Doc. No.") AND (Rec."Applies-to Doc. No." = '') THEN
                                                                      SetAmountToApply(xRec."Applies-to Doc. No.",Rec."Customer No.");
                                                                }
                                                                //>>IMH138
                                                              END;

                                                   OnLookup=VAR
                                                              ApplyCustEntries@1000 : Form 232;
                                                            BEGIN
                                                              //<<IMH138
                                                              {
                                                              TESTFIELD("Bal. Account No.",'');
                                                              CustLedgEntry.SETCURRENTKEY("Customer No.",Open,Positive,"Due Date");
                                                              CustLedgEntry.SETRANGE("Customer No.","Bill-to Customer No.");
                                                              CustLedgEntry.SETRANGE(Open,TRUE);
                                                              IF "Applies-to Doc. No." <> '' THEN BEGIN
                                                                CustLedgEntry.SETRANGE("Document Type","Applies-to Doc. Type");
                                                                CustLedgEntry.SETRANGE("Document No.","Applies-to Doc. No.");
                                                                IF CustLedgEntry.FIND('-') THEN;
                                                                CustLedgEntry.SETRANGE("Document Type");
                                                                CustLedgEntry.SETRANGE("Document No.");
                                                              END
                                                              ELSE
                                                                IF "Applies-to Doc. Type" <> 0 THEN BEGIN
                                                                  CustLedgEntry.SETRANGE("Document Type","Applies-to Doc. Type");
                                                                  IF CustLedgEntry.FIND('-') THEN
                                                                    CustLedgEntry.SETRANGE("Document Type");
                                                                END;

                                                              ApplyCustEntries.SetService(Rec,CustLedgEntry,ServHeader.FIELDNO("Applies-to Doc. No."));
                                                              ApplyCustEntries.SETTABLEVIEW(CustLedgEntry);
                                                              ApplyCustEntries.SETRECORD(CustLedgEntry);
                                                              ApplyCustEntries.LOOKUPMODE(TRUE);
                                                              IF ApplyCustEntries.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                                                ApplyCustEntries.GetCustLedgEntry(CustLedgEntry);
                                                                GenJnlApply.CheckAgainstApplnCurrency(
                                                                  "Currency Code",CustLedgEntry."Currency Code",GenJnlLine."Account Type"::Customer,TRUE);
                                                                "Applies-to Doc. Type" := CustLedgEntry."Document Type";
                                                                "Applies-to Doc. No." := CustLedgEntry."Document No.";
                                                              END;
                                                              CLEAR(ApplyCustEntries);
                                                              }
                                                              //>>IMH138
                                                            END;

                                                   CaptionML=[ENU=Applies-to Doc. No.;
                                                              FRA=Nø doc. lettrage] }
    { 55  ;   ;Bal. Account No.    ;Code20        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Payment Method"."Bal. Account No." WHERE (Code=FIELD(Payment Method Code)));
                                                   TableRelation=IF (Bal. Account Type=CONST(G/L Account)) "G/L Account"
                                                                 ELSE IF (Bal. Account Type=CONST(Bank Account)) "Bank Account";
                                                   OnValidate=BEGIN
                                                                //<<IMH138
                                                                {
                                                                IF "Bal. Account No." <> '' THEN
                                                                  CASE "Bal. Account Type" OF
                                                                    "Bal. Account Type"::"G/L Account":
                                                                      BEGIN
                                                                        GLAcc.GET("Bal. Account No.");
                                                                        GLAcc.CheckGLAcc;
                                                                        GLAcc.TESTFIELD("Direct Posting",TRUE);
                                                                      END;
                                                                    "Bal. Account Type"::"Bank Account":
                                                                      BEGIN
                                                                        BankAcc.GET("Bal. Account No.");
                                                                        BankAcc.TESTFIELD(Blocked,FALSE);
                                                                        BankAcc.TESTFIELD("Currency Code","Currency Code");
                                                                      END;
                                                                  END;
                                                                }
                                                                //>>IMH138
                                                              END;

                                                   CaptionML=[ENU=Bal. Account No.;
                                                              FRA=Nø compte contrepartie] }
    { 62  ;   ;Shipping No.        ;Code20        ;CaptionML=[ENU=Shipping No.;
                                                              FRA=Utiliser B.L. Nø] }
    { 63  ;   ;Posting No.         ;Code20        ;CaptionML=[ENU=Posting No.;
                                                              FRA=Utiliser facture nø] }
    { 64  ;   ;Last Shipping No.   ;Code20        ;TableRelation="Service Shipment Header";
                                                   CaptionML=[ENU=Last Shipping No.;
                                                              FRA=Nø dern. bon de livraison];
                                                   Editable=No }
    { 65  ;   ;Last Posting No.    ;Code20        ;TableRelation="Service Invoice Header";
                                                   CaptionML=[ENU=Last Posting No.;
                                                              FRA=Nø dern. facture];
                                                   Editable=No }
    { 70  ;   ;VAT Registration No.;Text20        ;CaptionML=[ENU=VAT Registration No.;
                                                              FRA=Nø identif. intracomm.] }
    { 73  ;   ;Reason Code         ;Code10        ;TableRelation="Reason Code";
                                                   CaptionML=[ENU=Reason Code;
                                                              FRA=Code motif] }
    { 74  ;   ;Gen. Bus. Posting Group;Code10     ;TableRelation="Gen. Business Posting Group";
                                                   OnValidate=BEGIN
                                                                IF "Gen. Bus. Posting Group" <> xRec."Gen. Bus. Posting Group" THEN
                                                                  IF GenBusPostingGrp.ValidateVatBusPostingGroup(GenBusPostingGrp,"Gen. Bus. Posting Group") THEN BEGIN
                                                                    "VAT Bus. Posting Group" := GenBusPostingGrp."Def. VAT Bus. Posting Group";
                                                                    RecreateServLines(FIELDCAPTION("Gen. Bus. Posting Group"));
                                                                  END;
                                                              END;

                                                   CaptionML=[ENU=Gen. Bus. Posting Group;
                                                              FRA=Groupe compta. march‚] }
    { 75  ;   ;EU 3-Party Trade    ;Boolean       ;CaptionML=[ENU=EU 3-Party Trade;
                                                              FRA=Trans. tripartite UE] }
    { 76  ;   ;Transaction Type    ;Code10        ;TableRelation="Transaction Type";
                                                   OnValidate=BEGIN
                                                                UpdateServLines(FIELDCAPTION("Transaction Type"),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Transaction Type;
                                                              FRA=Nature transaction] }
    { 77  ;   ;Transport Method    ;Code10        ;TableRelation="Transport Method";
                                                   OnValidate=BEGIN
                                                                UpdateServLines(FIELDCAPTION("Transport Method"),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Transport Method;
                                                              FRA=Mode de transport] }
    { 78  ;   ;VAT Country/Region Code;Code10     ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=VAT Country/Region Code;
                                                              FRA=Code pays/r‚gion TVA] }
    { 79  ;   ;Name                ;Text50        ;CaptionML=[ENU=Name;
                                                              FRA=Nom];
                                                   Editable=No }
    { 80  ;   ;Name 2              ;Text50        ;CaptionML=[ENU=Name 2;
                                                              FRA=Nom 2] }
    { 81  ;   ;Address             ;Text50        ;CaptionML=[ENU=Address;
                                                              FRA=Adresse];
                                                   Editable=No }
    { 82  ;   ;Address 2           ;Text50        ;CaptionML=[ENU=Address 2;
                                                              FRA=Adresse 2];
                                                   Editable=No }
    { 83  ;   ;City                ;Text30        ;OnValidate=BEGIN
                                                                PostCode.ValidateCity(City,"Post Code", "Country/Region Code"); //IMH29 Ajout Code pays
                                                                "Geo. Reference Code" := PostCode.GetGeoCode("Post Code",City); //IMH103.ST
                                                              END;

                                                   OnLookup=BEGIN
                                                              PostCode.LookUpCity(City,"Post Code","Country/Region Code", TRUE); //IMH29 Ajout Code pays
                                                              "Geo. Reference Code" := PostCode.GetGeoCode("Post Code",City); //IMH103.ST
                                                            END;

                                                   CaptionML=[ENU=City;
                                                              FRA=Ville];
                                                   Editable=No }
    { 84  ;   ;Contact Name        ;Text50        ;CaptionML=[ENU=Contact Name;
                                                              FRA=Nom b‚n‚ficiaire] }
    { 85  ;   ;Bill-to Post Code   ;Code20        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer."Post Code" WHERE (No.=FIELD(Bill-to Customer No.)));
                                                   TableRelation="Post Code";
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode("Bill-to City","Bill-to Post Code","Bill-to Country/Region Code"); //IMH29 Ajout Code pays
                                                              END;

                                                   OnLookup=BEGIN
                                                              PostCode.LookUpPostCode("Bill-to City","Bill-to Post Code","Bill-to Country/Region Code", TRUE); //IMH29 Ajout Code pays
                                                            END;

                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Bill-to Post Code;
                                                              FRA=Code postal facturation];
                                                   Editable=No }
    { 86  ;   ;Bill-to County      ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer.County WHERE (No.=FIELD(Bill-to Customer No.)));
                                                   CaptionML=[ENU=Bill-to County;
                                                              FRA=R‚gion facturation];
                                                   Editable=No }
    { 87  ;   ;Bill-to Country/Region Code;Code10 ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer."Country/Region Code" WHERE (No.=FIELD(Bill-to Customer No.)));
                                                   TableRelation=Country/Region;
                                                   CaptionML=[ENU=Bill-to Country/Region Code;
                                                              FRA=Code pays/r‚gion facturation];
                                                   Editable=No }
    { 88  ;   ;Post Code           ;Code20        ;TableRelation="Post Code";
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(City,"Post Code", "Country/Region Code"); //IMH29 Ajout Code pays
                                                                "Geo. Reference Code" := PostCode.GetGeoCode("Post Code",City); //IMH103.ST
                                                              END;

                                                   OnLookup=BEGIN
                                                              PostCode.LookUpPostCode(City,"Post Code","Country/Region Code",TRUE); //IMH29 Ajout Code pays
                                                              "Geo. Reference Code" := PostCode.GetGeoCode("Post Code",City); //IMH103.ST
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Post Code;
                                                              FRA=Code postal];
                                                   Editable=No }
    { 89  ;   ;County              ;Text30        ;CaptionML=[ENU=County;
                                                              FRA=R‚gion];
                                                   Editable=No }
    { 90  ;   ;Country/Region Code ;Code10        ;TableRelation=Country/Region;
                                                   OnValidate=BEGIN
                                                                VALIDATE("Ship-to Country/Region Code");
                                                              END;

                                                   CaptionML=[ENU=Country/Region Code;
                                                              FRA=Code pays/r‚gion];
                                                   Editable=No }
    { 91  ;   ;Ship-to Post Code   ;Code20        ;TableRelation="Post Code" WHERE (Country/Region Code=FIELD(Ship-to Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode("Ship-to City","Ship-to Post Code","Ship-to Country/Region Code");   //IMH29 Ajout Code pays
                                                                //<<IMH76.PC
                                                                //<<IMH123.PC
                                                                IF NOT DisableNotif THEN BEGIN
                                                                //>>IMH123.PC
                                                                  CommentNotificationMgt.CreateNotifFromServHeader(Rec,xRec);
                                                                END;
                                                                //>>IMH76.PC
                                                                //<<IMH80.PC
                                                                "Ship-to Geo. Reference Code" := PostCode.GetGeoCode("Ship-to Post Code","Ship-to City"); //IMH103.ST
                                                                //>>IMH80.PC
                                                                "Default Team Code" := GetDefaultTeamCodeByServOrder(Rec); //IMH89.ST
                                                              END;

                                                   OnLookup=VAR
                                                              lxRec@1000000000 : Record 5900;
                                                            BEGIN
                                                              lxRec := Rec; //IMH96.ST
                                                              PostCode.LookUpPostCode("Ship-to City","Ship-to Post Code","Ship-to Country/Region Code", TRUE); //IMH29 Ajout Code pays
                                                              "Ship-to Geo. Reference Code" := PostCode.GetGeoCode("Ship-to Post Code","Ship-to City"); //IMH103.ST
                                                              "Default Team Code" := GetDefaultTeamCodeByServOrder(Rec); //IMH89.ST
                                                              CommentNotificationMgt.CreateNotifFromServHeader(Rec,lxRec); //IMH96.ST
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Ship-to Post Code *;
                                                              FRA=Code postal MEO *] }
    { 92  ;   ;Ship-to County      ;Text30        ;CaptionML=[ENU=Ship-to County;
                                                              FRA=R‚gion MEO];
                                                   Editable=No }
    { 93  ;   ;Ship-to Country/Region Code;Code10 ;TableRelation=Country/Region;
                                                   OnValidate=BEGIN
                                                                IF "Ship-to Country/Region Code" <> '' THEN
                                                                  "VAT Country/Region Code" := "Country/Region Code"
                                                                ELSE
                                                                  "VAT Country/Region Code" := "Country/Region Code";
                                                                "Default Team Code" := GetDefaultTeamCodeByServOrder(Rec); //IMH89.ST
                                                                //<<IMH76.PC
                                                                CommentNotificationMgt.CreateNotifFromServHeader(Rec,xRec);
                                                                //>>IMH76.PC
                                                              END;

                                                   CaptionML=[ENU=Ship-to Country/Region Code;
                                                              FRA=Code pays/r‚gion MEO] }
    { 94  ;   ;Bal. Account Type   ;Option        ;CaptionML=[ENU=Bal. Account Type;
                                                              FRA=Type compte contrepartie];
                                                   OptionCaptionML=[ENU=G/L Account,Bank Account;
                                                                    FRA=G‚n‚ral,Banque];
                                                   OptionString=G/L Account,Bank Account }
    { 97  ;   ;Exit Point          ;Code10        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer."Country/Region Code" WHERE (No.=FIELD(Bill-to Customer No.)));
                                                   TableRelation="Entry/Exit Point";
                                                   OnValidate=BEGIN
                                                                UpdateServLines(FIELDCAPTION("Exit Point"),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Exit Point;
                                                              FRA=Pays destination] }
    { 98  ;   ;Correction          ;Boolean       ;CaptionML=[ENU=Correction;
                                                              FRA=Correction] }
    { 99  ;   ;Document Date       ;Date          ;OnValidate=BEGIN
                                                                VALIDATE("Payment Terms Code");
                                                              END;

                                                   CaptionML=[ENU=Document Date;
                                                              FRA=Date document] }
    { 101 ;   ;Area                ;Code10        ;TableRelation=Area;
                                                   OnValidate=BEGIN
                                                                UpdateServLines(FIELDCAPTION(Area),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Area;
                                                              FRA=D‚pt destination/provenance] }
    { 102 ;   ;Transaction Specification;Code10   ;TableRelation="Transaction Specification";
                                                   OnValidate=BEGIN
                                                                UpdateServLines(FIELDCAPTION("Transaction Specification"),FALSE);
                                                              END;

                                                   CaptionML=[ENU=Transaction Specification;
                                                              FRA=R‚gime] }
    { 104 ;   ;Payment Method Code ;Code10        ;TableRelation="Payment Method";
                                                   OnValidate=BEGIN
                                                                PaymentMethod.INIT;
                                                                IF "Payment Method Code" <> '' THEN
                                                                  PaymentMethod.GET("Payment Method Code");
                                                                "Bal. Account Type" := PaymentMethod."Bal. Account Type";
                                                                //"Bal. Account No." := PaymentMethod."Bal. Account No.";  //IMH138

                                                                //<<IMH138
                                                                {
                                                                IF "Bal. Account No." <> '' THEN BEGIN
                                                                  TESTFIELD("Applies-to Doc. No.",'');
                                                                  TESTFIELD("Applies-to ID",'');
                                                                END;
                                                                }
                                                                //>>IMH138

                                                                UpdatePaymentMethodCode(); // IMH41.ISAT.MA
                                                              END;

                                                   CaptionML=[ENU=Payment Method Code;
                                                              FRA=Code mode de rŠglement] }
    { 107 ;   ;No. Series          ;Code10        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=No. Series;
                                                              FRA=Souches de nø];
                                                   Editable=No }
    { 108 ;   ;Posting No. Series  ;Code10        ;TableRelation="No. Series";
                                                   OnValidate=BEGIN
                                                                IF "Posting No. Series" <> '' THEN BEGIN
                                                                  ServSetup.GET;
                                                                  TestNoSeries;
                                                                  NoSeriesMgt.TestSeries(GetPostingNoSeriesCode,"Posting No. Series");
                                                                END;
                                                                TESTFIELD("Posting No.",'');
                                                              END;

                                                   CaptionML=[ENU=Posting No. Series;
                                                              FRA=Souches de nø validation] }
    { 109 ;   ;Shipping No. Series ;Code10        ;TableRelation="No. Series";
                                                   OnValidate=BEGIN
                                                                IF "Shipping No. Series" <> '' THEN BEGIN
                                                                  ServSetup.GET;
                                                                  ServSetup.TESTFIELD("Posted Service Shipment Nos.");
                                                                  NoSeriesMgt.TestSeries(ServSetup."Posted Service Shipment Nos.","Shipping No. Series");
                                                                END;
                                                                TESTFIELD("Shipping No.",'');
                                                              END;

                                                   CaptionML=[ENU=Shipping No. Series;
                                                              FRA=Souche de nø exp‚dition] }
    { 114 ;   ;Tax Area Code       ;Code20        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer."Tax Area Code" WHERE (No.=FIELD(Customer No.)));
                                                   TableRelation="Tax Area";
                                                   OnValidate=BEGIN
                                                                MessageIfServLinesExist(FIELDCAPTION("Tax Area Code"));
                                                              END;

                                                   CaptionML=[ENU=Tax Area Code;
                                                              FRA=Code zone recouvrement];
                                                   Editable=No }
    { 115 ;   ;Tax Liable          ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer."Tax Liable" WHERE (No.=FIELD(Customer No.)));
                                                   OnValidate=BEGIN
                                                                MessageIfServLinesExist(FIELDCAPTION("Tax Liable"));
                                                              END;

                                                   CaptionML=[ENU=Tax Liable;
                                                              FRA=Soumis … recouvrement];
                                                   Editable=No }
    { 116 ;   ;VAT Bus. Posting Group;Code10      ;TableRelation="VAT Business Posting Group";
                                                   OnValidate=BEGIN
                                                                IF "VAT Bus. Posting Group" <> xRec."VAT Bus. Posting Group" THEN
                                                                  RecreateServLines(FIELDCAPTION("VAT Bus. Posting Group"));
                                                              END;

                                                   CaptionML=[ENU=VAT Bus. Posting Group;
                                                              FRA=Groupe compta. march‚ TVA] }
    { 117 ;   ;Reserve             ;Option        ;CaptionML=[ENU=Reserve;
                                                              FRA=R‚server];
                                                   OptionCaptionML=[ENU=Never,Optional,Always;
                                                                    FRA=Jamais,Manuel,Toujours];
                                                   OptionString=Never,Optional,Always }
    { 118 ;   ;Applies-to ID       ;Code20        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Company Information"."Primary Key");
                                                   OnValidate=VAR
                                                                TempCustLedgEntry@1000 : Record 21;
                                                                CustEntrySetApplID@1001 : Codeunit 101;
                                                              BEGIN
                                                                //<<IMH138
                                                                {
                                                                IF "Applies-to ID" <> '' THEN
                                                                  TESTFIELD("Bal. Account No.",'');
                                                                IF ("Applies-to ID" <> xRec."Applies-to ID") AND (xRec."Applies-to ID" <> '') THEN BEGIN
                                                                  CustLedgEntry.SETCURRENTKEY("Customer No.",Open);
                                                                  CustLedgEntry.SETRANGE("Customer No.","Bill-to Customer No.");
                                                                  CustLedgEntry.SETRANGE(Open,TRUE);
                                                                  CustLedgEntry.SETRANGE("Applies-to ID",xRec."Applies-to ID");
                                                                  IF CustLedgEntry.FINDFIRST THEN
                                                                    CustEntrySetApplID.SetApplId(CustLedgEntry,TempCustLedgEntry,0,0,'');
                                                                  CustLedgEntry.RESET;
                                                                END;
                                                                }
                                                                //>>IMH138
                                                              END;

                                                   CaptionML=[ENU=Applies-to ID;
                                                              FRA=ID lettrage] }
    { 119 ;   ;VAT Base Discount % ;Decimal       ;OnValidate=BEGIN
                                                                GLSetup.GET;
                                                                IF "VAT Base Discount %" > GLSetup."VAT Tolerance %" THEN
                                                                  ERROR(
                                                                    Text011,
                                                                    FIELDCAPTION("VAT Base Discount %"),
                                                                    GLSetup.FIELDCAPTION("VAT Tolerance %"),
                                                                    GLSetup.TABLECAPTION);

                                                                IF ("VAT Base Discount %" = xRec."VAT Base Discount %") AND
                                                                   (CurrFieldNo <> 0)
                                                                THEN
                                                                  EXIT;

                                                                ServLine.RESET;
                                                                ServLine.SETRANGE("Document Type","Document Type");
                                                                ServLine.SETRANGE("Document No.","No.");
                                                                ServLine.SETFILTER(Type,'<>%1',ServLine.Type::" ");
                                                                ServLine.SETFILTER(Quantity,'<>0');
                                                                DocDim.LOCKTABLE;
                                                                ServLine.LOCKTABLE;
                                                                LOCKTABLE;
                                                                IF ServLine.FINDSET THEN BEGIN
                                                                  MODIFY;
                                                                  REPEAT
                                                                    IF (ServLine."Quantity Invoiced" <> ServLine.Quantity) OR
                                                                       ("Shipping Advice" <> "Shipping Advice"::Partial) OR
                                                                       (CurrFieldNo <> 0)
                                                                    THEN BEGIN
                                                                      ServLine.UpdateAmounts(ServLine);
                                                                      ServLine.MODIFY;
                                                                    END;
                                                                  UNTIL ServLine.NEXT = 0;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=VAT Base Discount %;
                                                              FRA=% remise base TVA];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 120 ;   ;Status              ;Option        ;OnValidate=VAR
                                                                lSalesInvoicingMgt@1100281000 : Codeunit 50079;
                                                                lEAISentIMAAction@1100281001 : Codeunit 50130;
                                                              BEGIN
                                                                //<<IMH17
                                                                CASE Status OF
                                                                  Status::Finished, Status::"4" : BEGIN
                                                                    "Finishing Date" := TODAY;
                                                                    "Finishing Time" := TIME;
                                                                    //<<IMH.isat.PC
                                                                    IF Status = Status::Finished THEN BEGIN
                                                                      //<<IMH115.ISAT.RC
                                                                      // La facturation au prestataire est declench‚e … la cl“ture de l'intervention pour le service habitat et le diag immo
                                                                      IF NOT "Real Estate Diag."  AND NOT "Home Service"  THEN
                                                                        lSalesInvoicingMgt.CreateSalesOrderFromService(Rec);
                                                                      //>>IMH115.isat.RC

                                                                      //<<IMH115.ISAT.RC
                                                                      //Fonction SendProviderOrderToIMA comment‚
                                                                      //<<IMH87.ISAT.EBA
                                                                      //SendProviderOrderToIMA(TRUE);
                                                                      //>>IMH87.ISAT.EBA
                                                                      //>>IMH115.isat.RC

                                                                      //<<IMH83.ISAT.EBA
                                                                      SendReturnToIMA(FALSE);
                                                                      //>>IMH83.ISAT.EBA

                                                                    END;
                                                                    // ********** gestion des avoirs ******
                                                                    //>>IMH.isat.PC
                                                                  END;

                                                                END;

                                                                {
                                                                ServItemLine.RESET;
                                                                ServItemLine.SETRANGE("Document Type","Document Type");
                                                                ServItemLine.SETRANGE("Document No.","No.");
                                                                IF ServItemLine.FIND('-') THEN
                                                                  REPEAT
                                                                    IF ServItemLine."Repair Status Code" <> '' THEN BEGIN
                                                                      RepairStatus.GET(ServItemLine."Repair Status Code");
                                                                      IF ((Status = Status::Pending) AND NOT RepairStatus."Pending Status Allowed") OR
                                                                         ((Status = Status::"In Process") AND NOT RepairStatus."In Process Status Allowed") OR
                                                                         ((Status = Status::Finished) AND NOT RepairStatus."Finished Status Allowed") OR
                                                                         ((Status = Status::"On Hold") AND NOT RepairStatus."On Hold Status Allowed")
                                                                      THEN
                                                                        ERROR(
                                                                          Text031,
                                                                          FIELDCAPTION(Status),FORMAT(Status),TABLECAPTION,"No.",ServItemLine.FIELDCAPTION("Repair Status Code"),
                                                                          ServItemLine."Repair Status Code",ServItemLine.TABLECAPTION,ServItemLine."Line No.")
                                                                    END;
                                                                  UNTIL ServItemLine.NEXT = 0;

                                                                LinesExist := ServItemLineExists;
                                                                CASE Status OF
                                                                  Status::"In Process":
                                                                    BEGIN
                                                                      IF NOT LinesExist THEN BEGIN
                                                                        "Starting Date" := WORKDATE;
                                                                        VALIDATE("Starting Time",TIME);
                                                                      END ELSE
                                                                        UpdateStartingDateTime;
                                                                    END;
                                                                  Status::Finished:
                                                                    BEGIN
                                                                      TestMandatoryFields(ServLine);
                                                                      IF Status <> xRec.Status THEN BEGIN
                                                                        IF "Notify Customer" = "Notify Customer"::"By E-Mail" THEN BEGIN
                                                                          TESTFIELD("Customer No.");
                                                                          CLEAR(NotifyCust);
                                                                          NotifyCust.RUN(Rec);
                                                                        END;
                                                                      END;
                                                                      IF NOT LinesExist THEN BEGIN
                                                                        IF ("Finishing Date" = 0D) AND ("Finishing Time" = 0T) THEN BEGIN
                                                                          "Finishing Date" := WORKDATE;
                                                                          "Finishing Time" := TIME;
                                                                        END;
                                                                      END ELSE
                                                                        UpdateFinishingDateTime;
                                                                    END;
                                                                END;

                                                                IF Status <> Status::Finished THEN BEGIN
                                                                  "Finishing Date" := 0D;
                                                                  "Finishing Time" := 0T;
                                                                  "Service Time (Hours)" := 0;
                                                                END;

                                                                IF ("Starting Date" <> 0D) AND
                                                                   ("Finishing Date" <> 0D) AND
                                                                   NOT LinesExist
                                                                THEN BEGIN
                                                                  CALCFIELDS("Contract Serv. Hours Exist");
                                                                  "Service Time (Hours)" :=
                                                                    ServOrderMgt.CalcServTime(
                                                                      "Starting Date","Starting Time","Finishing Date","Finishing Time",
                                                                      "Contract No.","Contract Serv. Hours Exist");
                                                                END;
                                                                }
                                                                //>>IMH17
                                                              END;

                                                   CaptionML=[ENU=Status;
                                                              FRA=Statut];
                                                   OptionCaptionML=[ENU=Pending,In Process,Finished,On Hold,,,Cancelled;
                                                                    FRA=Suspendu,En cours,Termin‚,En attente,,,Annul‚];
                                                   OptionString=Pending,In Process,Finished,On Hold,,,Cancelled }
    { 121 ;   ;Invoice Discount Calculation;Option;CaptionML=[ENU=Invoice Discount Calculation;
                                                              FRA=Calcul remise facture];
                                                   OptionCaptionML=[ENU=None,%,Amount;
                                                                    FRA=Aucun,%,Montant];
                                                   OptionString=None,%,Amount;
                                                   Editable=No }
    { 122 ;   ;Invoice Discount Value;Decimal     ;CaptionML=[ENU=Invoice Discount Value;
                                                              FRA=Valeur remise facture];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 5052;   ;Contact No.         ;Code20        ;TableRelation=Contact.No.;
                                                   OnValidate=VAR
                                                                Cont@1000 : Record 5050;
                                                                ContBusinessRelation@1001 : Record 5054;
                                                              BEGIN
                                                                IF ("Contact No." <> xRec."Contact No.") AND
                                                                   (xRec."Contact No." <> '')
                                                                THEN BEGIN
                                                                  //<<IMH02
                                                                  //IF HideValidationDialog THEN
                                                                  IF HideValidationDialog OR ("No." = '') THEN
                                                                  //>>IMH02
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed := CONFIRM(Text005,FALSE,FIELDCAPTION("Contact No."));
                                                                  IF Confirmed THEN BEGIN
                                                                    ServLine.RESET;
                                                                    ServLine.SETRANGE("Document Type","Document Type");
                                                                    ServLine.SETRANGE("Document No.","No.");
                                                                    IF ("Contact No." = '') AND ("Customer No." = '') THEN BEGIN
                                                                      IF NOT ServLine.ISEMPTY THEN
                                                                        ERROR(Text050,FIELDCAPTION("Contact No."));
                                                                      INIT;
                                                                      ServSetup.GET;
                                                                      InitRecord;
                                                                      "No. Series" := xRec."No. Series";
                                                                      IF xRec."Shipping No." <> '' THEN BEGIN
                                                                        "Shipping No. Series" := xRec."Shipping No. Series";
                                                                        "Shipping No." := xRec."Shipping No.";
                                                                      END;
                                                                      IF xRec."Posting No." <> '' THEN BEGIN
                                                                        "Posting No. Series" := xRec."Posting No. Series";
                                                                        "Posting No." := xRec."Posting No.";
                                                                      END;
                                                                      EXIT;
                                                                    END;
                                                                  END ELSE BEGIN
                                                                    Rec := xRec;
                                                                    EXIT;
                                                                  END;
                                                                END;
                                                                IF NOT IsServiceDoc THEN BEGIN //IMH02
                                                                IF ("Customer No." <> '') AND ("Contact No." <> '') THEN BEGIN
                                                                  Cont.GET("Contact No.");
                                                                  ContBusinessRelation.RESET;
                                                                  ContBusinessRelation.SETCURRENTKEY("Link to Table","No.");
                                                                  ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Customer);
                                                                  ContBusinessRelation.SETRANGE("No.","Customer No.");
                                                                  IF ContBusinessRelation.FINDFIRST AND
                                                                     (ContBusinessRelation."Contact No." <> Cont."Company No.")
                                                                  THEN
                                                                    ERROR(Text038,Cont."No.",Cont.Name,"Customer No.");
                                                                END;


                                                                UpdateCust("Contact No.");
                                                                END; //IMH02
                                                                //<<IMH02
                                                                IF Cont.GET("Contact No.") THEN BEGIN
                                                                  Name := Cont.Name;
                                                                  "Name 2" := Cont."Name 2";
                                                                  Address := Cont.Address;
                                                                  "Address 2" := Cont."Address 2";
                                                                  "Address 3" := Cont."Address 3";//IMH75
                                                                  City := Cont.City;
                                                                  "Post Code" := Cont."Post Code";
                                                                  County := Cont.County;
                                                                  "Country/Region Code" := Cont."Country/Region Code";
                                                                  "Geo. Reference Code" := Cont."Geo. Reference Code";
                                                                  "Contact Name" := Cont.Name;
                                                                  "Phone No." := Cont."Phone No.";
                                                                  "E-Mail" := Cont."E-Mail";
                                                                  VALIDATE("Corporate No.",Cont."Corporate No.");
                                                                  "Corporate Region Code" := Cont."Corporate Region Code";
                                                                  "VIP Code" := "VIP Code";
                                                                  VALIDATE("Declaration Contact No.", GetDeclarationContact("Corporate No."));
                                                                //   GetContactContractForm;
                                                                END;
                                                                //>>IMH02
                                                              END;

                                                   CaptionML=[ENU=Contact No.;
                                                              FRA=Nø contact];
                                                   Editable=No }
    { 5053;   ;Bill-to Contact No. ;Code20        ;TableRelation=Contact;
                                                   OnValidate=VAR
                                                                Cont@1001 : Record 5050;
                                                                ContBusinessRelation@1000 : Record 5054;
                                                              BEGIN
                                                                IF ("Bill-to Contact No." <> xRec."Bill-to Contact No.") AND
                                                                   (xRec."Bill-to Contact No." <> '')
                                                                THEN BEGIN
                                                                  IF HideValidationDialog THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed := CONFIRM(Text005,FALSE,FIELDCAPTION("Bill-to Contact No."));
                                                                  IF Confirmed THEN BEGIN
                                                                    ServLine.RESET;
                                                                    ServLine.SETRANGE("Document Type","Document Type");
                                                                    ServLine.SETRANGE("Document No.","No.");
                                                                    IF ("Bill-to Contact No." = '') AND ("Bill-to Customer No." = '') THEN BEGIN
                                                                      IF NOT ServLine.ISEMPTY THEN
                                                                        ERROR(Text050,FIELDCAPTION("Bill-to Contact No."));
                                                                      INIT;
                                                                      ServSetup.GET;
                                                                      InitRecord;
                                                                      "No. Series" := xRec."No. Series";
                                                                      IF xRec."Shipping No." <> '' THEN BEGIN
                                                                        "Shipping No. Series" := xRec."Shipping No. Series";
                                                                        "Shipping No." := xRec."Shipping No.";
                                                                      END;
                                                                      IF xRec."Posting No." <> '' THEN BEGIN
                                                                        "Posting No. Series" := xRec."Posting No. Series";
                                                                        "Posting No." := xRec."Posting No.";
                                                                      END;
                                                                      EXIT;
                                                                    END;
                                                                  END ELSE BEGIN
                                                                    "Bill-to Contact No." := xRec."Bill-to Contact No.";
                                                                    EXIT;
                                                                  END;
                                                                END;

                                                                IF ("Bill-to Customer No." <> '') AND ("Bill-to Contact No." <> '') THEN BEGIN
                                                                  Cont.GET("Bill-to Contact No.");
                                                                  ContBusinessRelation.RESET;
                                                                  ContBusinessRelation.SETCURRENTKEY("Link to Table","No.");
                                                                  ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Customer);
                                                                  ContBusinessRelation.SETRANGE("No.","Bill-to Customer No.");
                                                                  IF ContBusinessRelation.FINDFIRST AND
                                                                     (ContBusinessRelation."Contact No." <> Cont."Company No.")
                                                                  THEN
                                                                    ERROR(Text038,Cont."No.",Cont.Name,"Bill-to Customer No.");
                                                                END;

                                                                UpdateBillToCust("Bill-to Contact No.");
                                                              END;

                                                   OnLookup=VAR
                                                              Cont@1001 : Record 5050;
                                                              ContBusinessRelation@1000 : Record 5054;
                                                            BEGIN
                                                              IF "Bill-to Customer No." <> '' THEN BEGIN
                                                                IF Cont.GET("Bill-to Contact No.") THEN
                                                                  Cont.SETRANGE("Company No.",Cont."Company No.")
                                                                ELSE BEGIN
                                                                  ContBusinessRelation.RESET;
                                                                  ContBusinessRelation.SETCURRENTKEY("Link to Table","No.");
                                                                  ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Customer);
                                                                  ContBusinessRelation.SETRANGE("No.","Bill-to Customer No.");
                                                                  IF ContBusinessRelation.FINDFIRST THEN
                                                                    Cont.SETRANGE("Company No.",ContBusinessRelation."Contact No.")
                                                                  ELSE
                                                                    Cont.SETRANGE("No.",'');
                                                                END;
                                                              END;

                                                              IF "Bill-to Contact No." <> '' THEN
                                                                IF Cont.GET("Bill-to Contact No.") THEN ;
                                                              IF FORM.RUNMODAL(0,Cont) = ACTION::LookupOK THEN BEGIN
                                                                xRec := Rec;
                                                                VALIDATE("Bill-to Contact No.",Cont."No.");
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Bill-to Contact No.;
                                                              FRA=Nø contact facturation] }
    { 5700;   ;Responsibility Center;Code10       ;TableRelation="Responsibility Center";
                                                   OnValidate=VAR
                                                                RespCenter@1000 : Record 5714;
                                                              BEGIN
                                                                IF NOT UserMgt.CheckRespCenter(2,"Responsibility Center") THEN
                                                                  ERROR(
                                                                    Text010,
                                                                    RespCenter.TABLECAPTION,UserMgt.GetServiceFilter);

                                                                UpdateShipToAddress;

                                                                CreateDim(
                                                                  DATABASE::"Responsibility Center","Responsibility Center",
                                                                  DATABASE::Customer,"Bill-to Customer No.",
                                                                  DATABASE::"Salesperson/Purchaser","Salesperson Code",
                                                                  DATABASE::"Service Order Type","Service Order Type",
                                                                  DATABASE::"Service Contract Header","Contract No.");

                                                                ServItemLine.RESET;
                                                                ServItemLine.SETRANGE("Document Type","Document Type");
                                                                ServItemLine.SETRANGE("Document No.","No.");
                                                                IF ServItemLine.FIND('-') THEN
                                                                  REPEAT
                                                                    ServItemLine.VALIDATE("Responsibility Center","Responsibility Center");
                                                                    ServItemLine.MODIFY(TRUE);
                                                                  UNTIL ServItemLine.NEXT = 0;

                                                                IF xRec."Responsibility Center" <> "Responsibility Center" THEN BEGIN
                                                                  RecreateServLines(FIELDCAPTION("Responsibility Center"));
                                                                  VALIDATE("Location Code",UserMgt.GetLocation(2,'',"Responsibility Center"));
                                                                  "Assigned User ID" := '';
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Responsibility Center;
                                                              FRA=Centre de gestion] }
    { 5750;   ;Shipping Advice     ;Option        ;CaptionML=[ENU=Shipping Advice;
                                                              FRA=Option d'exp‚dition];
                                                   OptionCaptionML=[ENU=Partial,Complete;
                                                                    FRA=Partielle,Totale];
                                                   OptionString=Partial,Complete }
    { 5752;   ;Completely Shipped  ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Min("Service Line"."Completely Shipped" WHERE (Document Type=FIELD(Document Type),
                                                                                                              Document No.=FIELD(No.),
                                                                                                              Type=FILTER(<>' ')));
                                                   CaptionML=[ENU=Completely Shipped;
                                                              FRA=EntiŠrement exp‚di‚e];
                                                   Editable=No }
    { 5796;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              FRA=Filtre date] }
    { 5902;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              FRA=D‚signation] }
    { 5904;   ;Service Order Type  ;Code10        ;TableRelation="Service Order Type";
                                                   OnValidate=VAR
                                                                lProductCatalog@1100281000 : Record 50060;
                                                                lContract@1100281002 : Record 50059;
                                                                lRecRef@1100281004 : RecordRef;
                                                                lFieldRef@1100281003 : FieldRef;
                                                                lBool@1100281005 : Boolean;
                                                              BEGIN
                                                                IF GetServOrderType THEN BEGIN
                                                                  IF NOT ServOrderType."Quality Control" THEN BEGIN
                                                                    //<<IMH06.ST
                                                                    TESTFIELD("Corporate No.");
                                                                    IF lProductCatalog.GET("Corporate No.", "Service Order Type") THEN BEGIN
                                                                      lProductCatalog.TESTFIELD(Active, TRUE);
                                                                      VALIDATE("Corporate Declaration", lProductCatalog."Corporate Declaration");
                                                                      //"Intervention Ceiling" := lProductCatalog."Intervention Ceiling";//IMH22//IMH24
                                                                    //  UpdateFromServiceQuoteExcep;
                                                                    //>>IMH06.ST
                                                                    //<<IMH07
                                                                    END;
                                                                  END;
                                                                  "Home Service" := ServOrderType."Home Service";
                                                                  Claim := ServOrderType.Claim;
                                                                //<<IMH91.ISAT.SB
                                                                  "Real Estate Diag." := ServOrderType."Init. Diag. Elmts Table";
                                                                //>>IMH91.ISAT.SB
                                                                  "Quote Managment" := ServOrderType."Quote Management";//IMH25
                                                                  "Intervention Allowed" := NOT ServOrderType."Complete Service Control";//IMH19
                                                                //<<IMH20.ST
                                                                  IF (ServOrderType."Contract Condition Field No." <> 0) AND (NOT SkipCheck) THEN BEGIN //IMH43.ST
                                                                    IF NOT lContract.GET("Contact No.", "Corporate No.", "Contract Form Code", "Contract Occurence No.") THEN
                                                                      ERROR(Text50001);
                                                                    lRecRef.GETTABLE(lContract);
                                                                    lFieldRef := lRecRef.FIELD(ServOrderType."Contract Condition Field No.");
                                                                    lBool := lFieldRef.VALUE;
                                                                    IF lBool = FALSE THEN
                                                                      ERROR(Text50002, lFieldRef.CAPTION);
                                                                  END;
                                                                //>>IMH20.ST
                                                                  //<<IMH27
                                                                  //<<IMH37
                                                                    //IF lServiceOrderType."Service Card Form ID" = PAGE::"Service Header Assistance Card" THEN
                                                                    //Urgent := Urgent::Yes;
                                                                  //>>IMH37
                                                                  //>>IMH27
                                                                  //<<IMH035
                                                                  IF Channel = '' THEN
                                                                    Channel := ServOrderType."Default Channel";
                                                                  IF Requisitioner = '' THEN
                                                                    Requisitioner := ServOrderType."Default Requisitioner";
                                                                  //>>IMH035
                                                                  IF ("Provider No." = '') AND (ServOrderType."Provider No." <> '') THEN
                                                                    VALIDATE("Provider No.", ServOrderType."Provider No.");
                                                                END;
                                                                //>>IMH07

                                                                CreateDim(
                                                                  DATABASE::"Service Order Type","Service Order Type",
                                                                  DATABASE::Customer,"Bill-to Customer No.",
                                                                  DATABASE::"Salesperson/Purchaser","Salesperson Code",
                                                                  DATABASE::"Responsibility Center","Responsibility Center",
                                                                  DATABASE::"Service Contract Header","Contract No.");
                                                              END;

                                                   CaptionML=[ENU=Service Order Type;
                                                              FRA=Type produit];
                                                   NotBlank=Yes }
    { 5905;   ;Link Service to Service Item;Boolean;
                                                   OnValidate=BEGIN
                                                                IF "Link Service to Service Item" <> xRec."Link Service to Service Item" THEN BEGIN
                                                                  ServLine.RESET;
                                                                  ServLine.SETRANGE("Document Type","Document Type");
                                                                  ServLine.SETRANGE("Document No.","No.");
                                                                  ServLine.SETFILTER(Type,'<>%1',ServLine.Type::Cost);
                                                                  IF ServLine.FIND('-') THEN
                                                                    MESSAGE(
                                                                      Text001 +
                                                                      Text022,
                                                                      FIELDCAPTION("Link Service to Service Item"),TABLECAPTION,"No.");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Link Service to Service Item;
                                                              FRA=Lier service … article de service] }
    { 5907;   ;Priority            ;Option        ;CaptionML=[ENU=Priority;
                                                              FRA=Priorit‚];
                                                   OptionCaptionML=[ENU=Low,Medium,High;
                                                                    FRA=Faible,Moyenne,Haute];
                                                   OptionString=Low,Medium,High;
                                                   Editable=No }
    { 5911;   ;Allocated Hours     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Service Order Allocation"."Allocated Hours" WHERE (Document Type=FIELD(Document Type),
                                                                                                                       Document No.=FIELD(No.),
                                                                                                                       Allocation Date=FIELD(Date Filter),
                                                                                                                       Resource No.=FIELD(Resource Filter),
                                                                                                                       Status=FILTER(Active|Finished),
                                                                                                                       Resource Group No.=FIELD(Resource Group Filter)));
                                                   CaptionML=[ENU=Allocated Hours;
                                                              FRA=Heures affect‚es];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5915;   ;Phone No.           ;Text30        ;OnValidate=VAR
                                                                lPhoneStandardization@1100281000 : Codeunit 50099;
                                                              BEGIN
                                                                //<<IMH01
                                                                lPhoneStandardization.ValidatePhoneNo(DATABASE::"Service Header",5915,"Country/Region Code","Phone No.");
                                                                //>>IMH01
                                                              END;

                                                   ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Phone No.;
                                                              FRA=Nø t‚l‚phone];
                                                   Editable=No }
    { 5916;   ;E-Mail              ;Text80        ;OnValidate=VAR
                                                                lEmailStandardization@1100281000 : Codeunit 50096;
                                                              BEGIN
                                                                lEmailStandardization.ValidateEmail("E-Mail"); //IMH30
                                                              END;

                                                   ExtendedDatatype=E-Mail;
                                                   CaptionML=[ENU=E-Mail;
                                                              FRA=E-mail] }
    { 5917;   ;Phone No. 2         ;Text30        ;OnValidate=VAR
                                                                lPhoneStandardization@1100281000 : Codeunit 50099;
                                                              BEGIN
                                                                //<<IMH01
                                                                lPhoneStandardization.ValidatePhoneNo(DATABASE::"Service Header",5917,"Country/Region Code","Phone No. 2");
                                                                //>>IMH01
                                                              END;

                                                   ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Phone No. 2;
                                                              FRA=Nø t‚l‚phone 2] }
    { 5918;   ;Fax No.             ;Text30        ;OnValidate=VAR
                                                                lPhoneStandardization@1100281000 : Codeunit 50099;
                                                              BEGIN
                                                                //<<IMH01
                                                                lPhoneStandardization.ValidatePhoneNo(DATABASE::"Service Header",5918,"Country/Region Code","Fax No.");
                                                                //>>IMH01
                                                              END;

                                                   CaptionML=[ENU=Fax No.;
                                                              FRA=Nø t‚l‚copie] }
    { 5921;   ;No. of Unallocated Items;Integer   ;FieldClass=FlowField;
                                                   CalcFormula=Count("Service Item Line" WHERE (Document Type=FIELD(Document Type),
                                                                                                Document No.=FIELD(No.),
                                                                                                No. of Active/Finished Allocs=CONST(0)));
                                                   CaptionML=[ENU=No. of Unallocated Items;
                                                              FRA=Nbre articles non affect‚s];
                                                   Editable=No }
    { 5923;   ;Order Time          ;Time          ;OnValidate=BEGIN
                                                                IF "Order Time" <> xRec."Order Time" THEN BEGIN
                                                                  IF ("Order Time" > "Starting Time") AND
                                                                     ("Starting Time" <> 0T) AND
                                                                     ("Order Date" = "Starting Date")
                                                                  THEN
                                                                    ERROR(Text007,FIELDCAPTION("Order Time"),FIELDCAPTION("Starting Time"));
                                                                  IF "Starting Time" <> 0T THEN
                                                                    VALIDATE("Starting Time");
                                                                  ServItemLine.RESET;
                                                                  ServItemLine.SETRANGE("Document Type","Document Type");
                                                                  ServItemLine.SETRANGE("Document No.","No.");
                                                                  IF ServItemLine.FIND('-') THEN
                                                                    REPEAT
                                                                      ServItemLine.CalculateResponseDateTime("Order Date","Order Time");
                                                                      ServItemLine.MODIFY;
                                                                    UNTIL ServItemLine.NEXT = 0;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Order Time;
                                                              FRA=Heure commande];
                                                   NotBlank=Yes }
    { 5924;   ;Default Response Time (Hours);Decimal;
                                                   CaptionML=[ENU=Default Response Time (Hours);
                                                              FRA=D‚lai de r‚ponse par d‚f. (heures)];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 5925;   ;Actual Response Time (Hours);Decimal;
                                                   CaptionML=[ENU=Actual Response Time (Hours);
                                                              FRA=D‚lai de r‚ponse r‚el (heures)];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   Editable=No }
    { 5926;   ;Service Time (Hours);Decimal       ;CaptionML=[ENU=Service Time (Hours);
                                                              FRA=Temps de service (heures)];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 5927;   ;Response Date       ;Date          ;OnValidate=BEGIN
                                                                //"Response Time" := "Response Date" -  //IMH17
                                                              END;

                                                   CaptionML=[ENU=Response Date;
                                                              FRA=Date de r‚ponse];
                                                   Editable=No }
    { 5928;   ;Response Time       ;Time          ;CaptionML=[ENU=Response Time;
                                                              FRA=D‚lai de r‚ponse];
                                                   Editable=No }
    { 5929;   ;Starting Date       ;Date          ;OnValidate=BEGIN
                                                                IF "Starting Date" <> 0D THEN BEGIN
                                                                  IF "Starting Date" < "Order Date" THEN
                                                                    ERROR(Text026,FIELDCAPTION("Starting Date"),FIELDCAPTION("Order Date"));

                                                                  IF ("Starting Date" > "Finishing Date") AND
                                                                     ("Finishing Date" <> 0D)
                                                                  THEN
                                                                    ERROR(Text007,FIELDCAPTION("Starting Date"),FIELDCAPTION("Finishing Time"));

                                                                  ServItemLine.RESET;
                                                                  ServItemLine.SETCURRENTKEY("Document Type","Document No.","Starting Date");
                                                                  ServItemLine.SETRANGE("Document Type","Document Type");
                                                                  ServItemLine.SETRANGE("Document No.","No.");
                                                                  ServItemLine.SETFILTER("Starting Date",'<>%1',0D);
                                                                  IF ServItemLine.FIND('-') THEN
                                                                    REPEAT
                                                                      IF ServItemLine."Starting Date" < "Starting Date" THEN
                                                                        ERROR(Text024,FIELDCAPTION("Starting Date"));
                                                                    UNTIL ServItemLine.NEXT = 0;

                                                                  IF TIME < "Order Time" THEN
                                                                    VALIDATE("Starting Time","Order Time")
                                                                  ELSE
                                                                    VALIDATE("Starting Time",TIME);
                                                                END ELSE BEGIN
                                                                  "Starting Time" := 0T;
                                                                  "Actual Response Time (Hours)" := 0;
                                                                  "Finishing Date" := 0D;
                                                                  "Finishing Time" := 0T;
                                                                  "Service Time (Hours)" := 0;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Starting Date;
                                                              FRA=Date d‚but] }
    { 5930;   ;Starting Time       ;Time          ;OnValidate=BEGIN
                                                                TESTFIELD("Starting Date");

                                                                IF ("Starting Date" = "Finishing Date") AND
                                                                   ("Starting Time" > "Finishing Time")
                                                                THEN
                                                                  ERROR(Text007,FIELDCAPTION("Starting Time"),FIELDCAPTION("Finishing Time"));

                                                                IF ("Starting Date" = "Order Date") AND
                                                                   ("Starting Time" < "Order Time")
                                                                THEN
                                                                  ERROR(Text026,FIELDCAPTION("Starting Time"),FIELDCAPTION("Order Time"));

                                                                IF ("Starting Time" = 0T) AND (xRec."Starting Time" <> 0T) THEN BEGIN
                                                                  "Finishing Time" := 0T;
                                                                  "Finishing Date" := 0D;
                                                                  "Service Time (Hours)" := 0;
                                                                END;

                                                                IF ("Starting Time" <> 0T) AND
                                                                   ("Starting Date" <> 0D)
                                                                THEN BEGIN
                                                                  CALCFIELDS("Contract Serv. Hours Exist");
                                                                  "Actual Response Time (Hours)" :=
                                                                    ServOrderMgt.CalcServTime(
                                                                      "Order Date","Order Time","Starting Date","Starting Time",
                                                                      "Contract No.","Contract Serv. Hours Exist");
                                                                END ELSE
                                                                  "Actual Response Time (Hours)" := 0;
                                                                IF "Finishing Time" <> 0T THEN
                                                                  VALIDATE("Finishing Time");
                                                              END;

                                                   CaptionML=[ENU=Starting Time;
                                                              FRA=Heure d‚but] }
    { 5931;   ;Finishing Date      ;Date          ;OnValidate=BEGIN
                                                                IF "Finishing Date" <> 0D THEN BEGIN
                                                                  IF "Finishing Date" < "Starting Date" THEN
                                                                    ERROR(Text026,FIELDCAPTION("Finishing Date"),FIELDCAPTION("Starting Date"));

                                                                  IF "Finishing Date" < "Order Date" THEN
                                                                    ERROR(
                                                                      Text026,
                                                                      FIELDCAPTION("Finishing Date"),
                                                                      FIELDCAPTION("Order Date"));

                                                                  IF "Starting Date" = 0D THEN BEGIN
                                                                    "Starting Date" := "Finishing Date";
                                                                    "Starting Time" := TIME;
                                                                    CALCFIELDS("Contract Serv. Hours Exist");
                                                                    "Actual Response Time (Hours)" :=
                                                                      ServOrderMgt.CalcServTime(
                                                                        "Order Date","Order Time","Starting Date","Starting Time",
                                                                        "Contract No.","Contract Serv. Hours Exist");
                                                                  END;

                                                                  IF "Finishing Date" <> xRec."Finishing Date" THEN BEGIN
                                                                    IF TIME < "Starting Time" THEN
                                                                      "Finishing Time" := "Starting Time"
                                                                    ELSE
                                                                      "Finishing Time" := TIME;
                                                                    VALIDATE("Finishing Time");
                                                                  END;

                                                                  ServItemLine.RESET;
                                                                  ServItemLine.SETCURRENTKEY("Document Type","Document No.","Finishing Date");
                                                                  ServItemLine.SETRANGE("Document Type","Document Type");
                                                                  ServItemLine.SETRANGE("Document No.","No.");
                                                                  ServItemLine.SETFILTER("Finishing Date",'<>%1',0D);
                                                                  IF ServItemLine.FIND('-') THEN
                                                                    REPEAT
                                                                      IF ServItemLine."Finishing Date" > "Finishing Date" THEN
                                                                        ERROR(Text025,FIELDCAPTION("Finishing Date"));
                                                                    UNTIL ServItemLine.NEXT = 0;
                                                                END ELSE BEGIN
                                                                  "Finishing Time" := 0T;
                                                                  "Service Time (Hours)" := 0;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Finishing Date;
                                                              FRA=Date fin] }
    { 5932;   ;Finishing Time      ;Time          ;OnValidate=BEGIN
                                                                TESTFIELD("Finishing Date");
                                                                IF "Finishing Time" <> 0T THEN BEGIN
                                                                  IF ("Starting Date" = "Finishing Date") AND
                                                                     ("Finishing Time" < "Starting Time")
                                                                  THEN
                                                                    ERROR(
                                                                      Text026,FIELDCAPTION("Finishing Time"),
                                                                      FIELDCAPTION("Starting Time"));

                                                                  IF ("Finishing Date" = "Order Date") AND
                                                                     ("Finishing Time" < "Order Time")
                                                                  THEN
                                                                    ERROR(
                                                                      Text026,FIELDCAPTION("Finishing Time"),
                                                                      FIELDCAPTION("Order Time"));

                                                                  ServItemLine.RESET;
                                                                  ServItemLine.SETCURRENTKEY("Document Type","Document No.","Finishing Date");
                                                                  ServItemLine.SETRANGE("Document Type","Document Type");
                                                                  ServItemLine.SETRANGE("Document No.","No.");
                                                                  ServItemLine.SETFILTER("Finishing Date",'<>%1',0D);
                                                                  IF ServItemLine.FIND('-') THEN
                                                                    REPEAT
                                                                      IF (ServItemLine."Finishing Date" = "Finishing Date") AND
                                                                         (ServItemLine."Finishing Time" > "Finishing Time")
                                                                      THEN
                                                                        ERROR(Text025,FIELDCAPTION("Finishing Time"));
                                                                    UNTIL ServItemLine.NEXT = 0;

                                                                  CALCFIELDS("Contract Serv. Hours Exist");
                                                                  "Service Time (Hours)" :=
                                                                    ServOrderMgt.CalcServTime(
                                                                      "Starting Date","Starting Time","Finishing Date","Finishing Time",
                                                                      "Contract No.","Contract Serv. Hours Exist");
                                                                END ELSE
                                                                  "Service Time (Hours)" := 0;
                                                              END;

                                                   CaptionML=[ENU=Finishing Time;
                                                              FRA=Heure fin] }
    { 5933;   ;Contract Serv. Hours Exist;Boolean ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Service Hour" WHERE (Service Contract No.=FIELD(Contract No.)));
                                                   CaptionML=[ENU=Contract Serv. Hours Exist;
                                                              FRA=Heures contrat de service d‚finies];
                                                   Editable=No }
    { 5934;   ;Reallocation Needed ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Service Order Allocation" WHERE (Status=CONST(Reallocation Needed),
                                                                                                       Resource No.=FIELD(Resource Filter),
                                                                                                       Document Type=FIELD(Document Type),
                                                                                                       Document No.=FIELD(No.),
                                                                                                       Resource Group No.=FIELD(Resource Group Filter)));
                                                   CaptionML=[ENU=Reallocation Needed;
                                                              FRA=R‚affectation n‚cessaire];
                                                   Editable=No }
    { 5936;   ;Notify Customer     ;Option        ;CaptionML=[ENU=Notify Customer;
                                                              FRA=Informer client];
                                                   OptionCaptionML=[ENU=No,By Phone 1,By Phone 2,By Fax,By E-Mail;
                                                                    FRA=Non,Par t‚l‚phone 1,Par t‚l‚phone 2,Par t‚l‚copie,Par e-mail];
                                                   OptionString=No,By Phone 1,By Phone 2,By Fax,By E-Mail }
    { 5937;   ;Max. Labor Unit Price;Decimal      ;OnValidate=BEGIN
                                                                IF ServLineExists THEN
                                                                  MESSAGE(
                                                                    Text001 +
                                                                    Text022,
                                                                    FIELDCAPTION("Max. Labor Unit Price"),TABLECAPTION,"No.",
                                                                    ServLine.TABLECAPTION);
                                                              END;

                                                   CaptionML=[ENU=Max. Labor Unit Price;
                                                              FRA=Prix unitaire max. M.O.];
                                                   BlankZero=Yes;
                                                   AutoFormatType=2;
                                                   AutoFormatExpr="Currency Code" }
    { 5938;   ;Warning Status      ;Option        ;CaptionML=[ENU=Warning Status;
                                                              FRA=Statut alerte];
                                                   OptionCaptionML=[ENU=" ,First Warning,Second Warning,Third Warning";
                                                                    FRA=" ,PremiŠre alerte,DeuxiŠme alerte,TroisiŠme alerte"];
                                                   OptionString=[ ,First Warning,Second Warning,Third Warning] }
    { 5939;   ;No. of Allocations  ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Service Order Allocation" WHERE (Document Type=FIELD(Document Type),
                                                                                                       Document No.=FIELD(No.),
                                                                                                       Resource No.=FIELD(Resource Filter),
                                                                                                       Resource Group No.=FIELD(Resource Group Filter),
                                                                                                       Allocation Date=FIELD(Date Filter),
                                                                                                       Status=FILTER(Active|Finished)));
                                                   CaptionML=[ENU=No. of Allocations;
                                                              FRA=Nbre affectations];
                                                   Editable=No }
    { 5940;   ;Contract No.        ;Code20        ;TableRelation="Service Contract Header"."Contract No." WHERE (Contract Type=CONST(Contract),
                                                                                                                 Customer No.=FIELD(Customer No.),
                                                                                                                 Ship-to Code=FIELD(Ship-to Code),
                                                                                                                 Bill-to Customer No.=FIELD(Bill-to Customer No.));
                                                   OnValidate=BEGIN
                                                                IF "Contract No." <> xRec."Contract No." THEN BEGIN
                                                                  IF "Contract No." <> '' THEN BEGIN
                                                                    TESTFIELD("Order Date");
                                                                    ServContract.GET(ServContract."Contract Type"::Contract,"Contract No.");
                                                                    IF ServContract.Status <> ServContract.Status::Signed THEN
                                                                      ERROR(Text041,"Contract No.");
                                                                    IF ServContract."Starting Date" > "Order Date" THEN
                                                                      ERROR(Text042,"Contract No.");
                                                                    IF (ServContract."Expiration Date" <> 0D) AND
                                                                       (ServContract."Expiration Date" <= "Order Date")
                                                                    THEN
                                                                      ERROR(Text043,"Contract No.");
                                                                  END;
                                                                  ServItemLine.RESET;
                                                                  ServItemLine.SETRANGE("Document Type","Document Type");
                                                                  ServItemLine.SETRANGE("Document No.","No.");
                                                                  IF ServItemLine.FIND('-') THEN
                                                                    ERROR(Text028,
                                                                      FIELDCAPTION("Contract No."),ServItemLine.TABLECAPTION);
                                                                  IF NOT
                                                                     CONFIRM(
                                                                       Text029 + Text030,
                                                                       FALSE,ServContractLine.FIELDCAPTION("Next Planned Service Date"),
                                                                       ServContractLine.TABLECAPTION,
                                                                       FIELDCAPTION("Contract No."))
                                                                  THEN BEGIN
                                                                    "Contract No." := xRec."Contract No.";
                                                                    EXIT;
                                                                  END;

                                                                  IF "Contract No." <> '' THEN BEGIN
                                                                    TESTFIELD("Customer No.");
                                                                    TESTFIELD("Bill-to Customer No.");
                                                                    "Default Response Time (Hours)" := ServContract."Response Time (Hours)";
                                                                    TESTFIELD("Ship-to Code",ServContract."Ship-to Code");
                                                                    "Service Order Type" := ServContract."Service Order Type";
                                                                    VALIDATE("Currency Code",ServContract."Currency Code");
                                                                    "Max. Labor Unit Price" := ServContract."Max. Labor Unit Price";
                                                                    "Your Reference" := ServContract."Your Reference";
                                                                    "Service Zone Code" := ServContract."Service Zone Code";
                                                                  END;

                                                                END;

                                                                IF "Contract No." <> '' THEN
                                                                  CreateDim(
                                                                    DATABASE::"Service Contract Header","Contract No.",
                                                                    DATABASE::"Service Order Type","Service Order Type",
                                                                    DATABASE::Customer,"Bill-to Customer No.",
                                                                    DATABASE::"Salesperson/Purchaser","Salesperson Code",
                                                                    DATABASE::"Responsibility Center","Responsibility Center");
                                                              END;

                                                   OnLookup=BEGIN
                                                              IF "Contract No." <> '' THEN BEGIN
                                                                IF ServContract.GET(ServContract."Contract Type"::Contract,"Contract No.") THEN
                                                                  ServContractList.SETRECORD(ServContract);
                                                              END;

                                                              ServContract.RESET;
                                                              ServContract.FILTERGROUP(2);
                                                              ServContract.SETCURRENTKEY("Customer No.","Ship-to Code");
                                                              ServContract.SETRANGE("Customer No.","Customer No.");
                                                              ServContract.SETRANGE("Ship-to Code","Ship-to Code");
                                                              ServContract.SETRANGE("Contract Type",ServContract."Contract Type"::Contract);
                                                              ServContract.SETRANGE("Bill-to Customer No.","Bill-to Customer No.");
                                                              ServContract.SETRANGE(Status,ServContract.Status::Signed);
                                                              ServContract.SETFILTER("Starting Date",'<=%1',"Order Date");
                                                              ServContract.SETFILTER("Expiration Date",'>%1 | =%2',"Order Date",0D);
                                                              ServContract.FILTERGROUP(0);
                                                              CLEAR(ServContractList);
                                                              ServContractList.SETTABLEVIEW(ServContract);
                                                              ServContractList.LOOKUPMODE(TRUE);
                                                              IF ServContractList.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                                                ServContractList.GETRECORD(ServContract);
                                                                VALIDATE("Contract No.",ServContract."Contract No.");
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Contract No.;
                                                              FRA=Nø contrat] }
    { 5951;   ;Type Filter         ;Option        ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Type Filter;
                                                              FRA=Filtre type];
                                                   OptionCaptionML=[ENU=" ,Resource,Item,Service Cost,Service Contract";
                                                                    FRA=" ,Ressource,Article,Co–t service,Contrat de service"];
                                                   OptionString=[ ,Resource,Item,Service Cost,Service Contract] }
    { 5952;   ;Customer Filter     ;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation=Customer.No.;
                                                   CaptionML=[ENU=Customer Filter;
                                                              FRA=Filtre client] }
    { 5953;   ;Resource Filter     ;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation=Resource;
                                                   CaptionML=[ENU=Resource Filter;
                                                              FRA=Filtre ressource] }
    { 5954;   ;Contract Filter     ;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation="Service Contract Header"."Contract No." WHERE (Contract Type=CONST(Contract));
                                                   CaptionML=[ENU=Contract Filter;
                                                              FRA=Filtre contrat] }
    { 5955;   ;Ship-to Fax No.     ;Text30        ;CaptionML=[ENU=Ship-to Fax No.;
                                                              FRA=Nø t‚l‚copie destinataire MEO] }
    { 5956;   ;Ship-to E-Mail      ;Text80        ;OnValidate=VAR
                                                                lEmailStandardization@1100281000 : Codeunit 50096;
                                                              BEGIN
                                                                //<<IMH134
                                                                //lEmailStandardization.ValidateEmail("E-Mail"); //IMH30
                                                                lEmailStandardization.ValidateEmail("Ship-to E-Mail");
                                                                //>>IMH134
                                                                //<<IMH76.PC
                                                                //CommentNotificationMgt.CreateNotifFromServHeader(Rec,xRec);
                                                                //>>IMH76.PC
                                                              END;

                                                   ExtendedDatatype=E-Mail;
                                                   CaptionML=[ENU=Ship-to E-Mail;
                                                              FRA=E-mail destinataire MEO] }
    { 5957;   ;Resource Group Filter;Code20       ;FieldClass=FlowFilter;
                                                   TableRelation="Resource Group";
                                                   CaptionML=[ENU=Resource Group Filter;
                                                              FRA=Filtre gpe ressources] }
    { 5958;   ;Ship-to Phone       ;Text30        ;OnValidate=VAR
                                                                lPhoneStandardization@1100281000 : Codeunit 50099;
                                                                lIntervention@1100281001 : Record 50075;
                                                              BEGIN
                                                                //<<IMH01
                                                                lPhoneStandardization.ValidatePhoneNo(DATABASE::"Service Header",5958,"Country/Region Code","Ship-to Phone");
                                                                //>>IMH01
                                                                //<<IMH73.ST
                                                                lIntervention.SETRANGE("Service Header No.", "No.");
                                                                IF lIntervention.FINDSET THEN
                                                                  REPEAT
                                                                    IF lIntervention."Phone No." <> "Ship-to Phone" THEN BEGIN
                                                                      lIntervention."Phone No." := "Ship-to Phone";
                                                                      lIntervention.MODIFY(FALSE);
                                                                    END;
                                                                  UNTIL lIntervention.NEXT = 0;
                                                                //>>IMH73.ST

                                                                //<<IMH76.PC
                                                                CommentNotificationMgt.CreateNotifFromServHeader(Rec,xRec);
                                                                //>>IMH76.PC
                                                              END;

                                                   ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Ship-to Phone;
                                                              FRA=T‚l. destinataire MEO] }
    { 5959;   ;Ship-to Phone 2     ;Text30        ;OnValidate=VAR
                                                                lPhoneStandardization@1100281000 : Codeunit 50099;
                                                              BEGIN
                                                                //<<IMH01
                                                                lPhoneStandardization.ValidatePhoneNo(DATABASE::"Service Header",5959,"Country/Region Code","Ship-to Phone 2");
                                                                //>>IMH01
                                                              END;

                                                   ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Ship-to Phone 2;
                                                              FRA=T‚l. 2 destinataire MEO] }
    { 5966;   ;Service Zone Filter ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation="Service Zone".Code;
                                                   CaptionML=[ENU=Service Zone Filter;
                                                              FRA=Filtre zone service] }
    { 5968;   ;Service Zone Code   ;Code10        ;TableRelation="Service Zone".Code;
                                                   OnValidate=BEGIN
                                                                IF ShiptoAddr.GET("Customer No.","Ship-to Code") THEN
                                                                  "Service Zone Code" := ShiptoAddr."Service Zone Code"
                                                                ELSE
                                                                  IF Cust.GET("Customer No.") THEN
                                                                    "Service Zone Code" := Cust."Service Zone Code"
                                                                  ELSE
                                                                    "Service Zone Code" := '';
                                                              END;

                                                   CaptionML=[ENU=Service Zone Code;
                                                              FRA=Code zone service];
                                                   Editable=No }
    { 5981;   ;Expected Finishing Date;Date       ;CaptionML=[ENU=Expected Finishing Date;
                                                              FRA=Date fin pr‚vue] }
    { 7001;   ;Allow Line Disc.    ;Boolean       ;OnValidate=BEGIN
                                                                MessageIfServLinesExist(FIELDCAPTION("Allow Line Disc."));
                                                              END;

                                                   CaptionML=[ENU=Allow Line Disc.;
                                                              FRA=Autoriser remise ligne] }
    { 9000;   ;Assigned User ID    ;Code20        ;TableRelation="User Setup";
                                                   OnValidate=BEGIN
                                                                IF NOT UserMgt.CheckRespCenter2(2,"Responsibility Center","Assigned User ID") THEN
                                                                  ERROR(
                                                                    Text060,"Assigned User ID",
                                                                    RespCenter.TABLECAPTION,UserMgt.GetServiceFilter2("Assigned User ID"));
                                                              END;

                                                   CaptionML=[ENU=Assigned User ID;
                                                              FRA=Code utilisateur affect‚] }
    { 50000;  ;Service No.         ;Code20        ;TableRelation=Service."Service No.";
                                                   OnValidate=BEGIN
                                                                //<<IMH02
                                                                //IF "No." <> '' THEN
                                                                GetService;
                                                                //>>IMH02
                                                              END;

                                                   CaptionML=[ENU=Service  No.;
                                                              FRA=Nø service];
                                                   Editable=No }
    { 50001;  ;Member No.          ;Code20        ;OnValidate=VAR
                                                                lContact@1100281000 : Record 5050;
                                                              BEGIN
                                                              END;

                                                   CaptionML=[ENU=Member No.;
                                                              FRA=Nø b‚n‚ficiaire];
                                                   Editable=No }
    { 50002;  ;Reference No.       ;Code30        ;CaptionML=[ENU=Reference No.;
                                                              FRA=Nø ‚vŠnement];
                                                   Editable=No }
    { 50003;  ;Open File No.       ;Code20        ;CaptionML=[ENU=Open File No.;
                                                              FRA=Nø de dossier t‚l‚ chiffrage] }
    { 50004;  ;Intervention Allowed;Boolean       ;CaptionML=[ENU=Intervention Allowed;
                                                              FRA=Intervention autoris‚e] }
    { 50005;  ;Appropriate Deductible Amount;Option;
                                                   CaptionML=[ENU=Appropriate Deductible Amount;
                                                              FRA=Franchise … pr‚lever];
                                                   OptionCaptionML=[ENU=" ,No Deductible,Other,Deductible 1,Deductible 2";
                                                                    FRA=" ,Absence de franchise,Autre,Franchise,Franchise BG"];
                                                   OptionString=[ ,No Deductible,Other,Deductible 1,Deductible 2];
                                                   BlankZero=Yes }
    { 50006;  ;Deductible Amount   ;Decimal       ;CaptionML=[ENU=Deductible Amount;
                                                              FRA=Montant franchise] }
    { 50009;  ;Ship-to Mobile Phone No.;Text30    ;OnValidate=VAR
                                                                lPhoneStandardization@1000000000 : Codeunit 50099;
                                                              BEGIN
                                                                lPhoneStandardization.ValidatePhoneNo(DATABASE::"Service Header",50009,"Country/Region Code","Ship-to Mobile Phone No."); //IMH96.ST
                                                                CommentNotificationMgt.CreateNotifFromServHeader(Rec,xRec); //IMH96.ST
                                                              END;

                                                   ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Ship-to Mobile Phone No.;
                                                              FRA=T‚l. mobile destinataire MEO] }
    { 50010;  ;Ship-to Address 3   ;Text50        ;CaptionML=[ENU=Ship-to Address 3;
                                                              FRA=Adresse MEO 3] }
    { 50011;  ;Address 3           ;Text50        ;CaptionML=[ENU=Address 3;
                                                              FRA=Adresse 3];
                                                   Editable=No }
    { 50012;  ;Context             ;Text250       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Service Comment Line".Text WHERE (Table Name=CONST(Service Header),
                                                                                                         Table Subtype=FIELD(Document Type),
                                                                                                         No.=FIELD(No.),
                                                                                                         Type=CONST(General),
                                                                                                         Table Line No.=CONST(0),
                                                                                                         Line No.=CONST(-50012)));
                                                   CaptionML=[ENU=Context;
                                                              FRA=Contexte];
                                                   Editable=No }
    { 50013;  ;Contact Mobile Phone No.;Text30    ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Service."Contact Mobile Phone No." WHERE (Service No.=FIELD(Service No.)));
                                                   ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Contact Mobile Phone No.;
                                                              FRA=Nø t‚l‚phone mobile];
                                                   Editable=No }
    { 50014;  ;Geo. Reference Code ;Code10        ;TableRelation="Geographical Reference";
                                                   CaptionML=[ENU=Geo. Reference Code;
                                                              FRA=Code r‚f‚rence g‚o.] }
    { 50015;  ;Ship-to Geo. Reference Code;Code10 ;TableRelation="Geographical Reference";
                                                   CaptionML=[ENU=Ship-to Geo. Reference Code;
                                                              FRA=Code r‚f‚rence g‚o. MEO] }
    { 50016;  ;Ship-to Address Code;Code10        ;TableRelation="Contact Alt. Address".Code WHERE (Contact No.=FIELD(Contact No.));
                                                   OnValidate=VAR
                                                                lService@1100281000 : Record 50066;
                                                                lServiceInterventionLine@1100281001 : Record 50075;
                                                              BEGIN
                                                                IF CurrFieldNo = FIELDNO("Ship-to Address Code") THEN
                                                                  IF NOT CONFIRM(Text50013) THEN BEGIN
                                                                    "Ship-to Address Code" := xRec."Ship-to Address Code";
                                                                    EXIT;
                                                                  END;
                                                                ////<<IMH02
                                                                GetShipToAddress;
                                                                //>>IMH02
                                                                //<<IMH68
                                                                IF "No." <> '' THEN BEGIN
                                                                  lService.GET("Service No.");
                                                                  lService.GetAltAddress;
                                                                  lService.MODIFY(FALSE);
                                                                  lServiceInterventionLine.SETRANGE("Service Header No.", "No.");
                                                                  lServiceInterventionLine.SETRANGE("Intervention Status", lServiceInterventionLine."Intervention Status"::InProgress);
                                                                  IF lServiceInterventionLine.FINDSET THEN
                                                                    REPEAT
                                                                      lServiceInterventionLine.GetAltAddress;
                                                                      lServiceInterventionLine.MODIFY(FALSE);
                                                                    UNTIL lServiceInterventionLine.NEXT = 0;
                                                                END;
                                                                //>>IMH68
                                                              END;

                                                   CaptionML=[ENU=Ship-to Address Code;
                                                              FRA=Code adresse MEO] }
    { 50017;  ;VIP Code            ;Code10        ;CaptionML=[ENU=VIP Code;
                                                              FRA=Code VIP];
                                                   Editable=No }
    { 50018;  ;Corporate No.       ;Code20        ;TableRelation=Customer.No. WHERE (Service Contact=CONST(Corporate Customer),
                                                                                     Service Corporate=CONST(Yes));
                                                   OnValidate=VAR
                                                                lContactAltAddress@1100281000 : Record 5051;
                                                                lServicePartnerCatalog@1100281001 : Record 50060;
                                                              BEGIN
                                                                //<<IMH02
                                                                IF "Corporate No." <> xRec."Corporate No." THEN BEGIN
                                                                  IF "Corporate Region Code" <> '' THEN
                                                                    VALIDATE("Corporate Region Code", '');
                                                                //  IF "Service Order Type" <> '' THEN
                                                                //    UpdateFromServiceQuoteExcep;

                                                                  IF lServicePartnerCatalog.GET("Corporate No.","Service Order Type") THEN BEGIN
                                                                    VALIDATE("Corporate Declaration", lServicePartnerCatalog."Corporate Declaration");
                                                                  END;
                                                                  //>>IMH42
                                                                  VALIDATE("Declaration Contact No.", GetDeclarationContact("Corporate No."));
                                                                  //>>IMH42


                                                                END;
                                                                //>>IMH02
                                                              END;

                                                   CaptionML=[ENU=Corporate No.;
                                                              FRA=Nø grand compte];
                                                   Editable=No }
    { 50019;  ;Corporate Region Code;Code10       ;TableRelation="Corporate Region"."Region Code" WHERE (Corporate No.=FIELD(Corporate No.));
                                                   OnValidate=VAR
                                                                lCorporateRegion@1100281001 : Record 50058;
                                                                lServiceInterventionLine@1100281000 : Record 50075;
                                                              BEGIN
                                                                //<<IMH71
                                                                IF "Corporate Region Code" <> xRec."Corporate Region Code" THEN BEGIN
                                                                  lServiceInterventionLine.SETRANGE("Service Header No.","No.");
                                                                  IF lServiceInterventionLine.FINDSET THEN
                                                                  lServiceInterventionLine.MODIFYALL("Corporate Region Code","Corporate Region Code",TRUE);
                                                                END;
                                                                //>>IMH71

                                                                IF ("Corporate Contact No." = '') AND ("Corporate Region Code" <> '') THEN BEGIN
                                                                  lCorporateRegion.SETRANGE("Corporate No.","Corporate No.");
                                                                  lCorporateRegion.SETRANGE("Region Code","Corporate Region Code");
                                                                  IF NOT lCorporateRegion.ISEMPTY THEN BEGIN
                                                                    lCorporateRegion.FINDFIRST;
                                                                    "Corporate Contact No." := lCorporateRegion."Main Contact No.";
                                                                  END ELSE BEGIN
                                                                    lCorporateRegion.SETRANGE("Region Code");
                                                                    lCorporateRegion.SETFILTER("Region Code",'%1','');
                                                                    IF NOT lCorporateRegion.ISEMPTY THEN BEGIN
                                                                      lCorporateRegion.FINDFIRST;
                                                                      "Corporate Contact No." := lCorporateRegion."Main Contact No.";
                                                                    END
                                                                  END;
                                                                END;

                                                                VALIDATE("Declaration Contact No.", GetDeclarationContact("Corporate No."));
                                                              END;

                                                   CaptionML=[ENU=Corporate Region Code;
                                                              FRA=Code r‚gion grand compte] }
    { 50020;  ;Corporate Declaration;Boolean      ;OnValidate=BEGIN
                                                                VALIDATE("Meeting Date Input");
                                                              END;

                                                   CaptionML=[ENU=Corporate Declaration;
                                                              FRA=D‚claration grand compte];
                                                   Editable=No }
    { 50021;  ;Urgent              ;Option        ;OnValidate=BEGIN
                                                                //VALIDATE("Deposit Amount", SalesInvoicingMgt.UpdateSalesPrice(Rec));
                                                              END;

                                                   CaptionML=[ENU=Urgent;
                                                              FRA=Urgent];
                                                   OptionCaptionML=[ENU=" ,Yes,No";
                                                                    FRA=" ,Oui,Non"];
                                                   OptionString=[ ,Yes,No] }
    { 50022;  ;Campaign No.        ;Code20        ;TableRelation=Campaign WHERE (Active=CONST(Yes));
                                                   OnValidate=BEGIN
                                                                "Default Team Code" := GetDefaultTeamCodeByServOrder(Rec);   //IMH111
                                                              END;

                                                   CaptionML=[ENU=Campaign No.;
                                                              FRA=Nø ‚vŠnement exceptionnel] }
    { 50023;  ;Closed Reason Code  ;Code10        ;TableRelation=Code.Code WHERE (Table ID=CONST(5900),
                                                                                  Field ID=CONST(50023));
                                                   OnValidate=BEGIN
                                                                //<<IMH83.ISAT.EBA
                                                                SendReturnToIMA(FALSE);
                                                                //>>IMH83.ISAT.EBA
                                                              END;

                                                   CaptionML=[ENU=Closed Reason Code;
                                                              FRA=Code motif cl“ture] }
    { 50024;  ;Closed Reason       ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Code.Description WHERE (Table ID=CONST(5900),
                                                                                              Field ID=CONST(50023),
                                                                                              Code=FIELD(Closed Reason Code)));
                                                   CaptionML=[ENU=Closed Reason;
                                                              FRA=Motif cl“ture];
                                                   Editable=No }
    { 50025;  ;Reimbursement Refusal Cause;Option ;CaptionML=[ENU=Reimbursement Refusal Cause;
                                                              FRA=Motif refus remboursement];
                                                   OptionCaptionML=[ENU=" ,No Original Invoice,Support Not Provided,Voucher older than 2 years,Transfer To IMA";
                                                                    FRA=" ,Pas de facture originale,Prise en charge non pr‚vue IMH,Autre,Justificatif sup‚rieur … 2 ans,Transmis … IMA"];
                                                   OptionString=[ ,NoOriginalInvoice,SupportNotProvided,VoucherOlder,TransferToIMA] }
    { 50026;  ;Cancel Reason Code  ;Code10        ;TableRelation=Code.Code WHERE (Table ID=CONST(5900),
                                                                                  Field ID=CONST(50026));
                                                   CaptionML=[ENU=Cancel Reason Code;
                                                              FRA=Code motif annulation] }
    { 50027;  ;Cancel Reason       ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Code.Description WHERE (Table ID=CONST(5900),
                                                                                              Field ID=CONST(50026),
                                                                                              Code=FIELD(Cancel Reason Code)));
                                                   CaptionML=[ENU=Cancel Reason;
                                                              FRA=Motif annulation];
                                                   Editable=No }
    { 50028;  ;Suspended Reason Code;Code10       ;TableRelation=Code.Code WHERE (Table ID=CONST(5900),
                                                                                  Field ID=CONST(50028));
                                                   CaptionML=[ENU=Suspended Reason Code;
                                                              FRA=Code motif suspension] }
    { 50029;  ;Suspended Reason    ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Code.Description WHERE (Table ID=CONST(5900),
                                                                                              Field ID=CONST(50028),
                                                                                              Code=FIELD(Suspended Reason Code)));
                                                   CaptionML=[ENU=Suspended Reason;
                                                              FRA=Motif suspension];
                                                   Editable=No }
    { 50031;  ;Contact Involved    ;Code20        ;TableRelation=Contact;
                                                   CaptionML=[ENU=Contact Involved;
                                                              FRA=Tiers impliqu‚] }
    { 50032;  ;Body Damage         ;Boolean       ;CaptionML=[ENU=Body Damage;
                                                              FRA=Dommages corporels] }
    { 50033;  ;Content Theft       ;Option        ;CaptionML=[ENU=Content Theft;
                                                              FRA=Vol de contenu];
                                                   OptionCaptionML=[ENU=" ,Yes,No";
                                                                    FRA=" ,Oui,Non"];
                                                   OptionString=[ ,Yes,No] }
    { 50035;  ;Max. Est. Work Amt Excl. VAT;Decimal;
                                                   OnValidate=BEGIN
                                                                //<<IMH48.ST
                                                                IF ("Max. Est. Work Amt Excl. VAT" > "Max. Est. Work Amt Incl. VAT") AND ("Max. Est. Work Amt Incl. VAT" > 0) THEN
                                                                  ERROR(
                                                                    Text011,
                                                                    FIELDCAPTION("Max. Est. Work Amt Excl. VAT"),
                                                                    FIELDCAPTION("Max. Est. Work Amt Incl. VAT"),
                                                                    TABLECAPTION);
                                                                //>>IMH48.ST
                                                              END;

                                                   CaptionML=[ENU=Max. Estimate Work Amount Excl. VAT;
                                                              FRA=Estimation max des travaux HT];
                                                   MinValue=0;
                                                   BlankZero=Yes;
                                                   AutoFormatType=1 }
    { 50036;  ;Intervention Ceiling;Decimal       ;CaptionML=[ENU=Intervention Ceiling;
                                                              FRA=Plafond de d‚l‚gation];
                                                   BlankZero=Yes }
    { 50037;  ;Unsecured Depreciation Amount;Decimal;
                                                   CaptionML=[ENU=Unsecured Depreciation Amount;
                                                              FRA=V‚tust‚ non garantie mtt];
                                                   BlankZero=Yes }
    { 50038;  ;Unsecured Depreciation %;Decimal   ;CaptionML=[ENU=Unsecured Depreciation %;
                                                              FRA=V‚tust‚ non garantie %];
                                                   BlankZero=Yes }
    { 50039;  ;Max. Est. Work Amt Incl. VAT;Decimal;
                                                   OnValidate=BEGIN
                                                                VALIDATE("Max. Est. Work Amt Excl. VAT");
                                                              END;

                                                   CaptionML=[ENU=Max. Estimate Work Amount Incl. VAT;
                                                              FRA=Estimation max des travaux TTC];
                                                   MinValue=0;
                                                   BlankZero=Yes;
                                                   AutoFormatType=1 }
    { 50040;  ;Cheque / BC Receipt Date;Date      ;OnValidate=BEGIN
                                                                //<<IMH82.ISAT.EBA
                                                                //TESTFIELD("Payment Method","Payment Method"::Cheque);
                                                                //>>IMH82.ISAT.EBA
                                                                //<<IMH87.ISAT.EBA
                                                                IF ("Cheque / BC Receipt Date" > WORKDATE) AND ("Cheque / BC Receipt Date" <> 0D) THEN
                                                                  ERROR(Text50014, FIELDCAPTION("Cheque / BC Receipt Date"));
                                                                //>>IMH87.ISAT.EBA
                                                              END;

                                                   CaptionML=[ENU=Cheque / BC Receipt Date;
                                                              FRA=Date r‚ception chŠque / CB] }
    { 50055;  ;Quote Managment     ;Boolean       ;CaptionML=[ENU=Quote Managment;
                                                              FRA=Demande devis];
                                                   Editable=No }
    { 50060;  ;Building Trade      ;Code10        ;TableRelation=IF (Main Speciality=CONST('')) "Building Trade".No.
                                                                 ELSE IF (Main Speciality=FILTER(<>'')) "Specialization Building Trade"."Specialization Code" WHERE (Building Trade No.=FIELD(Building Trade));
                                                   OnValidate=VAR
                                                                lSpecBuild@1100281000 : Record 50031;
                                                                lServCode@1100281001 : Record 50040;
                                                              BEGIN
                                                                IF "Main Speciality" <> '' THEN BEGIN
                                                                  IF "Building Trade" = '' THEN
                                                                    VALIDATE("Main Speciality", '')
                                                                  ELSE
                                                                    IF NOT lSpecBuild.GET("Building Trade", "Main Speciality") THEN
                                                                      VALIDATE("Main Speciality", '');
                                                                  lServCode.UpdateMain(lServCode."Service Type"::ServiceHeader, "No.", 0,
                                                                                       lServCode."Code Type"::Speciality, "Main Speciality", "Building Trade");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Building Trade;
                                                              FRA=Corps de m‚tier] }
    { 50061;  ;Main Speciality     ;Code10        ;TableRelation=IF (Building Trade=FILTER(<>'')) "Specialization Building Trade"."Specialization Code" WHERE (Building Trade No.=FIELD(Building Trade))
                                                                 ELSE IF (Building Trade=CONST('')) Specialization.Code;
                                                   OnValidate=VAR
                                                                lServCode@1100281000 : Record 50040;
                                                                lSpeciality@1100281001 : Record 50005;
                                                                lBuildTrade@1100281002 : Code[20];
                                                              BEGIN
                                                                IF "Main Speciality" <> '' THEN BEGIN
                                                                  IF lSpeciality.GetBuildingTrade("Main Speciality", lBuildTrade) THEN
                                                                    "Building Trade" := lBuildTrade
                                                                  ELSE
                                                                    "Main Speciality" := xRec."Main Speciality";
                                                                END;

                                                                IF "No." <> '' THEN
                                                                  lServCode.UpdateMain(lServCode."Service Type"::ServiceHeader, "No.", 0,
                                                                                       lServCode."Code Type"::Speciality, "Main Speciality", "Building Trade");
                                                              END;

                                                   CaptionML=[ENU=Main Speciality;
                                                              FRA=Sp‚cialit‚ principale] }
    { 50065;  ;No. Intervention Descr.;Integer    ;FieldClass=FlowField;
                                                   CalcFormula=Count("Intervention Description" WHERE (Service Header No.=FIELD(No.),
                                                                                                       Speciality Code=FILTER(<>''),
                                                                                                       Building Trade No.=FILTER(<>''),
                                                                                                       Affected Location Code=FILTER(<>'')));
                                                   CaptionML=[ENU=No. Intervention Descr.;
                                                              FRA=Nombre lignes descriptif des travaux];
                                                   Description=Doublon champ 50193 }
    { 50070;  ;Channel             ;Code10        ;TableRelation=Code.Code WHERE (Table ID=CONST(50066),
                                                                                  Field ID=CONST(12));
                                                   CaptionML=[ENU=Channel;
                                                              FRA=Canal] }
    { 50071;  ;Requisitioner       ;Code10        ;TableRelation=Code.Code WHERE (Table ID=CONST(50066),
                                                                                  Field ID=CONST(13));
                                                   CaptionML=[ENU=Requisitioner;
                                                              FRA=Demandeur] }
    { 50080;  ;Contract Form Code  ;Code10        ;TableRelation="Corporate Contract"."Contract Form Code" WHERE (Corporate No.=FIELD(Corporate No.));
                                                   OnValidate=BEGIN
                                                                //<<IMH02
                                                                IF ("Contact No." <> '') AND
                                                                   ("Contract Form Code" <> '') AND
                                                                   ("Contract Occurence No." <> 0) THEN BEGIN
                                                                  GetContactContract;
                                                                END;
                                                                //>>IMH02
                                                              END;

                                                   CaptionML=[ENU=Contract Form Code;
                                                              FRA=Code formule];
                                                   Editable=No }
    { 50081;  ;Contract Occurence No.;Integer     ;TableRelation="Contact Contract"."Occurence No." WHERE (Contact No.=FIELD(Contact No.),
                                                                                                           Contract Form Code=FIELD(Contract Form Code));
                                                   OnValidate=BEGIN
                                                                //<<IMH02
                                                                IF ("Contact No." <> '') AND
                                                                   ("Contract Form Code" <> '') THEN BEGIN
                                                                  GetContactContract;
                                                                END;
                                                                //>>IMH02
                                                              END;

                                                   CaptionML=[ENU=Contract Occurence No.;
                                                              FRA=Nø occurence formule];
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 50082;  ;Occupier Nature     ;Code10        ;TableRelation=Code.Code WHERE (Table ID=CONST(5051),
                                                                                  Field ID=CONST(50070));
                                                   OnValidate=VAR
                                                                lContactAltAdd@1100281000 : Record 5051;
                                                                lService@1100281002 : Record 50066;
                                                                lModify@1100281001 : Boolean;
                                                              BEGIN
                                                                {
                                                                //<<IMH39
                                                                IF lContactAltAdd.GET("Contact No.","Ship-to Address Code") THEN BEGIN
                                                                  lModify := TRUE;
                                                                  IF (lContactAltAdd."Occupier Nature" <> '') AND
                                                                     (lContactAltAdd."Occupier Nature" <> "Occupier Nature") THEN BEGIN
                                                                     lContactAltAdd.CALCFIELDS("Occupier Nature Description");
                                                                     lModify := CONFIRM(STRSUBSTNO(Text50008,FIELDCAPTION("Occupier Nature"),lContactAltAdd."Occupier Nature Description"));
                                                                  END;
                                                                  IF lModify THEN BEGIN
                                                                    lContactAltAdd."Occupier Nature" := "Occupier Nature";
                                                                    lContactAltAdd.MODIFY(TRUE);
                                                                    IF lService.GET("Service No.") THEN BEGIN
                                                                      lService."Occupier Nature" := "Occupier Nature";
                                                                      lService.MODIFY;
                                                                    END;
                                                                  END;
                                                                END;
                                                                IF NOT lModify THEN
                                                                  "Occupier Nature" := xRec."Occupier Nature";
                                                                  EXIT;
                                                                //>>IMH39
                                                                }
                                                              END;

                                                   CaptionML=[ENU=Occupier Nature;
                                                              FRA=Nature de l'occupant] }
    { 50083;  ;Residence Type      ;Code10        ;TableRelation=Code.Code WHERE (Table ID=CONST(5051),
                                                                                  Field ID=CONST(50071));
                                                   CaptionML=[ENU=Residence Type;
                                                              FRA=Type de r‚sidence];
                                                   Editable=No }
    { 50084;  ;Deductible 1 (LCY)  ;Decimal       ;CaptionML=[ENU=Deductible 1 (LCY);
                                                              FRA=Franchise];
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 50085;  ;Deductible 2 (LCY)  ;Decimal       ;CaptionML=[ENU=Deductible 2 (LCY);
                                                              FRA=Franchise BG];
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 50086;  ;Housing Type        ;Code10        ;TableRelation=Code.Code WHERE (Table ID=CONST(5051),
                                                                                  Field ID=CONST(50072));
                                                   CaptionML=[ENU=Housing Type;
                                                              FRA=Type d'habitation] }
    { 50087;  ;Property Type       ;Code10        ;TableRelation=Code.Code WHERE (Table ID=CONST(5051),
                                                                                  Field ID=CONST(50073));
                                                   CaptionML=[ENU=Property Type;
                                                              FRA=Type de propri‚t‚] }
    { 50090;  ;Information Type    ;Code10        ;TableRelation=Code.Code WHERE (Table ID=CONST(5900),
                                                                                  Field ID=CONST(50090));
                                                   CaptionML=[ENU=Information Type;
                                                              FRA=Type information] }
    { 50091;  ;Information         ;Text250       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Service Comment Line".Text WHERE (Table Name=CONST(Service Header),
                                                                                                         Table Subtype=FIELD(Document Type),
                                                                                                         No.=FIELD(No.),
                                                                                                         Type=CONST(General),
                                                                                                         Table Line No.=CONST(0),
                                                                                                         Line No.=CONST(-50091)));
                                                   CaptionML=[ENU=Information;
                                                              FRA=Information];
                                                   Editable=No }
    { 50100;  ;Work Type           ;Code10        ;CaptionML=[ENU=Work Type;
                                                              FRA=Type de travaux] }
    { 50101;  ;Job Amount Class    ;Code10        ;TableRelation=Code.Code WHERE (Table ID=CONST(5900),
                                                                                  Field ID=CONST(50101));
                                                   CaptionML=[ENU=Job Amount Class;
                                                              FRA=Montant du projet habitat] }
    { 50102;  ;Financing Housing Project;Option   ;CaptionML=[ENU=Financing housing project;
                                                              FRA="Financement projet habitat "];
                                                   OptionCaptionML=[ENU=,Obtained,In progress;
                                                                    FRA=,Obtenu,En cours de recherche];
                                                   OptionString=,Obtained,In Search,Rejected;
                                                   BlankZero=Yes }
    { 50103;  ;Requested Realised Date;Text5      ;OnValidate=VAR
                                                                lPos@1100281000 : Integer;
                                                                lInt@1100281001 : Integer;
                                                                lDate@1100281002 : Date;
                                                              BEGIN
                                                                //<<IMH17
                                                                {//<<IMH02
                                                                // V‚rifie le format saisi MM/AA
                                                                lPos := STRPOS("Requested Realised Date",'/');
                                                                IF lPos = 0 THEN
                                                                  ERROR(Text50000);
                                                                IF (NOT EVALUATE(lInt,COPYSTR("Requested Realised Date", 1, lPos -1))) OR
                                                                   (NOT EVALUATE(lInt,COPYSTR("Requested Realised Date", lPos+1, STRLEN("Requested Realised Date")-lPos))) THEN
                                                                  ERROR(Text50000);
                                                                //>>IMH02
                                                                }
                                                                //>>IMH17
                                                                //<<IMH89.ST
                                                                IF ("Requested Realised Date" <> '') AND (CurrFieldNo = FIELDNO("Requested Realised Date")) THEN BEGIN
                                                                  lPos := STRPOS("Requested Realised Date",'/');
                                                                  IF lPos = 0 THEN BEGIN
                                                                    IF NOT EVALUATE(lDate, '01/01/' + "Requested Realised Date") THEN
                                                                      EXIT;
                                                                  END ELSE
                                                                    IF NOT EVALUATE(lDate, '01/' + "Requested Realised Date") THEN
                                                                      EXIT;
                                                                  IF (DATE2DMY(lDate,3) < DATE2DMY(DT2DATE("Creation Date"),3)) OR
                                                                     ((DATE2DMY(lDate,3) = DATE2DMY(DT2DATE("Creation Date"),3)) AND
                                                                      (DATE2DMY(lDate,2) < DATE2DMY(DT2DATE("Creation Date"),2))) THEN
                                                                    ERROR(STRSUBSTNO(Text026, FIELDCAPTION("Requested Realised Date"),
                                                                          DT2DATE("Creation Date")));
                                                                END;
                                                                //>>IMH89.ST
                                                              END;

                                                   CaptionML=[ENU=Requested Realised Date;
                                                              FRA=Date souhait‚e] }
    { 50104;  ;Event Nature        ;Code10        ;TableRelation=Code.Code WHERE (Table ID=CONST(5900),
                                                                                  Field ID=CONST(50104));
                                                   CaptionML=[ENU=Event Nature;
                                                              FRA=Nature ‚vŠnement] }
    { 50106;  ;Transaction Code    ;Text30        ;CaptionML=[ENU=Transaction Code;
                                                              FRA=Code transaction] }
    { 50107;  ;Deposit Amount      ;Decimal       ;CaptionML=[ENU=Deposit Amount;
                                                              FRA=Montant frais de dossier];
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 50108;  ;Event Date          ;Date          ;OnValidate=BEGIN
                                                                //VALIDATE("Deposit Amount", SalesInvoicingMgt.UpdateSalesPrice(Rec));
                                                              END;

                                                   CaptionML=[ENU=Event Date;
                                                              FRA=Date ‚vŠnement];
                                                   Editable=No }
    { 50109;  ;Project Type        ;Code10        ;TableRelation=Code.Code WHERE (Table ID=CONST(5900),
                                                                                  Field ID=CONST(50109));
                                                   CaptionML=[ENU=Project Type;
                                                              FRA=Type projet] }
    { 50110;  ;Contact Quote       ;Option        ;CaptionML=[ENU=Competitor Quote;
                                                              FRA=Devis concurrent];
                                                   OptionCaptionML=[ENU=" ,Yes,No";
                                                                    FRA=" ,Oui,Non"];
                                                   OptionString=[ ,Yes,No] }
    { 50120;  ;Address Type        ;Option        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Service Header Address"."Address Type" WHERE (Service Header No.=FIELD(No.)));
                                                   CaptionML=[ENU=Address Type;
                                                              FRA=Type adresse];
                                                   OptionCaptionML=[ENU=Contact involved,Guarding,Moving,Public Storage,Annexe Contact,Disaster Declaration,Voucher Contact,Expert Contact;
                                                                    FRA=Tiers impliqu‚,Gardiennage,D‚m‚nagement,Garde-meuble,Contact annexe,D‚claration sinistre,Contact remboursement,Contact expert];
                                                   OptionString=Contact involved,Guarding,Moving,Public Storage,Annexe Contact,Disaster Declaration,Voucher,Expert Contact;
                                                   Editable=No }
    { 50188;  ;Meeting Date Input  ;Option        ;OnValidate=BEGIN
                                                                IF "Meeting Date Input" = "Meeting Date Input"::Mandatory THEN
                                                                  "Corporate Declaration" := TRUE;
                                                              END;

                                                   CaptionML=[ENU=Meeting Date Input;
                                                              FRA=Saisie date rdv];
                                                   OptionCaptionML=[ENU=" ,Blank,Mandatory";
                                                                    FRA=" ,Vide,Obligatoire"];
                                                   OptionString=[ ,Blank,Mandatory] }
    { 50189;  ;Corporate Contact Input;Option     ;CaptionML=[ENU=Corporate Contact Input;
                                                              FRA=Saisie contact GC];
                                                   OptionCaptionML=[ENU=" ,Blank,Mandatory";
                                                                    FRA=" ,Vide,Obligatoire"];
                                                   OptionString=[ ,Blank,Mandatory] }
    { 50190;  ;Intervention Line Exists;Boolean   ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Service Intervention Line" WHERE (Service Header No.=FIELD(No.)));
                                                   CaptionML=[ENU=Intervention Line Exists;
                                                              FRA=Intervention existe];
                                                   Editable=No }
    { 50191;  ;Intervention Status Filter;Option  ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Interventionn Status Filter;
                                                              FRA=Filtre statut ligne intervention];
                                                   OptionCaptionML=[ENU=" ,In progress,Closed,Cancel,Suspended";
                                                                    FRA=" ,En cours,Cl“tur‚e,Annul‚e,Suspendu"];
                                                   OptionString=[ ,In progress,Closed,Cancel,Suspended] }
    { 50192;  ;No. of Intervention Lines;Integer  ;FieldClass=FlowField;
                                                   CalcFormula=Count("Service Intervention Line" WHERE (Service Header No.=FIELD(No.),
                                                                                                        Intervention Status=FIELD(Intervention Status Filter)));
                                                   CaptionML=[ENU=No. of Intervention Lines;
                                                              FRA=Nombre d'interventions];
                                                   Editable=No }
    { 50193;  ;No. of Interv. Desc. Lines;Integer ;FieldClass=FlowField;
                                                   CalcFormula=Count("Intervention Description" WHERE (Service Header No.=FIELD(No.),
                                                                                                       Speciality Code=FILTER(<>''),
                                                                                                       Building Trade No.=FILTER(<>''),
                                                                                                       Affected Location Code=FILTER(<>'')));
                                                   CaptionML=[ENU=No. of Interv. Desc. Lines;
                                                              FRA=Nombre de lieux touch‚s];
                                                   Description=Doublon champ 50065;
                                                   Editable=No }
    { 50200;  ;Diagnosis Nature    ;Code10        ;TableRelation=Code.Code WHERE (Table ID=CONST(5900),
                                                                                  Field ID=CONST(50200));
                                                   CaptionML=[ENU=Diagnosis Nature;
                                                              FRA=Nature diagnostic] }
    { 50201;  ;Provider No.        ;Code20        ;TableRelation=Provider.No.;
                                                   CaptionML=[ENU=Provider No.;
                                                              FRA=Nø prestataire];
                                                   Editable=No }
    { 50202;  ;Quote Reference No. ;Text30        ;CaptionML=[ENU=Quote Reference No.;
                                                              FRA=R‚f‚rence devis] }
    { 50203;  ;Global Amount (Incl. VAT);Decimal  ;OnValidate=VAR
                                                                lServiceInterventionLine@1100281000 : Record 50075;
                                                              BEGIN
                                                                lServiceInterventionLine.SETRANGE("Service Header No.", "No.");
                                                                lServiceInterventionLine.SETFILTER("Intervention Status", '<>%1', lServiceInterventionLine."Intervention Status"::Cancel);
                                                                IF lServiceInterventionLine.FINDSET THEN
                                                                  REPEAT
                                                                    lServiceInterventionLine."Global Amount (Incl. VAT)" := "Global Amount (Incl. VAT)";
                                                                    lServiceInterventionLine.MODIFY(TRUE);
                                                                  UNTIL lServiceInterventionLine.NEXT = 0;
                                                              END;

                                                   CaptionML=[ENU=Global Amount (Incl. VAT);
                                                              FRA=Montant global TTC];
                                                   BlankZero=Yes }
    { 50250;  ;BC Transaction No.  ;Code20        ;OnValidate=BEGIN
                                                                //<<IMH53.ISAT.EBA
                                                                IF "BC Transaction No." <> '' THEN BEGIN
                                                                  TESTFIELD("Payment Method", "Payment Method"::"Credit Card");
                                                                  "Cheque / BC Receipt Date" := WORKDATE;
                                                                  SendToIMA(FALSE);
                                                                END;
                                                                //>>IMH53.ISAT.EBA
                                                              END;

                                                   CaptionML=[ENU=BC Transaction No.;
                                                              FRA=Nø transaction CB] }
    { 50251;  ;Check No.           ;Code20        ;OnValidate=BEGIN
                                                                //<<IMH53.ISAT.EBA
                                                                IF "Check No." <> '' THEN BEGIN
                                                                  TESTFIELD("Payment Method", "Payment Method"::Cheque);
                                                                  "Cheque / BC Receipt Date" := WORKDATE;
                                                                  SendToIMA(FALSE);
                                                                END;
                                                                //>>IMH53.ISAT.EBA
                                                              END;

                                                   CaptionML=[ENU=Check No.;
                                                              FRA=Nø chŠque] }
    { 50252;  ;Order Created       ;Boolean       ;CaptionML=[ENU=Order Created;
                                                              FRA=Commande cr‚‚];
                                                   Editable=No }
    { 50260;  ;Other Phone No. Type;Code10        ;TableRelation=Code.Code WHERE (Table ID=CONST(5900),
                                                                                  Field ID=CONST(50260));
                                                   CaptionML=[ENU=Other Phone No. Type;
                                                              FRA=Type t‚l. autre] }
    { 50261;  ;Other Phone No.     ;Text30        ;OnValidate=VAR
                                                                lPhoneStandardization@1000000000 : Codeunit 50099;
                                                              BEGIN
                                                                //<<IMH126
                                                                lPhoneStandardization.ValidatePhoneNo(DATABASE::"Service Header", 50009, "Country/Region Code", "Other Phone No.");
                                                                //>>IMH126
                                                              END;

                                                   ExtendedDatatype=Phone No.;
                                                   CaptionML=FRA=T‚l. autre MEO }
    { 50262;  ;Person To Contact MEO Name;Text50  ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Service Header Address".Name WHERE (Address No.=FIELD(Person To Contact MEO No.),
                                                                                                           Service Header No.=FIELD(No.),
                                                                                                           Address Type=CONST(Annexe Contact)));
                                                   CaptionML=[ENU=Person To Contact MEO Name;
                                                              FRA=Nom personne … contacter MEO];
                                                   Editable=No }
    { 50263;  ;Person To Contact MEO Phone;Text30 ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Service Header Address"."Phone No." WHERE (Address No.=FIELD(Person To Contact MEO No.),
                                                                                                                  Service Header No.=FIELD(No.),
                                                                                                                  Address Type=CONST(Annexe Contact)));
                                                   CaptionML=[ENU=Person To Contact MEO Phone;
                                                              FRA=Tel. personne … contacter MEO];
                                                   Editable=No }
    { 50264;  ;Person To Contact MEO Quality;Code10;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Lookup("Service Header Address"."Role Code" WHERE (Address No.=FIELD(Person To Contact MEO No.),
                                                                                                                  Service Header No.=FIELD(No.),
                                                                                                                  Address Type=CONST(Annexe Contact)));
                                                   CaptionML=[ENU=Person To Contact MEO Quality;
                                                              FRA=Qualit‚ personne … contacter MEO];
                                                   Editable=No }
    { 50265;  ;Person To Contact MEO No.;Integer  ;InitValue=0;
                                                   CaptionML=[ENU=Person To Contact MEO No.;
                                                              FRA=Nø personne … contacter MEO];
                                                   Editable=No }
    { 50266;  ;DARVA Doc. Entry No.;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Interface Reference".Field25 WHERE (Source Table ID=CONST(5900),
                                                                                                           Source No.=FIELD(No.)));
                                                   CaptionML=[ENU=DARVA Doc. Entry No.;
                                                              FRA=Nø s‚quence document DARVA];
                                                   Description=MATMUT02;
                                                   Editable=No }
    { 50300;  ;Delivery Date       ;Date          ;CaptionML=[ENU=Delivery Date;
                                                              FRA=Date de livraison] }
    { 50400;  ;Guarding            ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Service Header Address" WHERE (Service Header No.=FIELD(No.),
                                                                                                     Address Type=FILTER(Guarding)));
                                                   CaptionML=[ENU=Guarding;
                                                              FRA=Gardiennage];
                                                   Editable=No }
    { 50401;  ;Moving              ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Service Header Address" WHERE (Service Header No.=FIELD(No.),
                                                                                                     Address Type=FILTER(Moving)));
                                                   CaptionML=[ENU=Moving;
                                                              FRA=D‚m‚nagement];
                                                   Editable=No }
    { 50402;  ;Public Storage      ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Service Header Address" WHERE (Service Header No.=FIELD(No.),
                                                                                                     Address Type=FILTER(Public Storage)));
                                                   CaptionML=[ENU=Public Storage;
                                                              FRA=Garde-meuble];
                                                   Editable=No }
    { 50403;  ;Temporary Accomodation;Boolean     ;CaptionML=[ENU=Temporary Accomodation;
                                                              FRA=Habitation temporaire] }
    { 50410;  ;Home Service        ;Boolean       ;CaptionML=[ENU=Home Service;
                                                              FRA=Service … l'habitat];
                                                   Editable=No }
    { 50411;  ;Claim               ;Boolean       ;CaptionML=[ENU=Claim;
                                                              FRA=R‚clamation];
                                                   Editable=No }
    { 50412;  ;Confidence Prior    ;Boolean       ;CaptionML=[ENU=Confidence Prior;
                                                              FRA=Confiance pr‚alable] }
    { 50413;  ;Taking Charge On Voucher;Boolean   ;CaptionML=[ENU=Taking Charge On Voucher;
                                                              FRA=Prise en charge sur justificatifs] }
    { 50414;  ;Service Cause       ;Code20        ;TableRelation="Fault Reason Code".Code;
                                                   CaptionML=[ENU=Service Cause;
                                                              FRA=Cause intervention] }
    { 50415;  ;Meeting Date        ;Date          ;OnValidate=BEGIN
                                                                //<<IMH63.ST
                                                                IF "Meeting Date" <> 0D THEN BEGIN
                                                                  IF "Meeting Date" < WORKDATE THEN
                                                                    ERROR(Text50009, FIELDCAPTION("Meeting Date"));
                                                                  ServSetup.GET;
                                                                  IF ServSetup."Max. Meeting Date Days" > 0 THEN BEGIN
                                                                    IF "Meeting Date" > (WORKDATE + ServSetup."Max. Meeting Date Days") THEN
                                                                      ERROR(STRSUBSTNO(Text50010, FIELDCAPTION("Meeting Date"), WORKDATE + ServSetup."Max. Meeting Date Days"));
                                                                  END;
                                                                  VALIDATE("Declaration Comment Code",'');
                                                                END
                                                                ELSE BEGIN
                                                                  "9h-12h" := FALSE;
                                                                  "14h-17h" := FALSE;
                                                                END;
                                                                //>>IMH63.ST
                                                              END;

                                                   CaptionML=[ENU=Meeting Date;
                                                              FRA=Jour de rendez-vous] }
    { 50416;  ;9h-12h              ;Boolean       ;OnValidate=BEGIN
                                                                TESTFIELD("Meeting Date");
                                                                IF "9h-12h" THEN
                                                                  "14h-17h" := FALSE;
                                                              END;

                                                   CaptionML=[ENU=9h-12h;
                                                              FRA=9h-12h] }
    { 50417;  ;14h-17h             ;Boolean       ;OnValidate=BEGIN
                                                                TESTFIELD("Meeting Date");
                                                                IF "14h-17h" THEN
                                                                  "9h-12h" := FALSE;
                                                              END;

                                                   CaptionML=[ENU=14h-17h;
                                                              FRA=14h-17h] }
    { 50418;  ;Declaration Comment Code;Code10    ;TableRelation="Standard Text".Code;
                                                   OnValidate=BEGIN
                                                                IF "Declaration Comment Code" <> '' THEN BEGIN
                                                                  VALIDATE("Meeting Date", 0D);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Declaration Comment Code;
                                                              FRA=Code commentaire d‚claration] }
    { 50419;  ;Declaration Contact No.;Code20     ;TableRelation=Contact;
                                                   OnLookup=VAR
                                                              lMarketingSetup@1100281000 : Record 5079;
                                                              lContactBusinessRelation@1100281001 : Record 5054;
                                                              lContact@1100281002 : Record 5050;
                                                            BEGIN
                                                              lMarketingSetup.GET;
                                                              lContactBusinessRelation.SETCURRENTKEY("Link to Table","No.");
                                                              lContactBusinessRelation.SETRANGE("Link to Table",lContactBusinessRelation."Link to Table"::Customer);
                                                              lContactBusinessRelation.SETRANGE("No.","Corporate No.");
                                                              lContactBusinessRelation.SETRANGE("Business Relation Code",lMarketingSetup."Bus. Rel. Code for Customers");
                                                              IF lContactBusinessRelation.ISEMPTY THEN
                                                                EXIT;
                                                              lContactBusinessRelation.FINDFIRST;
                                                              lContact.SETCURRENTKEY("Company No.");
                                                              lContact.SETRANGE("Company No.",lContactBusinessRelation."Contact No.");
                                                              lContact.SETRANGE(Type,lContact.Type::Person);
                                                              lContact.SETRANGE("Declaration Contact", TRUE);
                                                              IF FORM.RUNMODAL(0,lContact) = ACTION::LookupOK THEN BEGIN
                                                                "Declaration Contact No." := lContact."No.";
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Declaration Contact No.;
                                                              FRA=Nø contact d‚claration] }
    { 50420;  ;Corporate Contact No.;Code20       ;OnLookup=BEGIN
                                                              OnLookUpCorporateContactNo;//IMH34
                                                            END;

                                                   CaptionML=[ENU=Corporate Contact No.;
                                                              FRA=Nø contact grand compte] }
    { 50421;  ;Corporate Contact Name;Text50      ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact.Name WHERE (No.=FIELD(Corporate Contact No.)));
                                                   CaptionML=[ENU=Corporate Contact Name;
                                                              FRA=Nom contact grand compte];
                                                   Editable=No }
    { 50422;  ;Declaration Contact Name;Text50    ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact.Name WHERE (No.=FIELD(Declaration Contact No.)));
                                                   TableRelation=Contact;
                                                   OnLookup=VAR
                                                              lMarketingSetup@1100281000 : Record 5079;
                                                              lContactBusinessRelation@1100281001 : Record 5054;
                                                              lContact@1100281002 : Record 5050;
                                                            BEGIN
                                                              lMarketingSetup.GET;
                                                              lContactBusinessRelation.SETCURRENTKEY("Link to Table","No.");
                                                              lContactBusinessRelation.SETRANGE("Link to Table",lContactBusinessRelation."Link to Table"::Customer);
                                                              lContactBusinessRelation.SETRANGE("No.","Corporate No.");
                                                              lContactBusinessRelation.SETRANGE("Business Relation Code",lMarketingSetup."Bus. Rel. Code for Customers");
                                                              IF lContactBusinessRelation.ISEMPTY THEN
                                                                EXIT;
                                                              lContactBusinessRelation.FINDFIRST;
                                                              lContact.SETCURRENTKEY("Company No.");
                                                              lContact.SETRANGE("Company No.",lContactBusinessRelation."Contact No.");
                                                              lContact.SETRANGE(Type,lContact.Type::Person);
                                                              IF FORM.RUNMODAL(0,lContact) = ACTION::LookupOK THEN BEGIN
                                                                "Declaration Contact No." := lContact."No.";
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Declaration Contact Name;
                                                              FRA=Nom contact d‚claration];
                                                   Editable=No }
    { 50423;  ;Declaration Comment Text;Text80    ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Standard Text".Description WHERE (Code=FIELD(Declaration Comment Code)));
                                                   CaptionML=[ENU=Declaration Comment Text;
                                                              FRA=Commentaire d‚claration];
                                                   Editable=No }
    { 50424;  ;Real Estate Diag.   ;Boolean       ;CaptionML=[ENU=Real Estate Diag.;
                                                              FRA=Diagnostic Immobilier] }
    { 50429;  ;Person To Contact   ;Text80        ;CaptionML=[ENU=Person To Contact;
                                                              FRA=Personne … contacter] }
    { 50430;  ;Default Team Code   ;Code10        ;TableRelation=Team.Code;
                                                   CaptionML=[ENU=Default Team Code;
                                                              FRA=Code corbeille par d‚faut] }
    { 50431;  ;Force Default Team Code;Boolean    ;CaptionML=[ENU=Force Default Team Code;
                                                              FRA=Forcer code corbeille par d‚faut] }
    { 50432;  ;Default Team Name   ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Team.Name WHERE (Code=FIELD(Default Team Code)));
                                                   CaptionML=[ENU=Default Team Name;
                                                              FRA=Nom corbeille par d‚faut];
                                                   Editable=No }
    { 50440;  ;No. Of Beneficiary  ;Integer       ;CaptionML=[ENU=No. Of Beneficiary;
                                                              FRA=Nombre de b‚n‚ficiaires];
                                                   BlankZero=Yes }
    { 50450;  ;Service Header Address Nb.;Integer ;FieldClass=FlowField;
                                                   CalcFormula=Count("Service Header Address" WHERE (Service Header No.=FIELD(No.)));
                                                   CaptionML=[ENU=Service header Address Nb.;
                                                              FRA=Nombre de moyens de mise en oeuvre];
                                                   Editable=No }
    { 50470;  ;Total Descr. Amount Incl. VAT;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Intervention Description"."Amount Incl. VAT" WHERE (Service Header No.=FIELD(No.)));
                                                   CaptionML=[ENU=Total Descr. Amount Incl. VAT;
                                                              FRA=Montant chiffrage TTC];
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 50471;  ;Total Descr. Amount Excl. VAT;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Intervention Description"."Amount Excl. VAT" WHERE (Service Header No.=FIELD(No.)));
                                                   CaptionML=[ENU=Total Descr. Amount Excl. VAT;
                                                              FRA=Montant chiffrage HT];
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 50472;  ;Est. Suite Amt Excl. VAT;Decimal   ;OnValidate=BEGIN
                                                                //<<IMH48.ST
                                                                IF ("Max. Est. Work Amt Excl. VAT" > "Max. Est. Work Amt Incl. VAT") AND ("Max. Est. Work Amt Incl. VAT" > 0) THEN
                                                                  ERROR(
                                                                    Text011,
                                                                    FIELDCAPTION("Max. Est. Work Amt Excl. VAT"),
                                                                    FIELDCAPTION("Max. Est. Work Amt Incl. VAT"),
                                                                    TABLECAPTION);
                                                                //>>IMH48.ST
                                                              END;

                                                   CaptionML=[ENU=Est. Suite Amt Excl. VAT;
                                                              FRA=Montant estimation mobilier HT];
                                                   MinValue=0;
                                                   BlankZero=Yes;
                                                   AutoFormatType=1 }
    { 50473;  ;Est. Suite Amt Incl. VAT;Decimal   ;OnValidate=BEGIN
                                                                VALIDATE("Max. Est. Work Amt Excl. VAT");
                                                              END;

                                                   CaptionML=[ENU=Est. Suite Amt Incl. VAT;
                                                              FRA=Montant estimation mobilier TTC];
                                                   MinValue=0;
                                                   BlankZero=Yes;
                                                   AutoFormatType=1 }
    { 50474;  ;Indemnity Mode      ;Option        ;CaptionML=[ENU=Indemnity Mode;
                                                              FRA=Mode d'indemnisation];
                                                   OptionCaptionML=[ENU=Pecuniary Indemnity,Nature Repair,Auto Repair;
                                                                    FRA=Indemnisation p‚cuniaire,R‚paration en nature,Auto r‚paration];
                                                   OptionString=Pecuniary Indemnity,Nature Repair,Auto Repair }
    { 50480;  ;Service Creation Date;DateTime     ;FieldClass=Normal;
                                                   CaptionML=[ENU=Service Creation Date;
                                                              FRA=Date cr‚ation service];
                                                   Editable=No }
    { 50484;  ;Voucher Posted Filter;Boolean      ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Voucher Posted Filter;
                                                              FRA=Filtre justificatif valid‚] }
    { 50485;  ;Service Order Type Description;Text30;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Lookup("Service Order Type".Description WHERE (Code=FIELD(Service Order Type)));
                                                   CaptionML=[ENU=Service Order Type Descrption;
                                                              FRA=D‚signation type produit];
                                                   Editable=No }
    { 50486;  ;Voucher Exists      ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Service Header Voucher" WHERE (Service Header No.=FIELD(No.)));
                                                   CaptionML=[ENU=Voucher Exists;
                                                              FRA=Justificatif existe];
                                                   Editable=No }
    { 50487;  ;No. Of Voucher      ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Service Header Voucher" WHERE (Service Header No.=FIELD(No.),
                                                                                                     Post=FIELD(Voucher Posted Filter)));
                                                   CaptionML=[ENU=No. Of Voucher;
                                                              FRA=Nombre de justificatif];
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 50488;  ;Service Address Options;Integer    ;FieldClass=FlowField;
                                                   CalcFormula=Count("Service Header Address" WHERE (Service Header No.=FIELD(No.),
                                                                                                     Address Type=FILTER(Guarding|Moving|Public Storage)));
                                                   CaptionML=[ENU=Service Address Options;
                                                              FRA=Garanties IMH];
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 50489;  ;Service Accomm. Option Nb;Integer  ;FieldClass=FlowField;
                                                   CalcFormula=Count("Service Accomm. Option" WHERE (Service Header No.=FIELD(No.),
                                                                                                     Used=CONST(Yes)));
                                                   CaptionML=[ENU=Service Accomm. Option Nb;
                                                              FRA=Nbre options garantie compl‚mentaire];
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 50490;  ;Person Involved Exist;Boolean      ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Service Header Address" WHERE (Service Header No.=FIELD(No.),
                                                                                                     Address Type=CONST(Contact involved)));
                                                   CaptionML=[ENU=Person Involved;
                                                              FRA=Tiers impliqu‚ existe];
                                                   Editable=No }
    { 50491;  ;Service Header Diag. Elmts Nbr;Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count("Service Diagnosis Element" WHERE (Service Header No.=FIELD(No.),
                                                                                                        Diagnosis Status=CONST(Yes)));
                                                   CaptionML=[ENU=Service Header Diag. Elmts Nbr;
                                                              FRA=Nbre ‚l‚ments diag.];
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 50492;  ;Corporate Name      ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Customer.Name WHERE (Service Contact=CONST(Corporate Customer),
                                                                                           No.=FIELD(Corporate No.)));
                                                   CaptionML=[ENU=Corporate Name;
                                                              FRA=Nom grand compte];
                                                   Editable=No }
    { 50493;  ;Corporate Region Name;Text50       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Corporate Region".Name WHERE (Corporate No.=FIELD(Corporate No.),
                                                                                                     Region Code=FIELD(Corporate Region Code)));
                                                   CaptionML=[ENU=Corporate Region Name;
                                                              FRA=Nom r‚gion grand compte];
                                                   Editable=No }
    { 50494;  ;Contract Form Name  ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Corporate Contract".Name WHERE (Corporate No.=FIELD(Corporate No.),
                                                                                                       Contract Form Code=FIELD(Contract Form Code)));
                                                   CaptionML=[ENU=Contract Form Name;
                                                              FRA=Nom formule];
                                                   Editable=No }
    { 50495;  ;Person Involved     ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Service Header Address" WHERE (Service Header No.=FIELD(No.),
                                                                                                     Address Type=CONST(Contact involved)));
                                                   CaptionML=[ENU=Person Involved;
                                                              FRA=Tiers impliqu‚];
                                                   Editable=No }
    { 50496;  ;Campaign Description;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Campaign.Description WHERE (No.=FIELD(Campaign No.)));
                                                   CaptionML=[ENU=Campaign Name;
                                                              FRA=D‚signation ‚vŠnement exceptionnel];
                                                   Editable=No }
    { 50497;  ;Building Trade Description;Text50  ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Building Trade".Description WHERE (No.=FIELD(Building Trade)));
                                                   CaptionML=[ENU=Building Trade description;
                                                              FRA=D‚signation corps de m‚tier];
                                                   Editable=No }
    { 50498;  ;Main Speciality Description;Text50 ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Specialization.Description WHERE (Code=FIELD(Main Speciality)));
                                                   OnValidate=VAR
                                                                lServCode@1100281000 : Record 50040;
                                                              BEGIN
                                                              END;

                                                   CaptionML=[ENU=Main Speciality Description;
                                                              FRA=D‚signation sp‚cialit‚ principale];
                                                   Editable=No }
    { 50499;  ;Service Cause Description;Text30   ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Fault Reason Code".Description WHERE (Code=FIELD(Service Cause)));
                                                   CaptionML=[ENU=Service Cause Description;
                                                              FRA=D‚signation cause intervention];
                                                   Editable=No }
    { 50500;  ;Creation Date       ;DateTime      ;CaptionML=[ENU=Creation Date;
                                                              FRA=Date de cr‚ation];
                                                   Editable=No }
    { 50501;  ;Creation User ID    ;Text30        ;TableRelation="User Setup"."User ID";
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Creation User ID;
                                                              FRA=Utilisateur cr‚ation];
                                                   Editable=No }
    { 50502;  ;Last Modification Date;DateTime    ;CaptionML=[ENU=Last Modification Date;
                                                              FRA=Date derniŠre modification];
                                                   Editable=No }
    { 50503;  ;Last Modification User ID;Text30   ;TableRelation="User Setup"."User ID";
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Last Modification User ID;
                                                              FRA=Utilisateur derniŠre modification];
                                                   Editable=No }
    { 50520;  ;Process Code        ;Code10        ;TableRelation=Process.Code WHERE (Source Data=CONST(ServiceHeader));
                                                   CaptionML=[ENU=Process Code;
                                                              FRA=Code processus];
                                                   Editable=No }
    { 50521;  ;Process Status No.  ;Integer       ;TableRelation="Process Status"."Status No." WHERE (Process Code=FIELD(Process Code));
                                                   OnValidate=VAR
                                                                lProcessServHeaderMgt@1100281000 : Codeunit 50043;
                                                              BEGIN
                                                                //<<IMH120
                                                                lProcessServHeaderMgt.SetXRec(xRec);
                                                                //>>IMH120
                                                                lProcessServHeaderMgt.OnChangeProcessStatus(Rec);
                                                              END;

                                                   CaptionML=[ENU=Process Status No.;
                                                              FRA=Nø statut processus];
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 50522;  ;Process Status Description;Text30  ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Process Status".Description WHERE (Process Code=FIELD(Process Code),
                                                                                                          Status No.=FIELD(Process Status No.)));
                                                   OnLookup=VAR
                                                              lProcessStatusHistory@1100281000 : Record 50047;
                                                            BEGIN
                                                              lProcessStatusHistory.ListHistory(FALSE, DATABASE::"Service Header","No.", '', 0,0);
                                                            END;

                                                   CaptionML=[ENU=Status Description;
                                                              FRA=Description statut];
                                                   Editable=No }
    { 50523;  ;User Next Step Available;Boolean   ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Process Step" WHERE (Process Code=FIELD(Process Code),
                                                                                           Previous Status=FIELD(Process Status No.),
                                                                                           Active=CONST(Yes),
                                                                                           Manual User Step=CONST(Yes)));
                                                   CaptionML=[ENU=User Next Step Available;
                                                              FRA=Etape suivante disponible];
                                                   Editable=No }
    { 50530;  ;RC Receipt Date     ;Date          ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Service Intervention Line"."RC Receipt Date" WHERE (Service Header No.=FIELD(No.)));
                                                   CaptionML=[ENU=RC Receipt Date;
                                                              FRA=Date r‚ception compte-rendu] }
    { 50602;  ;Sale Order Nb       ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Header" WHERE (Document Type=CONST(Order),
                                                                                           Service Header No.=FIELD(No.),
                                                                                           Service No.=FIELD(Service No.)));
                                                   OnLookup=VAR
                                                              lSalesHeader@1100281000 : Record 36;
                                                              lCounter@1100281001 : Integer;
                                                            BEGIN
                                                              lSalesHeader.SETCURRENTKEY("Service No.","Service Header No.","Intervention Line No.","Quote Line No.");
                                                              lSalesHeader.SETRANGE("Service No.","Service No.");
                                                              lSalesHeader.SETRANGE("Service Header No.","No.");
                                                              lSalesHeader.SETRANGE("Document Type",lSalesHeader."Document Type"::Order);
                                                              lCounter := lSalesHeader.COUNT;
                                                              CASE lCounter OF
                                                                0 : ;
                                                                1 : FORM.RUNMODAL(FORM::"Sales Order",lSalesHeader);
                                                                ELSE FORM.RUNMODAL(FORM::"Sales List",lSalesHeader);
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Sale Order Nb;
                                                              FRA=Nb commande vente];
                                                   Editable=No }
    { 50603;  ;Purchase Order Nb   ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Purchase Header" WHERE (Document Type=CONST(Order),
                                                                                              Service Header No.=FIELD(No.),
                                                                                              Service No.=FIELD(Service No.)));
                                                   OnLookup=VAR
                                                              lPurchaseHeader@1100281000 : Record 38;
                                                              lCounter@1100281001 : Integer;
                                                            BEGIN
                                                              lPurchaseHeader.SETCURRENTKEY("Service No.","Service Header No.","Intervention Line No.","Quote Line No.");
                                                              lPurchaseHeader.SETRANGE("Service No.","Service No.");
                                                              lPurchaseHeader.SETRANGE("Service Header No.","No.");
                                                              lPurchaseHeader.SETRANGE("Document Type",lPurchaseHeader."Document Type"::Order);
                                                              lCounter := lPurchaseHeader.COUNT;
                                                              CASE lCounter OF
                                                                0 : ;
                                                                1 : FORM.RUNMODAL(FORM::"Purchase Order",lPurchaseHeader);
                                                                ELSE FORM.RUNMODAL(FORM::"Purchase List",lPurchaseHeader);
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Purchase Order Nb;
                                                              FRA=Nb commande achat];
                                                   Editable=No }
    { 50610;  ;Diagnostician Ref.  ;Text30        ;CaptionML=[ENU=Diagnostician Ref.;
                                                              FRA=R‚f. diagnostiqueur] }
    { 50650;  ;Claimed Service Header;Boolean     ;OnValidate=VAR
                                                                ServiceHeaderClaimsMgt@1100281000 : Codeunit 50068;
                                                              BEGIN
                                                                TESTFIELD("Service Header Claims No.", '');
                                                                IF "Claimed Service Header" THEN BEGIN
                                                                  IF NOT ServiceHeaderClaimsMgt.CreateClaimsByServHeader(Rec) THEN
                                                                    ERROR('');
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Claimed Service Header;
                                                              FRA=En r‚clamation] }
    { 50651;  ;Service Header Claims No.;Code20   ;CaptionML=[ENU=Service Header Claims No.;
                                                              FRA=Nø ligne produit r‚clamation] }
    { 50660;  ;Claim Visit Date    ;Date          ;OnValidate=VAR
                                                                lNetworkFacilitatorVisitMgt@1000000000 : Codeunit 50076;
                                                              BEGIN
                                                                //IMH102
                                                                lNetworkFacilitatorVisitMgt.CreateUpdtVisitByClaimService(Rec);
                                                              END;

                                                   CaptionML=FRA=Date de visite r‚clamation }
    { 50661;  ;Claim Visit Time    ;Time          ;OnValidate=VAR
                                                                lNetworkFacilitatorVisitMgt@1000000000 : Codeunit 50076;
                                                              BEGIN
                                                                //IMH102
                                                                lNetworkFacilitatorVisitMgt.CreateUpdtVisitByClaimService(Rec);
                                                              END;

                                                   CaptionML=FRA=Heure de visite r‚clamation }
    { 50700;  ;TeleExpert          ;Text50        ;CaptionML=[ENU=TeleExpert;
                                                              FRA=Nom t‚l‚ expert] }
    { 50710;  ;Expert Contact No.  ;Code20        ;TableRelation=Contact WHERE (Company No.=FIELD(Princ. Expert Contact No.),
                                                                                Type=CONST(Person));
                                                   CaptionML=[ENU=Expert Contact No.;
                                                              FRA=Nø contact expert] }
    { 50711;  ;Expert Ref.         ;Text30        ;CaptionML=[ENU=Expert Ref.;
                                                              FRA=R‚ference expert] }
    { 50712;  ;Expert Contact Name ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact.Name WHERE (No.=FIELD(Expert Contact No.)));
                                                   CaptionML=[ENU=Expert Contact Name;
                                                              FRA=Nom expert];
                                                   Editable=No }
    { 50713;  ;Princ. Expert Contact No.;Code20   ;TableRelation=Contact WHERE (Service Contact=CONST(Expert),
                                                                                Type=FILTER(Company));
                                                   OnLookup=VAR
                                                              lExpertList@1100281000 : Form 50212;
                                                              lContact@1100281001 : Record 5050;
                                                            BEGIN
                                                              IF NOT lContact.GET("Princ. Expert Contact No.") THEN
                                                                CLEAR(lContact);
                                                              lExpertList.SETRECORD(lContact);
                                                              lExpertList.LOOKUPMODE(TRUE);
                                                              IF lExpertList.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                                                lExpertList.GETRECORD(lContact);
                                                                VALIDATE("Princ. Expert Contact No.", lContact."No.");
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Princ. Expert Contact No.;
                                                              FRA=Nø contact cabinet expert] }
    { 50714;  ;Princ. Expert Contact Name;Text50  ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact.Name WHERE (No.=FIELD(Princ. Expert Contact No.)));
                                                   CaptionML=[ENU=Princ. Expert Contact Name;
                                                              FRA=Nom cabinet expert] }
    { 50750;  ;Provider Name       ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Provider.Name WHERE (No.=FIELD(Provider No.)));
                                                   OnValidate=VAR
                                                                ContBusRel@1001 : Record 5054;
                                                                Cust@1000 : Record 18;
                                                                Vend@1002 : Record 23;
                                                              BEGIN
                                                              END;

                                                   CaptionML=[ENU=Provider Name;
                                                              FRA=Raison sociale prestataire];
                                                   Editable=No }
    { 50751;  ;Provider Address    ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Provider.Address WHERE (No.=FIELD(Provider No.)));
                                                   CaptionML=[ENU=Provider Address;
                                                              FRA=Adresse prestataire];
                                                   Editable=No }
    { 50752;  ;Provider Address 2  ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Provider."Address 2" WHERE (No.=FIELD(Provider No.)));
                                                   CaptionML=[ENU=Provider Address 2;
                                                              FRA=Adresse (2Šme ligne) prestataire];
                                                   Editable=No }
    { 50753;  ;Provider City       ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Provider.City WHERE (No.=FIELD(Provider No.)));
                                                   CaptionML=[ENU=Provider City;
                                                              FRA=Ville prestataire];
                                                   Editable=No }
    { 50754;  ;Provider Post Code  ;Code20        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Provider."Post Code" WHERE (No.=FIELD(Provider No.)));
                                                   TableRelation="Post Code";
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Provider Post Code;
                                                              FRA=Code postal prestataire];
                                                   Editable=No }
    { 50755;  ;Provider County     ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Provider.County WHERE (No.=FIELD(Provider No.)));
                                                   CaptionML=[ENU=Provider County;
                                                              FRA=R‚gion prestataire];
                                                   Editable=No }
    { 50756;  ;Provider Phone No.  ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Provider."Phone No." WHERE (No.=FIELD(Provider No.)));
                                                   ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Provider Phone No.;
                                                              FRA=Nø t‚l‚phone prestataire];
                                                   Editable=No }
    { 50757;  ;Provider Mobile Phone No.;Text30   ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Provider."Mobile Phone No." WHERE (No.=FIELD(Provider No.)));
                                                   ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Provider Mobile Phone No.;
                                                              FRA=Nø t‚l‚phone mobile prestataire];
                                                   Editable=No }
    { 50758;  ;Provider Fax No.    ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Provider."Fax No." WHERE (No.=FIELD(Provider No.)));
                                                   CaptionML=[ENU=Provider Fax No.;
                                                              FRA=Nø fax prestataire];
                                                   Editable=No }
    { 50800;  ;Payment Method      ;Option        ;OnValidate=BEGIN
                                                                IF "Payment Method" = "Payment Method"::"Credit Card" THEN BEGIN
                                                                  IF "Check No." <> '' THEN BEGIN
                                                                  ERROR('Vous ne pouvez pas modifier cette valeur car une commande existe d‚j….');
                                                                  //TESTFIELD("Check No.", '');
                                                                //<<IMH82.ISAT.EBA
                                                                  //"Cheque / BC Receipt Date" := WORKDATE;
                                                                //>>IMH82.ISAT.EBA
                                                                  END;
                                                                END;

                                                                IF "Payment Method" = "Payment Method"::Cheque THEN BEGIN
                                                                  IF "BC Transaction No." <> '' THEN BEGIN
                                                                  ERROR('Vous ne pouvez pas modifier cette valeur car une commande existe d‚j….');
                                                                  //TESTFIELD("BC Transaction No.", '');
                                                                //<<IMH85.ISAT.SB
                                                                  //"Cheque / BC Receipt Date" := WORKDATE;
                                                                //>>IMH85.ISAT.SB
                                                                END;
                                                                END;
                                                                UpdatePaymentMethodCode(); // IMH41.ISAT.MA
                                                              END;

                                                   CaptionML=[ENU=Payment Method;
                                                              FRA=Mode de rŠglement];
                                                   OptionCaptionML=[ENU=" ,Credit Card,Cheque";
                                                                    FRA=" ,Carte Bancaire,ChŠque"];
                                                   OptionString=[ ,Credit Card,Cheque];
                                                   BlankZero=Yes }
    { 50802;  ;Access Condition    ;Text80        ;CaptionML=[ENU=Access Condition;
                                                              FRA=Condition d'accŠs] }
    { 50810;  ;Completed Product   ;Boolean       ;CaptionML=[ENU=Completed Product;
                                                              FRA=Produit compl‚t‚] }
    { 51000;  ;Date of Last Interaction;Date      ;FieldClass=FlowField;
                                                   CalcFormula=Max("Interaction Log Entry".Date WHERE (Service No.=FIELD(Service No.),
                                                                                                       Service Header No.=FIELD(No.),
                                                                                                       Date=FIELD(Date Filter),
                                                                                                       Contact Company No.=FIELD(Contact Company Filter),
                                                                                                       Interaction Template Code=FIELD(Interaction Template Filter),
                                                                                                       Attempt Failed=CONST(No),
                                                                                                       Postponed=CONST(No)));
                                                   CaptionML=[ENU=Date of Last Interaction;
                                                              FRA=Date derniŠre interaction];
                                                   Editable=No }
    { 51001;  ;Interaction Template Filter;Code10 ;FieldClass=FlowFilter;
                                                   TableRelation="Interaction Template".Code;
                                                   CaptionML=[ENU=Interaction Template Filter;
                                                              FRA=Filtre modŠle interaction] }
    { 51002;  ;Contact Company Filter;Code10      ;FieldClass=FlowFilter;
                                                   TableRelation=Contact.No. WHERE (Type=CONST(Company));
                                                   CaptionML=[ENU=Contact Company Filter;
                                                              FRA=Filtre soci‚t‚ contact] }
    { 56011;  ;GUID Fusion Code    ;Code40        ;CaptionML=[ENU=GUID Fusion Code;
                                                              FRA=Code Fusion GUID] }
    { 56012;  ;Fusion Status       ;Option        ;CaptionML=[ENU=Fusion Status;
                                                              FRA=Statut Fusion];
                                                   OptionCaptionML=[ENU=" ,Waiting,Error,Integrated";
                                                                    FRA=" ,En attente,En erreur,Int‚gr‚"];
                                                   OptionString=[ ,Waiting,Error,Integrated] }
    { 56013;  ;Fusion Service      ;Boolean       ;CaptionML=[ENU=Fusion Service;
                                                              FRA=Service Fusion] }
    { 56014;  ;Fusion Reference No.;Text30        ;CaptionML=[ENU=Reference No.;
                                                              FRA=Nø r‚f‚rence Fusion] }
    { 56015;  ;Fusion Service Status;Text50       ;OnValidate=BEGIN
                                                                //<<IMH70.ST
                                                                IF "Fusion Service Status" <> '' THEN BEGIN
                                                                END;
                                                                //>>IMH70.ST
                                                              END;

                                                   CaptionML=[ENU=Fusion Service Status;
                                                              FRA=Statut service Fusion] }
    { 56016;  ;Fusion Service Status Created;Boolean;
                                                   CaptionML=[ENU=Fusion Service Status Created;
                                                              FRA=Fusion service statut cr‚ation] }
    { 56017;  ;New Service Order Type;Code10      ;TableRelation="Service Order Type".Code;
                                                   CaptionML=[ENU=New Service Order Type;
                                                              FRA=Nouveau type produit] }
    { 56019;  ;DARVA Interface     ;Boolean       ;CaptionML=[ENU=DARVA Interface;
                                                              FRA=Interface DARVA] }
    { 56020;  ;DARVA Carrier Subscriber No.;Code20;CaptionML=FRA=Nø abonn‚ emetteur DARVA }
    { 56021;  ;DARVA Recipient Subscriber No.;Code20;
                                                   CaptionML=FRA=Nø abonn‚ destinataire DARVA }
    { 56022;  ;SDR64 Send          ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Interface Reference" WHERE (Source Table ID=CONST(5900),
                                                                                                  Source No.=FIELD(No.),
                                                                                                  SDR64 Send=CONST(Yes)));
                                                   CaptionML=[ENU=SDR64 Send;
                                                              FRA=SDR64 envoy‚e];
                                                   Editable=No }
    { 56023;  ;SDR99 Send          ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Interface Reference" WHERE (Source Table ID=CONST(5900),
                                                                                                  Source No.=FIELD(No.),
                                                                                                  SDR99 New DT=CONST(Yes)));
                                                   CaptionML=[ENU=SDR99 New DT;
                                                              FRA=SDR99 nouvelle DT];
                                                   Editable=No }
    { 56030;  ;EAI Entry No.       ;Code20        ;CaptionML=[ENU=EAI Entry No.;
                                                              FRA=Nø s‚quence EAI];
                                                   Editable=No }
    { 57010;  ;PMU Owner No.       ;Code10        ;CaptionML=FRA=Code ‚metteur PMU }
    { 57011;  ;PMU Flux Type       ;Code10        ;CaptionML=FRA=Type flux PMU }
    { 57012;  ;PMU Interface       ;Boolean       ;CaptionML=[ENU=PMU Interface;
                                                              FRA=Interface PMU] }
    { 57013;  ;IMA Reference No.   ;Code30        ;CaptionML=[ENU=IMA Reference No.;
                                                              FRA=Nø r‚f‚rence IMA] }
  }
  KEYS
  {
    {    ;Document Type,No.                       ;Clustered=Yes }
    {    ;No.,Document Type                       ;MaintainSQLIndex=No }
    {    ;Customer No.,Order Date                 ;MaintainSQLIndex=No }
    {    ;Contract No.,Status,Posting Date        ;MaintainSQLIndex=No }
    {    ;Status,Response Date,Response Time,Priority;
                                                   MaintainSQLIndex=No }
    {    ;Status,Priority,Response Date,Response Time;
                                                   MaintainSQLIndex=No }
    {    ;Document Type,Customer No.,Order Date   ;MaintainSQLIndex=No }
    {    ;Contact No.,Corporate No.,No.            }
    {    ;Contact Name,Corporate No.              ;KeyGroups=SearchCont }
    {    ;Service No.                              }
    {    ;Service Order Type,Status                }
    {    ;Corporate No.,Service Order Type,No.     }
    {    ;GUID Fusion Code                         }
    {    ;Campaign No.                             }
    {    ;Process Code,Process Status No.          }
    {    ;Service Creation Date                    }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;No.,Service Order Type,Contact Name,No. of Intervention Lines }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=You cannot delete this document. Your identification is set up to process from %1 %2 only.;FRA=Vous ne pouvez pas supprimer ce document. Le param‚trage de votre code utilisateur ne vous permet de travailler que sur %1 %2.';
      Text001@1001 : TextConst 'ENU=Changing %1 in %2 %3 will not update the existing service lines.\;FRA=La modification de %1 dans %2 %3 ne met pas … jour les lignes service existantes.\';
      Text002@1095 : TextConst 'ENU=Do you want to print credit memo %1?;FRA=Souhaitez-vous imprimer l''avoir %1?';
      Text003@1003 : TextConst 'ENU=You cannot change the %1 because the %2 %3 %4 is associated with a %5 %6.;FRA=Vous ne pouvez pas modifier le %1, car le %2 %3 %4 est associ‚ … un %5 %6.';
      Text004@1004 : TextConst 'ENU=When you change the %1 the existing %2 and %3 will be deleted.\;FRA=Si vous modifiez %1, les enregistrements de type %2 et %3 existants seront supprim‚s.\';
      Text005@1005 : TextConst 'ENU=Do you want to change the %1?;FRA=Souhaitez-vous modifier l''enregistrement %1 ?';
      Text006@1090 : TextConst 'ENU=An empty posted invoice %1 will be created to fill this gap in the number series.\\;FRA=Une facture enregistr‚e vide %1 va ˆtre cr‚‚e pour ‚viter une discontinuit‚ dans les num‚ros.\\';
      Text007@1007 : TextConst 'ENU=%1 cannot be greater than %2.;FRA=L''%1 ne peut pas ˆtre sup‚rieur … l''%2.';
      Text008@1008 : TextConst 'ENU="You cannot create Service %1 with %2=%3 because this number has already been used in the system.";FRA="Vous ne pouvez pas cr‚er de %1 Service avec %2=%3 car cette valeur a d‚j… ‚t‚ utilis‚e dans le systŠme."';
      Text009@1092 : TextConst 'ENU=An empty shipment %1 will be created to fill this gap in the number series.\\;FRA=Une exp‚dition vide %1 va ˆtre cr‚‚e pour ‚viter une discontinuit‚ dans les num‚ros.\\';
      Text010@1010 : TextConst 'ENU=Your identification is set up to process from %1 %2 only.;FRA=Le param‚trage de votre code utilisateur ne vous permet de travailler que sur %1 %2.';
      Text011@1011 : TextConst 'ENU=%1 cannot be greater than %2 in the %3 table.;FRA=%1 ne peut pas ˆtre sup‚rieur(e) … %2 dans la table %3.';
      Text012@1012 : TextConst 'ENU=If you change %1, the existing service lines will be deleted and the program will create new service lines based on the new information on the header.\;FRA=Si vous modifiez %1, les lignes service seront supprim‚es et le programme cr‚era des lignes service bas‚es sur les nouvelles informations de l''en-tˆte.\';
      Text013@1089 : TextConst 'ENU="Deleting this document will cause a gap in the number series for posted credit memos. ";FRA="La suppression de ce document va provoquer une discontinuit‚ dans la souche avoirs enregistr‚s. "';
      Text014@1081 : TextConst 'ENU=An empty posted credit memo %1 will be created to fill this gap in the number series.\\;FRA=Un avoir enregistr‚ vide %1 va ˆtre cr‚‚ pour ‚viter une discontinuit‚ dans les num‚ros.\\';
      Text015@1015 : TextConst 'ENU=Do you want to update the exchange rate?;FRA=Souhaitez-vous mettre … jour le taux de change ?';
      Text016@1016 : TextConst 'ENU=You have modified %1.\;FRA=Vous avez modifi‚ le champ %1.\';
      Text017@1017 : TextConst 'ENU=Do you want to update the service lines?;FRA=Souhaitez-vous mettre … jour les lignes service ?';
      Text018@1018 : TextConst 'ENU="You have not specified the %1 for %2 %3=%4, %5=%6.";FRA="Vous n''avez pas d‚fini le %1 pour %2 %3=%4, %5=%6."';
      Text019@1019 : TextConst 'ENU=You have changed %1 on the service header, but it has not been changed on the existing service lines.\;FRA=Vous avez modifi‚ le champ %1 dans l''en-tˆte service, mais il n''a pas ‚t‚ modifi‚ dans les lignes service.\';
      Text020@1020 : TextConst 'ENU=The change may affect the exchange rate used in the price calculation of the service lines.;FRA=Cette modification va affecter le taux de change utilis‚ pour le calcul des prix des lignes service.';
      Text021@1021 : TextConst 'ENU=You have changed %1 on the %2, but it has not been changed on the existing service lines.\;FRA=Vous avez modifi‚ %1 du/de la %2, mais il/elle n''a pas ‚t‚ modifi‚(e) sur les lignes service existantes.\';
      Text022@1022 : TextConst 'ENU=You must update the existing service lines manually.;FRA=Vous devez mettre manuellement … jour les lignes service existantes.';
      ServSetup@1023 : Record 5911;
      Cust@1024 : Record 18;
      ServHeader@1025 : Record 5900;
      ServLine@1026 : Record 5902;
      ServItemLine@1027 : Record 5901;
      ShiptoAddr@1028 : Record 222;
      ServOrderAlloc@1029 : Record 5950;
      ServCommentLine@1030 : Record 5906;
      PostCode@1031 : Record 225;
      GenBusPostingGrp@1032 : Record 250;
      CurrExchRate@1033 : Record 330;
      GLSetup@1034 : Record 98;
      RespCenter@1035 : Record 5714;
      ServContract@1036 : Record 5965;
      ServContractLine@1072 : Record 5964;
      RepairStatus@1058 : Record 5927;
      Loaner@1066 : Record 5913;
      LoanerEntry@1065 : Record 5914;
      GLAcc@1006 : Record 15;
      GenJnlLine@1014 : Record 81;
      BankAcc@1049 : Record 270;
      PaymentTerms@1074 : Record 3;
      PaymentMethod@1067 : Record 289;
      DocDim@1087 : Record 357;
      CustLedgEntry@1086 : Record 21;
      ServShptHeader@1085 : Record 5990;
      ServInvHeader@1084 : Record 5992;
      ServCrMemoHeader@1077 : Record 5994;
      ReservEntry@1076 : Record 337;
      TempReservEntry@1075 : TEMPORARY Record 337;
      ServOrderType@1100281012 : Record 5903;
      ServContractList@1071 : Form 6051;
      CommentNotificationMgt@1100281020 : Codeunit 50148;
      ServOrderMgt@1037 : Codeunit 5900;
      DimMgt@1038 : Codeunit 408;
      NoSeriesMgt@1039 : Codeunit 396;
      ServLogMgt@1040 : Codeunit 5906;
      CustCheckCreditLimit@1041 : Codeunit 312;
      TransferExtendedText@1042 : Codeunit 378;
      UserMgt@1043 : Codeunit 5700;
      NotifyCust@1044 : Codeunit 5915;
      GenJnlApply@1009 : Codeunit 225;
      ServPost@1101 : Codeunit 5980;
      FUSIONInterfaceMgt@1100281017 : Codeunit 50181;
      ServLog@1100281014 : Codeunit 50149;
      SalesInvoicingMgt@1100281013 : Codeunit 50079;
      ApplicationMgt@1100281005 : Codeunit 1;
      CurrencyDate@1046 : Date;
      TempLinkToServItem@1047 : Boolean;
      HideValidationDialog@1048 : Boolean;
      Text024@1002 : TextConst 'ENU=The %1 cannot be greater than the minimum %1 of the\ Service Item Lines.;FRA=Le/la %1 ne peut pas ˆtre sup‚rieur(e) au/… la %1 minimum des\ lignes article service.';
      Text025@1050 : TextConst 'ENU=The %1 cannot be less than the maximum %1 of the related\ Service Item Lines.;FRA=Le/la %1 ne peut pas ˆtre inf‚rieur(e) au/… la %1 maximum des\ lignes article service associ‚es.';
      Text026@1051 : TextConst 'ENU=%1 cannot be earlier than the %2.;FRA=%1 ne doit pas ˆtre ant‚rieure au %2.';
      Text027@1052 : TextConst 'ENU=The %1 cannot be greater than the minimum %2 of the related\ Service Item Lines.;FRA=Le/la %1 ne peut pas ˆtre sup‚rieur(e) au/… la %2 minimum des\ lignes article service associ‚es.';
      ValidatingFromLines@1053 : Boolean;
      LinesExist@1054 : Boolean;
      Text028@1057 : TextConst 'ENU=You cannot change the %1 because %2 exists.;FRA=Vous ne pouvez pas modifier %1 parce que il existe des %2.';
      Text029@1056 : TextConst 'ENU=The %1 field on the %2 will be updated if you change %3 manually.\;FRA=Le champ %1 du formulaire %2 sera mis … jour si vous modifiez manuellement la valeur %3.\';
      Text030@1055 : TextConst 'ENU=Do you want to continue?;FRA=Souhaitez-vous continuer ?';
      Text031@1059 : TextConst 'ENU=You cannot change %1 to %2 in %3 %4.\\%5 %6 in %7 %8 line is preventing it.;FRA=Vous ne pouvez pas modifier %1 en %2 dans %3%4.\\%5%6 de la ligne %7 %8 vous empˆche de le faire.';
      Text037@1060 : TextConst 'ENU=Contact %1 %2 is not related to customer %3.;FRA=Le contact %1 %2 n''est pas associ‚ au client %3.';
      Text038@1013 : TextConst 'ENU=Contact %1 %2 is related to a different company than customer %3.;FRA=Le contact %1 %2 est associ‚ … une soci‚t‚ diff‚rente de celle du client %3.';
      Text039@1061 : TextConst 'ENU=Contact %1 %2 is not related to a customer.;FRA=Le contact %1 %2 n''est associ‚ … aucun client.';
      Text040@1063 : TextConst 'ENU=You cannot delete %1 %2 because the %4 %5 for Service Item Line %3 has not been received.;FRA=Vous ne pouvez pas supprimer la %1 %2, car l''%4 %5 pour la ligne article de service %3 n''a pas ‚t‚ r‚ceptionn‚.';
      SkipContact@1064 : Boolean;
      SkipBillToContact@1062 : Boolean;
      Text041@1068 : TextConst 'ENU=Contract %1 is not signed.;FRA=Le contrat %1 n''a pas ‚t‚ sign‚.';
      Text042@1069 : TextConst 'ENU=The service period for contract %1 has not yet started.;FRA=La p‚riode de service du contrat %1 n''a pas encore commenc‚.';
      Text043@1070 : TextConst 'ENU=The service period for contract %1 has expired.;FRA=La p‚riode de service du contrat %1 a expir‚.';
      Text044@1073 : TextConst 'ENU=You cannot rename a %1.;FRA=Vous ne pouvez pas renommer l''enregistrement %1.';
      Confirmed@1080 : Boolean;
      Text045@1083 : TextConst 'ENU="You can not change the %1 field because %2 %3 has %4 = %5 and the %6 has already been assigned %7 %8.";FRA="Vous ne pouvez pas modifier le champ %1 car %2 %3 a %4 = %5 et %6 a d‚j… ‚t‚ affect‚(e) … %7 %8."';
      Text046@1104 : TextConst 'ENU=You cannot delete invoice %1 because one or more service ledger entries exist for this invoice.;FRA=Vous ne pouvez pas supprimer la facture %1 car il existe une ou plusieurs ‚critures comptables service pour cette facture.';
      Text047@1100 : TextConst 'ENU=You cannot change %1 because reservation, item tracking, or order tracking exists on the sales order.;FRA=Vous ne pouvez pas modifier %1 car une r‚servation, une tra‡abilit‚ ou un chaŒnage existe sur la commande vente.';
      Text048@1097 : TextConst 'ENU=Do you want to print shipment %1?;FRA=Souhaitez-vous imprimer le B.L. %1?';
      Text049@1096 : TextConst 'ENU=Do you want to print invoice %1?;FRA=Souhaitez-vous imprimer la facture %1?';
      Text050@1094 : TextConst 'ENU=You cannot reset %1 because the document still has one or more lines.;FRA=Impossible de r‚initialiser %1 car le document contient une ou plusieurs ligne(s).';
      Text051@1082 : TextConst 'ENU=The service %1 %2 already exists.;FRA=Le service %1 %2 existe d‚j….';
      Text052@1098 : TextConst 'ENU=The service %1 %2 has item tracking. Do you want to delete it anyway?;FRA=Le service %1 %2 a une tra‡abilit‚. Souhaitez-vous quand mˆme le supprimer ?';
      Text053@1093 : TextConst 'ENU="Deleting this document will cause a gap in the number series for shipments. ";FRA="La suppression de ce document va provoquer une discontinuit‚ dans la souche exp‚dition. "';
      Text054@1091 : TextConst 'ENU="Deleting this document will cause a gap in the number series for posted invoices. ";FRA="La suppression de ce document va provoquer une discontinuit‚ dans la souche fact. enregistr‚es. "';
      Text055@1079 : TextConst 'ENU="You have modified the %1 field. Note that the recalculation of VAT may cause penny differences, so you must check the amounts afterwards. ";FRA="Vous avez modifi‚ le champ %1. Le recalcul de la TVA va provoquer de petites diff‚rences. Veuillez v‚rifier les montants. "';
      Text056@1078 : TextConst 'ENU=Do you want to update the %2 field on the lines to reflect the new value of %1?;FRA=Souhaitez-vous mettre … jour le champ %2 sur les lignes pour refl‚ter la nouvelle valeur de %1 ?';
      Text057@1103 : TextConst 'ENU=When you change the %1 the existing %2 will be deleted.\;FRA=Si vous changez le %1, la %2 existante sera supprim‚e.\';
      Text058@1088 : TextConst 'ENU=You cannot change %1 because %2 %3 is linked to Contract %4.;FRA=Vous ne pouvez pas modifier le %1 car %2 %3 est li‚(e) au contrat %4.';
      Text060@1154 : TextConst 'ENU=%1 is set up to process from %2 %3 only.;FRA=%1 est param‚tr‚ pour traiter uniquement … partir de %2 %3.';
      Text50000@1100281000 : TextConst 'ENU=Requested Realised Date must be formated as YY/MM;FRA=La p‚riode souhait‚e des travaux doit ˆtre au format MM/AA';
      Text50001@1100281001 : TextConst 'ENU=You must specify beneficiairy contract.;FRA=Vous devez sp‚cifier le contrat b‚n‚ficiaire.';
      Text50002@1100281002 : TextConst 'ENU=%1 is not active on beneficiairy contract.;FRA=%1 n''est pas autoris‚ sur le contrat b‚n‚ficiaire.';
      Text50003@1100281003 : TextConst 'ENU=Criteria are not met to create the intervention;FRA=Les critŠres (facture origine, montant achat, date d''achat, garantie)  ne sont pas remplis pour cr‚er l''intervention';
      Text50004@1100281004 : TextConst 'ENU=You must enter at least one location and speciality;FRA=Vous devez saisir au moins un moyen mis en oeuvre (lieu et sp‚cialit‚)';
      Text50005@1100281008 : TextConst 'ENU=Excl. VAT;FRA=HT';
      Text50006@1100281007 : TextConst 'ENU=Incl. VAT;FRA=TTC';
      Text50007@1100281006 : TextConst 'ENU=No default tray line found.;FRA=Aucune corbeille de service trouv‚e.';
      Text50008@1100281009 : TextConst 'ENU=The field% 1 of the shipment address is % 2, modify ?;FRA=Le champ %1 de l''adresse de mise en oeuvre … la valeur %2, modifier ?';
      ServSetupGet@1100281010 : Boolean;
      SkipCheck@1100281011 : Boolean;
      Text50009@1100281015 : TextConst 'ENU=%1 can''t be before workdate.;FRA=%1 ne peut ˆtre inf‚rieur … la date du jour.';
      Text50010@1100281016 : TextConst 'ENU=%1 can''t be after %2;FRA=%1 ne peut ˆtre aprŠs %2.';
      Text50011@1100281018 : TextConst 'ENU=Field Urgent is required;FRA=Champ Urgent obligatoire';
      Text50012@1100281019 : TextConst 'ENU=Intervention description is mandatory.;FRA=Le chiffrage est obligatoire.';
      Text50013@1100281021 : TextConst 'ENU=Do you want to modify the ship-to address code?;FRA=Souhaitez-vous modifier le code adresse MEO?';
      Text50014@1100281022 : TextConst 'ENU=%1 must be before workdate.;FRA=La %1 doit ˆtre inf‚rieure ou ‚gale … la date du jour.';
      Text50015@1000000000 : TextConst 'ENU=You don''t have enougth permissions to create intervention.;FRA=Vous ne disposez pas des droits suffisants pour cr‚er une intervention.';
      SkipAutoStep@1100281023 : Boolean;
      DisableNotif@1100281024 : Boolean;
      ContactNo@1100281025 : Code[20];
      DARVASetup@1000000001 : Record 50126;

    PROCEDURE AssistEdit@1(OldServHeader@1000 : Record 5900) : Boolean;
    VAR
      ServHeader2@1001 : Record 5900;
    BEGIN
      WITH ServHeader DO BEGIN
        COPY(Rec);
        ServSetup.GET;
        TestNoSeries;
        IF NoSeriesMgt.SelectSeries(GetNoSeriesCode,OldServHeader."No. Series","No. Series") THEN BEGIN
          IF ("Customer No." = '') AND ("Contact No." = '') THEN BEGIN
            CheckCreditMaxBeforeInsert(FALSE);
          END;
          NoSeriesMgt.SetSeries("No.");
          IF ServHeader2.GET("Document Type","No.") THEN
            ERROR(Text051,LOWERCASE(FORMAT("Document Type")),"No.");
          Rec := ServHeader;
          EXIT(TRUE);
        END;
      END;
    END;

    PROCEDURE CreateDim@16(Type1@1000 : Integer;No1@1001 : Code[20];Type2@1002 : Integer;No2@1003 : Code[20];Type3@1004 : Integer;No3@1005 : Code[20];Type4@1006 : Integer;No4@1007 : Code[20];Type5@1012 : Integer;No5@1011 : Code[20]);
    VAR
      SourceCodeSetup@1008 : Record 242;
      TempDocDim@1015 : TEMPORARY Record 357;
      ServContractDim@1017 : Record 389;
      TempDefDim@1018 : Record 352;
      No@1010 : ARRAY [10] OF Code[20];
      TableID@1009 : ARRAY [10] OF Integer;
      DeleteContractDim@1016 : Boolean;
    BEGIN
      SourceCodeSetup.GET;
      IF ServItemLineExists OR ServLineExists THEN
        TempDocDim.GetDimensions(DATABASE::"Service Header","Document Type","No.",0,TempDocDim);

      TableID[1] := Type1;
      No[1] := No1;
      TableID[2] := Type2;
      No[2] := No2;
      TableID[3] := Type3;
      No[3] := No3;
      TableID[4] := Type4;
      No[4] := No4;
      TableID[5] := Type5;
      No[5] := No5;

      "Shortcut Dimension 1 Code" := '';
      "Shortcut Dimension 2 Code" := '';

      IF "No." <> '' THEN BEGIN
        IF "Contract No." <> '' THEN BEGIN
          ServContractDim.SETRANGE("Table ID",DATABASE::"Service Contract Header");
          ServContractDim.SETRANGE(Type,ServContractDim.Type::Contract);
          ServContractDim.SETRANGE("No.","Contract No.");
          ServContractDim.SETRANGE("Line No.",0);
          IF ServContractDim.FIND('-') THEN BEGIN
            DeleteContractDim := TRUE;

            TempDefDim.SETRANGE("Table ID",DATABASE::"Service Contract Header");
            TempDefDim.SETRANGE("No.","Contract No.");
            IF TempDefDim.FIND('-') THEN
              TempDefDim.DELETEALL;

            TempDefDim.RESET;

            REPEAT
              TempDefDim.INIT;
              TempDefDim."Table ID" := DATABASE::"Service Contract Header";
              TempDefDim."No." := "Contract No.";
              TempDefDim."Dimension Code" := ServContractDim."Dimension Code";
              TempDefDim."Dimension Value Code" := ServContractDim."Dimension Value Code";
              TempDefDim.INSERT;
            UNTIL ServContractDim.NEXT = 0;
          END;
        END;

        DimMgt.GetDefaultDim(
          TableID,No,SourceCodeSetup."Service Management",
          "Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");

        DimMgt.UpdateDocDefaultDim(
          DATABASE::"Service Header","Document Type","No.",0,
          "Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;

      IF ServItemLineExists OR ServLineExists THEN
        TempDocDim.UpdateAllLineDim(DATABASE::"Service Header","Document Type","No.",TempDocDim);

      IF DeleteContractDim THEN BEGIN
        TempDefDim.SETRANGE("Table ID",DATABASE::"Service Contract Header");
        TempDefDim.SETRANGE("No.","Contract No.");
        TempDefDim.DELETEALL;
      END;
    END;

    PROCEDURE ValidateShortcutDimCode@19(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      DimMgt.ValidateDimValueCode(FieldNumber,ShortcutDimCode);
      IF "No." <> '' THEN BEGIN
        DimMgt.SaveDocDim(
          DATABASE::"Service Header","Document Type","No.",0,FieldNumber,ShortcutDimCode);
        MODIFY(TRUE);
      END ELSE
        DimMgt.SaveTempDim(FieldNumber,ShortcutDimCode);
    END;

    PROCEDURE LookupShortcutDimCode@18(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      DimMgt.LookupDimValueCode(FieldNumber,ShortcutDimCode);
      IF "No." <> '' THEN BEGIN
        DimMgt.SaveDocDim(
          DATABASE::"Service Header","Document Type","No.",0,FieldNumber,ShortcutDimCode);
        MODIFY(TRUE);
      END ELSE
        DimMgt.SaveTempDim(FieldNumber,ShortcutDimCode);
    END;

    LOCAL PROCEDURE UpdateCurrencyFactor@12();
    BEGIN
      IF "Currency Code" <> '' THEN BEGIN
        CurrencyDate := "Posting Date";
        "Currency Factor" := CurrExchRate.ExchangeRate(CurrencyDate,"Currency Code");
      END ELSE
        "Currency Factor" := 0;
    END;

    PROCEDURE RecreateServLines@2(ChangedFieldName@1000 : Text[100]);
    VAR
      TempServLine@1002 : TEMPORARY Record 5902;
      ServDocReg@1005 : Record 5936;
      TempServDocReg@1004 : TEMPORARY Record 5936;
      ExtendedTextAdded@1003 : Boolean;
    BEGIN
      IF ServLineExists THEN BEGIN
        IF HideValidationDialog OR NOT GUIALLOWED THEN
          Confirmed := TRUE
        ELSE
          Confirmed :=
            CONFIRM(
              Text012 +
              Text005,FALSE,ChangedFieldName);
        IF Confirmed THEN BEGIN
          DocDim.LOCKTABLE;
          ServLine.LOCKTABLE;
          ReservEntry.LOCKTABLE;
          MODIFY;

          ServLine.RESET;
          ServLine.SETRANGE("Document Type","Document Type");
          ServLine.SETRANGE("Document No.","No.");
          IF ServLine.FIND('-') THEN BEGIN
            REPEAT
              ServLine.TESTFIELD("Quantity Shipped",0);
              ServLine.TESTFIELD("Quantity Invoiced",0);
              ServLine.TESTFIELD("Shipment No.",'');
              TempServLine := ServLine;
              IF ServLine.Nonstock THEN BEGIN
                ServLine.Nonstock := FALSE;
                ServLine.MODIFY;
              END;
              TempServLine.INSERT;
              RecreateReservEntry(ServLine,0,TRUE);
            UNTIL ServLine.NEXT = 0;

            IF "Location Code" <> xRec."Location Code" THEN
              IF NOT TempReservEntry.ISEMPTY THEN
                ERROR(Text047,FIELDCAPTION("Location Code"));

            IF "Document Type" = "Document Type"::Invoice THEN BEGIN
              ServDocReg.SETCURRENTKEY("Destination Document Type","Destination Document No.");
              ServDocReg.SETRANGE("Destination Document Type",ServDocReg."Destination Document Type"::Invoice);
              ServDocReg.SETRANGE("Destination Document No.",TempServLine."Document No.");
              IF ServDocReg.FIND('-') THEN
                REPEAT
                  TempServDocReg := ServDocReg;
                  TempServDocReg.INSERT;
                UNTIL ServDocReg.NEXT = 0;
            END;
            ServLine.DELETEALL(TRUE);

            IF "Document Type" = "Document Type"::Invoice THEN BEGIN
              IF TempServDocReg.FIND('-') THEN
                REPEAT
                  ServDocReg := TempServDocReg;
                  ServDocReg.INSERT;
                UNTIL TempServDocReg.NEXT = 0;
            END;

            ServLine.INIT;
            ServLine."Line No." := 0;
            TempServLine.FIND('-');
            ExtendedTextAdded := FALSE;
            REPEAT
              IF TempServLine."Attached to Line No." = 0 THEN BEGIN
                ServLine.INIT;
                ServLine.SetHideReplacementDialog(TRUE);
                ServLine.SetHideCostWarning(TRUE);
                ServLine."Line No." := ServLine."Line No." + 10000;
                ServLine.VALIDATE(Type,TempServLine.Type);
                IF TempServLine."No." <> '' THEN BEGIN
                  ServLine.VALIDATE("No.",TempServLine."No.");
                  IF ServLine.Type <> ServLine.Type::" " THEN BEGIN
                    ServLine.VALIDATE("Unit of Measure Code",TempServLine."Unit of Measure Code");
                    ServLine.VALIDATE("Variant Code",TempServLine."Variant Code");
                    IF TempServLine.Quantity <> 0 THEN
                      ServLine.VALIDATE(Quantity,TempServLine.Quantity);
                  END;
                END;

                ServLine."Serv. Price Adjmt. Gr. Code" := TempServLine."Serv. Price Adjmt. Gr. Code";
                ServLine."Document No." := TempServLine."Document No.";
                ServLine."Service Item No." := TempServLine."Service Item No.";
                ServLine."Appl.-to Service Entry" := TempServLine."Appl.-to Service Entry";
                ServLine."Service Item Line No." := TempServLine."Service Item Line No.";
                ServLine.VALIDATE(Description,TempServLine.Description);
                ServLine.VALIDATE("Description 2",TempServLine."Description 2");

                IF TempServLine."No." <> '' THEN BEGIN
                  TempLinkToServItem := "Link Service to Service Item";
                  IF "Link Service to Service Item" THEN BEGIN
                    "Link Service to Service Item" := FALSE;
                    MODIFY(TRUE);
                  END;
                  ServLine."Spare Part Action" := TempServLine."Spare Part Action";
                  ServLine."Component Line No." := TempServLine."Component Line No.";
                  ServLine."Replaced Item No." := TempServLine."Replaced Item No.";
                  ServLine.VALIDATE("Work Type Code",TempServLine."Work Type Code");

                  ServLine."Location Code" := TempServLine."Location Code";
                  IF ServLine.Type <> ServLine.Type::" " THEN BEGIN
                    IF ServLine.Type = ServLine.Type::Item THEN BEGIN
                      ServLine.VALIDATE("Variant Code",TempServLine."Variant Code");
                      IF ServLine."Location Code" <> '' THEN
                        ServLine."Bin Code" := TempServLine."Bin Code";
                    END;
                    ServLine."Fault Reason Code" := TempServLine."Fault Reason Code";
                    ServLine."Exclude Warranty" := TempServLine."Exclude Warranty";
                    ServLine."Exclude Contract Discount" := TempServLine."Exclude Contract Discount";
                    ServLine.VALIDATE("Contract No.",TempServLine."Contract No.");
                    ServLine.VALIDATE(Warranty,TempServLine.Warranty);
                  END;
                  ServLine."Fault Area Code" := TempServLine."Fault Area Code";
                  ServLine."Symptom Code" := TempServLine."Symptom Code";
                  ServLine."Resolution Code" := TempServLine."Resolution Code";
                  ServLine."Fault Code" := TempServLine."Fault Code";
                END;
                "Link Service to Service Item" := TempLinkToServItem;

                ServLine.INSERT;
                ExtendedTextAdded := FALSE;

              END ELSE
                IF NOT ExtendedTextAdded THEN BEGIN
                  TransferExtendedText.ServCheckIfAnyExtText(ServLine,TRUE);
                  TransferExtendedText.InsertServExtText(ServLine);
                  ServLine.FIND('+');
                  ExtendedTextAdded := TRUE;
                END;
              RecreateReservEntry(TempServLine,ServLine."Line No.",FALSE);
            UNTIL TempServLine.NEXT = 0;

            TempServLine.SETRANGE(Type);
            TempServLine.DELETEALL;
          END;
        END ELSE
          ERROR('');
      END;
    END;

    LOCAL PROCEDURE ConfirmUpdateCurrencyFactor@13();
    BEGIN
      IF CONFIRM(Text015,FALSE) THEN
        VALIDATE("Currency Factor")
      ELSE
        "Currency Factor" := xRec."Currency Factor";
    END;

    PROCEDURE UpdateServLines@15(ChangedFieldName@1000 : Text[100];AskQuestion@1001 : Boolean);
    VAR
      Question@1002 : Text[250];
    BEGIN
      IF ServLineExists AND AskQuestion THEN BEGIN
        Question := STRSUBSTNO(
          Text016 +
          Text017,ChangedFieldName);
        IF GUIALLOWED AND NOT DIALOG.CONFIRM(Question,TRUE) THEN
          EXIT
      END;

      IF ServLineExists THEN BEGIN
        ServLine.LOCKTABLE;
        ServLine.RESET;
        ServLine.SETRANGE("Document Type","Document Type");
        ServLine.SETRANGE("Document No.","No.");

        ServLine.SETRANGE("Quantity Shipped",0);
        ServLine.SETRANGE("Quantity Invoiced",0);
        ServLine.SETRANGE("Quantity Consumed",0);
        ServLine.SETRANGE("Shipment No.",'');

        IF ServLine.FIND('-') THEN
          REPEAT
            CASE ChangedFieldName OF
              FIELDCAPTION("Currency Factor"):
                IF (ServLine."Posting Date" = "Posting Date") AND (ServLine.Type <> ServLine.Type::" ") THEN BEGIN
                  ServLine.VALIDATE("Unit Price");
                  ServLine.MODIFY(TRUE);
                END;
              FIELDCAPTION("Posting Date"):
                BEGIN
                  ServLine.VALIDATE("Posting Date","Posting Date");
                  ServLine.MODIFY(TRUE);
                END;
              FIELDCAPTION("Responsibility Center"):
                BEGIN
                  ServLine.VALIDATE("Responsibility Center","Responsibility Center");
                  ServLine.MODIFY(TRUE);
                  ServItemLine.RESET;
                  ServItemLine.SETRANGE("Document Type","Document Type");
                  ServItemLine.SETRANGE("Document No.","No.");
                  IF ServItemLine.FIND('-') THEN
                    REPEAT
                      ServItemLine.VALIDATE("Responsibility Center","Responsibility Center");
                      ServItemLine.MODIFY(TRUE);
                    UNTIL ServItemLine.NEXT = 0;
                END;
              FIELDCAPTION("Order Date"):
                BEGIN
                  ServLine."Order Date" := "Order Date";
                  ServLine.MODIFY(TRUE);
                END;
              FIELDCAPTION("Transaction Type"):
                BEGIN
                  ServLine.VALIDATE("Transaction Type","Transaction Type");
                  ServLine.MODIFY(TRUE);
                END;
              FIELDCAPTION("Transport Method"):
                BEGIN
                  ServLine.VALIDATE("Transport Method","Transport Method");
                  ServLine.MODIFY(TRUE);
                END;
              FIELDCAPTION("Exit Point"):
                BEGIN
                  ServLine.VALIDATE("Exit Point","Exit Point");
                  ServLine.MODIFY(TRUE);
                END;
              FIELDCAPTION(Area):
                BEGIN
                  ServLine.VALIDATE(Area,Area);
                  ServLine.MODIFY(TRUE);
                END;
              FIELDCAPTION("Transaction Specification"):
                BEGIN
                  ServLine.VALIDATE("Transaction Specification","Transaction Specification");
                  ServLine.MODIFY(TRUE);
                END;
            END;
          UNTIL ServLine.NEXT = 0;
      END;
    END;

    PROCEDURE TestMandatoryFields@9(VAR PassedServLine@1002 : Record 5902);
    BEGIN
      ServSetup.GET;
      IF ServSetup."Salesperson Mandatory" THEN
        TESTFIELD("Salesperson Code");

      IF "Document Type" = "Document Type"::Order THEN BEGIN
        IF ServSetup."Service Order Type Mandatory" AND ("Service Order Type" = '') THEN
          ERROR(Text018,
            FIELDCAPTION("Service Order Type"),TABLECAPTION,
            FIELDCAPTION("Document Type"),FORMAT("Document Type"),
            FIELDCAPTION("No."),FORMAT("No."));
        IF ServSetup."Service Order Start Mandatory" THEN BEGIN
          TESTFIELD("Starting Date");
          TESTFIELD("Starting Time");
        END;
        IF ServSetup."Service Order Finish Mandatory" THEN BEGIN
          TESTFIELD("Finishing Date");
          TESTFIELD("Finishing Time");
        END;
        IF ServSetup."Fault Reason Code Mandatory" AND NOT ValidatingFromLines THEN BEGIN
          ServItemLine.RESET;
          ServItemLine.SETRANGE("Document Type","Document Type");
          ServItemLine.SETRANGE("Document No.","No.");
          IF ServItemLine.FIND('-') THEN
            REPEAT
              ServItemLine.TESTFIELD("Fault Reason Code");
            UNTIL ServItemLine.NEXT = 0;
        END;
      END;
      PassedServLine.RESET;
      ServLine.RESET;
      ServLine.SETRANGE("Document Type","Document Type");
      ServLine.SETRANGE("Document No.","No.");

      IF PassedServLine.FIND('-') THEN
        REPEAT
          IF (PassedServLine."Qty. to Ship" <> 0) OR
             (PassedServLine."Qty. to Invoice" <> 0) OR
             (PassedServLine."Qty. to Consume" <> 0)
          THEN BEGIN
            IF ("Document Type" = "Document Type"::Order) AND
               "Link Service to Service Item" AND
               (PassedServLine.Type IN [PassedServLine.Type::Item,PassedServLine.Type::Resource])
            THEN
              PassedServLine.TESTFIELD("Service Item Line No.");

            CASE PassedServLine.Type OF
              PassedServLine.Type::Item:
                BEGIN
                  IF ServSetup."Unit of Measure Mandatory" THEN
                    PassedServLine.TESTFIELD("Unit of Measure Code");
                END;
              PassedServLine.Type::Resource:
                BEGIN
                  IF ServSetup."Work Type Code Mandatory" THEN
                    PassedServLine.TESTFIELD("Work Type Code");
                  IF ServSetup."Unit of Measure Mandatory" THEN
                    PassedServLine.TESTFIELD("Unit of Measure Code");
                END;
              PassedServLine.Type::Cost:
                IF ServSetup."Unit of Measure Mandatory" THEN
                  PassedServLine.TESTFIELD("Unit of Measure Code");
            END;
          END;
        UNTIL PassedServLine.NEXT = 0
      ELSE
        IF ServLine.FIND('-') THEN
          REPEAT
            IF (ServLine."Qty. to Ship" <> 0) OR
               (ServLine."Qty. to Invoice" <> 0) OR
               (ServLine."Qty. to Consume" <> 0)
            THEN BEGIN
              IF ("Document Type" = "Document Type"::Order) AND
                 "Link Service to Service Item" AND
                 (ServLine.Type IN [ServLine.Type::Item,ServLine.Type::Resource])
              THEN
                ServLine.TESTFIELD("Service Item Line No.");

              CASE ServLine.Type OF
                ServLine.Type::Item:
                  BEGIN
                    IF ServSetup."Unit of Measure Mandatory" THEN
                      ServLine.TESTFIELD("Unit of Measure Code");
                  END;
                ServLine.Type::Resource:
                  BEGIN
                    IF ServSetup."Work Type Code Mandatory" THEN
                      ServLine.TESTFIELD("Work Type Code");
                    IF ServSetup."Unit of Measure Mandatory" THEN
                      ServLine.TESTFIELD("Unit of Measure Code");
                  END;
                ServLine.Type::Cost:
                  IF ServSetup."Unit of Measure Mandatory" THEN
                    ServLine.TESTFIELD("Unit of Measure Code");
              END;
            END;
          UNTIL ServLine.NEXT = 0;
    END;

    PROCEDURE UpdateResponseDateTime@3();
    BEGIN
      ServItemLine.RESET;
      ServItemLine.SETCURRENTKEY("Document Type","Document No.","Response Date");
      ServItemLine.SETRANGE("Document Type","Document Type");
      ServItemLine.SETRANGE("Document No.","No.");
      IF ServItemLine.FIND('-') THEN BEGIN
        "Response Date" := ServItemLine."Response Date";
        "Response Time" := ServItemLine."Response Time";
        MODIFY(TRUE);
      END;
    END;

    PROCEDURE UpdateStartingDateTime@5();
    BEGIN
      IF ValidatingFromLines THEN
        EXIT;
      ServItemLine.RESET;
      ServItemLine.SETCURRENTKEY("Document Type","Document No.","Starting Date");
      ServItemLine.SETRANGE("Document Type","Document Type");
      ServItemLine.SETRANGE("Document No.","No.");
      ServItemLine.SETFILTER("Starting Date",'<>%1',0D);
      IF ServItemLine.FIND('-') THEN BEGIN
        "Starting Date" := ServItemLine."Starting Date";
        "Starting Time" := ServItemLine."Starting Time";
        MODIFY(TRUE);
      END
      ELSE BEGIN
        "Starting Date" := 0D;
        "Starting Time" := 0T;
      END;
    END;

    PROCEDURE UpdateFinishingDateTime@8();
    BEGIN
      IF ValidatingFromLines THEN
        EXIT;
      ServItemLine.RESET;
      ServItemLine.SETCURRENTKEY("Document Type","Document No.","Finishing Date");
      ServItemLine.ASCENDING := FALSE;
      ServItemLine.SETRANGE("Document Type","Document Type");
      ServItemLine.SETRANGE("Document No.","No.");
      ServItemLine.SETFILTER("Finishing Date",'<>%1',0D);
      IF ServItemLine.FIND('-') THEN BEGIN
        "Finishing Date" := ServItemLine."Finishing Date";
        "Finishing Time" := ServItemLine."Finishing Time";
        MODIFY(TRUE);
      END
      ELSE BEGIN
        "Finishing Date" := 0D;
        "Finishing Time" := 0T;
      END;
    END;

    PROCEDURE PriceMsgIfServLinesExist@10(ChangedFieldName@1000 : Text[100]);
    BEGIN
      IF ServLineExists THEN
        MESSAGE(
          Text019 +
          Text020,ChangedFieldName);
    END;

    PROCEDURE ServItemLineExists@4() : Boolean;
    VAR
      ServItemLine@1000 : Record 5901;
    BEGIN
      ServItemLine.RESET;
      ServItemLine.SETRANGE("Document Type","Document Type");
      ServItemLine.SETRANGE("Document No.","No.");
      EXIT(ServItemLine.FIND('-'));
    END;

    PROCEDURE ServLineExists@11() : Boolean;
    BEGIN
      ServLine.RESET;
      ServLine.SETRANGE("Document Type","Document Type");
      ServLine.SETRANGE("Document No.","No.");
      EXIT(ServLine.FIND('-'));
    END;

    PROCEDURE MessageIfServLinesExist@7(ChangedFieldName@1000 : Text[100]);
    BEGIN
      IF ServLineExists AND NOT HideValidationDialog THEN
        MESSAGE(
          Text021 + Text022,
          ChangedFieldName,TABLECAPTION);
    END;

    PROCEDURE ValidateServPriceGrOnServItem@6();
    BEGIN
      ServItemLine.RESET;
      ServItemLine.SETRANGE("Document Type","Document Type");
      ServItemLine.SETRANGE("Document No.","No.");
      IF ServItemLine.FIND('-') THEN BEGIN
        ServItemLine.SetServHeader(Rec);
        REPEAT
          IF ServItemLine."Service Price Group Code" <> '' THEN BEGIN
            ServItemLine.VALIDATE("Service Price Group Code");
            ServItemLine.MODIFY;
          END;
        UNTIL ServItemLine.NEXT = 0
      END;
    END;

    PROCEDURE SetHideValidationDialog@14(NewHideValidationDialog@1000 : Boolean);
    BEGIN
      HideValidationDialog := NewHideValidationDialog;
    END;

    PROCEDURE SetValidatingFromLines@17(NewValidatingFromLines@1000 : Boolean);
    BEGIN
      ValidatingFromLines := NewValidatingFromLines;
    END;

    LOCAL PROCEDURE TestNoSeries@21() : Boolean;
    BEGIN
      CASE "Document Type" OF
        "Document Type"::Quote:
          ServSetup.TESTFIELD("Service Quote Nos.");
        "Document Type"::Order:
          ServSetup.TESTFIELD("Service Order Nos.");
      //<<IMH04.ST
        "Document Type"::Invoice :
          ServSetup.TESTFIELD("Service Invoice Nos."); // non obligatoire sur Service Order Type
      //>>IMH04.ST
      END;
    END;

    LOCAL PROCEDURE GetNoSeriesCode@20() : Code[10];
    BEGIN
      CASE "Document Type" OF
        "Document Type"::Quote:
          EXIT(ServSetup."Service Quote Nos.");
        "Document Type"::Order:
          EXIT(ServSetup."Service Order Nos.");
        "Document Type"::Invoice: BEGIN
      //<<IMT04.ST
          ServOrderType.GET("Service Order Type");
          IF ServOrderType."Suffix Code" <> '' THEN
            EXIT(ServOrderType."Suffix Code")
          ELSE
      //>>IMH04.ST
          EXIT(ServSetup."Service Invoice Nos.");
        END;
        "Document Type"::"Credit Memo":
          EXIT(ServSetup."Service Credit Memo Nos.");
      END;
    END;

    LOCAL PROCEDURE TestNoSeriesManual@33();
    BEGIN
      CASE "Document Type" OF
        "Document Type"::Quote:
          NoSeriesMgt.TestManual(ServSetup."Service Quote Nos.");
        "Document Type"::Order:
          NoSeriesMgt.TestManual(ServSetup."Service Order Nos.");
        "Document Type"::Invoice: BEGIN
      //<<IMT04.ST
          ServOrderType.GET("Service Order Type");
          IF ServOrderType."Suffix Code" <> '' THEN
            NoSeriesMgt.TestManual(ServOrderType."Suffix Code")
          ELSE
      //>>IMH04.ST
          NoSeriesMgt.TestManual(ServSetup."Service Invoice Nos.");
        END;
        "Document Type"::"Credit Memo":
          NoSeriesMgt.TestManual(ServSetup."Service Credit Memo Nos.");
      END;
    END;

    PROCEDURE UpdateCont@24(CustomerNo@1000 : Code[20]);
    VAR
      ContBusRel@1003 : Record 5054;
      Cont@1002 : Record 5050;
      Cust@1004 : Record 18;
    BEGIN
      IF Cust.GET(CustomerNo) THEN BEGIN
        CLEAR(ServOrderMgt);
        ContactNo := ServOrderMgt.FindContactInformation(Cust."No.");
        IF Cont.GET(ContactNo) THEN BEGIN
          "Contact No." := Cont."No.";
          "Contact Name" := Cont.Name;
          "Phone No." := Cont."Phone No.";
          "E-Mail" := Cont."E-Mail";
        END ELSE BEGIN
          IF Cust."Primary Contact No." <> '' THEN
            "Contact No." := Cust."Primary Contact No."
          ELSE BEGIN
            ContBusRel.RESET;
            ContBusRel.SETCURRENTKEY("Link to Table","No.");
            ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Customer);
            ContBusRel.SETRANGE("No.","Customer No.");
            IF ContBusRel.FINDFIRST THEN
              "Contact No." := ContBusRel."Contact No."
            ELSE
              "Contact No." := '';
          END;
          "Contact Name" := Cust.Contact;
        END;
      END;
    END;

    PROCEDURE UpdateBillToCont@27(CustomerNo@1000 : Code[20]);
    VAR
      ContBusRel@1003 : Record 5054;
      Cont@1002 : Record 5050;
      Cust@1001 : Record 18;
    BEGIN
      IF Cust.GET(CustomerNo) THEN BEGIN
        CLEAR(ServOrderMgt);
        ContactNo := ServOrderMgt.FindContactInformation("Bill-to Customer No.");
        IF Cont.GET(ContactNo) THEN BEGIN
          "Bill-to Contact No." := Cont."No.";
          "Bill-to Contact" := Cont.Name;
        END ELSE BEGIN
          IF Cust."Primary Contact No." <> '' THEN
            "Bill-to Contact No." := Cust."Primary Contact No."
          ELSE BEGIN
            ContBusRel.RESET;
            ContBusRel.SETCURRENTKEY("Link to Table","No.");
            ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Customer);
            ContBusRel.SETRANGE("No.","Bill-to Customer No.");
            IF ContBusRel.FINDFIRST THEN
              "Bill-to Contact No." := ContBusRel."Contact No."
            ELSE
              "Bill-to Contact No." := '';
          END;
          "Bill-to Contact" := Cust.Contact;
        END;
      END;
    END;

    PROCEDURE UpdateCust@25(ContactNo@1002 : Code[20]);
    VAR
      ContBusinessRelation@1007 : Record 5054;
      Cust@1006 : Record 18;
      Cont@1005 : Record 5050;
    BEGIN
      IF Cont.GET(ContactNo) THEN BEGIN
        "Contact No." := Cont."No.";
        "Phone No." := Cont."Phone No.";
        "E-Mail" := Cont."E-Mail";
      END ELSE BEGIN
        "Phone No." := '';
        "E-Mail" := '';
        "Contact Name" := '';
        EXIT;
      END;

      IF Cont.Type = Cont.Type::Person THEN
        "Contact Name" := Cont.Name
      ELSE
        IF Cust.GET("Customer No.") THEN
          "Contact Name" := Cust.Contact
        ELSE
          "Contact Name" := '';

      ContBusinessRelation.RESET;
      ContBusinessRelation.SETCURRENTKEY("Link to Table","No.");
      ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Customer);
      ContBusinessRelation.SETRANGE("Contact No.",Cont."Company No.");
      IF ContBusinessRelation.FINDFIRST THEN BEGIN
        IF ("Customer No." <> '') AND
           ("Customer No." <> ContBusinessRelation."No.")
        THEN BEGIN
          ERROR(Text037,Cont."No.",Cont.Name,"Customer No.")
        END
        ELSE
          IF "Customer No." = '' THEN BEGIN
            SkipContact := TRUE;
            VALIDATE("Customer No.",ContBusinessRelation."No.");
            SkipContact := FALSE;
          END;
      END ELSE
        ERROR(Text039,Cont."No.",Cont.Name);


      IF ("Customer No." = "Bill-to Customer No.") OR
         ("Bill-to Customer No." = '')
      THEN
        VALIDATE("Bill-to Contact No.","Contact No.");
    END;

    PROCEDURE UpdateBillToCust@26(ContactNo@1000 : Code[20]);
    VAR
      ContBusinessRelation@1005 : Record 5054;
      Cust@1004 : Record 18;
      Cont@1003 : Record 5050;
    BEGIN
      IF Cont.GET(ContactNo) THEN BEGIN
        "Bill-to Contact No." := Cont."No.";
        IF Cont.Type = Cont.Type::Person THEN
          "Bill-to Contact" := Cont.Name
        ELSE
          IF Cust.GET("Bill-to Customer No.") THEN
            "Bill-to Contact" := Cust.Contact
          ELSE
            "Bill-to Contact" := '';
      END ELSE BEGIN
        "Bill-to Contact" := '';
        EXIT;
      END;

      ContBusinessRelation.RESET;
      ContBusinessRelation.SETCURRENTKEY("Link to Table","No.");
      ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Customer);
      ContBusinessRelation.SETRANGE("Contact No.",Cont."Company No.");
      IF ContBusinessRelation.FIND('-') THEN BEGIN
        IF "Bill-to Customer No." = '' THEN BEGIN
          SkipBillToContact := TRUE;
          VALIDATE("Bill-to Customer No.",ContBusinessRelation."No.");
          SkipBillToContact := FALSE;
        END ELSE
          IF "Bill-to Customer No." <> ContBusinessRelation."No." THEN
            ERROR(Text037,Cont."No.",Cont.Name,"Bill-to Customer No.");
      END ELSE
        ERROR(Text039,Cont."No.",Cont.Name);
    END;

    PROCEDURE CheckCreditMaxBeforeInsert@28(HideCreditCheckDialogue@1004 : Boolean);
    VAR
      ServHeader@1001 : Record 5900;
      ContBusinessRelation@1002 : Record 5054;
      Cont@1003 : Record 5050;
      CustCheckCreditLimit@1000 : Codeunit 312;
    BEGIN
      IF HideCreditCheckDialogue THEN
        EXIT;
      IF GETFILTER("Customer No.") <> '' THEN BEGIN
        IF GETRANGEMIN("Customer No.") = GETRANGEMAX("Customer No.") THEN BEGIN
          ServHeader."Bill-to Customer No." := GETRANGEMIN("Customer No.");
          CustCheckCreditLimit.ServiceHeaderCheck(ServHeader);
        END
      END ELSE
        IF GETFILTER("Contact No.") <> '' THEN
          IF GETRANGEMIN("Contact No.") = GETRANGEMAX("Contact No.") THEN BEGIN
            Cont.GET(GETRANGEMIN("Contact No."));
            ContBusinessRelation.RESET;
            ContBusinessRelation.SETCURRENTKEY("Link to Table","No.");
            ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Customer);
            ContBusinessRelation.SETRANGE("Contact No.",Cont."Company No.");
            IF ContBusinessRelation.FIND('-') THEN BEGIN
              ServHeader."Bill-to Customer No." := ContBusinessRelation."No.";
              CustCheckCreditLimit.ServiceHeaderCheck(ServHeader);
            END;
          END;
    END;

    PROCEDURE UpdateServiceOrderChangeLog@22(VAR OldServHeader@1000 : Record 5900);
    BEGIN
      IF IsServiceDoc THEN EXIT; //IMH04.ST
      IF Status <> OldServHeader.Status THEN
        ServLogMgt.ServHeaderStatusChange(Rec,OldServHeader);
      //<<IMH02
      //IF "Customer No." <> OldServHeader."Customer No." THEN
      //  ServLogMgt.ServHeaderCustomerChange(Rec,OldServHeader);
      //>>IMH02

      IF "Ship-to Code" <> OldServHeader."Ship-to Code" THEN
        ServLogMgt.ServHeaderShiptoChange(Rec,OldServHeader);

      IF "Contract No." <> OldServHeader."Contract No." THEN
        ServLogMgt.ServHeaderContractNoChanged(Rec,OldServHeader);
    END;

    LOCAL PROCEDURE GetPostingNoSeriesCode@39() : Code[10];
    BEGIN
      IF "Document Type" IN ["Document Type"::"Credit Memo"] THEN
        EXIT(ServSetup."Posted Serv. Credit Memo Nos.");
      EXIT(ServSetup."Posted Service Invoice Nos.");
    END;

    PROCEDURE InitRecord@32();
    BEGIN
      CASE "Document Type" OF
        "Document Type"::Quote,"Document Type"::Order:
          BEGIN
            NoSeriesMgt.SetDefaultSeries("Posting No. Series",ServSetup."Posted Service Invoice Nos.");
            NoSeriesMgt.SetDefaultSeries("Shipping No. Series",ServSetup."Posted Service Shipment Nos.");
          END;
        "Document Type"::Invoice:
          BEGIN
            IF ("No. Series" <> '') AND
               (ServSetup."Service Invoice Nos." = ServSetup."Posted Service Invoice Nos.")
            THEN
              "Posting No. Series" := "No. Series"
            ELSE
              NoSeriesMgt.SetDefaultSeries("Posting No. Series",ServSetup."Posted Service Invoice Nos.");
            IF ServSetup."Shipment on Invoice" THEN
              NoSeriesMgt.SetDefaultSeries("Shipping No. Series",ServSetup."Posted Service Shipment Nos.");
          END;
        "Document Type"::"Credit Memo":
          BEGIN
            IF ("No. Series" <> '') AND
               (ServSetup."Service Credit Memo Nos." = ServSetup."Posted Serv. Credit Memo Nos.")
            THEN
              "Posting No. Series" := "No. Series"
            ELSE
              NoSeriesMgt.SetDefaultSeries("Posting No. Series",ServSetup."Posted Serv. Credit Memo Nos.");
          END;
      END;

      IF "Document Type" IN ["Document Type"::Order,"Document Type"::Invoice,"Document Type"::Quote]
      THEN BEGIN
        "Order Date" := WORKDATE;
        "Order Time" := TIME;
        //<<IMH17
        "Starting Date" := WORKDATE;
        "Starting Time" := TIME;

        //>>IMH17
      END;

      "Posting Date" := WORKDATE;
      "Document Date" := WORKDATE;
      "Default Response Time (Hours)" := ServSetup."Default Response Time (Hours)";
      "Link Service to Service Item" := ServSetup."Link Service to Service Item";

      VALIDATE("Location Code",UserMgt.GetLocation(2,Cust."Location Code","Responsibility Center"));

      IF "Document Type" IN ["Document Type"::"Credit Memo"] THEN BEGIN
        GLSetup.GET;
        Correction := GLSetup."Mark Cr. Memos as Corrections";
      END;
      //<<IMH01
      //IF NOT IsServiceDoc THEN //IMH04.ST
      //"Posting Description" := FORMAT("Document Type") + ' ' + "No.";
      //>>IMH01

      Reserve := Reserve::Optional;

      IF Cust.GET("Customer No.") THEN
        "Responsibility Center" := UserMgt.GetRespCenter(2,Cust."Responsibility Center")
      ELSE
        "Responsibility Center" := UserMgt.GetServiceFilter;
    END;

    LOCAL PROCEDURE GetCust@30(CustNo@1000 : Code[20]);
    BEGIN
      IF NOT (("Document Type" = "Document Type"::Quote) AND (CustNo = '')) THEN BEGIN
        IF CustNo <> Cust."No." THEN
          Cust.GET(CustNo);
      END ELSE
        CLEAR(Cust);
    END;

    PROCEDURE ShippedServLinesExist@31() : Boolean;
    BEGIN
      ServLine.RESET;
      ServLine.SETRANGE("Document Type","Document Type");
      ServLine.SETRANGE("Document No.","No.");
      ServLine.SETFILTER("Quantity Shipped",'<>0');
      EXIT(ServLine.FIND('-'));
    END;

    LOCAL PROCEDURE UpdateShipToAddress@29();
    VAR
      Location@1000 : Record 14;
      CompanyInfo@1001 : Record 79;
    BEGIN
      IF "Document Type" = "Document Type"::"Credit Memo" THEN BEGIN
        IF "Location Code" <> '' THEN BEGIN
          Location.GET("Location Code");
          "Ship-to Name" := Location.Name;
          "Ship-to Name 2" := Location."Name 2";
          "Ship-to Address" := Location.Address;
          "Ship-to Address 2" := Location."Address 2";
          "Ship-to City" := Location.City;
          "Ship-to Post Code" := Location."Post Code";
          "Ship-to County" := Location.County;
          "Ship-to Country/Region Code" := Location."Country/Region Code";
          "Ship-to Contact" := Location.Contact;
        END ELSE BEGIN
          CompanyInfo.GET;
          "Ship-to Code" := '';
          "Ship-to Name" := CompanyInfo."Ship-to Name";
          "Ship-to Name 2" := CompanyInfo."Ship-to Name 2";
          "Ship-to Address" := CompanyInfo."Ship-to Address";
          "Ship-to Address 2" := CompanyInfo."Ship-to Address 2";
          "Ship-to City" := CompanyInfo."Ship-to City";
          "Ship-to Post Code" := CompanyInfo."Ship-to Post Code";
          "Ship-to County" := CompanyInfo."Ship-to County";
          "Ship-to Country/Region Code" := CompanyInfo."Ship-to Country/Region Code";
          "Ship-to Contact" := CompanyInfo."Ship-to Contact";
        END;
        "VAT Country/Region Code" := "Country/Region Code";
      END;
    END;

    PROCEDURE ConfirmDeletion@36() : Boolean;
    BEGIN
      ServPost.TestDeleteHeader(Rec,ServShptHeader,ServInvHeader,ServCrMemoHeader);
      IF ServShptHeader."No." <> '' THEN
        IF NOT
           CONFIRM(
             Text053 + Text009 + Text030,
             TRUE,ServShptHeader."No.")
        THEN
          EXIT;
      IF ServInvHeader."No." <> '' THEN
        IF NOT
           CONFIRM(
             Text054 + Text006 + Text030,
             TRUE,ServInvHeader."No.")
        THEN
          EXIT;
      IF ServCrMemoHeader."No." <> '' THEN
        IF NOT
           CONFIRM(
             Text013 + Text014 + Text030,
             TRUE,ServCrMemoHeader."No.")
        THEN
          EXIT;
      EXIT(TRUE);
    END;

    PROCEDURE SetAmountToApply@35(AppliesToDocNo@1000 : Code[20];CurstomerNo@1001 : Code[20]);
    VAR
      CustLedgEntry@1002 : Record 21;
    BEGIN
      CustLedgEntry.SETCURRENTKEY("Document No.");
      CustLedgEntry.SETRANGE("Document No.",AppliesToDocNo);
      CustLedgEntry.SETRANGE("Customer No.",CurstomerNo);
      CustLedgEntry.SETRANGE(Open,TRUE);
      IF CustLedgEntry.FIND('-') THEN BEGIN
        IF CustLedgEntry."Amount to Apply" = 0 THEN  BEGIN
          CustLedgEntry.CALCFIELDS("Remaining Amount");
          CustLedgEntry."Amount to Apply" := CustLedgEntry."Remaining Amount";
        END ELSE
          CustLedgEntry."Amount to Apply" := 0;
        CODEUNIT.RUN(CODEUNIT::"Cust. Entry-Edit",CustLedgEntry);
      END;
    END;

    PROCEDURE RecreateReservEntry@34(OldServLine@1000 : Record 5902;NewSourceRefNo@1001 : Integer;ToTemp@1002 : Boolean);
    BEGIN
      IF ToTemp THEN BEGIN
        CLEAR(ReservEntry);
        ReservEntry.SETCURRENTKEY("Source ID","Source Ref. No.","Source Type","Source Subtype");
        ReservEntry.SETRANGE("Source ID",OldServLine."Document No.");
        ReservEntry.SETRANGE("Source Ref. No.",OldServLine."Line No.");
        ReservEntry.SETRANGE("Source Type",DATABASE::"Service Line");
        ReservEntry.SETRANGE("Source Subtype",OldServLine."Document Type");
        IF ReservEntry.FINDSET THEN
          REPEAT
            TempReservEntry := ReservEntry;
            TempReservEntry.INSERT;
          UNTIL ReservEntry.NEXT = 0;
        ReservEntry.DELETEALL;
      END ELSE BEGIN
        CLEAR(TempReservEntry);
        TempReservEntry.SETCURRENTKEY("Source ID","Source Ref. No.","Source Type","Source Subtype");
        TempReservEntry.SETRANGE("Source Type",DATABASE::"Service Line");
        TempReservEntry.SETRANGE("Source Subtype",OldServLine."Document Type");
        TempReservEntry.SETRANGE("Source ID",OldServLine."Document No.");
        TempReservEntry.SETRANGE("Source Ref. No.",OldServLine."Line No.");
        IF TempReservEntry.FINDSET THEN
          REPEAT
            ReservEntry := TempReservEntry;
            ReservEntry."Source Ref. No." := NewSourceRefNo;
            IF NOT(ReservEntry.INSERT) THEN
              ;
          UNTIL TempReservEntry.NEXT = 0;
        TempReservEntry.DELETEALL;
      END;
    END;

    PROCEDURE ShowDocDim@23();
    VAR
      DocDim@1000 : Record 357;
      DocDims@1001 : Form 546;
    BEGIN
      DocDim.SETRANGE("Table ID",DATABASE::"Service Header");
      DocDim.SETRANGE("Document Type","Document Type");
      DocDim.SETRANGE("Document No.","No.");
      DocDim.SETRANGE("Line No.",0);
      DocDims.SETTABLEVIEW(DocDim);
      DocDims.RUNMODAL;
      GET("Document Type","No.");
    END;

    PROCEDURE HandleItemTrackingDeletion@43();
    VAR
      ReservEntry2@1000 : Record 337;
    BEGIN
      WITH ReservEntry DO BEGIN
        RESET;
        SETCURRENTKEY(
          "Source ID","Source Ref. No.","Source Type","Source Subtype",
          "Source Batch Name","Source Prod. Order Line","Reservation Status");
        SETRANGE("Source Type", DATABASE::"Service Line");
        SETRANGE("Source Subtype", "Document Type");
        SETRANGE("Source ID", "No.");
        SETRANGE("Source Batch Name", '');
        SETRANGE("Source Prod. Order Line", 0);
        SETFILTER("Item Tracking", '> %1', "Item Tracking"::None);
        IF ISEMPTY THEN
          EXIT;

        IF HideValidationDialog OR NOT GUIALLOWED THEN
          Confirmed := TRUE
        ELSE
          Confirmed := CONFIRM(Text052, FALSE, LOWERCASE(FORMAT("Document Type")),"No.");

        IF NOT Confirmed THEN
          ERROR('');

        IF FINDSET THEN
          REPEAT
            ReservEntry2 := ReservEntry;
            ReservEntry2.ClearItemTrackingFields;
            ReservEntry2.MODIFY;
          UNTIL NEXT = 0;
      END;
    END;

    PROCEDURE LookupAdjmtValueEntries@37(QtyType@1000 : 'General,Invoicing');
    VAR
      ItemLedgEntry@1004 : Record 32;
      ServiceLine@1001 : Record 5902;
      ServiceShptLine@1005 : Record 5991;
      TempValueEntry@1003 : TEMPORARY Record 5802;
    BEGIN
      ServiceLine.SETRANGE("Document Type","Document Type");
      ServiceLine.SETRANGE("Document No.","No.");
      TempValueEntry.RESET;
      TempValueEntry.DELETEALL;

      CASE "Document Type" OF
        "Document Type"::Order,"Document Type"::Invoice:
          BEGIN
            IF ServiceLine.FINDSET THEN
              REPEAT
                IF (ServiceLine.Type = ServiceLine.Type::Item) AND (ServiceLine.Quantity <> 0) THEN
                  WITH ServiceShptLine DO BEGIN
                    IF ServiceLine."Shipment No." <> '' THEN BEGIN
                      SETRANGE("Document No.",ServiceLine."Shipment No.");
                      SETRANGE("Line No.",ServiceLine."Shipment Line No.");
                    END ELSE BEGIN
                      SETCURRENTKEY("Order No.","Order Line No.");
                      SETRANGE("Order No.",ServiceLine."Document No.");
                      SETRANGE("Order Line No.",ServiceLine."Line No.");
                    END;
                    SETRANGE(Correction,FALSE);
                    IF QtyType = QtyType::Invoicing THEN
                      SETFILTER("Qty. Shipped Not Invoiced",'<>0');

                    IF FINDSET THEN
                      REPEAT
                        FilterPstdDocLnItemLedgEntries(ItemLedgEntry);
                        IF ItemLedgEntry.FINDSET THEN
                          REPEAT
                            CreateTempAdjmtValueEntries(TempValueEntry,ItemLedgEntry."Entry No.");
                          UNTIL ItemLedgEntry.NEXT = 0;
                      UNTIL NEXT = 0;
                  END;
              UNTIL ServiceLine.NEXT = 0;
          END;
      END;
      FORM.RUNMODAL(0,TempValueEntry);
    END;

    PROCEDURE CreateTempAdjmtValueEntries@38(VAR TempValueEntry@1001 : TEMPORARY Record 5802;ItemLedgEntryNo@1000 : Integer);
    VAR
      ValueEntry@1002 : Record 5802;
    BEGIN
      WITH ValueEntry DO BEGIN
        SETCURRENTKEY("Item Ledger Entry No.");
        SETRANGE("Item Ledger Entry No.",ItemLedgEntryNo);
        IF FINDSET THEN
          REPEAT
            IF Adjustment THEN BEGIN
              TempValueEntry := ValueEntry;
              IF TempValueEntry.INSERT THEN;
            END;
          UNTIL NEXT = 0;
      END;
    END;

    PROCEDURE CalcInvDiscForHeader@45();
    VAR
      ServiceInvDisc@1000 : Codeunit 5950;
    BEGIN
      ServiceInvDisc.CalculateIncDiscForHeader(Rec);
    END;

    PROCEDURE GetContactContract@1100281000();
    VAR
      lContactContract@1100281000 : Record 50059;
      lService@1100281001 : Record 50066;
    BEGIN
      //<<IMH02
      IF ("Contract Form Code" = '') OR ("Contract Occurence No." = 0) THEN
        EXIT;
      IF lContactContract.GET("Contact No.","Corporate No.","Contract Form Code","Contract Occurence No.") THEN BEGIN
        "Deductible 1 (LCY)" := lContactContract."Deductible 1 (LCY)";
        "Deductible 2 (LCY)" := lContactContract."Deductible 2 (LCY)";
      // R‚cup de l'adresse de formule par d‚faut
        IF lContactContract."Default Address Code" <> '' THEN BEGIN
          IF lService.GET("Service No.") THEN
            IF lContactContract."Default Address Code" <> lService."Alt. Address Code" THEN
              VALIDATE("Ship-to Address Code", lContactContract."Default Address Code");
        END;
      END;
      //>>IMH02
    END;

    PROCEDURE GetService@1100281001();
    VAR
      lService@1100281000 : Record 50066;
      lToolsMgt@1100281001 : Codeunit 8016602;
    BEGIN
      //<<IMH02
      IF "Service No." = '' THEN
        EXIT;
      IF NOT lService.GET("Service No.") THEN
        EXIT;
      VALIDATE("Contact No.",lService."Contact No.");
      Address := lService.Address;
      "Address 2" := lService."Address 2";
      "Address 3" := lService."Address 3";//IMH75
      "Post Code" := lService."Post Code";
      City := lService.City;
      "Country/Region Code" := lService."Country/Region Code";
      County := lService.County;
      "Geo. Reference Code" := lService."Geo. Reference Code";
      "Contact Mobile Phone No." := lService."Contact Mobile Phone No.";
      "Phone No." := lService."Contact Phone No.";
      "VIP Code" := lService."VIP Code";
      "E-Mail" := lService."Contact E-mail";

      "Corporate No." := lService."Corporate No.";
      "Corporate Region Code" := lService."Corporate Region Code";

      "Ship-to Name" := lService."Contact Name";
      "Ship-to Address" := lService.Address;
      "Ship-to Address 2" := lService."Address 2";
      "Ship-to Address 3" := lService."Address 3";//IMH75
      "Ship-to Country/Region Code" := lService."Country/Region Code";
      "Ship-to City" := lService.City;
      "Ship-to Post Code" := lService."Post Code";
      "Ship-to County" := lService.County;
      "Ship-to Geo. Reference Code" := lService."Geo. Reference Code";
      "Occupier Nature" := lService."Occupier Nature";
      "Residence Type" := lService."Residence Type";
      "Housing Type" := lService."Housing Type";
      "Property Type" := lService."Property Type";
      "Ship-to Phone" := lService."Contact Phone No.";
      "Ship-to Mobile Phone No." := lService."Contact Mobile Phone No.";  //IMH75
      VALIDATE("Ship-to Address Code",lService."Alt. Address Code");

      "Contract Form Code" := lService."Contract Form Code";
      IF lService."Contract Occurence No." <> 0 THEN
        VALIDATE("Contract Occurence No.",lService."Contract Occurence No.");

      //Urgent := lService.Urgent;
      //>>IMH02
      "Building Trade" := lService."Sensed Building Trade"; //IMH06.ST
      VALIDATE("Main Speciality", lService."Sensed Speciality"); //IMH06.ST
      "Member No." := lService."Member No.";
      "Reference No." := lService."Reference No.";
      "Service Cause" := lService."Service Cause";//IM010
      "Corporate Contact No." := lService."Corporate Contact No.";
      "Campaign No." := lService."Campaign No.";
      "Event Date" := lService."Event Date";
      "Occupier Nature" := lService."Occupier Nature";
      //<<IMH42
      VALIDATE("Declaration Contact No.", GetDeclarationContact("Corporate No."));
      //>>IMH42

      "Service Creation Date" := lService."Creation Date";   //IMH137
    END;

    PROCEDURE GetShipToAddress@1100281002();
    VAR
      lAltAddress@1100281000 : Record 5051;
      lService@1100281001 : Record 50066;
    BEGIN
      //<<IMH02
      IF lAltAddress.GET("Contact No.","Ship-to Address Code") THEN BEGIN
        "Ship-to Name" := lAltAddress."Company Name";
        "Ship-to Address" := lAltAddress.Address;
        "Ship-to Address 2" := lAltAddress."Address 2";
        "Ship-to Address 3" := lAltAddress."Address 3";
        "Ship-to City" := lAltAddress.City;
        "Ship-to Post Code" := lAltAddress."Post Code";
        "Ship-to County" := lAltAddress.County;
        VALIDATE("Ship-to Country/Region Code",lAltAddress."Country/Region Code");
        "Ship-to Geo. Reference Code" := lAltAddress."Geo. Reference Code";
      //<<IMH103.ST
        IF "Ship-to Geo. Reference Code" = '' THEN
          "Ship-to Geo. Reference Code" := PostCode.GetGeoCode("Ship-to Post Code","Ship-to City");
      //>>IMH103.ST
        "Ship-to Phone" := lAltAddress."Phone No.";
        "Ship-to Fax No." := lAltAddress."Fax No.";
        "Ship-to E-Mail" := lAltAddress."E-mail";
        //<<IMH09
        "Occupier Nature" := lAltAddress."Occupier Nature";
        "Residence Type" := lAltAddress."Residence Type";
        "Housing Type" := lAltAddress."Housing Type";
        "Property Type" := lAltAddress."Property Type";
        //>>IMH09
        //<<IMH54
        IF ("Occupier Nature" = '') OR ("Residence Type" = '')
           OR ("Housing Type" = '') OR ("Property Type" = '') THEN BEGIN
          IF lService.GET("Service No.") THEN BEGIN
            IF "Occupier Nature" = '' THEN
              "Occupier Nature" := lService."Occupier Nature";
            IF "Residence Type" = '' THEN
              "Residence Type" := lService."Residence Type";
            IF "Housing Type" = '' THEN
              "Housing Type" := lService."Housing Type";
            IF "Property Type" = '' THEN
              "Property Type" := lService."Property Type";
          END;
        END;
        //>>IMH54
      END;
      //>>IMH02
    END;

    PROCEDURE CreateServiceInterventionLine@1100281003(pShowCard@1100281000 : Boolean) ReturnValue : Boolean;
    VAR
      lServiceHeaderDevice@1100281003 : Record 50072;
      lInterventionMgt@1100281002 : Codeunit 50014;
    BEGIN
      {
      //IMH54 desactiv‚ : Controle creation intervention service panne Electro se fait dans la table Service header Device
      //<<IMH22
      // Controle si l'intervention peut ˆtre cr‚‚
      IF GetServOrderType THEN BEGIN
        IF (ServOrderType."Device Purchase Amount Min." <> 0) OR
          (ServOrderType."Device Age Max." <> 0) THEN BEGIN
          IF lServiceHeaderDevice.GET("No.") THEN BEGIN
            IF (CALCDATE('<+'+FORMAT(ServOrderType."Device Age Max.")+'Y>',
                lServiceHeaderDevice."Purchase Date") < TODAY)
            OR (lServiceHeaderDevice."Purchase Amount" < ServOrderType."Device Purchase Amount Min.")
            OR (NOT lServiceHeaderDevice."Original Invoice")
            OR (lServiceHeaderDevice."Contract Guaranteed") THEN BEGIN
              ERROR(Text50003);
            END;
          END;
        END;
      END;
      //>>IMH22
      }
      //<<IMH97.ST
      IF Status IN [Status::Cancelled, Status::Finished] THEN
        FIELDERROR(Status);
      //>>IMH97.ST
      //<<IMH78.PC
      //EXIT(lInterventionMgt.CreateInterventionFromServ(Rec, pShowCard)); //IMH03 isat.zw
      EXIT(lInterventionMgt.CreateIntFromServWithPressent(Rec, pShowCard));
      //>>IMH78.PC
    END;

    PROCEDURE DirectCreateInervLine@1100281050(pShowCard@1100281000 : Boolean) ReturnValue : Boolean;
    VAR
      lServiceHeaderDevice@1100281003 : Record 50072;
      lInterventionMgt@1100281002 : Codeunit 50014;
    BEGIN
      //IMH108
      IF Status IN [Status::Cancelled, Status::Finished] THEN
        FIELDERROR(Status);
      EXIT(lInterventionMgt.CreateIntervManualWithoutCheck(Rec, pShowCard));
    END;

    PROCEDURE CreateIntervLineFromAddress@1100281027(pShowCard@1100281000 : Boolean) ReturnValue : Boolean;
    VAR
      lServiceHeaderAddress@1100281001 : Record 50068;
      lInterventionMgt@1100281002 : Codeunit 50014;
    BEGIN
      //IMH22
      // Cr‚ation de l'intervention sur les adresses/sp‚cialit‚s saisies
      // V‚rification si adresse de saisi
      lServiceHeaderAddress.SETRANGE("Service Header No.","No.");
      lServiceHeaderAddress.SETFILTER("Speciality Code",'<>%1','');
      IF lServiceHeaderAddress.ISEMPTY THEN
        ERROR(Text50004);
      lServiceHeaderAddress.FINDFIRST;
      IF lServiceHeaderAddress.COUNT = 1 THEN BEGIN
        EXIT(lInterventionMgt.CreateInterventionFromAddress(Rec,lServiceHeaderAddress,pShowCard));
      END ELSE BEGIN
        IF FORM.RUNMODAL(0,lServiceHeaderAddress) = ACTION::LookupOK THEN
          EXIT(lInterventionMgt.CreateInterventionFromAddress(Rec,lServiceHeaderAddress,pShowCard));
      END;
    END;

    PROCEDURE CreateIntervFromAddress@1100281028(pServiceHeaderAddress@1100281003 : Record 50068;pShowCard@1100281000 : Boolean) ReturnValue : Boolean;
    VAR
      lServiceHeaderAddress@1100281001 : Record 50068;
      lInterventionMgt@1100281002 : Codeunit 50014;
    BEGIN
      //IMH22
      // Cr‚ation de l'intervention sur les adresses/sp‚cialit‚s saisies
      // V‚rification si adresse de saisi
      pServiceHeaderAddress.TESTFIELD("Service Header No.");
      pServiceHeaderAddress.TESTFIELD("Speciality Code");
      lInterventionMgt.CreateInterventionFromAddress(Rec,pServiceHeaderAddress,pShowCard);
    END;

    PROCEDURE GetServiceOrderTypeDescr@1100281004() ReturnValue : Text[30];
    BEGIN
      //<<IMH02
      IF GetServOrderType THEN
        EXIT(ServOrderType.Description);
      //>>IMH02
    END;

    PROCEDURE UpdateFromServiceQuoteExcep@1100281005();
    VAR
      lServQuoteExcept@1100281000 : Record 50063;
      lTempServHeader@1100281002 : TEMPORARY Record 5900;
      lApplyException@1100281003 : Boolean;
    BEGIN
      EXIT; //IMH57.ST
      //<<IMH02
      // Mise … jour du produit en fontion de la table des exceptions
      lServQuoteExcept.SETRANGE("Corporate No.", "Corporate No.");
      lServQuoteExcept.SETRANGE("Service Order Type", "Service Order Type");
      IF lServQuoteExcept.ISEMPTY THEN BEGIN
        GetServOrderType;
        "Quote Managment" := ServOrderType."Quote Management";
        EXIT;
      END;
      //IF "Quote Managment" OR (Urgent = Urgent::Yes) THEN
      //  EXIT;

      lTempServHeader := Rec;
      lTempServHeader.INSERT;
      lServQuoteExcept.FINDFIRST;
      REPEAT
        IF lServQuoteExcept.GetRecFilters(FALSE) = '' THEN
          lApplyException := TRUE
        ELSE BEGIN
          lTempServHeader.SETVIEW(lServQuoteExcept.GetRecFilters(FALSE));
          lApplyException := NOT lTempServHeader.ISEMPTY;
        END;
        IF lApplyException THEN BEGIN
          IF lServQuoteExcept."Set Quote" THEN
            "Quote Managment" := TRUE;
          //<<IMH54 d‚sactiv‚
          //IF lServQuoteExcept."Set Urgent" THEN
          //  Urgent := Urgent::Yes;
          //>>IMH54 d‚sactiv‚
            //Urgent := TRUE;//IMH27
        END;
      UNTIL lServQuoteExcept.NEXT = 0;
      //>>IMH02
    END;

    PROCEDURE ShowCard@1100281007(pRunModal@1100281001 : Boolean);
    VAR
      lFormID@1100281000 : Integer;
      lRec@1100281003 : Record 5900;
    BEGIN
      //IMH04.ST
      lRec := Rec;
      GetServOrderType;
      IF ServOrderType."Service Hdr Card Form ID" = 0 THEN
        ServOrderType."Service Hdr Card Form ID" := FORM::"Service Hdr Card"
      ELSE BEGIN
        lRec.FILTERGROUP(2);
        lRec.SETRANGE("Service Order Type", "Service Order Type");
        lRec.FILTERGROUP(0);
      END;
      IF pRunModal THEN
        FORM.RUNMODAL(ServOrderType."Service Hdr Card Form ID", lRec)
      ELSE
        FORM.RUN(ServOrderType."Service Hdr Card Form ID", lRec);
    END;

    LOCAL PROCEDURE IsServiceDoc@1100281010() : Boolean;
    BEGIN
      //IMH04.ST Fonction pour d‚sactiver certains traitements standard
      IF "Document Type" = "Document Type"::Invoice THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    PROCEDURE InitDiagElementTable@1100281008();
    VAR
      lServiceDiagElement@1100281000 : Record 50074;
      lCode@1100281001 : Record 50079;
    BEGIN
      //IMH05
      // initialise la table des elmts de diag. en fonction du type produit
      IF NOT GetServOrderType THEN
        EXIT;
      IF NOT ServOrderType."Init. Diag. Elmts Table" THEN
        EXIT;
      lCode.SETCURRENTKEY("Table ID","Field ID",Code);
      lCode.SETRANGE("Table ID",DATABASE::"Service Diagnosis Element");
      lCode.SETRANGE("Field ID",lServiceDiagElement.FIELDNO("Diagnosis Element Code"));
      //<<IMH26.ST
      IF ServOrderType."Code Loading Index" <> 0 THEN
        lCode.SETRANGE("Loading Index No.", ServOrderType."Code Loading Index");
      //>>IMH26.ST
      IF lCode.ISEMPTY THEN EXIT;
      lCode.FINDSET(FALSE);
      REPEAT
        lServiceDiagElement."Service Header No." := "No.";
        lServiceDiagElement.VALIDATE("Diagnosis Element Code", lCode.Code);
        lServiceDiagElement.INSERT(TRUE);
      UNTIL lCode.NEXT = 0;
    END;

    PROCEDURE InitAcommOptionTable@1100281012();
    VAR
      lServiceAccommOption@1100281000 : Record 50073;
      lCode@1100281001 : Record 50079;
    BEGIN
      //IMH10
      // initialise la table de garantie compl‚mentaire en fonction du type produit
      IF NOT GetServOrderType THEN
        EXIT;
      IF NOT ServOrderType."Init. Accomm. Options" THEN
        EXIT;
      lCode.SETCURRENTKEY("Table ID","Field ID",Code);
      lCode.SETRANGE("Table ID",DATABASE::"Service Accomm. Option");
      lCode.SETRANGE("Field ID",lServiceAccommOption.FIELDNO("Option Code"));
      //<<IMH26.ST
      IF ServOrderType."Code Loading Index" <> 0 THEN
        lCode.SETRANGE("Loading Index No.", ServOrderType."Code Loading Index");
      //>>IMH26.ST
      IF lCode.ISEMPTY THEN EXIT;
      lCode.FINDSET(FALSE);
      REPEAT
        lServiceAccommOption."Service Header No.":= "No.";
        lServiceAccommOption."Option Code" := lCode.Code;
        lServiceAccommOption.INSERT(TRUE);
      UNTIL lCode.NEXT = 0;
    END;

    PROCEDURE InitServiceHeaderCosting@1100281031();
    VAR
      lServiceHeaderCosting@1100281000 : Record 50101;
    BEGIN
      //IMH34
      IF NOT GetServOrderType THEN
        EXIT;
      IF ServOrderType."Service Hdr Card Form ID" = PAGE::"Service Hdr Remote Costing" THEN BEGIN
        lServiceHeaderCosting."Service Header No." := "No.";
        lServiceHeaderCosting.VALIDATE("Service No.","Service No.");
        lServiceHeaderCosting.INSERT(TRUE);
      END;
    END;

    LOCAL PROCEDURE _GetContactContractForm@1100281009();
    VAR
      lContactContract@1100281000 : Record 50059;
    BEGIN
      // controle de l'occurrence : date d‚but date expir vs date evt
      "Contract Form Code" := '';
      lContactContract.SETCURRENTKEY("Contact No.","Corporate No.");
      lContactContract.SETRANGE("Contact No.","Contact No.");
      lContactContract.SETRANGE("Corporate No.","Corporate No.");
      IF lContactContract.ISEMPTY THEN
        EXIT;
      IF lContactContract.COUNT > 1 THEN
        EXIT;
      lContactContract.FINDFIRST;
      "Contract Form Code" := lContactContract."Contract Form Code";
    END;

    PROCEDURE TouchRecord@1100281006(pInsert@1100281000 : Boolean);
    BEGIN
      //IMH04.ST
      IF pInsert THEN BEGIN
        "Creation Date" := CURRENTDATETIME;
        "Creation User ID" := USERID;
      END;
      "Last Modification Date" := CURRENTDATETIME;
      "Last Modification User ID" := USERID;
    END;

    PROCEDURE OnModify@1100281013(xRec@1100281000 : Record 5900);
    VAR
      lServiceInterventionLine@1100281001 : Record 50075;
    BEGIN
      IF xRec."No." <> "No." THEN
        EXIT;
      //IMH10
      IF xRec."Quote Managment" <> "Quote Managment" THEN BEGIN
        lServiceInterventionLine.UpdateServiceInterventionLine(Rec);
      END;
      //<<IMH93.ST
      IF (xRec."Ship-to Code" <> "Ship-to Code") OR
         //(xRec."Ship-to Name" <> "Ship-to Name") OR   //IMH119 d‚sactiv‚
         (xRec."Ship-to Address" <> "Ship-to Address") OR
         (xRec."Ship-to Address 2" <> "Ship-to Address 2") OR
         (xRec."Ship-to Address 3" <> "Ship-to Address 3") OR
         (xRec."Ship-to City" <> "Ship-to City") OR
         (xRec."Ship-to Post Code" <> "Ship-to Post Code") OR
         (xRec."Ship-to County" <> "Ship-to County") OR
         (xRec."Ship-to Country/Region Code" <> "Ship-to Country/Region Code") THEN BEGIN
        lServiceInterventionLine.SETRANGE("Service Header No.", "No.");
        lServiceInterventionLine.SETRANGE("Quality Control",FALSE);
        IF lServiceInterventionLine.FINDSET THEN
          REPEAT
            lServiceInterventionLine."Alt. Address Code" := "Ship-to Code";
            //lServiceInterventionLine."Contact Name" := "Ship-to Name";  //IMH119 d‚sactiv‚
            lServiceInterventionLine.Address := "Ship-to Address";
            lServiceInterventionLine."Address 2" := "Ship-to Address 2";
            lServiceInterventionLine."Address 3" := "Ship-to Address 3";
            lServiceInterventionLine.City := "Ship-to City";
            lServiceInterventionLine."Post Code" := "Ship-to Post Code";
            lServiceInterventionLine.County := "Ship-to County";
            lServiceInterventionLine."Country/Region Code" := "Ship-to Country/Region Code";
            lServiceInterventionLine.MODIFY;
          UNTIL lServiceInterventionLine.NEXT = 0;
      END;
      //>>IMH93.ST
    END;

    PROCEDURE GetNextServiceHeaderNo@1100281014() : Code[20];
    VAR
      lServiceHeader@1100281000 : Record 5900;
      lInt@1100281002 : Integer;
      lInt2@1100281001 : Integer;
    BEGIN
      //IMH10
      GetServOrderType;
      lServiceHeader.SETCURRENTKEY("Service No.");
      lServiceHeader.SETRANGE("Service No.","Service No.");
      lServiceHeader.SETRANGE("Service Order Type","Service Order Type");
      lServiceHeader.LOCKTABLE;
      IF lServiceHeader.FINDLAST THEN BEGIN
        IF NOT EVALUATE(lInt,DELSTR(lServiceHeader."No.",1,STRLEN("Service No." + '-' + ServOrderType."Suffix Code"))) THEN
          lInt := 0;
      //<<IMH109.ST
        IF lInt = 9 THEN BEGIN
          lServiceHeader.FINDSET(FALSE);
          REPEAT
            IF EVALUATE(lInt2,DELSTR(lServiceHeader."No.",1,STRLEN("Service No." + '-' + ServOrderType."Suffix Code"))) THEN
              IF lInt2 > lInt THEN
                lInt := lInt2;
          UNTIL lServiceHeader.NEXT=0;
        END;
      //>>IMH109.ST
        EXIT("Service No." + '-' + ServOrderType."Suffix Code" + FORMAT(lInt+1));
      END;
      EXIT("Service No." + '-' + ServOrderType."Suffix Code" + '1');
    END;

    PROCEDURE CheckCorporateDeclaration@1100281016();
    VAR
      lText001@1100281000 : TextConst 'ENU=%1 or %2 is required;FRA=Le %1 ou %2 est obligatoire';
      lServiceMgtSetup@1100281001 : Record 5911;
      lText002@1100281002 : TextConst 'ENU=Please select meeting hour.;FRA=Vous devez pr‚ciser un cr‚neau horaire.';
      lText003@1100281003 : TextConst 'ENU=Please select only one meeting hour.;FRA=Vous devez pr‚ciser un seul cr‚neau horaire.';
    BEGIN
      //IMH10
      IF (NOT "Corporate Declaration") THEN
        EXIT;
      lServiceMgtSetup.GET;
      IF (Requisitioner <> lServiceMgtSetup."Beneficiary Requ. Code") AND
         (Requisitioner <> lServiceMgtSetup."IMA Requisitionner Code") THEN
        EXIT;
      IF ("Meeting Date" = 0D) AND ("Declaration Comment Code" = '') THEN
        ERROR(STRSUBSTNO(lText001,FIELDCAPTION("Meeting Date"),FIELDCAPTION("Declaration Comment Code")));
      //<<IMH67.ST
      IF "Meeting Date" <> 0D THEN BEGIN
        IF NOT ("9h-12h" OR "14h-17h") THEN
          ERROR(lText002);
        IF ("9h-12h" AND "14h-17h") THEN
          ERROR(lText003);
      END;
      //>>IMH67.ST
    END;

    PROCEDURE CreateInteraction@1100281015();
    VAR
      lSegmentLine@1000 : TEMPORARY Record 5077;
    BEGIN
      //IMH11 isat.zw
      //<<IMH21
      //lSegmentLine.CreateInteracFromServHeader(Rec);
      lSegmentLine.CreateInteracFromServHeader(Rec,'');
      //>>IMH21
    END;

    PROCEDURE OpenContactCard@1100281017();
    VAR
      lContact@1100281000 : Record 5050;
    BEGIN
      IF lContact.GET("Contact No.") THEN
        PAGE.RUNMODAL(PAGE::"Contact Card",lContact);
    END;

    PROCEDURE GetServTimeRegister@1100281011() rTimeInSec : Integer;
    VAR
      lServTimeReg@1100281000 : Record 50067;
    BEGIN
      //IMH13 isat.zw
      lServTimeReg.SETRANGE("Service No.", "Service No.");
      lServTimeReg.SETRANGE("Service Header No.", "No.");
      lServTimeReg.SETRANGE("Timing Process", TRUE);
      IF lServTimeReg.ISEMPTY THEN
        EXIT(0);
      lServTimeReg.FINDFIRST;
      REPEAT
        rTimeInSec += lServTimeReg."Corrected Time";
      UNTIL lServTimeReg.NEXT = 0;
    END;

    PROCEDURE GetDefaultTeamCodeByServOrder@1100281018(pServiceHeader@1100281000 : Record 5900) : Code[10];
    VAR
      lTeam@1100281001 : Record 5083;
      lServiceOrderType@1100281002 : Record 5903;
      lServiceHeaderTemp@1100281003 : TEMPORARY Record 5900;
    BEGIN
      //IMH18 isat.zw
      lTeam.SETCURRENTKEY("Service Assignment", "Assignment Priority");
      lTeam.SETRANGE("Service Assignment", TRUE);
      lServiceHeaderTemp := pServiceHeader;
      lServiceHeaderTemp.INSERT;

      IF lTeam.FINDSET(FALSE) THEN
        REPEAT
          lServiceHeaderTemp.RESET;
          lServiceHeaderTemp.SETVIEW(lTeam.GetRecFilters(FALSE, 1));
          IF lServiceHeaderTemp.FINDFIRST THEN
            EXIT(lTeam.Code);
        UNTIL lTeam.NEXT = 0;
      ServSetup.GET;
      IF ServSetup."Service Tray Mandatory" THEN
        ERROR(Text50007);
    END;

    PROCEDURE GetTeamByServiceTask@1100281054(pServiceHeader@1100281000 : Record 5900;pTaskCode@1100281001 : Code[10]) : Code[10];
    VAR
      lTeam@1100281004 : Record 5083;
      lTrayTaskTemp@1100281003 : TEMPORARY Record 50080;
      lServiceHeaderTemp@1100281002 : TEMPORARY Record 5900;
      lTrayLineMgt@1000000000 : Codeunit 50050;
      lFilterTeamTrayTask@1000000001 : TEMPORARY Record 50129;
    BEGIN
      //IMH135
      //<<IMH136 remplacer la fonction par la fonction dans le CU tray line management
      EXIT(lTrayLineMgt.GetTeamByTask(pTaskCode, lFilterTeamTrayTask, pServiceHeader."No."));
      {
      lTeam.SETCURRENTKEY("Service Assignment", "Assignment Priority");
      lTeam.SETRANGE("Service Assignment", TRUE);
      lServiceHeaderTemp := pServiceHeader;
      lServiceHeaderTemp.INSERT;
      lTrayTaskTemp."Task Code" := pTaskCode;
      lTrayTaskTemp.INSERT;

      IF pTaskCode <> '' THEN BEGIN
        lTeam.SETFILTER("Service Tray Task Code Filter", '<>%1', '');
        IF lTeam.FINDSET(FALSE) THEN
          REPEAT
            lServiceHeaderTemp.RESET;
            lServiceHeaderTemp.SETVIEW(lTeam.GetRecFilters(FALSE, 1));
            lTrayTaskTemp.SETFILTER("Task Code", lTeam."Service Tray Task Code Filter");

            IF (NOT lServiceHeaderTemp.ISEMPTY) AND (NOT lTrayTaskTemp.ISEMPTY) THEN
              EXIT(lTeam.Code);
          UNTIL lTeam.NEXT = 0;
      END;

      lTeam.SETRANGE("Service Tray Task Code Filter", '');
      IF lTeam.FINDSET(FALSE) THEN
        REPEAT
          lServiceHeaderTemp.RESET;
          lServiceHeaderTemp.SETVIEW(lTeam.GetRecFilters(FALSE, 1));

          IF NOT lServiceHeaderTemp.ISEMPTY THEN
            EXIT(lTeam.Code);
        UNTIL lTeam.NEXT = 0;
      }
      //>>IMH136
    END;

    PROCEDURE GetUserNb@1100281019() : Integer;
    VAR
      lServTimeReg@1100281000 : Record 50067;
      lTempUser@1100281001 : TEMPORARY Record 2000000002;
      lUserNb@1100281002 : Integer;
    BEGIN
      //IMH17
      lServTimeReg.SETRANGE("Service No.", "Service No.");
      lServTimeReg.SETRANGE("Service Header No.", "No.");
      IF lServTimeReg.ISEMPTY THEN
        EXIT(0);
      lServTimeReg.FINDFIRST;
      REPEAT
        IF NOT lTempUser.GET(lServTimeReg."User ID") THEN BEGIN
          lTempUser."User ID" := lServTimeReg."User ID";
          lTempUser.INSERT;
          lUserNb += 1;
        END;
      UNTIL lServTimeReg.NEXT = 0;
      EXIT(lUserNb);
    END;

    PROCEDURE GetTotalTreatmentDayDuration@1100281022() : Decimal;
    VAR
      lToolsMgt@1100281002 : Codeunit 8016602;
      lStartingDateTime@1100281001 : DateTime;
      lFinishDateTime@1100281000 : DateTime;
    BEGIN
      IF NOT (Status = Status::Finished) THEN
        EXIT(0);
      IF "Finishing Date" = 0D THEN
        EXIT(0);
      IF "Starting Date" <> 0D THEN
        lStartingDateTime := CREATEDATETIME("Starting Date","Starting Time")
      ELSE
        lStartingDateTime := CREATEDATETIME("Order Date","Order Time");
      lFinishDateTime := CREATEDATETIME("Finishing Date","Finishing Time");
      EXIT(lToolsMgt.GetDayDuration(lStartingDateTime,lFinishDateTime));
    END;

    PROCEDURE GetTreatmentDayDuration@1100281026() : Decimal;
    VAR
      lToolsMgt@1100281002 : Codeunit 8016602;
      lStartingDateTime@1100281001 : DateTime;
      lFinishDateTime@1100281000 : DateTime;
    BEGIN
      IF "Starting Date" <> 0D THEN
        lStartingDateTime := CREATEDATETIME("Starting Date","Starting Time")
      ELSE
        lStartingDateTime := CREATEDATETIME("Order Date","Order Time");

      EXIT(lToolsMgt.GetDayDuration(lStartingDateTime,CURRENTDATETIME));
    END;

    PROCEDURE GetCorporateContactJobResp@1100281020() : Text[30];
    VAR
      lContactJobResponsibility@1100281000 : Record 5067;
    BEGIN
      lContactJobResponsibility.SETRANGE("Contact No.","Corporate Contact No.");
      IF lContactJobResponsibility.ISEMPTY THEN
       EXIT;
      lContactJobResponsibility.FINDFIRST;
      lContactJobResponsibility.CALCFIELDS("Job Responsibility Description");
      EXIT(lContactJobResponsibility."Job Responsibility Description");
    END;

    PROCEDURE GetDefaultProcessStatusCode@1100281021(VAR pProcessCode@1100281002 : Code[10];VAR pProcessStatus@1100281003 : Integer);
    VAR
      lProductCatalog@1100281001 : Record 50060;
    BEGIN
      IF lProductCatalog.GET("Corporate No.", "Service Order Type") THEN BEGIN
        pProcessCode := lProductCatalog."Serv. Header Proc. Code";
        pProcessStatus := lProductCatalog."Serv. Header Start Status";
      END;
      IF pProcessCode = '' THEN BEGIN
        IF GetServOrderType THEN BEGIN
          IF pProcessCode = '' THEN
            pProcessCode := ServOrderType."Serv. Header Proc. Code";
          pProcessStatus := ServOrderType."Serv. Header Start Status";
        END;
      END;
    END;

    PROCEDURE InterventionDescriptionsExist@1100281023() : Boolean;
    VAR
      lInterventionDescription@1100281000 : Record 50070;
    BEGIN
      //IMH22
      lInterventionDescription.SETRANGE("Service Header No.","No.");
      EXIT(NOT lInterventionDescription.ISEMPTY);
    END;

    PROCEDURE GetLastComment@1100281024() : Text[80];
    VAR
      lAdvCommentLine@1100281000 : Record 50056;
    BEGIN
      //IMH22
      lAdvCommentLine.SETRANGE("Source Table ID",DATABASE::"Service Header");
      lAdvCommentLine.SETRANGE("Source No.","Service No.");
      lAdvCommentLine.SETRANGE("Source No. 2","No.");
      IF lAdvCommentLine.FINDLAST THEN
        EXIT(lAdvCommentLine.Comment);
    END;

    PROCEDURE GetCodeDescription@1100281025(pTableID@1100281001 : Integer;pFieldID@1100281002 : Integer;pCode@1100281003 : Code[10]) : Text[50];
    VAR
      lCode@1100281000 : Record 50079;
    BEGIN
      //IMH22
      IF lCode.GET(pTableID,pFieldID,pCode) THEN
        EXIT(lCode.Description);
    END;

    PROCEDURE GetInterventionCeiling@1100281029(pFromInteract@1100281001 : Boolean) rValue : Text[50];
    VAR
      lServiceAmount@1100281002 : Record 50061;
      lGLSetup@1100281000 : Record 98;
    BEGIN
      //<<IMH78.PC
      IF "Intervention Ceiling" <> 0 THEN BEGIN
        rValue := FORMAT("Intervention Ceiling",0,ApplicationMgt.AutoFormatTranslate(1,''));
      END ELSE BEGIN
      //>>IMH78.PC
        //<<IMH95
        lServiceAmount."Corporate No." := "Corporate No.";
        lServiceAmount."Service Order Type" := "Service Order Type";
        lServiceAmount."Amount Type" := lServiceAmount."Amount Type"::InterventionCeiling;
        lServiceAmount."Campaign No." := "Campaign No.";
        lServiceAmount."Corporate Region Code" := "Corporate Region Code";
        //<<IMH40
        lServiceAmount.Requisitioner  := Requisitioner;
        lServiceAmount."Service Cause" := "Service Cause";
        //>>IMH40
        lServiceAmount.Urgent := Urgent; //IMH46.ST
        lServiceAmount."Occupier Nature" := "Occupier Nature";
        lServiceAmount."Contract Form Code" := "Contract Form Code";  //IMH132
        IF NOT lServiceAmount.RetrieveServAmount(lServiceAmount) THEN
          EXIT('');

        rValue := FORMAT(lServiceAmount.Amount, 0, ApplicationMgt.AutoFormatTranslate(1,''));
        //>>IMH95
        IF lServiceAmount."Amount Incl. VAT" THEN BEGIN
          rValue := rValue + ' ' + Text50006;
          EXIT;
        END;
        IF pFromInteract THEN
          rValue := rValue + ' ' + Text50005;
        //<<IMH46.ST on n'affiche rien en HT
        //ELSE
        //  rValue := rValue + ' ' + Text50005
        //>>IMH46.ST
      END;
    END;

    PROCEDURE CalcInterventionCeiling@1100281036() rValue : Decimal;
    VAR
      lServiceAmount@1100281002 : Record 50061;
    BEGIN
      //<<IMH95.zw
      lServiceAmount."Corporate No." := "Corporate No.";
      lServiceAmount."Service Order Type" := "Service Order Type";
      lServiceAmount."Amount Type" := lServiceAmount."Amount Type"::InterventionCeiling;
      lServiceAmount."Campaign No." := "Campaign No.";
      lServiceAmount."Corporate Region Code" := "Corporate Region Code";
      lServiceAmount.Requisitioner  := Requisitioner;
      lServiceAmount."Service Cause" := "Service Cause";
      lServiceAmount.Urgent := Urgent; //IMH46.ST
      lServiceAmount."Occupier Nature" := "Occupier Nature";
      lServiceAmount."Contract Form Code" := "Contract Form Code";  //IMH132
      IF NOT lServiceAmount.RetrieveServAmount(lServiceAmount) THEN
        EXIT;
      rValue := lServiceAmount.Amount;
    END;

    PROCEDURE AutoStep@1100281030() : Boolean;
    VAR
      lProcessServHeaderMgt@1100281000 : Codeunit 50043;
    BEGIN
      //IMH26.ST
      MODIFY;  //IMH128
      EXIT(lProcessServHeaderMgt.TestAutoStep(Rec));
    END;

    PROCEDURE OnLookUpCorporateContactNo@1100281032();
    VAR
      lMarketingSetup@1100281003 : Record 5079;
      lContact@1100281002 : Record 5050;
      lCorporateContact@1100281001 : Record 5050;
      lContactBusinessRelation@1100281000 : Record 5054;
    BEGIN
      lMarketingSetup.GET;
      lContactBusinessRelation.SETCURRENTKEY("Link to Table","No.");
      lContactBusinessRelation.SETRANGE("Link to Table",lContactBusinessRelation."Link to Table"::Customer);
      lContactBusinessRelation.SETRANGE("No.","Corporate No.");
      lContactBusinessRelation.SETRANGE("Business Relation Code",lMarketingSetup."Bus. Rel. Code for Customers");
      IF lContactBusinessRelation.ISEMPTY THEN
        EXIT;

      lCorporateContact.GET(lContactBusinessRelation."Contact No."); //IMH57.ST
      lContact.SETCURRENTKEY("Company No.");
      lContact.FILTERGROUP(2);
      lContact.SETRANGE("Company No.",lContactBusinessRelation."Contact No.");
      lContact.SETRANGE("Company Name", lCorporateContact.Name); //IMH57.ST ajout car l'index liste commence par le nom
      lContact.SETRANGE(Type,lContact.Type::Person);
      lContact.FILTERGROUP(0);
      lContact.SETFILTER("Corporate Region Code",'%1|%2','',"Corporate Region Code");
      //<<IMH57.ST
      ServSetup.GET;
      IF ServSetup."Corp. Contact Responsibility" <> '' THEN BEGIN
        lContact.SETFILTER("Job Responsibility Filter", ServSetup."Corp. Contact Responsibility");
        lContact.CALCFIELDS("No. of Job Responsibilities");
        lContact.SETFILTER("No. of Job Responsibilities", '>%1', 0);
      END;
      //>>IMH57.ST
      IF FORM.RUNMODAL(0,lContact) = ACTION::LookupOK THEN BEGIN
        "Corporate Contact No." := lContact."No.";
      END;
    END;

    LOCAL PROCEDURE GetServiceMgtSetup@1100281035();
    BEGIN
      // IMH41.ISAT.MA
      IF ServSetupGet THEN
        EXIT;
      ServSetup.GET;
      ServSetupGet := TRUE;
    END;

    LOCAL PROCEDURE UpdatePaymentMethodCode@1100281033();
    BEGIN
      // IMH41.ISAT.MA
      CASE CurrFieldNo OF
        FIELDNO("Payment Method") : BEGIN
          CASE "Payment Method" OF
            "Payment Method"::" " : BEGIN
              IF "Payment Method Code" = '' THEN
                EXIT;
              VALIDATE("Payment Method Code",'');
            END;
            "Payment Method"::"Credit Card" : BEGIN
              GetServiceMgtSetup();
              ServSetup.TESTFIELD("Credit Card Payment Method");
              IF "Payment Method Code" = ServSetup."Credit Card Payment Method" THEN
                EXIT;
              VALIDATE("Payment Method Code",ServSetup."Credit Card Payment Method");
            END;
            "Payment Method"::Cheque : BEGIN
              GetServiceMgtSetup();
              ServSetup.TESTFIELD("Cheque Payment Method");
              IF "Payment Method Code" = ServSetup."Cheque Payment Method" THEN
                EXIT;
              VALIDATE("Payment Method Code",ServSetup."Cheque Payment Method");
            END;
          END;
        END;

        FIELDNO("Payment Method Code") : BEGIN
          GetServiceMgtSetup();
          ServSetup.TESTFIELD("Credit Card Payment Method");
          ServSetup.TESTFIELD("Cheque Payment Method");
          CASE "Payment Method Code" OF
            ServSetup."Credit Card Payment Method" : "Payment Method" := "Payment Method"::"Credit Card";
            ServSetup."Cheque Payment Method" : "Payment Method" := "Payment Method"::Cheque;
            ELSE "Payment Method" := "Payment Method"::" ";
          END;
        END;
      END;
    END;

    PROCEDURE GetDeclarationContact@1000000000(pCorporateNo@1100281000 : Code[20]) : Code[20];
    VAR
      lMarketingSetup@1100281003 : Record 5079;
      lContBusRel@1100281002 : Record 5054;
      lContact@1100281001 : Record 5050;
      lCorporateRegion@1100281004 : Record 50058;
      lCustomerNo@1100281005 : Code[20];
    BEGIN
      //IMH42
      {
      IF pCorporateNo = '' THEN
        EXIT;

      lMarketingSetup.GET;
      lContactBusinessRelation.SETCURRENTKEY("Link to Table","No.");
      lContactBusinessRelation.SETRANGE("Link to Table",lContactBusinessRelation."Link to Table"::Customer);
      lContactBusinessRelation.SETRANGE("No.",pCorporateNo);
      lContactBusinessRelation.SETRANGE("Business Relation Code",lMarketingSetup."Bus. Rel. Code for Customers");
      IF lContactBusinessRelation.ISEMPTY THEN
        EXIT;
      lContactBusinessRelation.FINDFIRST;
      lContact.SETCURRENTKEY("Company No.");
      lContact.SETRANGE("Company No.",lContactBusinessRelation."Contact No.");
      lContact.SETRANGE(Type,lContact.Type::Person);
      lContact.SETRANGE("Declaration Contact", TRUE);

      IF lContact.FINDFIRST THEN
        EXIT(lContact."No.");
      }

      //<<IMH110 Isat.ZW
      //IF ("Corporate No." = '') OR ("Corporate Region Code" = '') THEN
      IF "Corporate No." = '' THEN
      //>>IMH110 Isat.ZW
        EXIT;
      lMarketingSetup.GET;
      //<<IMH110 Isat.ZW
      IF "Corporate Region Code" <> '' THEN BEGIN
        IF lCorporateRegion.GET("Corporate No.", "Corporate Region Code") THEN
          lCustomerNo := lCorporateRegion."Sell-to Customer No.";
      END ELSE
        lCustomerNo := "Corporate No.";

      IF lCustomerNo <> '' THEN BEGIN
      //<<IMH110 Isat.zw
        lContBusRel.SETCURRENTKEY("Link to Table","No.");
        lContBusRel.SETRANGE("Link to Table", lContBusRel."Link to Table"::Customer);
        //<<IMH110
        //lContBusRel.SETRANGE("No.", lCorporateRegion."Sell-to Customer No.");
        lContBusRel.SETRANGE("No.", lCustomerNo);
        //>>IMH110
        lContBusRel.SETRANGE("Business Relation Code",lMarketingSetup."Bus. Rel. Code for Customers");
        IF lContBusRel.FINDFIRST THEN BEGIN
          EXIT(lContBusRel."Contact No.");
        END;
      END;
    END;

    PROCEDURE SetSkipCheck@1100281037(pSkipCheck@1100281000 : Boolean);
    BEGIN
      //IMH43.ST
      SkipCheck := pSkipCheck;
    END;

    PROCEDURE GetServOrderType@1100281040() : Boolean;
    BEGIN
      //IMH43.ST
      IF "Service Order Type" = '' THEN
        EXIT(FALSE);

      IF ServOrderType.Code = "Service Order Type" THEN
        EXIT(TRUE)
      ELSE
        EXIT(ServOrderType.GET("Service Order Type"));
    END;

    PROCEDURE SendToIMA@1100281039(pResend@1100281001 : Boolean);
    VAR
      lEAISentIMAAction@1100281000 : Codeunit 50130;
    BEGIN
      //<<IMH.PC
      //<<IMH53.ISAT.EBA
      //IF lEAISentIMAAction.SendToIMA(Rec) THEN
      //  lEAISentIMAAction.CreateSalesOrderMsg(Rec,TRUE,TRUE);
      //>>IMH53.ISAT.EBA
      //>>IMH.PC

      //<<IMH87.ISAT.EBA
      //lEAISentIMAAction.SendToIMA(Rec, pResend);
      lEAISentIMAAction.SendFromSrvHeader(Rec,pResend,TRUE,TRUE);
      //>>IMH87.ISAT.EBA
    END;

    PROCEDURE SendReturnToIMA@1100281046(pResend@1100281001 : Boolean);
    VAR
      lReasonCode@1100281002 : Record 50079;
      lServiceInterventionQuote@1100281003 : Record 50076;
      lEAISentIMAAction@1100281000 : Codeunit 50130;
    BEGIN
      //<<IMH83.ISAT.EBA
      IF Status <>  Status::Finished THEN
        EXIT;

      IF NOT "Home Service" THEN
        EXIT;

      IF "Cheque / BC Receipt Date" = 0D THEN
        EXIT;


      //<<IMH116.ISAT.RC
      lServiceInterventionQuote.SETRANGE("Service Header No.","No.");
      lServiceInterventionQuote.SETRANGE(Acceptance,lServiceInterventionQuote.Acceptance::Yes);
      IF lServiceInterventionQuote.COUNT >= 1 THEN
        EXIT;

      //>>IMH116.ISAT.RC

      IF lReasonCode.GET(DATABASE::"Service Header",50023,"Closed Reason Code") THEN BEGIN
        IF NOT lReasonCode."Home Service Retractation" THEN
          EXIT;
      END ELSE
        EXIT;



      ServSetup.GET;
      ServSetup.TESTFIELD("Retraction Time");
      IF CALCDATE(ServSetup."Retraction Time","Cheque / BC Receipt Date") >= WORKDATE THEN
        lEAISentIMAAction.SendFromSrvHeader(Rec,pResend,TRUE,FALSE);
        //lEAISentIMAAction.SendReturnToIMA(Rec, pResend)
      //>>IMH83.ISAT.EBA
    END;

    PROCEDURE SendProviderOrderToIMA@1100281047(pResend@1100281001 : Boolean);
    VAR
      lServIntervLine@1100281003 : Record 50075;
      lServIntervMin@1100281002 : Record 50084;
      lEAISentIMAAction@1100281000 : Codeunit 50130;
    BEGIN
      //<<IMH115.ISAT.RC
      {

      //<<IMH87.ISAT.EBA
      IF Status <>  Status::Finished THEN
        EXIT;

      lServIntervLine.RESET;
      lServIntervLine.SETRANGE("Service Header No.","No.");
      lServIntervLine.SETFILTER("Intervention Status",'<>%1',lServIntervLine."Intervention Status"::Closed);
      IF NOT lServIntervLine.ISEMPTY THEN
        EXIT;

      lServIntervMin.RESET;
      lServIntervMin.SETRANGE("Service Header No.","No.");
      lServIntervMin.SETRANGE(Status,lServIntervMin.Status::Validated);
      lServIntervMin.SETRANGE(Type,lServIntervMin.Type::"End of work");
      IF NOT lServIntervMin.ISEMPTY THEN
        EXIT;

      lEAISentIMAAction.SendFromSrvHeader(Rec,TRUE,FALSE,TRUE)
      //>>IMH87.ISAT.EBA

      }
      //<<IMH115.ISAT.RC
    END;

    PROCEDURE CheckMandFields@1100281038();
    BEGIN
      //<<IMH52.ST
      IF "Meeting Date Input" = "Meeting Date Input"::Mandatory THEN
        TESTFIELD("Meeting Date");
      IF "Corporate Contact Input" = "Corporate Contact Input"::Mandatory THEN
        TESTFIELD("Corporate Contact Input");
      //>>IMH52.ST
    END;

    PROCEDURE ShowChangeLogs@1100281041();
    VAR
      lChangeLogEntry@1100281000 : Record 405;
    BEGIN
      //IMH06.zw
      lChangeLogEntry.SETCURRENTKEY("Table No.","Primary Key Field 1 Value");
      lChangeLogEntry.SETRANGE("Table No.", DATABASE::"Service Header");
      lChangeLogEntry.SETRANGE("Primary Key Field 1 Value", FORMAT("Document Type"));
      lChangeLogEntry.SETRANGE("Primary Key Field 2 Value", "No.");
      FORM.RUN(0, lChangeLogEntry);
    END;

    PROCEDURE TestDataBeforeAction@1100281042(pRaiseError@1100281000 : Boolean) : Boolean;
    VAR
      lCheckAmount@1000000000 : Decimal;
      lPermMgt@1000000001 : Codeunit 50093;
    BEGIN
      //IMH69.ST
      //Controle des donn‚es param‚tr‚es sur le type de produit avant action (cr‚ation d'intervention)

      // Tests des champs adresses ship-to
      TESTFIELD("Ship-to Address");
      TESTFIELD("Ship-to City");
      TESTFIELD("Ship-to Post Code");

      IF NOT GetServOrderType THEN EXIT;
      IF ServOrderType."Urgent Required" AND (Urgent = Urgent::" ") THEN BEGIN
        IF pRaiseError THEN
          ERROR(Text50011);
        EXIT(FALSE);
      END;
      IF ServOrderType."Estimate Amount Required" AND (NOT "Quote Managment") THEN BEGIN
        CALCFIELDS("Total Descr. Amount Incl. VAT");
        IF "Total Descr. Amount Incl. VAT" = 0 THEN BEGIN
          IF pRaiseError THEN
            ERROR(Text50012);
          EXIT(FALSE);
        END;
      END
      ELSE
        "Total Descr. Amount Incl. VAT" := 0;

      //<<IMH101.ST
      GetServiceMgtSetup;
      IF ServSetup."Work Amount Permission Check" <> 0 THEN BEGIN
        CALCFIELDS("Total Descr. Amount Incl. VAT");
        IF "Total Descr. Amount Incl. VAT" > "Max. Est. Work Amt Incl. VAT" THEN
          lCheckAmount := "Total Descr. Amount Incl. VAT"
        ELSE
          lCheckAmount := "Max. Est. Work Amt Incl. VAT";

        IF lCheckAmount >= ServSetup."Work Amount Permission Check" THEN BEGIN
          IF NOT lPermMgt.SkipWorkAmountCheck THEN BEGIN
            IF pRaiseError THEN
              ERROR(Text50015);
            EXIT(FALSE);
          END;
        END;
      END;
      //>>IMH101.ST
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE CalcDepositAmount@1100281043();
    VAR
      lNewDepositAmount@1100281000 : Decimal;
    BEGIN
      //IMH69.ST
      //Voir si on doit conditionner sur le type de produit
      IF NOT GetServOrderType THEN EXIT;
      IF NOT ServOrderType."Home Service" THEN
        EXIT;

      lNewDepositAmount := SalesInvoicingMgt.UpdateSalesPrice(Rec);
      IF "Deposit Amount" = lNewDepositAmount THEN
        EXIT;

      TESTFIELD("Check No.", '');
      TESTFIELD("BC Transaction No.", '');
      TESTFIELD("Transaction Code", '');
      VALIDATE("Deposit Amount", lNewDepositAmount);
    END;

    PROCEDURE UpdateContext@1100281044(pText@1100281000 : Text[250]);
    BEGIN
      UpdateExtText(pText, FIELDNO(Context)); //IMH72.ST
    END;

    PROCEDURE UpdateInformation@1100281034(pText@1100281000 : Text[250]);
    BEGIN
      UpdateExtText(pText, FIELDNO(Information)); //IMH72.ST
    END;

    LOCAL PROCEDURE UpdateExtText@1100281048(pText@1100281000 : Text[250];pFieldNo@1100281001 : Integer);
    VAR
      lServMgtComment@1100281002 : Record 5906;
    BEGIN
      //IMH72.ST
      IF lServMgtComment.GET(lServMgtComment."Table Name"::"Service Header",
                             "Document Type", "No.",
                             lServMgtComment.Type::General, 0, -pFieldNo) THEN BEGIN
        IF pText = '' THEN
          lServMgtComment.DELETE
        ELSE BEGIN
          lServMgtComment.Text := pText;
          lServMgtComment.MODIFY(TRUE);
        END;
      END
      ELSE BEGIN
        IF pText = '' THEN
          EXIT;
        lServMgtComment."Table Name" := lServMgtComment."Table Name"::"Service Header";
        lServMgtComment."Table Subtype" := "Document Type";
        lServMgtComment."No." := "No.";
        lServMgtComment.Type := lServMgtComment.Type::General;
        lServMgtComment."Table Line No." := 0;
        lServMgtComment."Line No." := -pFieldNo;
        lServMgtComment.Text := pText;
        lServMgtComment.INSERT(TRUE);
      END;
    END;

    PROCEDURE DARVATestFunction@1100281045(pServiceHeader@1100281005 : Record 5900;pDARVAType@1100281002 : 'SDR13,SDR61,SDR64,SDR99');
    VAR
      lServiceInterventionLine@1100281003 : Record 50075;
      lServiceCode@1100281006 : Record 50040;
      lInterventionDescription@1100281007 : Record 50070;
      lInterfaceSetup@1100281008 : Record 50139;
      lDARVAMgt@1100281001 : Codeunit 50150;
      lRecRef@1100281000 : RecordRef;
      lOKToSend@1100281004 : Boolean;
    BEGIN
      // IMH76.PC
      // Pour tester les fonctions DAVRA

      lServiceInterventionLine.RESET;
      lServiceInterventionLine.SETRANGE("Service Header No.",pServiceHeader."No.");
      lServiceInterventionLine.FINDFIRST;
      lRecRef.GETTABLE(lServiceInterventionLine);
      //<<IMH129.ACO
      DARVASetup.GET;
      //>>IMH129.ACO

      CASE pDARVAType OF
        // CARENCE DU LESE
        pDARVAType::SDR13 : BEGIN
          lServiceInterventionLine.SETRANGE("Service Header No.",pServiceHeader."No.");
          lServiceInterventionLine.SETFILTER("Intervention Status",'<>%1',lServiceInterventionLine."Intervention Status"::Cancel);
          IF lServiceInterventionLine.ISEMPTY THEN BEGIN
            lInterfaceSetup.GET;
            lInterfaceSetup.TESTFIELD("DARVA Canc. Reason Code SDR13");
            lServiceInterventionLine.SETRANGE("Intervention Status");
            lServiceInterventionLine.SETRANGE("Cancel Reason Code",lInterfaceSetup."DARVA Canc. Reason Code SDR13");
            IF NOT lServiceInterventionLine.ISEMPTY THEN BEGIN
              //<<IMH127.PC
              //lDARVAMgt.CreateSendMQ_SDR(lRecRef,'SDR13');
              //<<IMH129.ACO
              {lDARVAMgt.CreateSendMQ_SDR(
                lRecRef,'SDR13',
                lServiceInterventionLine."Corporate No.",lServiceInterventionLine."Corporate Region Code",
                lServiceInterventionLine."Service Order Type");}

              lDARVAMgt.CreateSendMQ_SDR(
                lRecRef,DARVASetup."DARVA SD13 Code",
                lServiceInterventionLine."Corporate No.",lServiceInterventionLine."Corporate Region Code",
                lServiceInterventionLine."Service Order Type");
              //>>IMH129.ACO
              //>>IMH127.PC
            END;
          END;
        END;
        // CARENCE DU PRETATAIRE / FIN DE MISSION
        pDARVAType::SDR61 : BEGIN
          lServiceInterventionLine.SETRANGE("Service Header No.",pServiceHeader."No.");
          lServiceInterventionLine.SETFILTER("Intervention Status",'<>%1',lServiceInterventionLine."Intervention Status"::Cancel);
          IF lServiceInterventionLine.ISEMPTY THEN BEGIN
            lInterfaceSetup.GET;
            lInterfaceSetup.TESTFIELD("DARVA Canc. Reason Code SDR13");
            lServiceInterventionLine.SETRANGE("Intervention Status");
            lServiceInterventionLine.SETRANGE("Cancel Reason Code",lInterfaceSetup."DARVA Canc. Reason Code SDR13");
            IF lServiceInterventionLine.ISEMPTY THEN BEGIN
              //<<IMH127.PC
              //lDARVAMgt.CreateSendMQ_SDR(lRecRef,'SDR61');
              //<<IMH129.ACO
              {lDARVAMgt.CreateSendMQ_SDR(
                lRecRef,'SDR61',
                lServiceInterventionLine."Corporate No.",lServiceInterventionLine."Corporate Region Code",
                lServiceInterventionLine."Service Order Type");}

              lDARVAMgt.CreateSendMQ_SDR(
                lRecRef,DARVASetup."DARVA SD61 Code",
                lServiceInterventionLine."Corporate No.",lServiceInterventionLine."Corporate Region Code",
                lServiceInterventionLine."Service Order Type");
              //>>IMH129.ACO
              //>>IMH127.PC
            END;
          END;
        END;
        // DESIGNATION PRESTATAIRE
        pDARVAType::SDR64 : BEGIN
          lOKToSend := TRUE;
          lInterventionDescription.SETRANGE("Service Header No.",pServiceHeader."No.");
          IF lInterventionDescription.FINDSET THEN BEGIN
            REPEAT
              // Recherche une ligne de desriptif portant la sp‚cialit‚
              lServiceCode.SETCURRENTKEY("Service Type","Service Header No.","Code Type",Code);
              lServiceCode.SETRANGE("Service Type",lServiceCode."Service Type"::Intervention);
              lServiceCode.SETRANGE("Service Header No.",pServiceHeader."No.");
              lServiceCode.SETRANGE("Code Type",lServiceCode."Code Type"::Speciality);
              lServiceCode.SETRANGE(Code,lInterventionDescription."Speciality Code");
              IF lServiceCode.FINDSET THEN BEGIN
                REPEAT
                  // V‚rification du statut de la ligne d'intervention
                  lServiceInterventionLine.SETRANGE("Service Header No.",lServiceCode."Service Header No.");
                  lServiceInterventionLine.SETRANGE("Line No.",lServiceCode."Intervention Line No.");
                  lServiceInterventionLine.SETFILTER(
                    "Intervention Status",'<>%1',lServiceInterventionLine."Intervention Status"::Cancel);
                  lServiceInterventionLine.SETFILTER("Mission Status",'<>%1',lServiceInterventionLine."Mission Status"::Canceled);
                  lOKToSend := NOT lServiceInterventionLine.ISEMPTY;
                UNTIL (NOT lOKToSend) OR (lServiceCode.NEXT = 0);
              END ELSE BEGIN
                lOKToSend := FALSE;
              END;
            UNTIL (NOT lOKToSend) OR (lInterventionDescription.NEXT = 0);
          END;
          IF lOKToSend THEN BEGIN
            //<<IMH127.PC
            //lDARVAMgt.CreateSendMQ_SDR(lRecRef,'SDR64');
            //<<IMH129.ACO
            {lDARVAMgt.CreateSendMQ_SDR(
              lRecRef,'SDR64',
              lServiceInterventionLine."Corporate No.",lServiceInterventionLine."Corporate Region Code",
              lServiceInterventionLine."Service Order Type");}

            lDARVAMgt.CreateSendMQ_SDR(
              lRecRef,DARVASetup."DARVA SD64 Code",
              lServiceInterventionLine."Corporate No.",lServiceInterventionLine."Corporate Region Code",
              lServiceInterventionLine."Service Order Type");
            //>>IMH129.ACO
            //>>IMH127.PC
          END;
        END;
      END;
    END;

    PROCEDURE GetClaimSourceInterv@1000000001(pServHeader@1100281001 : Record 5900;VAR pSourceIntervention@1000000000 : Record 50075) : Boolean;
    BEGIN
      //IMH06
      IF pServHeader."No." = '' THEN
        EXIT;
      IF NOT pServHeader.Claim THEN
        EXIT;

      pSourceIntervention.SETCURRENTKEY("Service No.");
      pSourceIntervention.SETRANGE("Service No.", pServHeader."Service No.");
      pSourceIntervention.SETRANGE("Service Header Claims No.", pServHeader."No.");
      IF pSourceIntervention.ISEMPTY THEN
        EXIT(FALSE);
      pSourceIntervention.FINDFIRST;
      EXIT(FALSE);
    END;

    PROCEDURE PhoneNoAssistEdit@1000000002(pPhoneNo@1100281000 : Text[30]);
    VAR
      lCTIMgt@1100281001 : Codeunit 50138;
    BEGIN
      // IMH99.PC
      IF pPhoneNo <> '' THEN BEGIN
        lCTIMgt.MakeCall(pPhoneNo);
      END;
    END;

    PROCEDURE CheckServiceCreateInterv@1100281049();
    VAR
      lRec@1100281000 : Record 5900;
    BEGIN
      //IMH106
      lRec := Rec;
      GetServOrderType;
      IF ServOrderType."Service Hdr Card Form ID" = 0 THEN
        ServOrderType."Service Hdr Card Form ID" := FORM::"Service Hdr Card"
      ELSE BEGIN
        lRec.FILTERGROUP(2);
        lRec.SETRANGE("Service Order Type", "Service Order Type");
        lRec.FILTERGROUP(0);
      END;

      CASE ServOrderType."Service Hdr Card Form ID" OF
        50101, 50102 : BEGIN
          CheckCorporateDeclaration;
        END;
        50107 : BEGIN
          CheckCorporateDeclaration;
          TESTFIELD("Person To Contact");
          TESTFIELD("Information Type");
          TESTFIELD(Information);
          TESTFIELD(Context);
        END;
      END;
      TestDataBeforeAction(TRUE)
    END;

    PROCEDURE GetWikiLink@1100281051(VAR pWikiLinkVisible@1100281001 : Boolean INDATASET;VAR pWikiLink@1100281000 : Text[250]);
    VAR
      lHelpMgt@1100281002 : Codeunit 50084;
    BEGIN
      //IMH114
      pWikiLinkVisible := lHelpMgt.RunHelp("Process Code","Process Status No.","Service Order Type","Corporate No.",1,pWikiLink);
    END;

    PROCEDURE SetSkipAutoStep@1100281052(pSkipAutoStep@1100281000 : Boolean);
    BEGIN
      //IMH120
      SkipAutoStep := pSkipAutoStep;
    END;

    PROCEDURE SetDisableNotif@1100281053(pDisableNotif@1100281000 : Boolean);
    BEGIN
      // IMH123.PC
      DisableNotif := pDisableNotif;
    END;

    BEGIN
    {
      /** @r IMH138 @d 23/05/14 @a ISAT.ZW @v IMH6.01.P010 @s Projet PMU
          @c rangement champs Table 5900 Service Header
          @c Ajouter champ 57010 - 57013 chmap PMU */
      /** @r IMH137 @d 16/04/14 @a ISAT.ZW @v IMH6.01.5071 @s Tri Service @h 5071
          @c Ajout tri sur la date de cr‚ation service + le passer de flowfield … un champ normal */
      /** @r IMH136 @d 26/03/14 @a ISAT.ZW @v IMH6.01.5005 @s Reorganisation DPS @h 5005
          @c Gestion de code corbeille par tache */
      /** @r IMH135 @d 24/02/14 @a ISAT.ZW @v IMH6.01.4985 @s R‚organisation DPS @c Ajout fonction GetTeamByServiceTask */
      /** @r IMH134 @d 04/01/14 @a ISAT.ZW @v IMH6.01.4402 @h 4402 @s Validation Email @c Correction validation mail */
      /** @r IMH133 @d 06/01/13 @a ISAT.ZW @v IMH6.01.4729 @h 4729 @s Gestion champ "Col de contenu"
          @c Modifier type champ 50033 Vol de contenu */
      /** @r IMH132 @d 31/12/13 @a ISAT.ZW @v IMH6.01.4843 @h 4843 @s Gestion plafond intervention
          @c Ajout champ 20 code formule dans la gestion */
      /** @r IMH131 @d 18/11/13 @a ISAT.ACO @v IMH6.01.348 @s DARVA MATMUT Lot 1 @h 4849
          @c Ajout champs Type Produit PELEC / Champ "T‚l destinataire MEO" non ‚ditable. */
      /** @r IMH130 @d 18/10/13 @a ISAT.ACO @v IMH6.01.348 @s DARVA MATMUT Lot 1 @h 4792
          @c Ajout champs 50262 "Person To contact MEO Name", flowfield vers champ 10 de la table 50127 "Service HEader 2"
          @c Ajout champs 50263 "Person To contact MEO Phone No.", flowfield vers champ 11 de la table 50127 "Service HEader 2"
          @c Ajout champs 50264 "Person To contact MEO Quality", flowfield vers champ 12 de la table 50127 "Service HEader 2"
          @c Ajout champs 50265 "Person To contact MEO No."*/
      /** @r IMH129 @d 03/09/13 @a ISAT.ACO @v IMH6.01.350 @s SystŠme d'aiguillage @c ParamŠtres DARVA */D
      /** @r IMH128 @d 11/07/13 @a ISAT.ST @v IMH6.01.351 @s JUILLET @h 3872 @c Modify avant autostep */
      /** @r IMH127 @d 25/06/13 @a ISAT.PC @v IMH6.01.350 @s SystŠme d'aiguillage @c Modification */
      /** @r IMH126 @d 19/06/13 @a ISAT.ACO @v IMH6.01.347 @s JUIN @h 4387 @c Ajout champs 50260 et 50261 */
      /** @r IMH125 @d 18/04/13 @a ISAT.PC @v IMH6.01.P008 @s Optimisation @c Ajout cl‚ "Process Code","Process Statut No." */
      /** @r IMH124 @d 08/03/13 @a ISAT.ZW @v IMH6.01.340 @s NEP IMH 4 @h 3769 @c Modif flowfield 50120 type adresse */
      /** @r IMH123 @d 29/11/12 @a ISAT.PC @v IMH6.01.224 @s NEP00006 @h 2901 @c add function SetDisableNotif */
      /** @r IMH122 @d 29/11/12 @a ISAT.PC @v IMH6.01.P008 @s Optimisation */
      /** @r IMH121 @d 15/11/12 @a ISAT.PC @v IMH6.01.214 @s NEP00005 @h 4122
          @c ajout de l'option Suspended sur le champ 50191,"Intervention Status Filter" */
      /** @r IMH120 @d 17/10/12 @a ISAT.ZW @v IMH6.01.224 @s NEP00006 @h 3702 @c Ajout SkipAutoStep */
      /** @r IMH119 @d 19/09/12 @a ISAT.ZW @v IMH6.01.224 @s NEP00004 @h 3621 @c Correction */
      /** @r IMH118 @d 17/09/12 @a ISAT.PC @v IMH6.01.P005 @s Controle de devis NAV-FUSION @c D‚sactivation de code */
      /** @r IMH117 @d 22/08/12 @a ISAT.ZW @v IMH6.01.212 @s Version 1.4 @h 1441
          @c Ajout champ 50756-50758 champs flowfield prestataire */
      /** @r IMH116 @d 21/08/12 @a ISAT.RC @v IMH6.01.212 @s Version 1.4.1 @h  3289
          @s Remboursement societaire deplac‚ … la cloture de la ligne produit*/
      /** @r IMH115 @d 21/08/12 @a ISAT.RC @v IMH6.01.212 @s Version 1.4.1 @h  3331
          @s Facturation de IMH … IMH Service … la cloture de l'intervention */
      /** @r IMH114 @d 18/07/12 @a ISAT.PC @v IMH6.01.226 @s version 1.4 @h 3537 @c Lien Wiki service + intervention */
      /** @r IMH113 @d 16/07/12 @a ISAT.PC @v IMH6.01.226 @s version 1.4 @h 1441
          @c Ajout champs flowfields prestataire */
      /** @r IMH112 @d 04/07/12 @a ISAT.ZW @v IMH6.01.020 @s Gestion du service @h 2868 @c Ajout champ 50530 RC Receipt Date */
      /** @r IMH111 @d 10/05/12 @a ISAT.ZW @v IMH6.01.020 @s Gestion du service @h 3424
          @c recalculer le code corbeille par d‚faut … la validation du code EVC */
      /** @r IMH110 @d 02/05/12 @a ISAT.ZW @v IMH6.01.020 @s Gestion du service @h 3421
          @c Gestion des contacts d‚claration sans r‚gion GC */
      /** @r IMH109 @d 16/04/12 @a ISAT.ST @v IMH6.01.106 @s Controle qualit‚ @c GetNextServiceHeaderNo si plus de 9 lignes */
      /** @r IMH108 @d 27/03/12 @a ISAT.ZW @v IMH6.01.020 @s Gestion du service @h 2725 @c Ajout fonction DirectCreateInervLine */
      /** @r IMH107 @d 20/03/12 @a ISAT.LLT @v IMH6.01.134 @s DARVA @c Ajout champ flowfield 56023, SDR99 Send */
      /** @r IMH106 @d 16/03/12 @a ISAT.ZW @v IMH6.01.011 @s EVC @c ajout des FOnction CheckServiceCreateInterv */
      /** @r IMH105 @d 14/03/12 @a ISAT.NFO @v IMH6.01.011 @s EVC @c ajout des cl‚ Campaign No. */
      /** @r IMH104 @d 08/03/12 @a ISAT.NFO @v IMH6.01.011 @s EVC @c ajout des contr“les li‚s aux EVC */
      /** @r IMH103 @d 22/02/12 @a ISAT.ST @v IMH6.01.011 @s G‚ocodage approximatif. @c GetReferenceGeoCode remplac‚ par GetGeoCode */
      /** @r IMH102 @d 15/02/12 @a ISAT.ZW @v IMH6.01.011 @s Ajout champ Claim Visit Date et cliam visite time */
      /** @r IMH101 @d 14/02/12 @a ISAT.ST @v IMH6.01.011 @s Controle des montants services */
      /** @r IMH100 @d 16/01/12 @a ISAT.ZW @v IMH6.01.129 @s Recla @c Ajout Champ Service Header Claims No. + Claimed Service Header*/
      /** @r IMH99 @d 14/01/12 @a ISAT.PC @v IMH6.01.129 @s CTI @c Ajout fonction PhoneNoAssistEdit */
      /** @r IMH98 @d 10/01/12 @a ISAT.PC @v IMH6.01.134 @s DARVA @c Ajout champ flowfield 56022, SDR64 Send */
      /** @r IMH97 @d 22/12/11 @a ISAT.ST @v IMH6.01.011 @s Gestion du service @c Bloquer la cr‚ation d'intervention sur les annul‚s */
      /** @r IMH96 @d 19/12/11 @a ISAT.ST @v IMH6.01.165 @s Gestion Notification @c finalisation IMH76 */
      /** @r IMH95 @d 13/12/11 @a ISAT.ZW @v IMH6.01.011 @s Mantis @c Gestion champ Plafond de d‚l‚gation */
      /** @r IMH94 @d 01/12/11 @a ISAT.ZW @v IMH6.01.011 @s Mantis @c MAJ code corbeille par d‚faut si changement Adresse MEO */
      /** @r IMH93 @d 29/11/11 @a ISAT.ST @v IMH6.01.011 @s Gestion du service @ Synchro adr. MEO sur intervention */
      /** @r IMH92 @d 25/11/11 @a ISAT.PC @v IMH6.01.011 @s Gestion du service @c ajout de champ 50630, EAI Entry No. */
      /** @r IMH91 @d 21/11/11 @a ISAT.SB @v IMH6.01.011 @s Gestion du service
          @c Ajout de la notion de diagnostic Immobilier reprise du type produit
      /** @r IMH90 @d 07/11/11 @a ISAT.PC @v IMH6.01.011 @s Gestion du service
          @c Ajout champ 50713, Princ. Expert Contact No.
          @c Ajout champ 50714, Princ. Expert Contact Name */
      /** @r IMH89 @d 25/10/11 @a ISAT.ST @v IMH6.01.011 @s Gestion du service @h 1950 @c Contr“le p‚riode souhait‚e */
      /** @r IMH89 @d 25/10/11 @a ISAT.ST @v IMH6.01.011 @s Gestion du service @h 1923 @c Mise … jour corbeille service */
      /** @r IMH88 @d 25/10/11 @a ISAT.ST @v IMH6.01.011 @s Gestion du service @h 1949 @c Ajout champ Declaration Comment Text */
      /** @r IMH87 @d 15/10/11 @a ISAT.EBA @v IMH6.01.011 @s Gestion du service
          @c Ajout de fonction : "SendProviderOrderToIMA" */
      /** @r IMH86 @d 07/10/11 @a ISAT.ZW @v IMH6.01.011 @s Gestion du service @h 1767
          @c Ajout champ 50610 Diagnostician Ref. */
      /** @r IMH85 @d 07/10/11 @a ISAT.SB @v IMH6.01.011 @s Gestion du service @h 1560
          @c Date r‚ception chŠque\CB = date de travail si mode de paiement = chŠque */
      /** @r IMH84 @d 04/10/11 @a ISAT.ZW @v IMH6.01.011 @s Gestion du service @h 1653
          @c Code r‚gion grand compte modifiable */
      /** @r IMH83 @d 03/10/11 @a ISAT.EBA @v IMH6.01.011 @s Gestion du service - Service … l'habitat
          @c Ajout de fonction : "SendReturnToIMA" */
      /** @r IMH82 @d 29/09/11 @a ISAT.EBA @v IMH6.01.011 @s Gestion du service - Service … l'habitat
          @c Modification champ "Cheque Receipt Date" en "Cheque / BC Receipt Date" */
      /** @r IMH81 @d 29/09/11 @a ISAT.ZW @v IMH6.01.011 @s Gestion du service @h 1505
          @c Code adresse MEO modifiable */
      /** @r IMH80 @d 28/09/11 @a ISAT.PC @v IMH6.01.011 @s Gestion du service @h 1498
          @c problŠme li‚ au g‚ocodage */
      /** @r IMH79 @d 27/09/11 @a ISAT.PC @v IMH6.01.011 @s Gestion du service @c On ne r‚cupŠre pas l'adresse de la formule */
      /** @r IMH78 @d 22/09/11 @a ISAT.PC @v IMH6.01.011 @s Gestion du service @c gestion du pr‚ssenti */
      /** @r IMH77 @d 20/09/11 @a ISAT.PC @v IMH6.01.011 @s DARVA @c Ajout fonction de test DARVA : DARVATestFunction */
      /** @r IMH76 @d 16/09/11 @a ISAT.PC @v IMH6.01.165 @s Gestion Notification
          @c Cr‚ation notif sur changement MEO */
      /** @r IMH75 @d 01/09/11 @a ISAT.LLT @v IMH6.01.011 @s Gestion du service
          @c les adresses de MEO deviennent modifiables
          @c Ajout champ 50010 Ship-to Address 3
          @c Ajout champ 50009*/
      /** @r IMH74 @d 01/09/11 @a ISAT.LLT @v IMH6.01.011 @s Gestion du service
          @c Modif Flowfield Contract
          @c Ajout champ 50540 Service Header Address Nb.*/
      /** @r IMH73 @d 30/08/11 @a ISAT.ST @v IMH6.01.011 @s Gestion du service @c Modif Flowfield Contact mobile Phone No. sur service */
      /** @r IMH72 @d 29/08/11 @a ISAT.ST @v IMH6.01.011 @s Gestion du service
          @c Suppression champ 50801 Deposit Amount Option
          @c champ 50091 Information en flowfield + Ajout fonction UpdateInformation
          @c Ajout champ 50012 Context + fonction UpdateContext */
      /** @r IMH71 @d 29/08/11 @a ISAT.LLT @v IMH6.01.011 @s Gestion du service @c Modif code region sur intervention */
      /** @r IMH70 @d 19/08/11 @a ISAT.ST @v IMH6.01.136 @s Fusion @c Gestion des statuts Fusion */
      /** @r IMH69 @d 12/08/11 @a ISAT.ST @v IMH6.01.011 @s Gestion du service @c Gestion "Deposit Amount" */
      /** @r IMH68 @d 25/07/11 @a ISAT.ZW @v IMH6.01.011 @s Gestion du service @c Synchro Adresse service */
      /** @r IMH67 @d 22/07/11 @a ISAT.ST @v IMH6.01.011 @s Gestion du service
          @c cr‚neau horaire rendez-vous obligatoire @h 768 */
      /** @r IMH66 @d 06/07/11 @a ISAT.MA @v IMH6.01.132 @s DARVA Management
          @c Ajout champ 50710 Expert Contact No.
          @c Ajout champ 50711 Nø Reference expert */
      /** @r IMH65 @d 22/06/11 @a ISAT.ZW @v IMH6.01.011 @s Gestion du service @c AJout champ 50485 Service order type description*/
      /** @r IMH64 @d 21/06/11 @a ISAT.ZW @v IMH6.01.011 @s Gestion du service @c AJout champ 50615 Fusion Service Status
      /** @r IMH63 @d 17/06/11 @a ISAT.ST @v IMH6.01.011 @s Gestion du service @c Controle date de rendez-vous */
      /** @r IMH62 @d 17/06/11 @a ISAT.ST @v IMH6.01.161 @s Log Service @c Appel sur les triggers de table */
      /** @r IMH61 @d 10/06/11 @a ISAT.ZW @v IMH6.01.011 @s Gestion du service @c Ajout champ No r‚f‚rence Fusion */
      /** @r IMH60 @d 06/06/11 @a ISAT.ZW @v IMH6.01.011 @s Gestion du service @c Ajout fonction ShowChangeLogs */
      /** @r IMH59 @d 31/05/11 @a ISAT.ST @v IMH6.01.011 @s Gestion du service @c Ajout champ 56019 DARVA Interface */
      /** @r IMH58 @d 30/05/11 @a ISAT.ZW @v IMH6.01.011 @s Gestion du service
          @c Ajout champ Fusion Service */
      /** @r IMH57 @d 27/05/11 @a ISAT.ST @v IMH6.01.011 @s Gestion du service
          @c D‚sactivation des exceptions
          @c Modif OnLookupCorporateContact*/
      /** @r IMH56 @d 20/05/11 @a ISAT.ZW @v IMH6.01.011 @s Gestion du service
          @c Ajout champ 50472, 50473, 50474 Montant estimation mobilier HT / TTC,Mode d'indemnisation */
      /** @r IMH55 @d 19/05/11 @a ISAT.PC @v IMH6.01.146 @s Gestion facturation
          @c Ajout champ 50602 Sales Order Nb
          @c Ajout champ 50603 Purchase Order Nb */
      /** @r IMH54 @d 16/05/11 @a ISAT.ZW @v IMH6.01.011 @s Gestion du service
          @c champ par defaut type hobitation
          @c gestion de cas particulier
          @c Controle creation intervention service panne Electro se fait dans la table Service header Device*/
      /** @r IMH53 @d 16/05/11 @a ISAT.EBA @v IMH6.01.159 @s Comptabilit‚ - IMA Service
          @c Ajout champ 50250 BC Transaction No.
          @c Ajout champ 50251 Check No.
          @c Ajout fonction SendToIMA */
      /** @r IMH52 @d 13/05/11 @a ISAT.ST @v IMH6.01.011 @s Gestion du service
          @c Controle de champs obligatoires */
      /** @r IMH51 @d 10/05/11 @a ISAT.PC @v IMH6.01.148 @s Gestion facturation @c
          @c Ajoute cr‚ation de commande vente lorsque type produit ne g‚nŠre pas d'intervention */
      /** @r IMH50 @d 05/05/11 @a ISAT.MA @v IMH6.01.131 @s Interface DARVA @c
          @c Ajout champ "DARVA Carrier Subscriber No." and "DARVA Recipient Subscriber No." */
      /** @r IMH49 @d 05/05/11 @a ISAT.ZW @v IMH6.01.011 @s Gestion du service @c
          @c Ajout champ "No. Intervention Descr." */
      /** @r IMH48 @d 06/04/11 @a ISAT.ST @v IMH6.01.011 @s Gestion du service
          @c Gestion Suivi d‚posit Amount
          @c Controle Estimate amount min/max */
      /** @r IMH47 @d 06/04/11 @a ISAT.ZW @v IMH6.01.136 @s Interface Fusion
          @c Ajout champ Fusion Status + GUID FUSION Code */
      /** @r IMH46 @d 02/04/11 @a ISAT.ST @v IMH6.01.011 @s Gestion du service @c Modif r‚cup plafond */
      /** @r IMH45 @d 01/04/11 @a ISAT.ZW @v IMH6.01.136 @s Interface fusion @c
          @c Ajout cl‚ "Fusion code " + cl‚ "Reference No." pour interface fusion */
      /** @r IMH44 @d 28/03/11 @a ISAT.ZW @v IMH6.01.136 @s Interface Fusion
          @c Creation ligne FIle de message en creation et modification service
          @c Ajout champ Fusion Code */
      /** @r IMH43 @d 25/03/11 @a ISAT.ST @v IMH6.01.198 @s RDD DPS @c Ajout SkipCheck
          @c MaintainSQLIndex … non sur No.,Document Type */
      /** @r IMH42 @d 24/03/11 @a ISAT.ZW @v IMH6.01.011 @s Gestion du service
          @c Precharger champ declaration contact no. */
      /** @r IMH41 @d 23/03/11 @a ISAT.MA @v IMH6.01.004 @s GED
          @c 464 : Champ 50102 Financement projet habitat : Suppression de l'option Refus‚
          @c 465 : Ajouts champs 50800,50801 */
      /** @r IMH40 @d 03/03/11 @a ISAT.LLT @v IMH6.01.011 @s Gestion du service
          @c Ajout champ 50440 No. Of Beneficiary
          @c Modifs r‚cup plafond */
      /** @r IMH39 @d 03/03/11 @a ISAT.LLT @v IMH6.01.011 @s Gestion du service
          @c Mode modif du champ Occupier Nature */
      /** @r IMH38 @d 03/03/11 @a ISAT.LLT @v IMH6.01.011 @s Gestion du service
          @c Ajout champ 50470 Total Descr. Amount Incl. VAT
          @c Ajout champ 50471 Total Descr. Amount Excl. VAT */
      /** @r IMH37 @d 02/03/11 @a ISAT.ZW @v IMH6.01.011 @s Gestion du service
      /** @r IMH36 @d 28/02/11 @a ISAT.ZW @v IMH6.01.011 @s Gestion du service
          @c Changer type Champ 50109 Project Type Option --> Code */
      /** @r IMH35 @d 21/02/11 @a ISAT.LLT @v IMH6.01.011 @s Gestion du service
          @c Gestion du canal et du b‚n‚ficiaire par d‚faut */
      /** @r IMH34 @d 21/02/11 @a ISAT.LLT @v IMH6.01.011 @s Gestion du service
          @c Gestion du d‚tail r‚clamation
          @c Gestion du d‚tail T‚l‚chiffrage
          @c Ajout champ 50700 TeleExpert */
      /** @r IMH33 @d 17/02/11 @a ISAT.LLT @v IMH6.01.011 @s Gestion du service
          @c Verrous - Suppresion champs 50510 "Locking Date" et 50511 "Locking User ID" et cl‚  */
      /** @r IMH32 @d 17/02/11 @a ISAT.LLT @v IMH6.01.011 @s Gestion du service
          @c Gestion nouveau type produit Justificatifs
          @c EN COURS : A ACTIVER
          @c Ajout champ 50600 Reimbursement Receipt Date
          @c Ajout champ 50601 Aount To Pay
          @c Ajout champ 50602 Contact Reimbursement
          @c Ajout champ 50603 Reimbursement Contact No.
          @c Ajout champ 50604 Reimbursement Refusal Cause
          @c Ajout champ 50605 Original Return Reimbursement  */
      /** @r IMH31 @d 14/02/11 @a ISAT.LLT @v IMH6.01.108 @s Interactions
          @c Ajout champ 50480 Service Creation Date */
      /** @r IMH30 @d 11/02/2011 @a IMH.ZW @v IMH6.01.001 @s Normalisation des donn‚es @c normalisation Email */
      /** @r IHM29 @d 10/02/11 @a ISAT.ZW @v IMH6.01.001 @s Normalisation des donn‚es
          @c Associer les Pays au code postaux - descendre le code pays automatiquement*/
      /** @r IMH28 @d 08/02/11 @a ISAT.ST @v IMH6.01.011 @s Gestion du service @c Optimisations */
      /** @r IMH27 @d 31/01/11 @a ISAT.LLT @v IMH6.01.011 @s Gestion du service @c Urgent passe de booleen a option
      /** @r IMH26 @d 27/01/11 @a ISAT.ST @v IMH6.01.011 @s Gestion du service @c Filtre sur chargement auto table code */
      /** @r IMH25 @d 17/01/11 @a ISAT.LLT @v IMH6.01.011 @s Gestion du service
          @c Doc Attach sur OnDelete
          @c Ajout champ 50040 Cheque Receipt Date
          @c Ajout champ 50429 Person to contact
          @c Correction affichage montant de d‚l‚gation
          @c Suivi du champ Quote Managment */
      /** @r IMH26 @d 14/01/11 @a ISAT.ST @v IMH6.01.102 @s Gestion des statuts
          @c Ajout fonction AutoStep + appel DeleteSourceRec des process */
      /** @r IMH25 @d 14/01/11 @a ISAT.LLT @v IMH6.01.011 @s Gestion du service
          @c Suppression commentaires */
      /** @r IMH24 @d 05/01/11 @a ISAT.ST @v IMH6.01.011 @s Gestion du service
          @c Gestion du montant de d‚l‚gation */
      /** @r IMH23 @d 20/12/10 @a ISAT.ZW @v IMH6.01.108 @s Interaction
          @c bloquer la cr‚ation d'une ligne produit si le type est exclu de la formule. */
      /** @r IMH22 @d 16/12/10 @a ISAT.LLT @v IMH6.01.011 @s Gestion du service
          @c Gestion du montant de d‚l‚gation
          @c Ajout contr“le lors de la cr‚ation de l'intervention
          @c Cr‚ation de l'intervention suivant les adresses
          @c Ajout champ 50109 Type projet
          @c Ajout champ 50005 Appropriate Deductible Amount
          @c Ajout champ 50006 Deductible Amount */
      /** @r IMH21 @d 15/12/10 @a ISAT.LLT @v IMH6.01.108 @s Interaction
          @c Gestion champs fusionn‚s */
      /** @r IMH20 @d 14/12/10 @a ISAT.ST @v IMH6.01.011 @s Gestion du service
          @c Contr“le du champ contrat */
      /** @r IMH19 @d 14/12/10 @a ISAT.LLT @v IMH6.01.011 @s Gestion du service
          @c Ajout du champ 50004 Intervention Allowed */
      /** @r IMH18 @d 08/12/10 @a ISAT.ZW @v IMH6.01.011 @s Gestion du service
          @c Ajout fonction GetDefaultTeamCodeByServOrder */
      /** @r IMH17 @d 08/12/10 @a ISAT.LLT @v IMH6.01.011 @s Gestion du service
          @c Gestion des champs date de cr‚ation et de cl“ture
          @c Ajout de fonctions pour les stats
          @c Passage du champ Requested Realised Date de Text en Date */
      /** @r IMH16 @d 07/12/10 @a ISAT.ZW @v IMH6.01.011 @s Gestion du service
          @c Ajout Champs 50520 + 50521 */
      /** @r IMH15 @d 07/12/10 @a ISAT.ZW @v IMH6.01.011 @s Gestion du service
          @c Ajout Champs "Force Default Team Code" + Default Team Code */
      /** @r IMH14 @d 07/12/10 @a ISAT.LLT @v IMH6.01.011 @s Gestion du service
          @c Ajout de la cl‚ "Locking Date,Locking User ID" pour la gestion des verrous */
      /** @r IMH13 @d 06/12/10 @a ISAT.ZW @v IMH6.01.011 @s Gestion du service
          @c AJout fonction GetServTimeRegister */
      /** @r IMH12 @d 03/12/10 @a ISAT.LLT @v IMH6.01.011 @s Gestion du service
          @c Suppression des trois champs Affected location */
      /** @r IMH11 @d 30/11/10 @a ISAT.ZW @v IMH6.01.011 @s Gestion du service
          @c Ajout fonciton create Interaction     */
      /** @r IMH10 @d 27/11/10 @a ISAT.LLT @v IMH6.01.011 @s Gestion du service
          @c Ajout fonction d'initialisation de garantie compl‚mentaire
          @c Fonction de synchronisation
          @c Gestion devis en fonction du cas particulier
          @c Ajout du champ 50414 Service Cause (provenant de serice)
          @c Ajout du champ 50499 Service Cause Description
          @c Ajout du champ 50416 Meeting Date
          @c Ajout du champ 50417 9h-12h
          @c Ajout du champ 50418 14h-17h
          @c Ajout du champ 50419 Declaration Comment Code */
      /** @r IMH09 @d 10/11/10 @a ISAT.LLT @v IMH6.01.011 @s Gestion du service
          @c Ajout du champ 50086 Housing Type
          @c Ajout du champ 50087 Property Type */
      /** @r IMH08 @d 10/11/10 @a ISAT.LLT @v IMH6.01.011 @s Gestion du service @c Ajout index sur Corporate No. pour infopane GC */
      /** @r IMH07 @d 09/11/2010 @a ISAT.LLT @v IMH6.01.011 @s Gestion du service
          @c Nø ligne produit = Nø service + type produit */
      /** @r IMH06 @d 28/10/2010 @a ISAT.ST @v IMH6.01.011 @s Gestion du service
          @c Gestion du corps d'‚tat et des sp‚cialit‚s
          @c Ajout champ 50060 Building Trade
          @c Ajout champ 50061 Main Speciality
          @c Controle des catalogues grand compte */
      /** @r IMH05 @d 15/10/2010 @a ISAT.LLT @v IMH6.01.011 @s Gestion du service
          @c Ajout fonction d'initialisation de la table Service Diagnostic Element
          @c Suppression de "Document Type" dans le DropDown */
      /** @r IMH04 @d 13/10/2010 @a ISAT.ST @v IMH6.01.011 @s Gestion du service
          @c Fonction ShowCard
          @c Corrections
          @c Maintain SQLIndex … non sur "Customer No.,Order Date", "Contract no.,Status,Posting Date",
          @c "Status,Response Date,Response Time,Priority","Status,Priority,Response Date,Response Time"
          @c Ajout Index Service Order Type, Status flowfields */
      /** @r IMH03 @d 13/10/2010 @a ISAT.ZW @v IMH6.01.012 @s Gestion de l'intervention
          @c Fonction CreateIntervention Avec la recherche de Prestataire */
      /** @r IMH02 @d 04/10/2010 @a ISAT.LLT @v IMH6.01.011 @s Gestion du service
          @c Ajout des champs de 50000 … 50055
          @c Gestion des suppressions
          @c d‚sactivation de la notion de client
          @c Ajout Cl‚ Service No.
          @c Ajout Cl‚ Partner No.,Contact No. */
      /** @r IMH01 @d 23/09/2010 @a ISAT.LLT @v IMH6.01.001 @s Normalisation des donn‚es
          @c Appel de la fonction de normalisation sur les champs de type t‚l‚phonie  */
    }
    END.
  }
}