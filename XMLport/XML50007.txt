OBJECT XMLport 50007 Import/Export Interaction
{
  OBJECT-PROPERTIES
  {
    Date=13/12/11;
    Time=15:44:59;
    Modified=Yes;
    Version List=IMH6.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Import/Export Interaction;
               FRA=Import/Export Interaction];
    OnPostXMLport=BEGIN
                    IF InteractionTemp.GET('') THEN
                      InteractionTemp.DELETE;
                  END;

    Format=Variable Text;
    FieldSeparator=<TAB>;
  }
  ELEMENTS
  {
    { [{30FB5C61-3939-4F70-9103-4438DCB90EC0}];0 ;Root                ;Element ;Text     }

    { [{D3EAD9DE-8C0B-43F4-A1C1-DC8758BBE04C}];1 ;InteractionTemplate ;Element ;Table   ;
                                                  SourceTable=Table5064;
                                                  Import::OnBeforeInsertRecord=BEGIN
                                                                                 IF "Interaction Template".Code = '' THEN
                                                                                   currXMLport.SKIP;
                                                                                 InteractionTemp := "Interaction Template";
                                                                                 IF InteractionTemp.FIND('=') THEN
                                                                                   InteractionTemp.DELETE(FALSE);
                                                                               END;

                                                  Export::OnAfterGetRecord=BEGIN
                                                                             InetactionTmplTemp.Code := "Interaction Template".Code;
                                                                             InetactionTmplTemp.INSERT;
                                                                           END;
                                                                            }

    { [{E014895B-D4FC-4E03-A563-0627311AC7F3}];2 ;Code                ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Interaction Template::Code }

    { [{10DCB96F-7DF7-426F-AEB8-17E44B746F03}];2 ;InteractionGroupCode;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Interaction Template::Interaction Group Code }

    { [{82A5CCFB-275A-4107-8728-941E31799692}];2 ;Description         ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Interaction Template::Description }

    { [{BEC648F0-C59A-4A5B-ACD6-D9177040091B}];2 ;UnitCostLCY         ;Element ;Field   ;
                                                  DataType=Decimal;
                                                  SourceField=Interaction Template::Unit Cost (LCY) }

    { [{E31A2C74-64BD-4B0C-B284-4A5FA7EEB1F9}];2 ;UnitDurationMin     ;Element ;Field   ;
                                                  DataType=Decimal;
                                                  SourceField=Interaction Template::Unit Duration (Min.) }

    { [{A8CA02E3-EECD-4612-ACE5-62D3809C3055}];2 ;InformationFlow     ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Interaction Template::Information Flow }

    { [{F03F1027-2D5C-4025-9F9B-3DDB448672D6}];2 ;InitiatedBy         ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Interaction Template::Initiated By }

    { [{551F46E7-CFCC-416F-B467-EC7FA403C274}];2 ;CampaignNo          ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Interaction Template::Campaign No. }

    { [{273EFAD7-17D3-445D-B407-416ABDBCED87}];2 ;CampaignTarget      ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Campaign Target }

    { [{8F240EFF-A43E-4811-A8AC-7F44D57E3CAE}];2 ;CampaignResponse    ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Campaign Response }

    { [{0BDCC92B-A9A2-40B9-AB0E-4E0AE2C15633}];2 ;CorrespondenceTypeDefault;Element;Field;
                                                  DataType=Option;
                                                  SourceField=Interaction Template::Correspondence Type (Default) }

    { [{E7142509-4B15-4D4F-9B78-138D95479544}];2 ;LanguageCodeDefault ;Element ;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=Interaction Template::Language Code (Default) }

    { [{72B75215-2B97-4C30-851F-33C5A5566010}];2 ;WizardAction        ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Interaction Template::Wizard Action }

    { [{A493690B-6601-4030-8752-1B1AAB76D922}];2 ;IgnoreContactCorresType;Element;Field ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Ignore Contact Corres. Type }

    { [{4F5D2FD8-78F7-4039-BBDB-680BD6D7BAC0}];2 ;MailAttachment      ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Mail Attachment }

    { [{117FE76C-94FD-419B-85BD-6CF4EB99E62A}];2 ;MailAttachmentName  ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Interaction Template::Mail Attachment Name }

    { [{C7484558-3DA3-4162-B0DE-A7AEE74ABF03}];2 ;AutomaticSendMail   ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Automatic Send Mail }

    { [{BEE84033-7B78-4AB5-8836-387C9D5E50B1}];2 ;DefaultInteractionDesc;Element;Field  ;
                                                  DataType=Text;
                                                  SourceField=Interaction Template::Default Interaction Descr. }

    { [{A1FD996C-AFC4-4295-9474-C4E004E4F890}];2 ;ServiceContactDest  ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Interaction Template::Service Contact Dest. }

    { [{FF587F51-16ED-4697-824C-2B00F2904E19}];2 ;SendToAdminContact  ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Send To Admin. Contact }

    { [{C942B12B-58FF-48A5-BD08-D40333C4FECD}];2 ;AttachmentReadOnly  ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Attachment Read Only }

    { [{ABFBBD28-C614-461D-B043-B1A3B1082067}];2 ;DescriptionReadOnly ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Description Read Only }

    { [{58FC3B2B-A743-4757-AD3D-A1E94DC016CB}];2 ;ShowToContact       ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Show To Contact }

    { [{EE7C496E-6996-4113-8EBB-F644BDCEF643}];2 ;ShowToService       ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Show To Service }

    { [{389FB5D3-C2A3-4C92-A9EF-4EE41DB78640}];2 ;ShowToServiceHeader ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Show To Service Header }

    { [{DA99F0E3-1D8D-476D-9518-5C005E22958F}];2 ;ShowToIntervention  ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Show To Intervention }

    { [{C5017048-07E8-41C6-92A2-9CA885ECD6F0}];2 ;ShowToPuchaseHeader ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Show To Puchase Header }

    { [{0309AAFF-5EA1-4899-ABC4-6F5B5015932C}];2 ;BuiltFieldNb        ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Interaction Template::Built Field Nb }

    { [{E8A6225F-7CFA-4DB9-B420-62D74D8B37A3}];2 ;QuoteFormulaNb      ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Interaction Template::Quote Formula Nb }

    { [{88136257-CD4E-4210-A8B4-3BF66BEBE494}];2 ;LocationFormulaNb   ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Interaction Template::Location Formula Nb }

    { [{B2C040CC-997B-409C-9F28-09D1C03C1E9A}];2 ;QuoteFormula        ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Interaction Template::Quote Formula }

    { [{0DE4CD7B-3F70-4D3C-8C7D-1A71B1731530}];2 ;LocationFormula     ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Interaction Template::Location Formula }

    { [{EA55B679-A192-485C-ACB4-F4E3F0E8E76E}];2 ;BuiltFieldCode1     ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Interaction Template::Built Field Code 1 }

    { [{74E89F4A-AD2A-4B3F-9030-16E0A9C0DA97}];2 ;BuiltFieldCode2     ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Interaction Template::Built Field Code 2 }

    { [{DC1CCFC7-3FE2-4C28-A085-8FCB53EC3350}];2 ;BuiltFieldCode3     ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Interaction Template::Built Field Code 3 }

    { [{A25D2ECF-0E81-4103-8D62-1899F8E11BD7}];2 ;BuiltFieldCode4     ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Interaction Template::Built Field Code 4 }

    { [{CF5B074D-B602-453E-A508-E2DDEC8E4ECB}];2 ;BuiltFieldCode5     ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Interaction Template::Built Field Code 5 }

    { [{883FE1AC-4D05-4DAA-B74B-52B55393C731}];2 ;BuiltFieldCode6     ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Interaction Template::Built Field Code 6 }

    { [{99238779-1EC2-4C90-BC30-858B694E545E}];2 ;BuiltFieldCode7     ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Interaction Template::Built Field Code 7 }

    { [{8D283194-4E8F-4FCE-9401-A861AB19AD83}];2 ;BuiltFieldCode8     ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Interaction Template::Built Field Code 8 }

    { [{DB90E07D-ACC0-4838-A909-B0221892E469}];2 ;BuiltFieldCode9     ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Interaction Template::Built Field Code 9 }

    { [{D5D5D2F1-CFDC-4980-B3F6-243E5F9D5561}];2 ;BuiltFieldCode10    ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Interaction Template::Built Field Code 10 }

    { [{B6AE31EE-5EC0-4EAE-832A-2E151ABCF9F0}];2 ;Checked             ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Checked }

    { [{ED0E2390-43D3-4A2E-80ED-57423CFA257B}];2 ;ShowToDGS           ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Show To DGS }

    { [{09F32A25-067A-4A47-A150-3347678493F2}];2 ;ShowToDPR           ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Show To DPR }

    { [{878F9CB2-4CA1-406C-B16D-1C2AC0F158EA}];2 ;ShowToDFC           ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Show To DFC }

    { [{6BB4FA57-A83F-4E4E-B63F-B040C4BAA79A}];2 ;ShowingFilter       ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Interaction Template::Showing Filter }

    { [{0B255ACA-AFF7-4970-B5E5-E65034E81F81}];2 ;MailObjectAuto      ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Mail Object Auto }

    { [{8F51C90C-CA24-445A-BBAB-489AB59B59E7}];2 ;NotifyToExtranet    ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Notify To Extranet }

    { [{D061F29B-7EFB-424D-A784-A06E1F2A5CDC}];1 ;InteractionTemplateField;Element;Table;
                                                  SourceTable=Table50083;
                                                  LinkTable=Interaction Template;
                                                  Import::OnBeforeInsertRecord=BEGIN
                                                                                 InteractionTempField := "Interaction Template Field";
                                                                                 IF InteractionTempField.FIND('=') THEN
                                                                                   InteractionTempField.DELETE(FALSE);
                                                                               END;

                                                  Export::OnAfterGetRecord=BEGIN
                                                                             IF NOT InetactionTmplTemp.GET("Interaction Template Field"."Interaction Template Code") THEN
                                                                               currXMLport.SKIP;
                                                                           END;
                                                                            }

    { [{718078AF-1F41-476A-BB3E-E499CA21B177}];2 ;InteractionTemplateCode;Element;Field ;
                                                  DataType=Code;
                                                  SourceField=Interaction Template Field::Interaction Template Code }

    { [{8FDF125B-8969-4F3F-8B18-B6A48DB656D6}];2 ;SourceTableID       ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Interaction Template Field::Source Table ID }

    { [{362DA147-22CB-4BA1-8FCB-86A82C07863F}];2 ;SourceFieldNo       ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Interaction Template Field::Source Field No. }

    { [{61F00FC0-E7BD-4631-93B7-644A0F9089E8}];2 ;SourceTable         ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Interaction Template Field::Source Table }

    { [{314F13B5-7277-4B70-A3D3-FC036944460B}];2 ;MergeFieldName      ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Interaction Template Field::Merge Field Name }

    { [{06946C78-17E9-4EA5-93B1-2ACC40D159D9}];1 ;BuiltMergeField     ;Element ;Table   ;
                                                  VariableName=Built Merge Field;
                                                  SourceTable=Table50140;
                                                  LinkTable=Interaction Template }

    { [{A11D0770-1608-40E4-85AD-06C558865D08}];2 ;Code                ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Built Merge Field::Code }

    { [{67F07E2A-B9FD-48E2-A26F-FFF212065544}];2 ;CorporateNo         ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Built Merge Field::Corporate No. }

    { [{A7A3B842-A245-47ED-93EE-2C9F48997F1B}];2 ;ServiceOrderType    ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Built Merge Field::Service Order Type }

    { [{F920E2D4-5DEE-458E-BA7A-DFF08B02D786}];2 ;Requisitioner       ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Built Merge Field::Requisitioner }

    { [{87FCD57B-8B59-40C3-8CCC-D63315F3831F}];2 ;ServiceReasonCode   ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Built Merge Field::Service Reason Code }

    { [{3A8EF0CE-F8FA-4DCB-8714-26A9CDEC3CCE}];2 ;Moisture            ;Element ;Field   ;
                                                  DataType=Decimal;
                                                  SourceField=Built Merge Field::Moisture % }

    { [{69E6080A-3F70-44B1-A87F-003443E2CECA}];2 ;NextAppointmentDate ;Element ;Field   ;
                                                  DataType=Date;
                                                  SourceField=Built Merge Field::Next Appointment Date }

    { [{864823AD-5BFD-4A37-BE03-4E0491690B73}];2 ;NextAppointmentDateModified;Element;Field;
                                                  DataType=Option;
                                                  SourceField=Built Merge Field::Next Appointment Date Modified }

    { [{0FDBB413-3923-48E0-9505-6634D1056107}];2 ;AcceptedActifQuoteExists;Element;Field;
                                                  DataType=Option;
                                                  SourceField=Built Merge Field::Accepted Actif Quote Exists }

    { [{FDAD4446-F4AD-4935-AD90-70FDB5C11743}];2 ;CancelReasonCode    ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Built Merge Field::Cancel Reason Code }

    { [{A5989F71-D8AB-4AEE-BFFE-41D105A6ADD1}];2 ;InterventionCeilingExceeded;Element;Field;
                                                  DataType=Option;
                                                  SourceField=Built Merge Field::Intervention Ceiling Exceeded }

    { [{5EF30C43-E7F2-4D70-9708-40DF670E7353}];2 ;OccupierNature      ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Built Merge Field::Occupier Nature }

    { [{F00778B8-4C6F-4BA9-BB8A-EEBF951DE005}];2 ;HousingType         ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Built Merge Field::Housing Type }

    { [{8EAEF545-B94A-4FE9-AB55-5CECB93DA8C3}];2 ;ExpectedWorkEndDateExist;Element;Field;
                                                  DataType=Option;
                                                  SourceField=Built Merge Field::Expected Work End Date Exist }

    { [{4C20F401-09A8-45AC-9130-5BDD8B4EFBB6}];2 ;MoistureExist       ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Built Merge Field::Moisture Exist }

    { [{54A29874-141D-4620-BD53-8A5644D40783}];2 ;NextAppointmentDateEdit;Element;Field ;
                                                  DataType=Option;
                                                  SourceField=Built Merge Field::Next Appointment Date Edit }

    { [{1A390E3C-16EF-4B71-83EA-22420632DE14}];2 ;QuoteDemand         ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Built Merge Field::Quote Demand }

    { [{8D1C1A8C-6624-4E2F-A484-A15661509674}];2 ;DeductibleDepreciationAmt;Element;Field;
                                                  DataType=Option;
                                                  SourceField=Built Merge Field::Deductible + Depreciation Amt. }

    { [{D42068B7-0503-4352-88A0-8A075DE32C7C}];2 ;PaymentMethod       ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Built Merge Field::Payment Method }

    { [{03101B4C-FBB0-4228-9A34-379786EFB875}];2 ;SentenceNo          ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Built Merge Field::Sentence No. }

    { [{FD9BDBBB-C3EB-4449-81BB-1798A4904793}];1 ;BuiltMergeFieldDetail;Element;Table   ;
                                                  VariableName=Built Merge Field Detail;
                                                  SourceTable=Table50141 }

    { [{1438BD46-03F5-42AB-BEEA-37DAF8A073CB}];2 ;BuiltMergeFieldCode ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Built Merge Field Detail::Built Merge Field Code }

    { [{10F5A98D-C4A4-4AAA-BC44-0B596D478205}];2 ;SentenceNo          ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Built Merge Field Detail::Sentence No. }

    { [{BD2CAD4F-F133-4F7E-85DD-5BBD8D8A407C}];2 ;Sentence            ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Built Merge Field Detail::Sentence }

    { [{0E2D51E8-AED1-4725-8251-CD4643E46FCE}];2 ;SourceTableID1      ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Table ID 1 }

    { [{B816C163-2983-4E54-A9C7-D2A308BF0E07}];2 ;SourceFieldNo1      ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Field No. 1 }

    { [{0E4073D1-AC8C-441A-86F5-635BBD84F891}];2 ;SourceTable1        ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Built Merge Field Detail::Source Table 1 }

    { [{74AC657D-C4E6-4852-9346-5FA5D41131F4}];2 ;SourceTableID2      ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Table ID 2 }

    { [{F08A775B-A2E4-48E7-B04E-1846475888DE}];2 ;SourceFieldNo2      ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Field No. 2 }

    { [{01E589CD-E6C6-45C4-8210-D069A765F22C}];2 ;SourceTable2        ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Built Merge Field Detail::Source Table 2 }

    { [{1A105CAD-EC01-499B-9A0C-4129BE4DF799}];2 ;SourceTableID3      ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Table ID 3 }

    { [{F7187A48-63C7-4372-9F60-16D67A3F4424}];2 ;SourceFieldNo3      ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Field No. 3 }

    { [{8E5624BD-27C4-44D8-8223-DA3EE7D2380E}];2 ;SourceTable3        ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Built Merge Field Detail::Source Table 3 }

    { [{2386A973-F4FA-4EEC-A4C7-8ABF640CE60F}];2 ;SourceTableID4      ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Table ID 4 }

    { [{EEB6FC65-F0CE-4AD8-ACBA-B9FAB277DFC6}];2 ;SourceFieldNo4      ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Field No. 4 }

    { [{BC2C0C17-0878-4F96-AE48-F237B25B6CCB}];2 ;SourceTable4        ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Built Merge Field Detail::Source Table 4 }

    { [{F7749EA5-FC1C-466C-A8C9-CCCC3012C2A8}];2 ;SourceTableID5      ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Table ID 5 }

    { [{AE2927A5-A138-49C1-94D3-96A86282F5D3}];2 ;SourceFieldNo5      ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Field No. 5 }

    { [{D56F5A4C-B02E-4D51-A490-2799EADF1C32}];2 ;SourceTable5        ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Built Merge Field Detail::Source Table 5 }

    { [{70592633-8F30-4488-BBCD-03F6D889271F}];2 ;SourceTableID6      ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Table ID 6 }

    { [{CFAF99B8-D6EB-4B6B-8849-92BB45877BC3}];2 ;SourceFieldNo6      ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Field No. 6 }

    { [{08AAA45C-C5D3-4B85-A09A-EB73316C8A00}];2 ;SourceTable6        ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Built Merge Field Detail::Source Table 6 }

    { [{A213BD00-71C3-4D2E-8508-FADB123BB9CB}];2 ;SourceTableID7      ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Table ID 7 }

    { [{AACA646E-DE0B-48D7-AC2A-1737198BE451}];2 ;SourceFieldNo7      ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Field No. 7 }

    { [{26F80598-F516-4482-9569-00B21F85B2EE}];2 ;SourceTable7        ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Built Merge Field Detail::Source Table 7 }

    { [{3ACDF671-904E-42B9-AF3A-639335EF6DA5}];2 ;SourceTableID8      ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Table ID 8 }

    { [{91C3C9CB-9510-4CE8-A922-9446D85A9E9C}];2 ;SourceFieldNo8      ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Field No. 8 }

    { [{C77D80B6-7ED5-41C7-BFF3-56435CC79069}];2 ;SourceTable8        ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Built Merge Field Detail::Source Table 8 }

    { [{F3ECD472-DD56-4FB4-B8E7-8AC70AAAEBC6}];2 ;SourceTableID9      ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Table ID 9 }

    { [{23EC691B-DA62-4BCA-8DF8-13C623A88651}];2 ;SourceFieldNo9      ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Field No. 9 }

    { [{415DAC03-38E1-429D-8C7E-9A44F35187CD}];2 ;SourceTable9        ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Built Merge Field Detail::Source Table 9 }

    { [{A5C0A6E6-030E-44CB-A538-98791CD3A6DD}];2 ;SourceTableID10     ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Table ID 10 }

    { [{C53A1EAE-21D0-4C1B-A666-6736A00DEEA5}];2 ;SourceFieldNo10     ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Field No. 10 }

    { [{D9398563-B6C1-4955-B354-40CAAD927C6D}];2 ;SourceTable10       ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Built Merge Field Detail::Source Table 10 }

    { [{57A9BCD2-7373-40F7-AA67-99EB66B5D56B}];1 ;InteractionTmplLanguage;Element;Table ;
                                                  SourceTable=Table5103;
                                                  SourceTableView=SORTING(Field1,Field2);
                                                  LinkTable=Interaction Template;
                                                  Import::OnBeforeInsertRecord=BEGIN
                                                                                 InteracTempLang := "Interaction Tmpl. Language";
                                                                                 IF InteracTempLang.FIND('=') THEN
                                                                                   InteracTempLang.DELETE(FALSE);
                                                                               END;

                                                  Export::OnAfterGetRecord=BEGIN
                                                                             IF NOT InetactionTmplTemp.GET("Interaction Tmpl. Language"."Interaction Template Code") THEN
                                                                               currXMLport.SKIP;

                                                                             AttachmentTemp."No." := "Interaction Tmpl. Language"."Attachment No.";
                                                                             IF AttachmentTemp.INSERT(FALSE) THEN;
                                                                           END;
                                                                            }

    { [{B5AA2EC7-F246-4EBA-9336-B1021801F2D7}];2 ;InteractionTemplateCode;Element;Field ;
                                                  DataType=Code;
                                                  SourceField=Interaction Tmpl. Language::Interaction Template Code }

    { [{F833EFAD-F7EA-4391-BC3B-D00F617025F7}];2 ;LanguageCode        ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Interaction Tmpl. Language::Language Code }

    { [{FFE3CE6C-120A-436C-954F-76DA949B3CE2}];2 ;Description         ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Interaction Tmpl. Language::Description }

    { [{EBB8599D-ED05-4FCF-8664-859DE2688F7B}];2 ;AttachmentNo        ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Interaction Tmpl. Language::Attachment No. }

    { [{0DF62C7D-E529-4BB4-953C-D11C1A90383D}];1 ;Attachment          ;Element ;Table   ;
                                                  SourceTable=Table5062;
                                                  Import::OnBeforeInsertRecord=VAR
                                                                                 lAttachment@1100281002 : Record 5062;
                                                                                 lInteractTmplLanguage@1100281001 : Record 5103;
                                                                                 lOldAttchNo@1100281000 : Integer;
                                                                               BEGIN
                                                                                 lAttachment := Attachment;
                                                                                 lOldAttchNo := Attachment."No.";
                                                                                 ImportAttach(lAttachment);
                                                                                 lAttachment."Last Date Modified" := Attachment."Last Date Modified";
                                                                                 lAttachment."Last Time Modified" := Attachment."Last Time Modified";
                                                                                 lAttachment.MODIFY(FALSE);
                                                                                 lInteractTmplLanguage.SETRANGE("Attachment No.", lOldAttchNo);
                                                                                 //IF lInteractTmplLanguage.FINDFIRST THEN BEGIN
                                                                                 //  lInteractTmplLanguage."Attachment No." := lAttachment."No.";
                                                                                 lInteractTmplLanguage.MODIFYALL("Attachment No.", lAttachment."No.");
                                                                                 //END;

                                                                                 currXMLport.SKIP;
                                                                               END;

                                                  Export::OnAfterGetRecord=BEGIN
                                                                             IF NOT AttachmentTemp.GET(Attachment."No.") THEN
                                                                               currXMLport.SKIP;

                                                                             ExportAttach(Attachment);
                                                                           END;
                                                                            }

    { [{A0AA5830-586F-4BBD-9074-8B0AA06F8EEF}];2 ;No                  ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Attachment::No. }

    { [{124D028D-46AC-4EC6-9838-F2E13682A944}];2 ;StorageType         ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Attachment::Storage Type }

    { [{9BBF31ED-3728-48A4-A5C7-2F5805E7F72A}];2 ;StoragePointer      ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Attachment::Storage Pointer }

    { [{6C0FF9BA-2445-411B-89FE-073F8A994D91}];2 ;FileExtension       ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Attachment::File Extension }

    { [{6034D515-0A99-490A-AEDE-2BA58AE0FA7A}];2 ;ReadOnly            ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Attachment::Read Only }

    { [{C016004F-1C95-42FA-8D31-D3C47CB68313}];2 ;LastDateModified    ;Element ;Field   ;
                                                  DataType=Date;
                                                  SourceField=Attachment::Last Date Modified }

    { [{FA1E196F-8C0B-4D85-9FB0-55DC9F5EA2CB}];2 ;LastTimeModified    ;Element ;Field   ;
                                                  DataType=Time;
                                                  SourceField=Attachment::Last Time Modified }

    { [{705E8CB5-2D89-42A6-ACFF-53661BFA6033}];2 ;StorePointerChecksum;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Attachment::Store Pointer Checksum }

    { [{A226468B-9B55-488E-B81E-CC444D367DE4}];2 ;EntryPointerChecksum;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Attachment::Entry Pointer Checksum }

    { [{6853555B-8B18-48A9-AE0E-49D6FA8C95A8}];2 ;ServiceHeaderNo     ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Attachment::Service Header No. }

  }
  EVENTS
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      InetactionTmplTemp@1100281002 : TEMPORARY Record 5064;
      AttachmentTemp@1100281003 : TEMPORARY Record 5062;
      FilePath@1100281001 : Text[250];
      AttachNo@1100281000 : Integer;
      InteractionTemp@1100281004 : Record 5064;
      InteractionTempField@1100281005 : Record 50083;
      InteracTempLang@1100281006 : Record 5103;
      Attach@1100281007 : Record 5062;

    PROCEDURE SetPath@1100281001(pFilePath@1100281001 : Text[250]);
    VAR
      i@1100281000 : Integer;
    BEGIN
      FilePath := pFilePath;
      i := STRLEN(FilePath);
      WHILE FilePath[i] <> '\' DO BEGIN
        i-=1;
      END;

      FilePath := COPYSTR(FilePath,1,i);
    END;

    PROCEDURE ExportAttach@1100281020(VAR pAttachment@1100281000 : Record 5062);
    VAR
      l3TierAutomationMgt@1100281002 : Codeunit 419;
      lBLOBRef@1100281001 : TEMPORARY Record 99008535;
      lFileName@1100281003 : Text[1024];
      lFileName2@1100281005 : Text[1024];
      lTemporaryFileName@1100281004 : Text[1024];
    BEGIN
      lFileName := FilePath + FORMAT(pAttachment."No.") + '_Attach.' + pAttachment."File Extension";
      //<<IMH02.PC
      lFileName2 := FORMAT(pAttachment."No.") + '_Attach.' + pAttachment."File Extension";
      lTemporaryFileName := TEMPORARYPATH + FORMAT(pAttachment."No.") + '_Attach.' + pAttachment."File Extension";
      //>>IMH02.PC

      CASE pAttachment."Storage Type" OF
        pAttachment."Storage Type"::Embedded : BEGIN
          pAttachment.CALCFIELDS(Attachment);
          IF pAttachment.Attachment.HASVALUE THEN BEGIN
            lBLOBRef.Blob := pAttachment.Attachment;
            l3TierAutomationMgt.BLOBExport(lBLOBRef, lFileName, FALSE);
            {
            //<<IMH02.PC
            IF ISSERVICETIER THEN BEGIN
              pAttachment.Attachment.EXPORT(lTemporaryFileName);
              DOWNLOAD(lTemporaryFileName,'',FilePath,'',lFileName2);
            END ELSE BEGIN
            //>>IMH02.PC
              pAttachment.Attachment.EXPORT(lFileName);
            END;
            }
          END;
        END;
        pAttachment."Storage Type"::"Disk File" : BEGIN
          IF pAttachment."Storage Pointer" <> '' THEN BEGIN
            l3TierAutomationMgt.BLOBImport(lBLOBRef, pAttachment.ConstDiskFileName, FALSE);
            l3TierAutomationMgt.BLOBExport(lBLOBRef, lFileName, FALSE);

            {
            lBLOBRef.Blob.IMPORT(pAttachment.ConstDiskFileName);
            //<<IMH02.PC
            IF ISSERVICETIER THEN BEGIN
              lBLOBRef.Blob.EXPORT(lTemporaryFileName);
              DOWNLOAD(lTemporaryFileName,'a',FilePath,'a',lFileName2);
            END ELSE BEGIN
            //>>IMH02.PC
              lBLOBRef.Blob.EXPORT(lFileName);
            END;
            }
          END;
        END;
      END;

      lFileName := FilePath + FORMAT(pAttachment."No.") + '_MergeSource.' + pAttachment."File Extension";
      pAttachment.CALCFIELDS("Merge Source");
      IF pAttachment."Merge Source".HASVALUE THEN BEGIN
        lBLOBRef.Blob := pAttachment."Merge Source";
        l3TierAutomationMgt.BLOBExport(lBLOBRef, lFileName, FALSE);
        //<<IMH02.PC
        {
        IF ISSERVICETIER THEN BEGIN
          pAttachment."Merge Source".EXPORT(lTemporaryFileName);
          DOWNLOAD(lTemporaryFileName,'a',FilePath,'a',lFileName2);
        END ELSE BEGIN
        //>>IMH02.PC
          pAttachment."Merge Source".EXPORT(lFileName);
        END;
        }
      END;
    END;

    PROCEDURE ImportAttach@1100281046(VAR pAttachment@1100281000 : Record 5062);
    VAR
      l3TierAutomationMgt@1100281003 : Codeunit 419;
      lBLOBRef@1100281004 : TEMPORARY Record 99008535;
      lFileName@1100281001 : Text[1024];
      lBool@1100281002 : Boolean;
    BEGIN
      lFileName := FilePath + FORMAT(pAttachment."No.") + '_Attach.' + pAttachment."File Extension";
      IF EXISTS(lFileName) THEN BEGIN
        lBool := pAttachment."Read Only";
        pAttachment."No." := 0;
        pAttachment."Read Only" := FALSE;
        pAttachment.SetSkipImportDialog(TRUE);
        pAttachment.ImportAttachment(lFileName, FALSE, FALSE);
        pAttachment."Read Only" := lBool;
      END ELSE BEGIN
        pAttachment."No." := 0;
        pAttachment.INSERT(TRUE);
      END;


      lFileName := FilePath + FORMAT(pAttachment."No.") + '_MergeSource.' + pAttachment."File Extension";
      IF EXISTS(lFileName) THEN BEGIN
        //l3TierAutomationMgt.BLOBImport(lBLOBRef, lFileName, FALSE);
        //pAttachment."Merge Source" := lBLOBRef.Blob;
        pAttachment."Merge Source".IMPORT(lFileName);
      END;
      //pAttachment.Modify(false);
    END;

    BEGIN
    {
      /** @r IMH02 @d 26/08/11 @a ISAT.PC @v IMH6.01.108 @s Interactions @c Gestion du service tiers */
      /** @r IMH01 @d 21/02/11 @a ISAT.ZW @v IMH6.01.108 @s Interactions @c Cr‚ation */
    }
    END.
  }
}