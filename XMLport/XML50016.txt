OBJECT XMLport 50016 Export Interaction
{
  OBJECT-PROPERTIES
  {
    Date=10/04/14;
    Time=12:20:59;
    Modified=Yes;
    Version List=IMH6.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Import/Export Interaction;
               FRA=Import/Export Interaction];
    Direction=Export;
    Format=Variable Text;
    FieldSeparator=<TAB>;
  }
  ELEMENTS
  {
    { [{30FB5C61-3939-4F70-9103-4438DCB90EC0}];  ;ROOT                ;Element ;Text     }

    { [{D3EAD9DE-8C0B-43F4-A1C1-DC8758BBE04C}];1 ;InteractionTemplate ;Element ;Table   ;
                                                  VariableName=Interaction Template;
                                                  SourceTable=Table5064;
                                                  Import::OnBeforeInsertRecord=BEGIN
                                                                                 IF "Interaction Template".Code = '' THEN
                                                                                   currXMLport.SKIP;
                                                                               END;

                                                  Export::OnAfterGetRecord=BEGIN
                                                                             InetactionTmplTemp.Code := "Interaction Template".Code;
                                                                             InetactionTmplTemp.INSERT;
                                                                           END;
                                                                            }

    { [{E10DB46E-CAAE-4FAC-9076-A9EEDB70EA6F}];2 ;Code                ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Interaction Template::Code }

    { [{7819A68A-A1B4-4D7A-A2A5-EC22BEF2A7D9}];2 ;InteractionGroupCode;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Interaction Template::Interaction Group Code }

    { [{B5F01A1F-CA41-490E-94CE-A28F762138A8}];2 ;Description         ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Interaction Template::Description }

    { [{140F39D5-1CA9-4953-A83D-5BF4DC1E16FB}];2 ;UnitCostLCY         ;Element ;Field   ;
                                                  DataType=Decimal;
                                                  SourceField=Interaction Template::Unit Cost (LCY) }

    { [{5A502C7E-D280-41E6-BED6-A4C49F989FE5}];2 ;UnitDurationMin     ;Element ;Field   ;
                                                  DataType=Decimal;
                                                  SourceField=Interaction Template::Unit Duration (Min.) }

    { [{070F1EE9-66A2-4102-B7B6-EAE38A5C7F80}];2 ;InformationFlow     ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Interaction Template::Information Flow }

    { [{87ACE165-BDED-4EE3-BF46-23A97EDC3F95}];2 ;InitiatedBy         ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Interaction Template::Initiated By }

    { [{DC0CA865-2A23-4E5A-BD4A-ACD7563B9E29}];2 ;CampaignNo          ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Interaction Template::Campaign No. }

    { [{20B1732F-F8A2-46A5-902A-E86C5E309CCA}];2 ;CampaignTarget      ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Campaign Target }

    { [{5064596F-B11E-48AB-9130-E49D687315D3}];2 ;CampaignResponse    ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Campaign Response }

    { [{23A634B8-526A-4E1A-B599-75AD1DF57886}];2 ;CorrespondenceTypeDefault;Element;Field;
                                                  DataType=Option;
                                                  SourceField=Interaction Template::Correspondence Type (Default) }

    { [{5022C4E3-90C9-4712-874A-34DBE66E96E0}];2 ;LanguageCodeDefault ;Element ;Field   ;
                                                  DataType=Code;
                                                  FieldValidate=No;
                                                  SourceField=Interaction Template::Language Code (Default) }

    { [{DAE46961-4062-465B-9A16-F600C313DB08}];2 ;WizardAction        ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Interaction Template::Wizard Action }

    { [{7D22A485-1ABE-4B5D-BCA9-C2D82163AAB8}];2 ;IgnoreContactCorresType;Element;Field ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Ignore Contact Corres. Type }

    { [{6EFEEA71-A853-4ED3-9EF9-ADAF0D100F24}];2 ;MailAttachment      ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Mail Attachment }

    { [{155FA783-6996-41B2-9F87-67CFBCB5175E}];2 ;MailAttachmentName  ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Interaction Template::Mail Attachment Name }

    { [{E040299B-D978-4E72-A7BD-5CBD45D0D50F}];2 ;AutomaticSendMail   ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Automatic Send Mail }

    { [{37AE8972-0F05-49C3-A365-513550F15DB6}];2 ;DefaultInteractionDesc;Element;Field  ;
                                                  DataType=Text;
                                                  SourceField=Interaction Template::Default Interaction Descr. }

    { [{90BDC407-E5C3-4AFC-8751-1F8BDAA93E78}];2 ;ServiceContactDest  ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Interaction Template::Service Contact Dest. }

    { [{AA8C9E67-4B3C-4D25-85E9-648C2E9172B7}];2 ;SendToAdminContact  ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Send To Admin. Contact }

    { [{AEB04FED-1014-4DBC-908F-61C8F6E567B6}];2 ;ServiceContactDestCC;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Interaction Template::Service Contact Dest. CC }

    { [{930EA3A0-4285-4CCD-8510-47EDEE04EB97}];2 ;AttachmentReadOnly  ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Attachment Read Only }

    { [{D6D4DEDE-538E-4034-B8E2-10BF7BC9E93D}];2 ;DescriptionReadOnly ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Description Read Only }

    { [{4C2164DE-1E36-4D79-9C33-CF9145370621}];2 ;AskForAttachment    ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Ask For Attachment }

    { [{B9D0DF7F-3648-44C6-8F07-BABF43C3A364}];2 ;ShowToContact       ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Show To Contact }

    { [{A7DF0B02-16E4-4192-94EC-CFCA79FBD9B8}];2 ;ShowToService       ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Show To Service }

    { [{0BCB45BC-BE96-4A48-8245-7A4248BC0B97}];2 ;ShowToServiceHeader ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Show To Service Header }

    { [{F542FEB1-A95E-4A1E-837E-E49C0DDB8E15}];2 ;ShowToIntervention  ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Show To Intervention }

    { [{AC210321-44F4-4893-A89E-5E547C4DCABC}];2 ;ShowToPuchaseHeader ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Show To Puchase Header }

    { [{00114B58-F6D3-44BD-A323-7AF5BA2DC5E3}];2 ;BuiltFieldNb        ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Interaction Template::Built Field Nb }

    { [{37EDDE77-C49C-42A0-99B3-1BEB7D483DFC}];2 ;QuoteFormulaNb      ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Interaction Template::Quote Formula Nb }

    { [{85F2CA6D-BCCB-42CE-BACA-9F2F0530081E}];2 ;LocationFormulaNb   ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Interaction Template::Location Formula Nb }

    { [{10F92010-1130-44D7-8DA4-FA553C2544AB}];2 ;QuoteFormula        ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Interaction Template::Quote Formula }

    { [{9047BBC3-E036-4A8E-A872-E2FA837BA2BA}];2 ;LocationFormula     ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Interaction Template::Location Formula }

    { [{425DDD78-2BBD-42B8-9B75-50E37DD41803}];2 ;BuiltFieldCode1     ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Interaction Template::Built Field Code 1 }

    { [{647782CA-6669-4E80-9F7E-7CD40D13D68C}];2 ;BuiltFieldCode2     ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Interaction Template::Built Field Code 2 }

    { [{FEA8D0D2-2AAE-4C74-B1FD-20447C805F06}];2 ;BuiltFieldCode3     ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Interaction Template::Built Field Code 3 }

    { [{15E870C1-4164-4E65-953D-933FE77F3500}];2 ;BuiltFieldCode4     ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Interaction Template::Built Field Code 4 }

    { [{3D845CBA-B600-4C44-ADAF-531213F542C7}];2 ;BuiltFieldCode5     ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Interaction Template::Built Field Code 5 }

    { [{0F3C6179-7B54-4B98-8F94-CF8C415EFDCC}];2 ;BuiltFieldCode6     ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Interaction Template::Built Field Code 6 }

    { [{C9DE0060-C438-444C-81A0-0D52090D1893}];2 ;BuiltFieldCode7     ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Interaction Template::Built Field Code 7 }

    { [{CB8A0464-A171-4CC9-A211-C55E4D4468F6}];2 ;BuiltFieldCode8     ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Interaction Template::Built Field Code 8 }

    { [{2703965A-4F05-44BA-A2AC-ABB3C61AB4FA}];2 ;BuiltFieldCode9     ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Interaction Template::Built Field Code 9 }

    { [{5F71A2C8-D64F-4ABD-A424-C81F48ECC2D7}];2 ;BuiltFieldCode10    ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Interaction Template::Built Field Code 10 }

    { [{7FE78663-B45A-45A7-9748-A75213009D59}];2 ;Checked             ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Checked }

    { [{0F43708E-5AD0-4438-8D14-92C21262860A}];2 ;ShowToDGS           ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Show To DGS }

    { [{E8B055FD-43AD-403A-B03F-1A3E4DCDE5D2}];2 ;ShowToDPR           ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Show To DPR }

    { [{07DF7A2B-400E-417C-BCB0-4C9A1C41BC47}];2 ;ShowToDFC           ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Show To DFC }

    { [{53456A4F-0004-4BE4-8DAB-730C169A6100}];2 ;ShowToDQP           ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Show To DQP }

    { [{3923BF80-C351-405B-99BB-60BF6628747B}];2 ;ShowingFilter       ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Interaction Template::Showing Filter }

    { [{F82317E6-0FC0-48A8-A23B-0CD06F716B82}];2 ;MailObjectAuto      ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Mail Object Auto }

    { [{7801B817-9EDE-4EA1-9174-A223F9EB2E6F}];2 ;NotifyToExtranet    ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Interaction Template::Notify To Extranet }

    { [{D061F29B-7EFB-424D-A784-A06E1F2A5CDC}];1 ;InteractionTemplateField;Element;Table;
                                                  SourceTable=Table50083;
                                                  LinkTable=Interaction Template;
                                                  Export::OnAfterGetRecord=BEGIN
                                                                             IF NOT InetactionTmplTemp.GET("Interaction Template Field"."Interaction Template Code") THEN
                                                                               currXMLport.SKIP;
                                                                           END;
                                                                            }

    { [{8EE1BFB7-66E4-4D33-988D-4ECB8ADDEEF7}];2 ;InteractionTemplateCode;Element;Field ;
                                                  DataType=Code;
                                                  SourceField=Interaction Template Field::Interaction Template Code }

    { [{FF2E3708-A07F-43E1-8BDC-87A02262F967}];2 ;SourceTableID       ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Interaction Template Field::Source Table ID }

    { [{27612043-825A-4019-B4D1-6BEE09061DB6}];2 ;SourceFieldNo       ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Interaction Template Field::Source Field No. }

    { [{CA79ED16-94E0-4F7B-8398-EE8D2320D4F4}];2 ;SourceTable         ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Interaction Template Field::Source Table }

    { [{F4069FAA-8614-4BAE-ABAD-F87490DC03FB}];2 ;MergeFieldName      ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Interaction Template Field::Merge Field Name }

    { [{6AA28DF5-62A5-4C63-A94B-A1A96AB69BC1}];1 ;BuiltMergeField     ;Element ;Table   ;
                                                  VariableName=Built Merge Field;
                                                  SourceTable=Table50140;
                                                  LinkTable=Interaction Template;
                                                  Export::OnAfterGetRecord=VAR
                                                                             lInteractionTemplate@1000000000 : Record 5064;
                                                                             lToExport@1000000001 : Boolean;
                                                                           BEGIN
                                                                             IF "Built Merge Field".Code = '' THEN
                                                                               currXMLport.SKIP;
                                                                             InetactionTmplTemp.RESET;
                                                                             IF InetactionTmplTemp.ISEMPTY THEN
                                                                               currXMLport.SKIP;
                                                                             IF InetactionTmplTemp.FINDSET THEN
                                                                               REPEAT
                                                                                 lInteractionTemplate.GET(InetactionTmplTemp.Code);
                                                                                 IF lInteractionTemplate."Built Field Code 1" = "Built Merge Field".Code THEN
                                                                                   lToExport := TRUE;
                                                                                 IF lInteractionTemplate."Built Field Code 2" = "Built Merge Field".Code THEN
                                                                                   lToExport := TRUE;
                                                                                 IF lInteractionTemplate."Built Field Code 3" = "Built Merge Field".Code THEN
                                                                                   lToExport := TRUE;
                                                                                 IF lInteractionTemplate."Built Field Code 4" = "Built Merge Field".Code THEN
                                                                                   lToExport := TRUE;
                                                                                 IF lInteractionTemplate."Built Field Code 5" = "Built Merge Field".Code THEN
                                                                                   lToExport := TRUE;
                                                                                 IF lInteractionTemplate."Built Field Code 6" = "Built Merge Field".Code THEN
                                                                                   lToExport := TRUE;
                                                                                 IF lInteractionTemplate."Built Field Code 7" = "Built Merge Field".Code THEN
                                                                                   lToExport := TRUE;
                                                                                 IF lInteractionTemplate."Built Field Code 8" = "Built Merge Field".Code THEN
                                                                                   lToExport := TRUE;
                                                                                 IF lInteractionTemplate."Built Field Code 9" = "Built Merge Field".Code THEN
                                                                                   lToExport := TRUE;
                                                                                 IF lInteractionTemplate."Built Field Code 10" = "Built Merge Field".Code THEN
                                                                                   lToExport := TRUE;
                                                                               UNTIL (InetactionTmplTemp.NEXT = 0) OR lToExport;
                                                                             IF NOT lToExport THEN
                                                                               currXMLport.SKIP
                                                                             ELSE BEGIN
                                                                               BuiltMergeFieldTemp.RESET;
                                                                               BuiltMergeFieldTemp.SETRANGE(Code, "Built Merge Field".Code);
                                                                               IF BuiltMergeFieldTemp.ISEMPTY THEN BEGIN
                                                                                 BuiltMergeFieldTemp.Code := "Built Merge Field".Code;
                                                                                 BuiltMergeFieldTemp.INSERT;
                                                                               END;
                                                                             END;
                                                                           END;
                                                                            }

    { [{20E2297E-FF0B-44E7-88A9-DFD4CFACFC08}];2 ;Code                ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Built Merge Field::Code }

    { [{F1FA8779-1C6A-4CAF-8B37-0163775C1693}];2 ;CorporateNo         ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Built Merge Field::Corporate No. }

    { [{D1AFEA1F-AFB8-483D-BE54-2FEAD8AF541B}];2 ;ServiceOrderType    ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Built Merge Field::Service Order Type }

    { [{DB0CA554-55E4-4979-9C0A-9B89555617EF}];2 ;Requisitioner       ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Built Merge Field::Requisitioner }

    { [{F739C1AF-73C0-422F-9B4F-421812C295BE}];2 ;ServiceReasonCode   ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Built Merge Field::Service Reason Code }

    { [{2374E8B6-7644-4355-AB65-4BA4BB1DEB98}];2 ;Moisture            ;Element ;Field   ;
                                                  DataType=Decimal;
                                                  SourceField=Built Merge Field::Moisture % }

    { [{3EEABEE5-A94C-429A-A6A0-356DD45489F9}];2 ;NextAppointmentDate ;Element ;Field   ;
                                                  DataType=Date;
                                                  SourceField=Built Merge Field::Next Appointment Date }

    { [{8684A7BA-5F6F-442B-94BA-B49421B9E532}];2 ;NextAppointmentDateModified;Element;Field;
                                                  DataType=Option;
                                                  SourceField=Built Merge Field::Next Appointment Date Modified }

    { [{AA9020A3-BDF1-4392-8A1E-4185553CA789}];2 ;AcceptedActifQuoteExists;Element;Field;
                                                  DataType=Option;
                                                  SourceField=Built Merge Field::Accepted Actif Quote Exists }

    { [{EEAC0069-E64E-4C1F-831A-A4A2935A6684}];2 ;CancelReasonCode    ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Built Merge Field::Cancel Reason Code }

    { [{2D88CD51-4163-4D09-AEC0-230747BA0BAC}];2 ;InterventionCeilingExceeded;Element;Field;
                                                  DataType=Option;
                                                  SourceField=Built Merge Field::Intervention Ceiling Exceeded }

    { [{5170B876-4C08-4070-9CF6-3FE0779B438A}];2 ;OccupierNature      ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Built Merge Field::Occupier Nature }

    { [{777A9351-0497-46E8-9BDE-70154CDC0BA2}];2 ;HousingType         ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Built Merge Field::Housing Type }

    { [{A56484FF-6621-459E-A932-DFFD35BDEB78}];2 ;ExpectedWorkEndDateExist;Element;Field;
                                                  DataType=Option;
                                                  SourceField=Built Merge Field::Expected Work End Date Exist }

    { [{8D1C4D28-AD55-4F42-9CDE-572BBF97D2AA}];2 ;LineNo              ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field::Line No. }

    { [{1A840E43-908E-429E-B152-673435844842}];2 ;ClosedReasonCode    ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Built Merge Field::Closed Reason Code }

    { [{619DBDA1-0A30-4E33-9928-759B5B54A6E1}];2 ;MoistureExist       ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Built Merge Field::Moisture Exist }

    { [{2E83EAF4-5068-4FFE-9609-ADF3023D1C55}];2 ;NextAppointmentDateEdit;Element;Field ;
                                                  DataType=Option;
                                                  SourceField=Built Merge Field::Next Appointment Date Edit }

    { [{605DBB29-BEA8-4AB7-B8A4-715BBD403478}];2 ;QuoteDemand         ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Built Merge Field::Quote Demand }

    { [{F1F267A7-24E2-4600-ACF8-348D8B1C1ED0}];2 ;DeductibleDepreciationAmt;Element;Field;
                                                  DataType=Option;
                                                  SourceField=Built Merge Field::Deductible + Depreciation Amt. }

    { [{97889895-4D21-4D04-8483-ED02CDACA2E4}];2 ;PaymentMethod       ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Built Merge Field::Payment Method }

    { [{900078A1-917C-4149-872A-8E2CF4CE1B18}];2 ;SentenceNo          ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Built Merge Field::Sentence No. }

    { [{48C73724-77FF-4D16-8AA9-EB19FBDA4F14}];1 ;BuiltMergeFieldDetail;Element;Table   ;
                                                  VariableName=Built Merge Field Detail;
                                                  SourceTable=Table50141;
                                                  Export::OnAfterGetRecord=BEGIN
                                                                             BuiltMergeFieldTemp.RESET;
                                                                             BuiltMergeFieldTemp.SETRANGE(Code, "Built Merge Field Detail"."Built Merge Field Code");
                                                                             IF BuiltMergeFieldTemp.ISEMPTY THEN
                                                                               currXMLport.SKIP;
                                                                           END;
                                                                            }

    { [{6A9AD801-47F0-4F67-BB6B-74E4F9CA5263}];2 ;BuiltMergeFieldCode ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Built Merge Field Detail::Built Merge Field Code }

    { [{4D3ED345-153C-4FFC-BBAB-2D4565929F75}];2 ;SentenceNo          ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Built Merge Field Detail::Sentence No. }

    { [{B6310893-B1ED-4195-BD29-558F31C49252}];2 ;Sentence            ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Built Merge Field Detail::Sentence }

    { [{91EF517C-9D0E-4CED-AF6A-4DC95189B743}];2 ;SourceTableID1      ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Table ID 1 }

    { [{45932561-3F47-4125-A0E3-CA3D1E6EEA97}];2 ;SourceFieldNo1      ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Field No. 1 }

    { [{54A57456-6CB0-4475-9465-E5B49B7A7EE0}];2 ;SourceTable1        ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Built Merge Field Detail::Source Table 1 }

    { [{5594C0D7-961E-4596-967A-A97625281C93}];2 ;SourceTableID2      ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Table ID 2 }

    { [{4F18570C-54DD-42BA-A6B4-056A1D04B5D4}];2 ;SourceFieldNo2      ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Field No. 2 }

    { [{6CB56669-1DBC-487C-81AB-1E808214D8FE}];2 ;SourceTable2        ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Built Merge Field Detail::Source Table 2 }

    { [{F6D4AB40-2D03-48A0-AE00-4801231F7F91}];2 ;SourceTableID3      ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Table ID 3 }

    { [{4BE38AE8-32C0-4A2E-8E99-87C73882ED18}];2 ;SourceFieldNo3      ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Field No. 3 }

    { [{27D2A7DA-515D-47C5-AA08-C41C524001B3}];2 ;SourceTable3        ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Built Merge Field Detail::Source Table 3 }

    { [{1974BCF6-7F2D-4EE5-9C38-EBDB6B9E96C7}];2 ;SourceTableID4      ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Table ID 4 }

    { [{4A29BC32-1E64-448A-8ADE-50FC4088354B}];2 ;SourceFieldNo4      ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Field No. 4 }

    { [{479D48B5-622E-4B35-AFB1-2D58F76DF947}];2 ;SourceTable4        ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Built Merge Field Detail::Source Table 4 }

    { [{8F379265-FA35-4145-8AD0-CDAC11363848}];2 ;SourceTableID5      ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Table ID 5 }

    { [{94729A3B-AF32-4787-95E1-E736D91450D4}];2 ;SourceFieldNo5      ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Field No. 5 }

    { [{AA9E428B-620E-4088-8189-3D84B889CC36}];2 ;SourceTable5        ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Built Merge Field Detail::Source Table 5 }

    { [{B9E5356E-B073-4C3E-A378-D71461D0DA8A}];2 ;SourceTableID6      ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Table ID 6 }

    { [{2641C078-893A-4367-B2D9-CF45208D01CB}];2 ;SourceFieldNo6      ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Field No. 6 }

    { [{706D926A-AE4C-40B1-8949-BCDAFB4B0395}];2 ;SourceTable6        ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Built Merge Field Detail::Source Table 6 }

    { [{221D3722-C247-4061-B4B7-D5DCB2FFCD3C}];2 ;SourceTableID7      ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Table ID 7 }

    { [{977F40DC-7AD3-40F6-A484-BEFA714BC57B}];2 ;SourceFieldNo7      ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Field No. 7 }

    { [{7A181DF7-5E6C-4383-B359-9A9ABE7FBD39}];2 ;SourceTable7        ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Built Merge Field Detail::Source Table 7 }

    { [{25B269EA-D6E0-4F50-B352-C6A0C44FF70D}];2 ;SourceTableID8      ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Table ID 8 }

    { [{643E46B6-609B-4C8B-AE02-BCE190A1EB64}];2 ;SourceFieldNo8      ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Field No. 8 }

    { [{B46E2E61-53D2-40F6-A4D2-CDC1BB290B99}];2 ;SourceTable8        ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Built Merge Field Detail::Source Table 8 }

    { [{BDA566D6-3775-4D69-9CF1-85BBFA21E789}];2 ;SourceTableID9      ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Table ID 9 }

    { [{215E6EC8-2E7B-457E-8369-EEAFEC31EF61}];2 ;SourceFieldNo9      ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Field No. 9 }

    { [{B64C000B-EBB4-43D9-A3A1-FDF15F9B9450}];2 ;SourceTable9        ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Built Merge Field Detail::Source Table 9 }

    { [{4C93FD79-1CBB-48A8-BD95-524D406DCB0C}];2 ;SourceTableID10     ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Table ID 10 }

    { [{D6086C4E-8F2E-4B1D-A158-F3F1DF711DFC}];2 ;SourceFieldNo10     ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Built Merge Field Detail::Source Field No. 10 }

    { [{3A8CDF7D-124C-4D4B-8E14-095260D0AD6F}];2 ;SourceTable10       ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Built Merge Field Detail::Source Table 10 }

    { [{57A9BCD2-7373-40F7-AA67-99EB66B5D56B}];1 ;InteractionTmplLanguage;Element;Table ;
                                                  SourceTable=Table5103;
                                                  Export::OnAfterGetRecord=BEGIN
                                                                             IF NOT InetactionTmplTemp.GET("Interaction Tmpl. Language"."Interaction Template Code") THEN
                                                                               currXMLport.SKIP;

                                                                             AttachmentTemp."No." := "Interaction Tmpl. Language"."Attachment No.";
                                                                             IF AttachmentTemp.INSERT(FALSE) THEN;
                                                                           END;
                                                                            }

    { [{B5AA2EC7-F246-4EBA-9336-B1021801F2D7}];2 ;InteractionTemplateCode;Element;Field ;
                                                  DataType=Code;
                                                  SourceField=Interaction Tmpl. Language::Interaction Template Code }

    { [{F833EFAD-F7EA-4391-BC3B-D00F617025F7}];2 ;LanguageCode        ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Interaction Tmpl. Language::Language Code }

    { [{FFE3CE6C-120A-436C-954F-76DA949B3CE2}];2 ;Description         ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Interaction Tmpl. Language::Description }

    { [{EBB8599D-ED05-4FCF-8664-859DE2688F7B}];2 ;AttachmentNo        ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Interaction Tmpl. Language::Attachment No. }

    { [{0DF62C7D-E529-4BB4-953C-D11C1A90383D}];1 ;Attachment          ;Element ;Table   ;
                                                  SourceTable=Table5062;
                                                  Import::OnBeforeInsertRecord=VAR
                                                                                 lAttachment@1100281002 : Record 5062;
                                                                                 lInteractTmplLanguage@1100281001 : Record 5103;
                                                                                 lOldAttchNo@1100281000 : Integer;
                                                                               BEGIN
                                                                                 lAttachment := Attachment;
                                                                                 lOldAttchNo := Attachment."No.";
                                                                                 ImportAttach(lAttachment);
                                                                                 lAttachment."Last Date Modified" := Attachment."Last Date Modified";
                                                                                 lAttachment."Last Time Modified" := Attachment."Last Time Modified";
                                                                                 IF lAttachment.MODIFY(FALSE) THEN;
                                                                                 lInteractTmplLanguage.SETRANGE("Attachment No.", lOldAttchNo);
                                                                                 //IF lInteractTmplLanguage.FINDFIRST THEN BEGIN
                                                                                 //  lInteractTmplLanguage."Attachment No." := lAttachment."No.";
                                                                                 lInteractTmplLanguage.MODIFYALL("Attachment No.", lAttachment."No.");
                                                                                 //END;

                                                                                 currXMLport.SKIP;
                                                                               END;

                                                  Export::OnAfterGetRecord=BEGIN
                                                                             IF NOT AttachmentTemp.GET(Attachment."No.") THEN
                                                                               currXMLport.SKIP;
                                                                             ExportAttach(Attachment);
                                                                           END;
                                                                            }

    { [{27EC8035-4482-459C-8259-308020A73526}];2 ;No                  ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Attachment::No. }

    { [{FD791DA9-D3A1-4058-95E0-C23B97BCB23E}];2 ;StorageType         ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Attachment::Storage Type }

    { [{1A8E3266-6FAD-4515-9FCD-01628F8689E1}];2 ;StoragePointer      ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Attachment::Storage Pointer }

    { [{E9D6E682-1E2A-4700-8E42-93F282BDAF3D}];2 ;FileExtension       ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Attachment::File Extension }

    { [{E2296E3F-42C6-4EED-A153-19413DA5FF25}];2 ;ReadOnly            ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=Attachment::Read Only }

    { [{5B3F4C76-C633-4FF7-88F9-E2189CE9EA52}];2 ;LastDateModified    ;Element ;Field   ;
                                                  DataType=Date;
                                                  SourceField=Attachment::Last Date Modified }

    { [{D39BB5AD-2D02-454F-95E3-8E5538DA3FDC}];2 ;LastTimeModified    ;Element ;Field   ;
                                                  DataType=Time;
                                                  SourceField=Attachment::Last Time Modified }

    { [{4809093A-F66C-4222-AD6A-5AD2304726FC}];2 ;StorePointerChecksum;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Attachment::Store Pointer Checksum }

    { [{B8CDE177-5804-4ADB-9D70-278C31E12E8C}];2 ;EntryPointerChecksum;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Attachment::Entry Pointer Checksum }

    { [{CC60394E-4E11-42BA-8789-0482B5C8B664}];2 ;ServiceHeaderNo     ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Attachment::Service Header No. }

  }
  EVENTS
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      InetactionTmplTemp@1100281002 : TEMPORARY Record 50029;
      AttachmentTemp@1100281003 : TEMPORARY Record 5062;
      BuiltMergeFieldTemp@1000000000 : TEMPORARY Record 50140;
      FilePath@1100281001 : Text[250];
      AttachNo@1100281000 : Integer;

    PROCEDURE SetPath@1100281001(pFilePath@1100281001 : Text[250]);
    VAR
      i@1100281000 : Integer;
    BEGIN
      FilePath := pFilePath;
      i := STRLEN(FilePath);
      WHILE FilePath[i] <> '\' DO BEGIN
        i-=1;
      END;

      FilePath := COPYSTR(FilePath,1,i);
    END;

    PROCEDURE ExportAttach@1100281020(VAR pAttachment@1100281000 : Record 5062);
    VAR
      l3TierAutomationMgt@1100281002 : Codeunit 419;
      lBLOBRef@1100281001 : TEMPORARY Record 99008535;
      lFileName@1100281003 : Text[1024];
      lFileName2@1100281005 : Text[1024];
      lTemporaryFileName@1100281004 : Text[1024];
    BEGIN
      lFileName := FilePath + FORMAT(pAttachment."No.") + '_Attach.' + pAttachment."File Extension";
      //<<IMH02.PC
      lFileName2 := FORMAT(pAttachment."No.") + '_Attach.' + pAttachment."File Extension";
      lTemporaryFileName := TEMPORARYPATH + FORMAT(pAttachment."No.") + '_Attach.' + pAttachment."File Extension";
      //>>IMH02.PC
      CASE pAttachment."Storage Type" OF
        pAttachment."Storage Type"::Embedded : BEGIN
          pAttachment.CALCFIELDS(Attachment);
          IF pAttachment.Attachment.HASVALUE THEN BEGIN
            lBLOBRef.Blob := pAttachment.Attachment;
            lBLOBRef.Blob.EXPORT(lFileName);
            //l3TierAutomationMgt.BLOBExport(lBLOBRef, lFileName, FALSE);
            {
            //<<IMH02.PC
            IF ISSERVICETIER THEN BEGIN
              pAttachment.Attachment.EXPORT(lTemporaryFileName);
              DOWNLOAD(lTemporaryFileName,'',FilePath,'',lFileName2);
            END ELSE BEGIN
            //>>IMH02.PC
              pAttachment.Attachment.EXPORT(lFileName);
            END;
            }
          END;
        END;
        pAttachment."Storage Type"::"Disk File" : BEGIN
          IF pAttachment."Storage Pointer" <> '' THEN BEGIN
            l3TierAutomationMgt.BLOBImport(lBLOBRef, pAttachment.ConstDiskFileName, FALSE);
            l3TierAutomationMgt.BLOBExport(lBLOBRef, lFileName, FALSE);

            {
            lBLOBRef.Blob.IMPORT(pAttachment.ConstDiskFileName);
            //<<IMH02.PC
            IF ISSERVICETIER THEN BEGIN
              lBLOBRef.Blob.EXPORT(lTemporaryFileName);
              DOWNLOAD(lTemporaryFileName,'a',FilePath,'a',lFileName2);
            END ELSE BEGIN
            //>>IMH02.PC
              lBLOBRef.Blob.EXPORT(lFileName);
            END;
            }
          END;
        END;
      END;

      lFileName := FilePath + FORMAT(pAttachment."No.") + '_MergeSource.' + pAttachment."File Extension";
      pAttachment.CALCFIELDS("Merge Source");
      IF pAttachment."Merge Source".HASVALUE THEN BEGIN
        lBLOBRef.Blob := pAttachment."Merge Source";
        //l3TierAutomationMgt.BLOBExport(lBLOBRef, lFileName, FALSE);
        lBLOBRef.Blob.EXPORT(lFileName);
        //<<IMH02.PC
        {
        IF ISSERVICETIER THEN BEGIN
          pAttachment."Merge Source".EXPORT(lTemporaryFileName);
          DOWNLOAD(lTemporaryFileName,'a',FilePath,'a',lFileName2);
        END ELSE BEGIN
        //>>IMH02.PC
          pAttachment."Merge Source".EXPORT(lFileName);
        END;
        }
      END;
    END;

    PROCEDURE ImportAttach@1100281046(VAR pAttachment@1100281000 : Record 5062);
    VAR
      l3TierAutomationMgt@1100281003 : Codeunit 419;
      lBLOBRef@1100281004 : TEMPORARY Record 99008535;
      lFileName@1100281001 : Text[1024];
      lBool@1100281002 : Boolean;
    BEGIN
      lFileName := FilePath + FORMAT(pAttachment."No.") + '_Attach.' + pAttachment."File Extension";
      IF EXISTS(lFileName) THEN BEGIN
        lBool := pAttachment."Read Only";
        pAttachment."No." := 0;
        pAttachment."Read Only" := FALSE;
        pAttachment.SetSkipImportDialog(TRUE);
        pAttachment.ImportAttachment(lFileName, FALSE, FALSE);
        pAttachment."Read Only" := lBool;
      END ELSE BEGIN
        pAttachment."No." := 0;
        pAttachment.INSERT(TRUE);
      END;


      lFileName := FilePath + FORMAT(pAttachment."No.") + '_MergeSource.' + pAttachment."File Extension";
      IF EXISTS(lFileName) THEN BEGIN
        //l3TierAutomationMgt.BLOBImport(lBLOBRef, lFileName, FALSE);
        //pAttachment."Merge Source" := lBLOBRef.Blob;
        pAttachment."Merge Source".IMPORT(lFileName);
      END;
      //pAttachment.Modify(false);
    END;

    BEGIN
    {
      /** @r IMH05 @d 12/12/13 @a IMH.DBR @v IMH6.01.2812 @s MAD Carence depuis ligne produit @h 2812
          @c Carence ne fonctionne pas depuis la ligne produit quand il n'y a pas d'intervention  */
      /** @r IMH04 @d 04/03/13 @a ISAT.ZW @v IMH6.01.340 @s NEP IMH 4 @h 4340 @c Gestion Distinataire service : Expert / cabinet Expert */
      /** @r IMH03 @d 14/05/12 @a ISAT.LLT @v IMH6.01.108 @s Interactions @h 2355 @c Export par slection */
      /** @r IMH02 @d 26/08/11 @a ISAT.PC @v IMH6.01.108 @s Interactions @c Gestion du service tiers */
      /** @r IMH01 @d 21/02/11 @a ISAT.ZW @v IMH6.01.108 @s Interactions @c Cration */
    }
    END.
  }
}